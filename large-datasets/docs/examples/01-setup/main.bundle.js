!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){(function(t,e){
/**
 * Ogma
 * @description Graph visualization library
 * @version 3.1.0 (built on Fri Sep 04 2020 16:52:54 GMT+0200 (Central European Summer Time))
 * @author Linkurious SAS
 * @license (c) Linkurious 2020. All rights reserved.
 * @preserve
 */
e.exports=function(){"use strict";function i(t){return"function"==typeof t||"[object Function]"===n.call(t)}function r(t){var e=function(t){var e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e}(t);return Math.min(Math.max(e,0),o)}var n,o;Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),i=e.length>>>0,r=arguments[1]>>0,n=r<0?Math.max(i+r,0):Math.min(r,i),o=arguments[2],a=void 0===o?i:o>>0,s=a<0?Math.max(i+a,0):Math.min(a,i);n<s;)e[n]=t,n++;return e}}),Array.prototype.copyWithin||(Array.prototype.copyWithin=function(t,e){if(null==this)throw new TypeError("this is null or not defined");var i=Object(this),r=i.length>>>0,n=t>>0,o=n<0?Math.max(r+n,0):Math.min(n,r),a=e>>0,s=a<0?Math.max(r+a,0):Math.min(a,r),u=arguments[2],d=void 0===u?r:u>>0,l=d<0?Math.max(r+d,0):Math.min(d,r),h=Math.min(l-s,r-o),c=1;for(s<o&&o<s+h&&(c=-1,s+=h-1,o+=h-1);0<h;)s in i?i[o]=i[s]:delete i[o],s+=c,o+=c,h--;return i}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t){if(null==this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0==i)return-1;var r=i-1;1<arguments.length&&((r=Number(arguments[1]))!=r?r=0:0!=r&&r!=1/0&&r!=-1/0&&(r=(0<r?1:-1)*Math.floor(Math.abs(r))));for(var n=0<=r?Math.min(r,i-1):i-Math.abs(r);0<=n;n--)if(n in e&&e[n]===t)return n;return-1}),Array.from||(Array.from=(n=Object.prototype.toString,o=Math.pow(2,53)-1,function(t,e,n){var o=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var a,s=1<arguments.length?e:void 0;if(void 0!==s){if(!i(s))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(a=n)}for(var u,d=r(o.length),l=i(this)?Object(new this(d)):new Array(d),h=0;h<d;)u=o[h],l[h]=s?void 0===a?s(u,h):s.call(a,u,h):u,h+=1;return l.length=d,l})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(0==r)return!1;for(var n,o,a=0|e,s=Math.max(0<=a?a:r-Math.abs(a),0);s<r;){if((n=i[s])===(o=t)||"number"==typeof n&&"number"==typeof o&&isNaN(n)&&isNaN(o))return!0;s++}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],n=0;n<i;){var o=e[n];if(t.call(r,o,n,e))return o;n++}},configurable:!0,writable:!0});var a=[Uint32Array,Uint16Array,Uint8Array,Int32Array,Int16Array,Int8Array,Float32Array,Float64Array],s=["join","slice","reverse","forEach","map","includes","copyWithin","reduce","indexOf","sort","filter","every","some","fill"];ArrayBuffer.isView||(ArrayBuffer.isView=function(t){for(var e=0;e<a.length;++e)if(t instanceof a[e])return!0;return!1});for(var u,d=function(t){return function(e,i){return new t(Array.prototype.slice.call(this,e,i))}},l=function(t){for(var e=0,i=s;e<i.length;e++){var r=i[e];if(!t.prototype[r]){var n="slice"===r?d(t):Array.prototype[r];t.prototype[r]=n}}t.from||(t.from=function(e,i,r){var n=t.__proto__;if("function"!=typeof this)throw new TypeError("# is not a constructor");if(this.__proto__!==n)throw new TypeError("this is not a typed array.");if("function"!=typeof(i=i||function(t){return t}))throw new TypeError("specified argument is not a function");if(!(e=Object(e)).length)return new this(0);for(var o=[],a=0;a<e.length;a++)o.push(e[a]);var s=new this((o=o.map(i,r)).length);for(a=0;a<s.length;a++)s[a]=o[a];return s})},h=0,c=a;h<c.length;h++)l(c[h]);function f(){}function g(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],b(t,this)}function p(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,g._immediateFn((function(){var i=1===t._state?e.onFulfilled:e.onRejected;if(null!==i){var r;try{r=i(t._value)}catch(i){return void v(e.promise,i)}_(e.promise,r)}else(1===t._state?_:v)(e.promise,t._value)}))):t._deferreds.push(e)}function _(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if(e instanceof g)return t._state=3,t._value=e,void m(t);if("function"==typeof i)return void b((r=i,n=e,function(){r.apply(n,arguments)}),t)}t._state=1,t._value=e,m(t)}catch(e){v(t,e)}var r,n}function v(t,e){t._state=2,t._value=e,m(t)}function m(t){2===t._state&&0===t._deferreds.length&&g._immediateFn((function(){t._handled||g._unhandledRejectionFn(t._value)}));for(var e=0,i=t._deferreds.length;e<i;e++)p(t,t._deferreds[e]);t._deferreds=null}function y(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}function b(t,e){var i=!1;try{t((function(t){i||(i=!0,_(e,t))}),(function(t){i||(i=!0,v(e,t))}))}catch(t){if(i)return;i=!0,v(e,t)}}"undefined"==typeof CanvasRenderingContext2D||CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(t){}),Math.log2||(Math.log2=function(t){return Math.log(t)*Math.LOG2E}),Math.sign||(Math.sign=function(t){return(0<t?1:0)-(t<0?1:0)||+t}),Number.isNaN||(Number.isNaN=function(t){return"number"==typeof t&&isNaN(t)}),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{enumerable:!1,configurable:!1,writable:!1,value:Math.pow(2,53)-1}),u=setTimeout,g.prototype.catch=function(t){return this.then(null,t)},g.prototype.then=function(t,e){var i=new this.constructor(f);return p(this,new y(t,e,i)),i},g.all=function(t){var e=Array.prototype.slice.call(t);return new g((function(t,i){if(0===e.length)return t([]);var r=e.length;function n(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(t){n(o,t)}),i)}e[o]=a,0==--r&&t(e)}catch(a){i(a)}}for(var o=0;o<e.length;o++)n(o,e[o])}))},g.resolve=function(t){return t&&"object"==typeof t&&t.constructor===g?t:new g((function(e){e(t)}))},g.reject=function(t){return new g((function(e,i){i(t)}))},g.race=function(t){return new g((function(e,i){for(var r=0,n=t.length;r<n;r++)t[r].then(e,i)}))},g._immediateFn="object"==typeof t&&"function"==typeof t.setImmediate?function(e){t.setImmediate(e)}:function(t){u(t,0)},g._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},g._setImmediateFn=function(t){g._immediateFn=t},g._setUnhandledRejectionFn=function(t){g._unhandledRejectionFn=t},"object"!=typeof t||t.Promise||(t.exports=g),"object"!=typeof window||"Promise"in window||(window.Promise=g),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var i=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>i.length)&&(e=i.length),e-=t.length;var r=i.lastIndexOf(t,e);return-1!==r&&r===e}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t}),String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t){var e=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),r=1;r<arguments.length;r++){var n=e[r];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o])}return i},writable:!0,configurable:!0});var x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function E(t,e){function i(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var A=function(){return(A=Object.assign||function(t){for(var e,i=arguments,r=1,n=arguments.length;r<n;r++)for(var o in e=i[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function S(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i}function w(){for(var t=arguments,e=0,i=0,r=arguments.length;i<r;i++)e+=t[i].length;var n=Array(e),o=0;for(i=0;i<r;i++)for(var a=arguments[i],s=0,u=a.length;s<u;s++,o++)n[o]=a[s];return n}var T={},C={},M={},I=function(t){return null};if("object"==typeof t&&(C=t),"object"==typeof window&&(M=window),"function"==typeof e.require){var L=e.require.bind(e);I=function(t){try{return L(t)}catch(t){return null}}}else"function"==typeof C.require&&(I=function(t){var i=e.require;try{return i(t)}catch(t){return null}});function N(t,e){var i=(void 0===e?{}:e).throwOnError,r=null;if(!r&&t&&(r=T[t]),!r&&t&&(r=I(t)),!r&&t&&(r=M[t]),!r&&t&&(r=C[t]),r||!i)return r;var n=['unable to find module "'+t+'"; make sure one of these statements is true:',"- Ogma.libraries['"+t+"'] is set to the right library","- require('"+t+"') returns the right library","- window['"+t+"'] is set to the right library"].join("\n");throw new Error(n)}function k(t,e){for(var i=1,r=t.length;i<r;i++){for(var n=t[i],o=i;0<o&&e.get(t[o-1])>e.get(n);)t[o]=t[o-1],--o;t[o]=n}return t}function O(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function F(t){return Array.isArray(t)?t:[t]}function R(t){for(var e=[],i=0;i<t.length;++i){var r=t[i];if(Array.isArray(r))for(var n=0;n<r.length;++n)e.push(r[n]);else e.push(r)}return e}function P(t,e){var i=t.indexOf(e);return-1!==i&&(t.splice(i,1),!0)}function D(t,e){for(var i,r,n=0,o=t.length-1;n<=o;)if((r=t[i=(n+o)/2|0])<e)n=1+i;else{if(!(e<r))return i;o=i-1}return-1}function z(t){if(!t)return[];if("string"==typeof t)return t.split(".");if(Array.isArray(t)){for(var e=0;e<t.length;++e)if("string"!=typeof t[e])throw new TypeError(t[e]+" is not a string");return t.slice()}throw new TypeError('invalid property path "'+t+'": expected string or array of strings')}function B(t,e,i){var r,n,o;if(0===e)return function(){t.apply(i,arguments)};function a(){r=!1,n&&(o.apply(i,n),n=null)}return o=function(){var o;return r?n=arguments:(o=t.apply(i,arguments),setTimeout(a,e),r=!0),o}}function U(){return 120===new Uint8Array(new Uint32Array([305419896]).buffer)[0]}function V(t){return t.reduce((function(t,e){return t.then(e)}),Promise.resolve())}function j(t,e,i,r,n,o,a,s){return t+n+256*(e+o)+65536*(i+a)+16777216*(r+s)}function G(t){return!(null===t||"object"!=typeof t||O(t)||t instanceof RegExp||"undefined"!=typeof HTMLElement&&t instanceof HTMLElement)}function H(t){for(var e=Object.keys(t),i=new Array(e.length),r=0;r<e.length;++r)i[r]=t[e[r]];return i}function W(t,e,i){if(Array.isArray(t))return t.forEach(e,i);if(!G(t))throw new Error("forEach: invalid argument "+JSON.stringify(t));var r=Object.keys(t);if(void 0!==i)for(var n=0;n<r.length;++n){var o=r[n];e.call(i,t[o],o)}else for(n=0;n<r.length;++n)e(t[o=r[n]],o)}function q(t){if(Array.isArray(t)){for(var e=new Array(t.length),i=0;i<t.length;++i)e[i]=q(t[i]);return e}if(!et(t))return t;var r={},n=Object.keys(t);for(i=0;i<n.length;++i){var o=n[i];r[o]=q(t[o])}return r}function X(t,e,i){for(var r="string"==typeof e?e.split("."):e,n=0;n<r.length-1;++n){var o=r[n],a=t[o];a||(a={},t[o]=a),t=a}t[r[r.length-1]]=i}function Y(t,e){var i=z(e);if(!i.length)return t;if(t){for(var r=0;r<i.length-1;++r){var n=t[i[r]];if(!n)return;t=n}return t[i[i.length-1]]}}function Z(t,e,i){void 0===i&&(i="."),e=e||function(t){return!G(t)};for(var r={},n=Object.keys(t),o=0;o<n.length;++o){var a=n[o],s=t[a];if(e(s))r[a]=s;else for(var u=Z(s,e),d=Object.keys(u),l=0;l<d.length;l++){var h=d[l];r[""+a+i+h]=u[h]}}return r}function K(t){for(var e={},i=Object.keys(t),r=0;r<i.length;++r){var n=i[r];X(e,n,t[n])}return e}function Q(t,e,i){void 0===i&&(i=[]);for(var r=Object.keys(t),n=0;n<r.length;++n){var o=r[n],a=t[o],s=e?e+o:o;et(a)?Q(a,s+".",i):i.push(s)}return i}function J(t,e){if(void 0===e&&(e=[]),et(t))for(var i=0,r=Object.keys(t);i<r.length;i++)J(t[r[i]],e);else e.push(t);return e}function $(t){for(var e in t)"function"==typeof t[e]&&delete t[e];return t}function tt(t,e){if(void 0===t)return q(e);if(!G(t))return t;for(var i={},r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],a=e[o],s=t[o];G(a)?i[o]=tt(s,a):i[o]=void 0===s?q(a):s}return i}function et(t){return t&&(t.constructor===Object||!t.constructor)}function it(t,e){if(!et(e)||!et(t))return e;for(var i=Object.assign({},t),r=Object.keys(e),n=0;n<r.length;++n){var o=r[n];i[o]=it(i[o],e[o])}return i}function rt(t,e){return null==e?t:e.reduce((function(e,i){return e[i]=t[i],e}),{})}var nt,ot=(nt=0,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(t){var e=Date.now(),i=Math.min(16,Math.max(0,16-(e-nt))),r=nt=e+i;return setTimeout((function(){return t(r)}),i)}),at="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:function(t){return clearTimeout(t)};function st(t,e){return ot((function(i){t.call(e,i)}))}function ut(t){t&&at(t)}var dt,lt,ht,ct,ft="object"==typeof t&&null!==t&&void 0!==t.it,gt="undefined"!=typeof document,pt="undefined"!=typeof window,_t=pt&&!window.__OGMA_HEADLESS,vt=_t&&gt,mt=(yt.prototype.open=function(t,e){this.method=t,this.url=e,yt.onSend&&yt.onSend(this)},yt.prototype.respond=function(t,e,i){this.readyState=4,this.status=t,this.headers=e,this.responseText=i,this.response=i,this.onreadystatechange()},yt.prototype.send=function(){this.readyState=4},yt.onCreate=function(){},yt.onSend=function(){},yt);function yt(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,yt.onCreate&&yt.onCreate(this)}var bt=(xt.prototype.readAsDataURL=function(t){this._blob=t,xt.onRead&&xt.onRead(this)},xt.prototype.load=function(t){this.result="function"==typeof t?t(this._blob):t,this.onload&&this.onload()},xt.onCreate=function(){},xt.onRead=function(){},xt);function xt(){this.onload=function(){},xt.onCreate&&xt.onCreate(this)}function Et(){return lt||{createElementNS:function(){return null},createElement:function(){return null},implementation:{createDocument:function(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}function At(t,e){if(document&&document.defaultView){var i=t.style[e];if((!i||"auto"===i)&&Et().defaultView){var r=document.defaultView.getComputedStyle(t,null);i=r?r[e]:null}return"auto"===i?null:i}return null}dt=N("xmldom"),lt=gt?document:dt?(new dt.DOMImplementation).createDocument():null,ht="undefined"!=typeof XMLHttpRequest?XMLHttpRequest:mt,ct="undefined"!=typeof FileReader?FileReader:bt;var St=(Object.defineProperty(wt.prototype,"offsetWidth",{get:function(){return parseFloat(this.style.width||"0")},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"offsetHeight",{get:function(){return parseFloat(this.style.height||"0")},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"firstChild",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"classList",{get:function(){return{length:0,value:"",add:function(){},remove:function(){},contains:function(t){return!1},item:null}},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"innerHTML",{get:function(){return""},set:function(t){},enumerable:!0,configurable:!0}),wt.prototype.appendChild=function(){},wt.prototype.removeChild=function(){},wt.prototype.addEventListener=function(){},wt.prototype.removeEventListener=function(){},wt.prototype.insertBefore=function(){},wt.prototype.contains=function(t){return!1},wt);function wt(){this.onmousewheel=function(){},this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:void 0,left:void 0,position:"",backgroundColor:void 0}}function Tt(){return new St}var Ct=pt?function(){return window.devicePixelRatio}:function(){return 1};function Mt(t){var e,i,r,n=";base64,";if(-1===t.indexOf(n))return i=(e=t.split(","))[0].split(":")[1],Lt(r=decodeURIComponent(e[1]),i);i=(e=t.split(n))[0].split(":")[1];for(var o=(r=window.atob(e[1])).length,a=new Uint8Array(o),s=0;s<o;++s)a[s]=r.charCodeAt(s);return Lt([a],i)}var It=function(t,e){this.data=t,this.type=e};function Lt(t,e){return"undefined"!=typeof Blob?new Blob(t,{type:e}):new It(t,e)}function Nt(t,e,i){if(!_t)return t;var r,n,o=null,a=null,s=null;if(window.Blob?(r=t,o="blob"===(n=i)?r:"dataURL"===n?Mt(r):Lt([r],"text/xml"),a=window.URL.createObjectURL(o)):s="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(t),navigator.msSaveBlob)navigator.msSaveBlob(o,e);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(o,e);else{var u=document.createElement("a");u.setAttribute("href",a||s),u.setAttribute("download",e),document.body.appendChild(u),u.click(),document.body.removeChild(u)}return a&&setTimeout((function(){window.URL.revokeObjectURL(a)}),0),t}function kt(t,e,i,r){if(void 0===r&&(r=Ct()),t.style.width=e+"px",t.style.height=i+"px","IMG"===t.tagName||"CANVAS"===t.tagName){var n=t;n.width=e*r,n.height=i*r}}function Ot(t,e){W(e,(function(e,i){void 0!==e&&t.setAttribute(i,e)}))}var Ft="http://www.w3.org/2000/svg",Rt="http://www.w3.org/2000/xmlns/",Pt="http://www.w3.org/1999/xlink";function Dt(t,e){var i=lt.createElementNS(Ft,t);return i.style||(i.style={}),e&&Ot(i,e),i}function zt(t){if(lt)return lt.createTextNode(t)}function Bt(t){return"undefined"==typeof Image?Promise.resolve(null):new Promise((function(e){var i=new Image;i.src=t,i.onload=function(){return e(i)},i.onerror=function(){return e(null)}}))}function Ut(t){if(0===t.indexOf("http://")||0===t.indexOf("https://"))return t;var e=window.location.origin,i=window.location.pathname,r=i.lastIndexOf("/");return-1===r?e+"/"+t:e+i.substr(0,r)+"/"+t}function Vt(t){return new Promise((function(e,i){var r=new ht;r.open("GET",Ut(t),!0),r.onreadystatechange=function(){if(4===r.readyState){var n=r.status;200===n?e(r.responseText):i(0!==n?new Error('cannot retrieve file at url "'+t+'"; the server responded with status code '+n+"."):new Error('cannot send XMLHttpRequest to url "'+t+"\"; if you're using the local file protocol this is most likely the cause."))}},r.onerror=function(){i(new Error('cannot retrieve file at url "'+t+'"; the XMLHttpRequest failed.'))},r.send()}))}function jt(t){return"undefined"!=typeof HTMLElement&&t instanceof HTMLElement}function Gt(t,e){t.style.cursor=e,t.style.cursor!==e&&(t.style.cursor="-webkit-"+e)}function Ht(t){return new Promise((function(e,i){var r=new ht;r.responseType="blob",r.open("GET",Ut(t),!0),r.onreadystatechange=function(){4===r.readyState&&(200===r.status?e(r.response):i(r.status))},r.onerror=function(t){return i(t)},r.send()}))}function Wt(t){return Ht(t).then((function(t){return new Promise((function(e,i){var r=new ct;r.onerror=i,r.onload=function(){return e(r.result)},r.readAsDataURL(t)}))}))}function qt(t,e){void 0===e&&(e=!0);var i=e?"&#13;":"\n";return(""+t).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,i).replace(/[\r\n]/g,i)}var Xt={0:"left",1:"middle",2:"right"};function Yt(t){if(t.baseURI)return t.baseURI;var e=t.getElementsByTagName("base");return 0<e.length?e[0].href:t.URL||t.location.href}function Zt(t,e,i,r){return new Promise((function(n){var o=e,a=Date.now(),s=(i-e)*Math.min(1,1/(r/16));!function e(){Date.now()-a<r?(o=Math.min(1,Math.max(0,o+s)),t.style.opacity=o.toString(),st(e)):n()}()}))}var Kt="undefined"!=typeof performance&&performance.now?function(){return 0|performance.now()}:function(){return Date.now()},Qt=Kt();function Jt(){return Kt()-Qt}function $t(){var t=new Date,e=t.getDate(),i=t.getMonth()+1;return t.getFullYear()+"-"+(i<10?"0"+i:i)+"-"+(e<10?"0"+e:e)}function te(){var t=new Date;return"["+ee((t.getUTCHours()-(t.getTimezoneOffset()/60|0))%24)+":"+ee(t.getUTCMinutes())+":"+ee(t.getUTCSeconds())+":"+ee(t.getUTCMilliseconds(),3)+"]"}function ee(t,e){void 0===e&&(e=2);for(var i=Math.pow(10,e-1),r=String(t);1<i;)t<i&&(r="0"+r),i/=10;return r}var ie,re,ne=pt&&!window.PointerEvent&&!!window.MSPointerEvent,oe=pt&&!(!window.PointerEvent&&!ne),ae=ne?"MSPointerDown":"pointerdown",se=ne?"MSPointerMove":"pointermove",ue=ne?"MSPointerUp":"pointerup",de=ne?"MSPointerCancel":"pointercancel",le={},he=0;function ce(t){return"mouse"===t.pointerType||t.MSPOINTER_TYPE_MOUSE&&t.pointerType===t.MSPOINTER_TYPE_MOUSE}function fe(t){return"mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE}function ge(t){le[t.pointerId]=t}function pe(t){le[t.pointerId]&&(le[t.pointerId]=t)}function _e(t){delete le[t.pointerId]}function ve(t,e){for(var i in t.touches=[],le)t.touches.push(le[i]);t.changedTouches=[t],e(t)}function me(t,e,i,r){return i===ie.START?t(e,ae,r,!1):i===ie.MOVE?t(e,se,r,!1):i===ie.END&&(t(e,ue,r,!1),t(e,de,r,!1))}(re=ie=ie||{}).START="touchstart",re.MOVE="touchmove",re.END="touchend",re.CANCEL="touchcancel";var ye,be,xe=(Ee.prototype.onMounted=function(t,e){},Ee.prototype.destroy=function(t){},Ee);function Ee(){}(be=ye=ye||{}).MOVE="move",be.DOWN="down",be.UP="up",be.CLICK="click",be.DOUBLE_CLICK="doubleClick",be.HOVER="hover",be.UNHOVER="unhover",be.WHEEL="wheel",be.DRAG_START="dragStart",be.DRAG_PROGRESS="dragProgress",be.DRAG_END="dragEnd",be.GESTURE_START="gestureStart",be.GESTURE_PROGRESS="gestureProgress",be.GESTURE_END="gestureEnd",be.RESIZE="resize",be.ADD_NODES="addNodes",be.ADD_EDGES="addEdges",be.REMOVE_NODES="removeNodes",be.REMOVE_EDGES="removeEdges",be.REQUEST_ELEMENTS_TO_DELETE="requestElementsToDelete",be.BEFORE_REMOVE_NODES="beforeRemoveNodes",be.BEFORE_REMOVE_EDGES="beforeRemoveEdges",be.CLEAR_GRAPH="clear",be.EXCLUDED_STATE_CHANGE="excludedStateChange",be.BEFORE_UPDATE_ATTRIBUTES="beforeUpdateAttributes",be.UPDATE_ATTRIBUTES="updateAttributes",be.RENDERER_STATE_CHANGE="rendererStateChange",be.UPDATE_NODE_DATA="updateNodeData",be.UPDATE_EDGE_DATA="updateEdgeData",be.SET_DATA="setData",be.START_ZOOM="startZoom",be.VIEW_CHANGED="viewChanged",be.MOVE_END="moveEnd",be.CAMERA_MOVE="cameraMove",be.CAMERA_ROTATE="cameraRotate",be.CAMERA_PAN="cameraPan",be.CAMERA_ZOOM="cameraZoom",be.NODES_DRAG_START="startMoveNodesByDragging",be.NODES_DRAG_PROGRESS="progressMoveNodesByDragging",be.NODES_DRAG_END="endMoveNodesByDragging",be.ANIMATE="animate",be.NEW_FRAME="newFrame",be.BEFORE_NEW_FRAME="beforeNewFrame",be.AFTER_NEW_FRAME="afterNewFrame",be.SET_CONTAINER="setContainer",be.RELOAD_FONTS="reloadFonts",be.SET_MULTIPLE_ATTRIBUTES="setMultipleAttributes",be.MOUSE_LEAVE="mouseLeave",be.MOUSE_DOWN="mouseDown",be.MOUSE_UP="mouseUp",be.MOUSE_MOVE="mouseMove",be.MOUSE_WHEEL="mouseWheel",be.MOUSE_CLICK="mouseClick",be.MOUSE_DOUBLE_CLICK="mouseDoubleClick",be.DOCUMENT_MOUSE_MOVE="documentMouseMove",be.DOCUMENT_MOUSE_UP="documentMouseUp",be.DROP="drop",be.VIRTUAL_DOWN="virtualDown",be.VIRTUAL_UP="virtualUp",be.VIRTUAL_MOVE="virtualMove",be.VIRTUAL_CLICK="virtualClick",be.VIRTUAL_DOUBLE_CLICK="virtualDoubleClick",be.VIRTUAL_WHEEL="virtualWheel",be.TOUCH_DOWN="touchDown",be.TOUCH_UP="touchUp",be.TOUCH_TAP="touchTap",be.TOUCH_DOUBLE_TAP="touchDoubleTap",be.TOUCH_MOVE="touchMove",be.TOUCH_START_GESTURE="touchStartGesture",be.TOUCH_PROGRESS_GESTURE="touchProgressGesture",be.TOUCH_END_GESTURE="touchEndGesture",be.DOCUMENT_TOUCH_MOVE="documentTouchMove",be.DOCUMENT_TOUCH_UP="documentTouchUp",be.GEO_LOADED="geoLoaded",be.GEO_ENABLED="geoEnabled",be.GEO_DISABLED="geoDisabled",be.GEO_READY="geoReady",be.TOOLTIP_HIDE="hideTooltip",be.TOOLTIP_SHOW="showTooltip",be.CONNECT_NODES="connectNodes",be.LAYOUT_START="layoutStart",be.LAYOUT_END="layoutEnd",be.LAYOUT_COMPUTED="layoutComputed";var Ae,Se=["graphics","legend","brand"],we=(E(Te,Ae=xe),Te.prototype.onMounted=function(t,e){e.container&&t.setContainer(e.container)},Te.prototype.addWindowEventListener=function(t,e,i){this._isRealBrowser&&this.addElementEventListener(window,t,e,i)},Te.prototype.addDirectWindowEventListener=function(t,e,i){this._isRealBrowser&&window.addEventListener(t,e,i)},Te.prototype.removeDirectWindowEventListener=function(t,e){this._isRealBrowser&&window.removeEventListener(t,e)},Te.prototype.addDocumentEventListener=function(t,e,i){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,t,e,i),e},Te.prototype.removeDocumentEventListener=function(t,e){this._isDocumentReady&&document.documentElement.removeEventListener(t,e)},Te.prototype.addMediaListener=function(t,e){if(this._isDocumentReady&&"function"==typeof window.matchMedia){var i=window.matchMedia(t);i.addListener(e),this._onDetachDom.push((function(){return i.removeListener(e)}))}},Te.prototype.addElementEventListener=function(t,e,i,r){return this._isDestroyed||(t.addEventListener(e,i,r),this._onDetachDom.push((function(){return t.removeEventListener(e,i,r)}))),i},Te.prototype.detachFromDom=function(){this._onDetachDom.forEach((function(t){return t()})),this._onDetachDom=[],this._emptyContainer()},Te.prototype.setTimeout=function(t,e){var i=this;void 0===e&&(e=0);var r=setTimeout((function(){i._timeouts.splice(i._timeouts.indexOf(r),1),t()}),e);return this._timeouts.push(r),r},Te.prototype.clearTimeout=function(t){return t&&(clearTimeout(t),this._timeouts.splice(this._timeouts.indexOf(t),1)),null},Te.prototype.clearAllTimeouts=function(){this._timeouts.forEach(clearTimeout),this._timeouts=[]},Te.prototype.stopFrames=function(){this._isDestroyed=!0,this._nextFrame&&(ut(this._nextFrame),this._nextFrame=null)},Te.prototype.isDestroyed=function(){return this._isDestroyed},Te.prototype.getDimensions=function(){return{width:this._width,height:this._height}},Te.prototype.setDimensions=function(t){this._resize(t)},Te.prototype.setLayer=function(t,e,i){var r=(void 0===i?{}:i).automaticResize,n=void 0!==r&&r;e&&(e._ogmaLayer=t,n&&(e.style.position="absolute",e.style.top="0px",e.style.left="0px",kt(e,this._width,this._height,Ct()))),this._layers[t]={element:e,automaticResize:n},this._updateContainerContent()},Te.prototype.setContainer=function(t){var e,i=this;if("string"==typeof t){if(!(e=document.getElementById(t)))throw new Error('unable to find DOM element with id "'+t+'"')}else e=t;if(e!==this._container){null===e&&this._emptyContainer();var r=this._container;this._isFullScreen=!1,this._container=e,this._container&&["fullscreenchange","webkitfullscreenchange"].forEach((function(t){i.addElementEventListener(i._container,t,i._onFullscreenChange)})),this._resize(),this._updateContainerContent(),this._events.fire(ye.SET_CONTAINER,{element:e,prevElement:r})}},Te.prototype.getContainer=function(){return this._container},Te.prototype.appendElement=function(t){null!==this._container&&this._container.appendChild(t)},Te.prototype.focus=function(){this._focus=!0},Te.prototype.blur=function(){this._focus=!1},Te.prototype.hasFocus=function(){return this._focus},Te.prototype.forceResize=function(){this._resize()},Te.prototype._beforeOrAfterNextFrame=function(t){var e=t?this._afterNextFramePromises:this._beforeNextFramePromises,i=new Promise((function(t){e.push((function(){return t(),i}))}));return this._refresh(),i},Te.prototype.beforeNextFrame=function(){return this._beforeOrAfterNextFrame(!1)},Te.prototype.afterNextFrame=function(){return this._beforeOrAfterNextFrame(!0)},Te.prototype.refresh=function(t){t&&(this._refreshUntil=Math.max(this._refreshUntil,t)),this._refresh()},Te.prototype._emptyContainer=function(){if(this._container){for(var t=[],e=0;e<this._container.childNodes.length;++e){var i=this._container.childNodes[e];i._ogmaLayer&&t.push(i)}for(e=0;e<t.length;++e)this._container.removeChild(t[e])}},Te.prototype._fillContainer=function(){var t=this;if(this._container){var e=At(this._container,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(this._container.style.position="relative");var i=this._container.firstChild;Se.forEach((function(e){var r=t._layers[e];r&&r.element&&t._container&&t._container.insertBefore(r.element,i)}))}},Te.prototype._updateContainerContent=function(){this._emptyContainer(),this._fillContainer()},Te.prototype._resize=function(t){if(this._container||t){var e,i,r=this._width,n=this._height;if(this._container){var o=this._settings.get("minimumWidth"),a=this._settings.get("minimumHeight"),s=this._container.clientWidth||1,u=this._container.clientHeight||1;e=Math.max(o,t?t.width:s),i=Math.max(a,t?t.height:u)}else null!=t&&(e=t.width,i=t.height);e===r&&i===n||(this._width=e,this._height=i,W(this._layers,(function(t){var r=t.element;t.automaticResize&&kt(r,e,i)})),this._events.fire(ye.RESIZE,{prevWidth:r,prevHeight:n,width:e,height:i,difWidth:e-r,difHeight:i-n}))}},Te.prototype._refresh=function(){var t=this;this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=st((function(){return t._playFrame()})))},Te.prototype._playFrame=function(){var t=this,e=Jt(),i=e-this._currentTime,r=R([this._beforeNextFramePromises,function(){return t._events.fire(ye.BEFORE_NEW_FRAME,{elapsed:i})},function(){return t._events.fire(ye.NEW_FRAME,{elapsed:i})},function(){return t._events.fire(ye.AFTER_NEW_FRAME,{elapsed:i})},this._afterNextFramePromises,function(){t._inFrame=!1,(t._mustRefresh||e<t._refreshUntil+17)&&(t._mustRefresh=!1,t._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=e,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],r.reduce((function(e,i){return e.then((function(){if(!t._isDestroyed)return i()}))}),Promise.resolve())},Te.prototype.isPlayingFrame=function(){return this._inFrame||!!this._nextFrame},Te.prototype.setFullScreen=function(t){var e=this,i=Promise.resolve();return t!==this._isFullScreen?(this._container&&(i=t?function(t){return Ce()?Promise.resolve():t.requestFullscreen?t.requestFullscreen():t.requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?Promise.resolve(t.webkitRequestFullScreen()):t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():Promise.resolve()}(this._container):Ce()&&"undefined"!=typeof document?document.exitFullscreen?document.exitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?Promise.resolve(document.webkitCancelFullScreen()):document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():Promise.resolve():Promise.resolve()),i.then((function(){return new Promise((function(t){e.setTimeout((function(){e._isFullScreen=Ce(),t(void 0)}),200)}))}))):i},Te.prototype.isFullScreen=function(){return Ce()},Te.prototype.debounceBeforeFrame=function(t){function e(){var e=n;r=!1,n=[],t(),e.forEach((function(t){return t()}))}var i=this,r=!1,n=[];return function(){return new Promise((function(t){n.push(t),r||(r=!0,i.beforeNextFrame().then(e))}))}},Te.prototype.destroy=function(){!function(){if(he--,gt&&0===he){var t=document.documentElement;t.removeEventListener(ae,ge,!0),t.removeEventListener(se,pe,!0),t.removeEventListener(ue,_e,!0),t.removeEventListener(de,_e,!0)}}(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()},Te);function Te(t,e){var i=t.events,r=t.settings,n=void 0===e?{}:e,o=n.width,a=void 0===o?300:o,s=n.height,u=void 0===s?300:s,d=Ae.call(this)||this;return d._layers={},d._focus=!1,d._container=null,d._isFullScreen=!1,d._beforeNextFramePromises=[],d._afterNextFramePromises=[],d._refreshUntil=0,d._currentTime=Jt(),d._timeouts=[],d._isDestroyed=!1,d._onDetachDom=[],d._isRealBrowser=_t,d._isDocumentReady=vt,d._inFrame=!1,d._mustRefresh=!1,d._nextFrame=null,d._onWindowResize=function(){return d._resize()},d._onWindowFocus=function(){return d.refresh()},d._onFullscreenChange=function(){d._isFullScreen=Ce()},d._events=i,d._settings=r,d._width=a,d._height=u,d._settings.register("minimumWidth",300,(function(){return d._resize()}),!1),d._settings.register("minimumHeight",300,(function(){return d._resize()}),!1),d._events.register([ye.BEFORE_NEW_FRAME,ye.NEW_FRAME,ye.AFTER_NEW_FRAME,ye.SET_CONTAINER,ye.RESIZE]),d._onDetachDom=[],function(){if(gt&&0===he&&oe){var t=document.documentElement;t.addEventListener(ae,ge,!0),t.addEventListener(se,pe,!0),t.addEventListener(ue,_e,!0),t.addEventListener(de,_e,!0)}he++}(),d.addWindowEventListener("resize",d._onWindowResize),d.addWindowEventListener("focus",d._onWindowFocus),d}function Ce(){return"undefined"!=typeof document&&!!(document.fullscreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}var Me,Ie=(E(Le,Me=xe),Le.prototype.setProperty=function(t,e,i,r){var n=(void 0===r?{}:r).dispatch,o=void 0!==n&&n;this._setDataProperty(t.isNode,t._indexes,e,i,o),this._events.fire(ye.SET_DATA,{elements:t})},Le.prototype.getProperty=function(t,e){return this._getDataProperty(t.isNode,t._indexes,e)},Le.prototype._setDataProperty=function(t,e,i,r,n){n&&"function"==typeof r&&(n=!1);for(var o=Ne(i),a="function"==typeof r,s=t?this._nodeList:this._edgeList,u=t?this._nodeDataList:this._edgeDataList,d=function(t,e){for(var i=0;i<t.length;++i){var r=t[i],n=r.property;if(null===e&&null===n)return r;if(e&&n&&n.length===e.length){for(var o=!0,a=0;a<n.length;++a)if(n[a]!==e[a]){o=!1;break}if(o)return r}}var s={property:e&&e.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,edges:null};return t.push(s),s}(t?this._nodeChanges:this._edgeChanges,o),l=0;l<e.length;++l){var h=e[l],c=u.get(h),f=s.get(h),g=n?r[l]:r,p=void 0,_=void 0;if(null===o)p=c,_=a?g(f):g,u.set(h,_);else{null==c&&(c={},u.set(h,c));for(var v=o.length,m=0;m<v;m++){var y=o[m],b=c[y];m<v-1?(null==b&&(b={},c[y]=b),c=b):(p=b,_=a?g(f):g,c[y]=_)}}d.indexes.push(h),d.previousValues.push(p),d.newValues.push(_)}this._scheduleEvents()},Le.prototype._getDataProperty=function(t,e,i,r){var n=Ne(i);r=r||new Array(e.length);for(var o=t?this._nodeDataList:this._edgeDataList,a=0;a<e.length;++a){var s=e[a],u=o.get(s),d=void 0;if(null!==n&&n.length)if(null==u)d=void 0;else for(var l=n.length,h=0;h<l&&u;++h)d=u=u[n[h]];else d=u;r[a]=d}return r},Le.prototype._scheduleEvents=function(){this._shouldTriggerEvents=!0,this._dom.refresh()},Le.prototype._triggerEvents=function(){var t=this._prepareEvtPayload(!0),e=this._prepareEvtPayload(!1);this._events.fire(ye.UPDATE_NODE_DATA,t),this._events.fire(ye.UPDATE_EDGE_DATA,e)},Le.prototype._prepareEvtPayload=function(t){var e=t?this._graph.nodeList:this._graph.edgeList,i=t?"_nodeChanges":"_edgeChanges",r=[],n=this[i];this[i]=[];for(var o=[],a=0;a<n.length;++a){var s=n[a],u=s.indexes,d=s.property,l=s.newValues,h=s.previousValues;r=r.concat(u||[]),t?o.push({property:d,newValues:l,previousValues:h,nodes:e(u)}):o.push({property:d,newValues:l,previousValues:h,edges:e(u)})}return t?{nodes:e(r).dedupe(),isNode:t,changes:o}:{edges:e(r).dedupe(),isNode:t,changes:o}},Le);function Le(t){var e,i=t.dom,r=t.graph,n=t.events,o=Me.call(this)||this;return o._nodeChanges=[],o._edgeChanges=[],o._shouldTriggerEvents=!1,o._dom=i,o._graph=r,o._events=n,o._nodeDataList=o._graph.createAttribute(!0,{name:"data",storage:"any"}),o._edgeDataList=o._graph.createAttribute(!1,{name:"data",storage:"any"}),o._nodeList=o._graph.getNodeAttribute("object"),o._edgeList=o._graph.getEdgeAttribute("object"),o._events.register([ye.SET_DATA,ye.UPDATE_NODE_DATA,ye.UPDATE_EDGE_DATA]),o._events.on(((e={})[ye.ADD_NODES+" "+ye.ADD_EDGES]=function(t){for(var e=t.nodes,i=t.edges,r=t.objects,n=e||i,a=n.isNode,s=n.size,u=n._indexes,d=o[a?"_nodeDataList":"_edgeDataList"],l=0;l<s;++l)d.set(u[l],r[l].data)},e[ye.BEFORE_NEW_FRAME]=function(){o._shouldTriggerEvents&&(o._shouldTriggerEvents=!1,o._triggerEvents())},e)),o}function Ne(t){return"string"==typeof t?t.split("."):O(t)?t:null}var ke={1:Pe(1),2:Pe(2),4:Pe(4),8:Fe(),16:Fe(),32:Fe(),int8:Fe(),int16:Fe(),int32:Fe(),float:Fe(),any:Fe()},Oe={1:De(1),2:De(2),4:De(4),8:Re(),16:Re(),32:Re(),int8:Re(),int16:Re(),int32:Re(),float:Re(),any:Re()};function Fe(){return new Function("array","index","return array[index];")}function Re(){return new Function("array","index","value","array[index] = value;")}function Pe(t){var e=8/t;return new Function("array","index","return (array[index / "+e+" | 0] >> ((index % "+e+") * "+t+")) & "+((1<<t)-1)+";")}function De(t){return new Function("array","index","value","\n    var offset = (index % "+8/t+") * "+t+";\n    var finalIndex = index / "+8/t+" | 0;\n    var orMask = value << offset;\n    var andMask = 255 - (("+(Math.pow(2,t)-1)+" - value) << offset);\n\n    array[finalIndex] = (array[finalIndex] & andMask) | orMask;")}var ze={get:function(t){return this._getArrayElt(this._buffer,t)},set:function(t,e){this._setArrayElt(this._buffer,t,e)}},Be={get:function(t){return this._byIndex[this._getArrayElt(this._buffer,t)]},set:function(t,e){var i=this._byName[e];void 0===i&&(i=this._nextIndex++,this._byIndex.push(e),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[e]=i),this._setArrayElt(this._buffer,t,i)}},Ue=(Ve.prototype.getValues=function(){return Object.keys(this._byName||{})},Ve.prototype.getName=function(){return this._name},Ve.prototype.get=function(t){return this._get(t)},Ve.prototype.set=function(t,e){this._set(t,e)},Ve.prototype._get=function(t){return this._defaultValue},Ve.prototype._set=function(t,e){e!==this._defaultValue&&(this._initialize(),this._set(t,e))},Ve.prototype.setFallback=function(t){this._fallback=t,this.get=this._getWithFallback},Ve.prototype._getWithFallback=function(t){var e=this._get(t);return void 0===e&&this._fallback?this._fallback.get(t):e},Ve.prototype._initialize=function(){this._initialized=!0,this._buffer=Ge(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)},Ve.prototype.increaseNbElements=function(t){var e=je(t+1);if(!(e<=this._nbElements)){if(this._initialized)if("any"===this._elementSize)for(var i=this._nbElements;i<e;++i)this._buffer.push(this._defaultValue);else{var r=Ge(e,this._elementSize);r.set(this._buffer),this._buffer=r,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=e}},Ve.prototype.increaseElementSize=function(){var t=this._elementSize;if("number"!=typeof t||32===t)throw new Error("FlexArray: cannot increase element size");var e=2*t,i=ke[e],r=Oe[e];if(this._initialized){var n=this._nbElements,o=this._getArrayElt,a=this._buffer,s=Ge(n,e);if(8<=t)s.set(a);else for(var u=0;u<n;++u)r(s,u,o(a,u));this._buffer=s}this._elementSize=e,this._getArrayElt=i,this._setArrayElt=r},Ve.prototype.buffer=function(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer},Ve.prototype.elementBitSize=function(){return this._elementSize},Ve.prototype.capacity=function(){return this._nbElements},Ve.prototype.byteSize=function(){return this._nbElements*this._elementSize/8},Ve.prototype.isInitialized=function(){return this._initialized||this._fallback&&this._fallback.isInitialized()},Ve.prototype.getMultiple=function(t,e){var i=t.length;void 0===e&&(e=new Array(i));for(var r=0,n=i;r<n;++r)e[r]=this.get(t[r]);return e},Ve.prototype.fill=function(t,e){for(var i=0,r=t.length;i<r;++i)this.set(t[i],e)},Ve.prototype.setMultiple=function(t,e,i){if(i||!Array.isArray(e)&&!ArrayBuffer.isView(e))for(r=0,n=t.length;r<n;++r)this.set(t[r],e);else for(var r=0,n=t.length;r<n;++r)this.set(t[r],e[r])},Ve.prototype.reset=function(){return this._initialized&&this._reset(0),this},Ve.prototype._reset=function(t){var e="resource"===this._storage?0:this._defaultValue;if(this._buffer)if("number"!=typeof this._elementSize||8<=this._elementSize)this._buffer.fill(e,t);else{for(var i=8/this._elementSize,r=0,n=0;n<i;++n)r<<=this._elementSize,r+=e;if(void 0===t)this._buffer.fill(r);else{var o=t+(8-t%8);for(n=t;n<o;++n)this._setArrayElt(this._buffer,n,e);this._buffer.fill(r,o/8)}}},Ve.prototype._getElementBitSize=function(){if(this._nextIndex)return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))},Ve);function Ve(t){this._initialized=!1;var e,i,r=t.name,n=t.storage,o=t.size||0,a=(i=n,void 0===(e=t.default)&&"any"!==i&&"resource"!==i?0:e),s=Math.max(8,je(o+1)),u="resource"===n?1:n;this._name=r,this._storage=n,this._getArrayElt=ke[u],this._setArrayElt=Oe[u],this._elementSize=u,this._nbElements=s,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=a,this._BASE_VALUE="any"===n?void 0:0,this._methods=ze,this._initialized=!1,this._buffer=null,"resource"===n&&(this._methods=Be,this._byName={},this._byIndex=[],this._nextIndex=1,this._byName[a]=0,this._byIndex.push(a))}function je(t){for(var e=2;e<t;)e*=2;return e}function Ge(t,e){return"any"===e?new Array(t):"float"===e?new Float32Array(t):"int8"===e?new Int8Array(t):"int16"===e?new Int16Array(t):"int32"===e?new Int32Array(t):32===e?new Uint32Array(t):16===e?new Uint16Array(t):new Uint8Array(Math.ceil(t/8*e))}function He(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function We(t){for(var e=0,i=0;i<t.length;++i)e+=t[i];return e}function qe(t,e,i){return Math.max(e,Math.min(i,t))}function Xe(t,e,i){return t+(e-t)*i}function Ye(t,e,i){return t*(1-i)+e*i}function Ze(t){if(!t.length)return-1/0;for(var e=t[0],i=1,r=t.length;i<r;++i){var n=t[i];e<n&&(e=n)}return e}function Ke(t){if(!t.length)return 1/0;for(var e=t[0],i=1,r=t.length;i<r;++i){var n=t[i];n<e&&(e=n)}return e}function Qe(t,e){return Math.log(t)/Math.log(e)}var Je=($e.prototype.isBusy=function(){return this._busy},$e.prototype.markBusy=function(){return this._busy=!0,this},$e.prototype.sliceAndReset=function(){this._busy=!1;var t=this.slice(0,this._size);return this.reset(),t},$e.prototype.reset=function(){return this._size=0,this},$e.prototype.reserve=function(t){return t>this._capacity&&this._setCapacity(He(t)),this},$e.prototype._setCapacity=function(t){var e=new Uint32Array(t);e.set(this._buffer),this._buffer=e,this._capacity=t},$e.prototype.push=function(t){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=t,this},$e.prototype.pushUnchecked=function(t){return this._buffer[this._size++]=t,this},$e.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this._size),this._buffer.slice(t,e)},$e.prototype.getBuffer=function(){return this._buffer},$e.prototype.getLength=function(){return this._size},$e.prototype.getCapacity=function(){return this._capacity},$e.prototype.setLength=function(t){return this._size=t,this},$e.prototype.isEmpty=function(){return 0===this._size},$e);function $e(){this._buffer=new Uint32Array(4),this._capacity=4,this._size=0,this._busy=!1}var ti=(ei.prototype.addElements=function(t){for(var e=[],i=0,r=t.length;i<r;++i){var n=t[i],o=this._idToIndex[n];void 0===o&&(o=this._getNextIndex(),this._idToIndex[n]=o,this._indexToId[o]=n),e.push(o)}for(var a=0,s=this._flexArrays;a<s.length;a++)s[a].increaseNbElements(this._nextIndex);for(var u=0,d=this._indexLists;u<d.length;u++)d[u].reserve(this._nextIndex);return new Uint32Array(e)},ei.prototype.removeElements=function(t){for(var e=0,i=t.length;e<i;++e){var r=t[e],n=this._indexToId[r];void 0!==n&&(delete this._idToIndex[n],this._removeIndex(r))}},ei.prototype.clear=function(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(var t=0,e=this._flexArrays;t<e.length;t++)e[t].reset();for(var i=0,r=this._indexLists;i<r.length;i++)r[i].reset()},ei.prototype.has=function(t){return void 0!==this._indexToId[t]},ei.prototype.getIndex=function(t,e){void 0===e&&(e=!1);var i=this._idToIndex[t];if(void 0===i&&e)throw new Error(this._name+' id "'+t+'" not found');return i},ei.prototype.createFlexArray=function(t){var e=t.name;if(e&&this._flexArraysByName[e])throw new Error(this._name+' flexArray "'+e+'" already exists');var i=t.default;void 0===i&&"any"!==t.storage&&"resource"!==t.storage&&(i=0);var r,n=this._nextIndex,o={storage:t.storage,size:n,name:e,default:i};return void 0===i&&"any"!==t.storage&&t.storage,r=new Ue(o),this._flexArrays.push(r),this._defaultValues.push(t.default),e&&(this._flexArraysByName[e]=r),r},ei.prototype.getFlexArray=function(t){return this._flexArraysByName[t]},ei.prototype.getAllFlexArrays=function(){return this._flexArraysByName},ei.prototype.createIndexList=function(){var t=new Je;return t.reserve(this._nextIndex),this._indexLists.push(t),t},ei.prototype.getId=function(t){return this._indexToId[t]},ei.prototype.getMaxIndex=function(){return this._nextIndex-1},ei.prototype._removeIndex=function(t){this._indexesToBeFreed.push(t)},ei.prototype._getNextIndex=function(){var t=this._freeIndexes.pop();return void 0===t&&(t=this._nextIndex++),t},ei.prototype.freeIndexes=function(){for(var t=0,e=this._indexesToBeFreed;t<e.length;t++){var i=e[t];this._indexToId[i]=void 0,this._freeIndexes.push(i)}for(var r=0;r<this._flexArrays.length;++r)for(var n=this._flexArrays[r],o=this._defaultValues[r],a=0,s=this._indexesToBeFreed;a<s.length;a++)i=s[a],n.set(i,o);this._indexesToBeFreed=[]},ei);function ei(t){var e=this;this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=t?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new Ue({storage:"int32"}),this._idFlexArray.get=function(t){return e._indexToId[t]},this._idFlexArray.getMultiple=function(t){for(var i=new Array(t.length),r=0;r<t.length;++r)i[r]=e._indexToId[t[r]];return i},this._flexArraysByName.id=this._idFlexArray}var ii=(ri.prototype.addEntry=function(t){return void 0===t&&(t=this._nextIndex++),t>=this._capacity&&this._reserve(t+1),this._sizes[t]=0,t},ri.prototype.get=function(t){var e=this._sizes[t],i=this._MAX_LIST_SIZE*t;if(e<=this._MAX_LIST_SIZE){for(var r=0,n=this._constList.length=e;r<n;++r)this._constList[r]=this._buffer[i+r];return this._constList}if(e!==this._BIG_LIST)throw new Error("Table: "+t+" out of bounds ("+e+")");var o=this._buffer[i];return this._bigLists[o]},ri.prototype.size=function(t){var e=this._sizes[t];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length},ri.prototype.sizes=function(t){for(var e=this._sizes,i=this._bigLists,r=this._buffer,n=this._MAX_LIST_SIZE,o=t.length,a=new Array(o),s=0;s<o;s++){var u=t[s],d=e[u];a[s]=d<=n?d:i[r[u*n]].length}return a},ri.prototype.addTo=function(t,e){var i=this._sizes[t],r=t*this._MAX_LIST_SIZE;if(i<this._MAX_LIST_SIZE)this._buffer[r+i]=e,this._sizes[t]=i+1;else if(i===this._BIG_LIST){var n=this._buffer[r];this._bigLists[n].push(e)}else{for(var o=new Array(this._MAX_LIST_SIZE),a=0;a<this._MAX_LIST_SIZE;++a)o[a]=this._buffer[r+a];o.push(e),this._bigLists.push(o),this._sizes[t]=this._BIG_LIST,this._buffer[r]=this._bigLists.length-1}return this},ri.prototype.removeFrom=function(t,e){return this.removeFromAndGetSize(t,e),this},ri.prototype.removeFromAndGetSize=function(t,e){var i=this._MAX_LIST_SIZE*t,r=this._sizes[t];if(r<=this._MAX_LIST_SIZE){for(var n=i,o=i+r;n<o;++n)if(this._buffer[n]===e)return--r,this._buffer[n]=this._buffer[o-1],this._sizes[t]=r}else if(r===this._BIG_LIST){var a=this._buffer[i],s=this._bigLists[a];if(-1!==(n=s.indexOf(e)))return s.splice(n,1),s.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')},ri.prototype.reserve=function(t){return this._capacity<t&&this._reserve(t),this},ri.prototype._reserve=function(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t))),this._buffer=ni(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=ni(this._sizes,this._capacity)},ri);function ri(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=8,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}function ni(t,e){var i=new t.constructor(e);return i.set(t),i}var oi="_visible",ai="_data",si="_hovered",ui="_hoverExtremityHighlighted",di="_selected",li="_selectionExtremityHighlighted",hi="_dragged",ci="_rewirable",fi="_export",gi="_faded",pi="_transparent",_i="out",vi="both",mi=[di,hi,li,si,ui,ci,fi,gi,pi,"_visual_groups"],yi=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"],bi=void 0,xi=(Ei.prototype.getAdjacentDirections=function(t){return this._neighborTable.get(t)},Ei.prototype.getEdgeIndexesInDirection=function(t){return this._parallelTable.get(t)},Ei.prototype.allocateNodes=function(t){this._neighborTable.reserve(t.length);for(var e=0;e<t.length;++e)this._neighborTable.addEntry(t[e])},Ei.prototype.allocateEdges=function(t,e,i){this._parallelTable.reserve(Math.floor(t.length/2));for(var r=0;r<t.length;r++){var n=t[r],o=e[r],a=i[r];this._sourceList.set(n,o),this._targetList.set(n,a),this.addToAdjacencyList(n)}},Ei.prototype.getExtremity=function(t,e){var i=t?this._sourceList:this._targetList;if(e.isList){for(var r=this._graph.acquireIndexList(!0),n=0;n<e._indexes.length;n++)r.push(i.get(e._indexes[n]));return this._graph.nodeList(r.sliceAndReset())}return this._graph.getObjectList(!0).get(i.get(e._index))},Ei.prototype.setExtremities=function(t,e,i){for(var r=0;r<t.length;++r)this.removeFromAdjacencyList(t[r]);for(null!==e&&this._sourceList.setMultiple(t,e),null!==i&&this._targetList.setMultiple(t,i),r=0;r<t.length;++r)this.addToAdjacencyList(t[r])},Ei.prototype.addToAdjacencyList=function(t){var e=this._sourceList.get(t),i=this._targetList.get(t),r=Ai(e,i),n=this._parallelEdgesIndex[r];n===bi&&(n=this._parallelTable.addEntry(),this._parallelEdgesIndex[r]=n,this._neighborTable.addTo(e,n),e!==i&&this._neighborTable.addTo(i,n)),this._parallelTable.addTo(n,t)},Ei.prototype.removeFromAdjacencyList=function(t){var e=this._sourceList.get(t),i=this._targetList.get(t),r=Ai(e,i),n=this._parallelEdgesIndex[r];n!==bi&&0===this._parallelTable.removeFromAndGetSize(n,t)&&(this._neighborTable.removeFrom(e,n),e!==i&&this._neighborTable.removeFrom(i,n),this._parallelEdgesIndex[r]=bi)},Ei.prototype.getParallelEdges=function(t,e){void 0===e&&(e={});for(var i=e.filter||"visible",r=this._graph.acquireIndexList(!1),n=this._graph.getFilter(!1,i),o=0;o<t._indexes.length;o++){var a=t._indexes[o],s=Ai(this._sourceList.get(a),this._targetList.get(a)),u=this._parallelEdgesIndex[s];if(u!==bi){var d=this._parallelTable.get(+u);if(d)for(var l=0,h=d;l<h.length;l++){var c=h[l];n(c)&&r.push(c)}}}return this._graph.edgeList(r.sliceAndReset())},Ei.prototype.fastGetNodesAdjacentElements=function(t){for(var e=this._graph.acquireIndexList(!0),i=this._graph.acquireIndexList(!1),r=this._sourceList,n=this._targetList,o=0;o<t.length;o++)for(var a=t[o],s=0,u=this._neighborTable.get(a);s<u.length;s++){var d=u[s],l=this._parallelTable.get(d),h=l[0],c=r.get(h),f=n.get(h);e.push(c+f-a);for(var g=0,p=l;g<p.length;g++){var _=p[g];i.push(_)}}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(i.sliceAndReset())}},Ei.prototype.fastGetEdgesAdjacentElements=function(t){for(var e=this._graph.acquireIndexList(!0),i=this._graph.acquireIndexList(!1),r=this._sourceList,n=this._targetList,o=0;o<t.length;o++){var a=t[o],s=r.get(a),u=n.get(a),d=Ai(s,u),l=this._parallelEdgesIndex[d];if(l!==bi){var h=this._parallelTable.get(+l);if(h)for(var c=0,f=h;c<f.length;c++){var g=f[c];i.push(g)}}e.push(s),e.push(u)}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(i.sliceAndReset())}},Ei.prototype.getDeduper=function(t){return(t?this.nodeDeduper:this.edgeDeduper).reset()},Ei.prototype.collectAdjacentEdges=function(t,e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var o="in"===e,a=!(e===_i||o||n),s=this._graph.acquireIndexList(!1),u=this._graph.getFilter(!1,i),d=r?this.getDeduper(!1):this._fakeDeduper,l=this._fakeInvertedDeduper,h=this._sourceList,c=this._targetList;if(n){l=this.getDeduper(!0);for(var f=0;f<t.length;f++)l.set(t[f],1)}for(f=0;f<t.length;f++)for(var g=t[f],p=0,_=this._neighborTable.get(g);p<_.length;p++){var v=_[p],m=this._parallelTable.get(v);if(a)for(var y=0,b=m;y<b.length;y++)u(A=b[y])&&0===d.get(A)&&(s.push(A),d.set(A,1));else for(var x=0,E=m;x<E.length;x++){var A=E[x],S=h.get(A),w=c.get(A),T=S+w-g;o!=(w===g)&&S!==w||!u(A)||0!==d.get(A)||1!==l.get(T)||(s.push(A),d.set(A,1))}}return s.sliceAndReset()},Ei.prototype.collectAdjacentNodes=function(t,e,i,r,n,o){void 0===r&&(r=!1);var a="in"!==e,s=e!==_i,u=this._graph.acquireIndexList(!0),d=this._graph.getFilter(!1,i),l=r?this.getDeduper(!0):this._fakeDeduper,h=this._sourceList,c=this._targetList;if(n)for(var f=0;f<n.length;f++){var g=n[f];u.push(g),l.set(g,1)}if(o)for(f=0;f<o.length;f++)g=o[f],l.set(g,1);for(f=0;f<t.length;f++)for(var p=t[f],_=0,v=this._neighborTable.get(p);_<v.length;_++)for(var m=v[_],y=0,b=this._parallelTable.get(m);y<b.length;y++){var x=b[y];if(d(x)){var E=h.get(x),A=c.get(x);if(g=E+A-p,(s&&p===A||a&&p===E)&&0===l.get(g)){u.push(g),l.set(g,1);break}}}return u.sliceAndReset()},Ei.prototype.getAdjacentElements=function(t,e,i){void 0===i&&(i={});var r=i.direction||vi,n=i.filter||"visible",o=i.policy||"union",a=!!i.bothExtremities,s=i.includeSources;if(!0===s?o="include-sources":!1===s&&(o="exclude-sources"),t){var u="include-sources"===o?e:null,d="exclude-sources"===o?e:null;return this.collectAdjacentNodes(e,r,n,!0,u,d)}return this.collectAdjacentEdges(e,r,n,!0,a)},Ei.prototype.getEdgesBetweenTwoNodes=function(t,e){var i=Ai(t,e),r=this._parallelEdgesIndex[i];if(r===bi)return new Uint32Array;var n=this._parallelTable.get(+r);return new Uint32Array(n)},Ei.prototype.getConnectedComponents=function(t,e){var i,r=void 0===e?{}:e,n=r.filter,o=void 0===n?"visible":n,a=r.returnIds,s=void 0!==a&&a,u=r.internalIndexes,d=void 0!==u&&u,l=this._graph,h=[],c={},f=l.acquireIndexList(!0);"string"==typeof o?i=l.getFilter(!0,o):(i=o,o="visible");for(var g=0;g<t.length;g++)i(v=t[g])&&f.push(v);var p=f.sliceAndReset(),_={filter:o};for(g=0;g<p.length;g++){var v;if(!c[v=p[g]]){for(var m=[v],y=[];0!==m.length;){var b=m.pop();!c[b]&&i(b)&&(m.push.apply(m,this.getAdjacentElements(!0,new Uint32Array([b]),_)),c[b]=!0,y.push(b))}0<y.length&&h.push(y)}}if(s){var x=l.getNodeAttribute("id");for(g=0;g<h.length;g++)h[g]=x.getMultiple(h[g])}else if(!d)for(g=0;g<h.length;g++)h[g]=l.nodeList(new Uint32Array(h[g]));return h},Ei.prototype.getAdjacencyList=function(t){for(var e=t.directed,i=t.ids,r=t.weight,n=t.nodes,o=e?_i:vi,a=new Array(n.length),s=this._graph,u=0;u<n.length;++u)a[u]=this.collectAdjacentEdges(new Uint32Array([n[u]]),o,"all");var d=s.getEdgeAttribute("source"),l=s.getEdgeAttribute("target"),h=s.getEdgeAttribute("width"),c=s.getNodeAttribute("id"),f=[],g="number"==typeof r,p=!("function"==typeof r||g||!r);for(u=0;u<a.length;u++){for(var _=a[u],v=n[u],m=_.length,y=new(i?Array:Uint32Array)(m),b=new Array(m),x=0;x<m;x++){var E=_[x],S=d.get(E),w=l.get(E),T=e||v===S?w:S;if(i&&(T=c.get(T)),y[x]=T,r){if(g&&(b[x]=r),"function"==typeof r){var C=s.getNode(S),M=s.getNode(w);b[x]=r(C,M)}p&&(b[x]=h.get(E)||1)}}var I=A({nodes:y,id:i?c.get(v):v},r&&{weights:b});f.push(I)}return f},Ei.prototype.degrees=function(t,e){if("in"!==e&&e!==_i)return this._neighborTable.sizes(t);for(var i=new Array(t.length),r="in"===e,n=0,o=t.length;n<o;n++)i[n]=this._degree(t[n],r);return i},Ei.prototype._degree=function(t,e){for(var i=this._neighborTable.get(t),r=this._sourceList,n=this._targetList,o=0,a=0;a<i.length;++a)for(var s=this._parallelTable.get(i[a]),u=0;u<s.length;++u){var d=s[u],l=r.get(d),h=n.get(d);if(e&&h===t||!e&&l===t){o+=1;break}}return o},Ei.prototype.getDegree=function(t,e){for(var i=this._getDegreeOptions(e),r=i.direction,n=i.filter,o=new Array(t.length),a=new Uint32Array(1),s=0;s<t.length;++s)a[0]=t[s],o[s]=this.collectAdjacentNodes(a,r,n).length;return o},Ei.prototype._getDegreeOptions=function(t){var e={direction:vi,filter:"visible"};return"string"==typeof t?e.direction=t:t&&("string"==typeof t.direction&&(e.direction=t.direction),"string"==typeof t.filter&&(e.filter=t.filter)),e},Ei);function Ei(t){this._neighborTable=new ii,this._parallelTable=new ii,this._parallelEdgesIndex=[],this._fakeDeduper={get:function(){return 0},set:function(){},reset:function(){return this}},this._fakeInvertedDeduper={get:function(){return 1},set:function(){},reset:function(){return this}},this._graph=t,this.nodeDeduper=t.createNodeAttribute({storage:1}),this.edgeDeduper=t.createEdgeAttribute({storage:1}),this._sourceList=t.getEdgeAttribute("source"),this._targetList=t.getEdgeAttribute("target")}function Ai(t,e){var i=t<e?t:e;return 67108864*i+(t+e-i)}function Si(t){ft||console.warn(te()+" "+t)}var wi=[];function Ti(t){"object"==typeof t&&null!==t||(t={});var e="function"==typeof t.data?t.data:function(t){return t};return{attributes:Array.isArray(t.attributes)?t.attributes:t.attributes||wi,data:e}}function Ci(t){1<t&&Si("getData: more than one argument were specified, you probably want to use a single array argument instead of multiple arguments")}function Mi(t,e){for(var i=function(t){var i=e;Object.keys(i).forEach((function(e){var r=i[e];t.prototype[e]=function(t,i){return Si('Deprecated method "'+e+'"; please use "'+r+'" instead.'),this[r](t,i)}}))},r=0,n=t;r<n.length;r++)i(n[r])}function Ii(t){var e=t.getFlexArray("removed"),i=t.getFlexArray("excluded"),r=t.getFlexArray("virtual");return{all:function(t){return 0===e.get(t)},visible:function(t){return 0===i.get(t)},raw:function(t){return 0===r.get(t)&&0===e.get(t)},_all:function(t){return!0}}}function Li(t,e,i){return{all:Ni(i.all,t,e),visible:Ni(i.visible,t,e),raw:Ni(i.raw,t,e),_all:Ni(i._all,t,e)}}function Ni(t,e,i){var r=null;return{getList:function(){if(!r){var n=e(),o=i();o.reset();for(var a=1;a<=n;++a)t(a)&&o.push(a);r=o.sliceAndReset()}return r},invalidList:function(){r=null}}}function ki(t){if(void 0===t)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if("string"!=typeof t&&("number"!=typeof t||!isFinite(t)))throw new Error(t+" is not a valid id, expected string or number");return t}function Oi(t,e,i){for(var r=t.getObjectList(e.isNode),n=0;n<e._indexes.length;++n){var o=e._indexes[n];i(r.get(o),n)}}function Fi(t,e,i){for(var r=new Array(e.size),n=t.getObjectList(e.isNode),o=0;o<e._indexes.length;++o){var a=e._indexes[o],s=n.get(a);r[o]=i(s,o)}return r}function Ri(t,e,i){i=i||function(){return!0};for(var r=e.isNode,n=t.acquireIndexList(r),o=t.getObjectList(r),a=t.getListFactory(r),s=0;s<e._indexes.length;++s){var u=e._indexes[s],d=o.get(u);d&&i(d,s)&&n.push(u)}return a(n.sliceAndReset())}function Pi(t,e,i,r){var n=t.getListFactory(e.isNode);if(!i)return{valid:e,invalid:n()};for(var o=t.acquireIndexList(e.isNode),a=t.acquireIndexList(e.isNode),s=t.getObjectList(e.isNode),u=0;u<e._indexes.length;u++){var d=e._indexes[u],l=s.get(d);void 0!==l&&(i(l,r)?o:a).pushUnchecked(d)}return{valid:n(o.sliceAndReset()),invalid:n(a.sliceAndReset())}}function Di(t,e,i,r){for(var n=t.getObjectList(e.isNode),o=r,a=0;a<e._indexes.length;++a){var s=e._indexes[a];o=i(o,n.get(s),a)}return o}function zi(t,e){for(var i=e.isNode,r=t.topology.getDeduper(i),n=t.acquireIndexList(i),o=t.getListFactory(i),a=0;a<e._indexes.length;a++){var s=e._indexes[a];0===r.get(s)&&(r.set(s,1),n.push(s))}return o(n.sliceAndReset())}function Bi(t,e){for(var i=e.isNode,r=t.storage.fetch(i),n=r.getFlexArray("excluded"),o=r.getMaxIndex(),a=t.topology.getDeduper(i),s=t.acquireIndexList(i),u=t.getListFactory(i),d=0;d<e._indexes.length;d++)a.set(e._indexes[d],1);for(var l=1;l<=o;++l)0===a.get(l)&&0===n.get(l)&&s.push(l);return u(s.sliceAndReset())}function Ui(t,e,i){var r=t.getListFactory(e.isNode),n=new Uint32Array(e._indexes.length+i._indexes.length);return n.set(e._indexes),n.set(i._indexes,e._indexes.length),r(n)}function Vi(t,e){return t.getObjectList(e.isNode).getMultiple(e._indexes)}function ji(t,e){var i=t.getStorage(e.isNode);if(e.isList){for(var r=new Array(e.size),n=0;n<e._indexes.length;++n)r[n]=i.getId(e._indexes[n]);return r}return i.getId(e._index)}function Gi(t,e){return t.topology.getExtremity(!0,e)}function Hi(t,e){return t.topology.getExtremity(!1,e)}function Wi(t,e,i){return t.getObjectList(e.isNode).get(e._indexes[i])}function qi(t,e,i){var r=t.getListFactory(e.isNode),n=t.getObjectList(e.isNode),o=e._indexes.slice();return o.sort((function(t,e){var r=n.get(t),o=n.get(e);return i(r,o)})),r(o)}var Xi=new Uint32Array(1),Yi=(Object.defineProperty(Zi.prototype,"_indexes",{get:function(){return Xi[0]=this._index,Xi},enumerable:!0,configurable:!0}),Zi.prototype.setAttributes=function(t,e,i){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e,i)},Zi.prototype.setAttribute=function(t,e,i){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,i)},Zi.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]},Zi.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]},Zi.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},Zi.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},Zi.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]},Zi.prototype.isInView=function(t){return this._ogma.modules.locate.isElementInView(this,t)},Zi.prototype.getParallelEdges=function(t){return this._ogma.modules.graph.getParallelEdges(this,t)},Zi.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},Zi.prototype.isVisible=function(){return!this.isExcluded()},Zi.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},Zi.prototype.setExcluded=function(t){return this._ogma.modules.graph.setExcluded(this,t)},Zi.prototype.setVisible=function(t){return this.setExcluded(!t)},Zi.prototype.toList=function(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))},Zi.prototype.getId=function(){return ji(this._ogma.modules.graph,this)},Zi.prototype.getSource=function(){return Gi(this._ogma.modules.graph,this)},Zi.prototype.getTarget=function(){return Hi(this._ogma.modules.graph,this)},Zi.prototype.getExtremities=function(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))},Zi.prototype.setSource=function(t){this._ogma.modules.graph.setSource(this,t)},Zi.prototype.setTarget=function(t){this._ogma.modules.graph.setTarget(this,t)},Zi.prototype.slice=function(){return this.toList()},Zi.prototype.toJSON=function(t){void 0===t&&(t={});var e=Ti(t),i=e.attributes,r=e.data;return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(i),data:r(q(this.getData()))}},Zi.prototype.get=function(t){return 0===t?this:void 0},Zi.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},Zi.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Zi.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},Zi.prototype.getBoundingBox=function(t){return this._ogma.modules.locate.getBoundingBox(this,t)},Zi.prototype.setData=function(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e),this},Zi.prototype.getData=function(t){return Ci(arguments.length),this._ogma.modules.data.getProperty(this,t||null)[0]},Zi.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},Zi.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},Zi.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},Zi.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},Zi.prototype.hasClass=function(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)},Zi.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},Zi.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},Zi.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},Zi.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},Zi.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},Zi.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},Zi.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},Zi);function Zi(t,e){this.size=1,this.isNode=!1,this.isList=!1,this._index=t,this._ogma=e}Mi([Yi],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var Ki=(Object.defineProperty(Qi.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),Qi.prototype.setAttributes=function(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)},Qi.prototype.setAttribute=function(t,e,i){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,i)},Qi.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)},Qi.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)},Qi.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},Qi.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},Qi.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)},Qi.prototype.getPreviousAttribute=function(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)},Qi.prototype.getParallelEdges=function(t){return this._ogma.modules.graph.getParallelEdges(this,t)},Qi.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},Qi.prototype.isVisible=function(){return this.isExcluded().map((function(t){return!t}))},Qi.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},Qi.prototype.setExcluded=function(t){return this._ogma.modules.graph.setExcluded(this,t)},Qi.prototype.setVisible=function(t){return this.setExcluded(!t)},Qi.prototype.toList=function(){return this},Qi.prototype.toArray=function(){return Vi(this._ogma.modules.graph,this)},Qi.prototype.clone=function(){return this._ogma.modules.graph.edgeList(this._indexes.slice())},Qi.prototype.getId=function(){return ji(this._ogma.modules.graph,this)},Qi.prototype.getSource=function(){return Gi(this._ogma.modules.graph,this)},Qi.prototype.getTarget=function(){return Hi(this._ogma.modules.graph,this)},Qi.prototype.getExtremities=function(){return this.getSource().concat(this.getTarget())},Qi.prototype.get=function(t){return Wi(this._ogma.modules.graph,this,t)},Qi.prototype.forEach=function(t){Oi(this._ogma.modules.graph,this,t)},Qi.prototype.map=function(t){return Fi(this._ogma.modules.graph,this,t)},Qi.prototype.filter=function(t){return Ri(this._ogma.modules.graph,this,t)},Qi.prototype.reduce=function(t,e){return Di(this._ogma.modules.graph,this,t,e)},Qi.prototype.concat=function(t){return Ui(this._ogma.modules.graph,this,t)},Qi.prototype.dedupe=function(){return zi(this._ogma.modules.graph,this)},Qi.prototype.slice=function(t,e){return this._ogma.modules.graph.edgeList(this._indexes.slice(t,e))},Qi.prototype.indexOf=function(t){return t instanceof Yi?this._indexes.indexOf(t._index):-1},Qi.prototype.includes=function(t){return-1!==this.indexOf(t)},Qi.prototype.sort=function(t){return qi(this._ogma.modules.graph,this,t)},Qi.prototype.inverse=function(){return Bi(this._ogma.modules.graph,this)},Qi.prototype.toJSON=function(t){return void 0===t&&(t={}),this.map((function(e){return e.toJSON(t)}))},Qi.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},Qi.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Qi.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},Qi.prototype.getBoundingBox=function(t){return this._ogma.modules.locate.getBoundingBox(this,t)},Qi.prototype.setData=function(t,e){if(arguments.length<2&&(e=t,t=null),"function"!=typeof e&&!O(e))throw new Error("invalid argument "+e+"; expected array or function");return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this},Qi.prototype.fillData=function(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e,{dispatch:!1}),this},Qi.prototype.getData=function(t){return Ci(arguments.length),this._ogma.modules.data.getProperty(this,t||null)},Qi.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},Qi.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},Qi.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},Qi.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},Qi.prototype.hasClass=function(t){var e=this;return this.map((function(i){return e._ogma.modules.classes.hasSingleElementClass(t,i)}))},Qi.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},Qi.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},Qi.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)},Qi.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)},Qi.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},Qi);function Qi(t,e){this.isList=!0,this.isNode=!1,this._indexes=t,this._ogma=e}Mi([Ki],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var Ji="geo.latitude",$i="geo.longitude",tr=85.0511287798,er={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,detectRetina:!1,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",subdomains:"abc",tms:!1,wms:!1},crs:void 0},ir={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1};function rr(){return pt||void 0!==t&&!t.process}function nr(t){return Math.log2(t)+1}function or(t){return null!=t&&!isNaN(t)}function ar(t,e){return ur(t,e,"longitude")}function sr(t,e){return ur(t,e,"latitude")}function ur(t,e,i){if(isNaN(e))throw new TypeError("node "+t+": "+e+" is not a valid "+i)}var dr=Et().createElement("div");function lr(t,e,i,r){var n,o,a,s,u,d,l;o=e,a=i,s=r,u=(n=t).getAttribute(!0,a),d=n.getAttribute(!0,s),l=o._indexes,d.setMultiple(l,u.getMultiple(l))}var hr=new Uint32Array(1),cr=(Object.defineProperty(fr.prototype,"_indexes",{get:function(){return hr[0]=this._index,hr},enumerable:!0,configurable:!0}),fr.prototype.setAttributes=function(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)},fr.prototype.setAttribute=function(t,e,i){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,i)},fr.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},fr.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]},fr.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]},fr.prototype.getPosition=function(){return this.getAttributes(["x","y"])},fr.prototype.getPositionOnScreen=function(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())},fr.prototype.isInScreen=function(){var t=this.getPositionOnScreen(),e=this._ogma.modules.camera;return 0<=t.x&&t.x<=e.width&&0<=t.y&&t.y<=e.height},fr.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},fr.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]},fr.prototype.getPreviousAttribute=function(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)},fr.prototype.isInView=function(t){return this._ogma.modules.locate.isElementInView(this,t)},fr.prototype.getAdjacentNodes=function(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)},fr.prototype.getAdjacentEdges=function(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)},fr.prototype.getDegree=function(t){return this._ogma.modules.graph.getDegree(this,t)[0]},fr.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},fr.prototype.getConnectedComponent=function(t){return this._ogma.modules.graph.getConnectedComponentByNode(this,t)[0]},fr.prototype.isVisible=function(){return!this.isExcluded()},fr.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},fr.prototype.setExcluded=function(t){return this._ogma.modules.graph.setExcluded(this,t)},fr.prototype.setVisible=function(t){return this.setExcluded(!t)},fr.prototype.toList=function(){return this._ogma.nodeList(new Uint32Array([+this._index]))},fr.prototype.getId=function(){return ji(this._ogma.modules.graph,this)},fr.prototype.slice=function(){return this.toList()},fr.prototype.toJSON=function(t){void 0===t&&(t={});var e=Ti(t),i=e.attributes,r=e.data;return{id:this.getId(),attributes:this.getAttributes(i),data:r(q(this.getData()))}},fr.prototype.get=function(t){return 0===t?this:void 0},fr.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},fr.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},fr.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},fr.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},fr.prototype.setData=function(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e),this},fr.prototype.getData=function(t){return Ci(arguments.length),this._ogma.modules.data.getProperty(this,t||null)[0]},fr.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},fr.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},fr.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},fr.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},fr.prototype.hasClass=function(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)},fr.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},fr.prototype.getGeoCoordinates=function(){var t=this._ogma.modules.graph,e=t.getNodeAttribute(Ji).get(this._index),i=t.getNodeAttribute($i).get(this._index);return{latitude:or(e)?e:void 0,longitude:or(i)?i:void 0}},fr.prototype.setGeoCoordinates=function(t){var e=this;return this.toList().setGeoCoordinates([t]).then((function(){return e}))},fr.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},fr.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},fr.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},fr.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},fr.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},fr.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},fr);function fr(t,e){this.size=1,this.isNode=!0,this.isList=!1,this._index=t,this._ogma=e}Mi([cr],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var gr=(Object.defineProperty(pr.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),pr.prototype.setAttributes=function(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)},pr.prototype.setAttribute=function(t,e,i){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,i)},pr.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)},pr.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)},pr.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},pr.prototype.getPosition=function(){return this.getAttributes(["x","y"])},pr.prototype.getPositionOnScreen=function(){var t=this;return this.getPosition().map((function(e){return t._ogma.modules.camera.graphToScreenCoordinates(e)}))},pr.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},pr.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)},pr.prototype.getPreviousAttribute=function(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)},pr.prototype.getAdjacentNodes=function(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)},pr.prototype.getAdjacentEdges=function(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)},pr.prototype.getDegree=function(t){return this._ogma.modules.graph.getDegree(this,t)},pr.prototype.getConnectedComponents=function(t){return this._ogma.modules.graph.getConnectedComponents(this,t)},pr.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},pr.prototype.isVisible=function(){return this.isExcluded().map((function(t){return!t}))},pr.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},pr.prototype.setExcluded=function(t){return this._ogma.modules.graph.setExcluded(this,t)},pr.prototype.setVisible=function(t){return this.setExcluded(!t)},pr.prototype.toList=function(){return this},pr.prototype.toArray=function(){return Vi(this._ogma.modules.graph,this)},pr.prototype.clone=function(){return this._ogma.modules.graph.nodeList(this._indexes.slice())},pr.prototype.getId=function(){return ji(this._ogma.modules.graph,this)},pr.prototype.get=function(t){return Wi(this._ogma.modules.graph,this,t)},pr.prototype.forEach=function(t){Oi(this._ogma.modules.graph,this,t)},pr.prototype.map=function(t){return Fi(this._ogma.modules.graph,this,t)},pr.prototype.filter=function(t){return Ri(this._ogma.modules.graph,this,t)},pr.prototype.reduce=function(t,e){return Di(this._ogma.modules.graph,this,t,e)},pr.prototype.concat=function(t){return Ui(this._ogma.modules.graph,this,t)},pr.prototype.dedupe=function(){return zi(this._ogma.modules.graph,this)},pr.prototype.slice=function(t,e){return this._ogma.modules.graph.nodeList(this._indexes.slice(t,e))},pr.prototype.indexOf=function(t){return t instanceof cr?this._indexes.indexOf(t._index):-1},pr.prototype.includes=function(t){return-1!==this.indexOf(t)},pr.prototype.inverse=function(){return Bi(this._ogma.modules.graph,this)},pr.prototype.sort=function(t){return qi(this._ogma.modules.graph,this,t)},pr.prototype.toJSON=function(t){return void 0===t&&(t={}),this.map((function(e){return e.toJSON(t)}))},pr.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},pr.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},pr.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},pr.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},pr.prototype.setData=function(t,e){if(arguments.length<2&&(e=t,t=null),"function"!=typeof e&&!O(e))throw new Error("invalid argument "+e+"; expected array or function");return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this},pr.prototype.fillData=function(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e,{dispatch:!1}),this},pr.prototype.getData=function(t){return Ci(arguments.length),this._ogma.modules.data.getProperty(this,t||null)},pr.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},pr.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},pr.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},pr.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},pr.prototype.hasClass=function(t){var e=this;return this.map((function(i){return e._ogma.modules.classes.hasSingleElementClass(t,i)}))},pr.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},pr.prototype.getGeoCoordinates=function(){for(var t=this._ogma.modules.graph,e=new Array(this._indexes.length),i=t.getNodeAttribute(Ji).getMultiple(this._indexes),r=t.getNodeAttribute($i).getMultiple(this._indexes),n=0,o=this._indexes.length;n<o;n++)e[n]={latitude:i[n],longitude:r[n]};return e},pr.prototype.setGeoCoordinates=function(t){var e=this,i=this._ogma.modules.geo,r=this._ogma.modules.graph,n=this.getId(),o=this._indexes,a=new Array(o.length),s=new Array(o.length);if(null===t&&(t=new Array(o.length).fill(null)),t.length!==o.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(var u=0,d=o.length;u<d;u++){var l=t[u]||{latitude:void 0,longitude:void 0},h=l.latitude,c=l.longitude,f=n[u];null==h&&null==c?h=c=void 0:(sr(f,h),ar(f,c)),a[u]=h,s[u]=c}return this.setData(i.latitudePath,a),this.setData(i.longitudePath,s),r.getNodeAttribute(Ji).setMultiple(o,a),r.getNodeAttribute($i).setMultiple(o,s),this._ogma.modules.transformations.refresh().then((function(){return e}))},pr.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},pr.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)},pr.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)},pr.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},pr);function pr(t,e){this.isList=!0,this.isNode=!0,this._indexes=t,this._ogma=e}function _r(t,e,i,r){return void 0===i&&(i={}),void 0===r&&(r={}),mr(t,e,[i],r).get(0)}function vr(t,e,i,r){if(void 0===r&&(r={}),r.batchSize){for(var n=[],o=0;o<i.length;o+=r.batchSize)n.push(i.slice(o,o+r.batchSize));var a=e?t.nodeList():t.edgeList();return n.reduce((function(i,n){var o;return i.then((function(e){return o=e,t.getDom().afterNextFrame()})).then((function(){return mr(t,e,n,r)})).then((function(t){return o.concat(t)}))}),Promise.resolve(a))}return Promise.resolve(mr(t,e,i,r))}function mr(t,e,i,r){t.setIndexFreeStep(0);for(var n=t.storage.fetch(e),o=[],a=[],s=[],u=[],d=new Set,l=r.virtual,h=void 0!==l&&l,c=0,f=i;c<f.length;c++){var g=f[c];if("object"!=typeof g||null===g||Array.isArray(g))throw new Error(g+" is not a valid "+(e?"node":"edge"));var p=ki(g.id);if(!n.getIndex(p,!1)&&!d.has(p)&&(a.push(p),o.push(g),d.add(p),!e)){var _=g,v=t.getExtremityIndex(p,_.source,"source"),m=t.getExtremityIndex(p,_.target,"target");s.push(v),u.push(m)}}var y=n.addElements(a);e?t.topology.allocateNodes(y):t.topology.allocateEdges(y,s,u);for(var b=n.getFlexArray("object"),x=n.getFlexArray("excluded"),E=n.getFlexArray("removed"),A=n.getFlexArray("virtual"),S=e?t.node:t.edge,w=e?t.nodeList:t.edgeList,T=t.getCacheLists(e),C=w(y),M=0;M<y.length;M++){var I=y[M];b.set(I,S(I))}return x.setMultiple(y,0),E.setMultiple(y,0),A.setMultiple(y,h?1:0),T.visible.invalidList(),T.all.invalidList(),T._all.invalidList(),h||T.raw.invalidList(),0!==C.size&&(e?t.fireEvent(ye.ADD_NODES,{virtual:h,objects:o,nodes:C}):t.fireEvent(ye.ADD_EDGES,{virtual:h,objects:o,edges:C})),C}Mi([gr],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var yr,br=(E(xr,yr=xe),xr.prototype.onMounted=function(t,e){if(e.graph){var i=e.graph,r=i.nodes,n=i.edges;r&&this.addNodes(r),n&&this.addEdges(n)}},xr.prototype.createIndexList=function(t){return this.storage.fetch(t).createIndexList()},xr.prototype.setIndexFreeStep=function(t){this._indexFreeStep=t},xr.prototype.getDom=function(){return this._dom},xr.prototype.acquireIndexList=function(t){var e=t?this._nodeIndexLists:this._edgeIndexLists,i=e.find((function(t){return!t.isBusy()}));return i||(i=this.createIndexList(t),e.push(i)),i.markBusy(),i},xr.prototype.getObjectList=function(t){return t?this._nodes:this._edges},xr.prototype.getListFactory=function(t){return t?this.nodeList:this.edgeList},xr.prototype.getStorage=function(t){return t?this.storage.nodes:this.storage.edges},xr.prototype.getFilter=function(t,e){var i=t?this._nodeFilters:this._edgeFilters;return i[e]||i.visible},xr.prototype.fireEvent=function(t,e){this._events.fire(t,e)},xr.prototype.getCacheLists=function(t){return t?this._nodeCacheLists:this._edgeCacheLists},xr.prototype._resolvePromises=function(){var t=this._promisesToResolve;this._promisesToResolve=[],t.forEach((function(t){return t()}))},xr.prototype._initialize=function(){var t=this;this._nodeCacheLists=Li((function(){return t.getNodeMaxIndex()}),(function(){return t.acquireIndexList(!0)}),this._nodeFilters),this._edgeCacheLists=Li((function(){return t.getEdgeMaxIndex()}),(function(){return t.acquireIndexList(!1)}),this._edgeFilters),this.topology=new xi(this),this._resolvePromises()},xr.prototype.getNodeMaxIndex=function(){return this.storage.nodes.getMaxIndex()},xr.prototype.getEdgeMaxIndex=function(){return this.storage.edges.getMaxIndex()},xr.prototype.isExcluded=function(t){return this.storage.fetch(t.isNode).getFlexArray("excluded").getMultiple(t._indexes)},xr.prototype.setExcluded=function(t,e){for(var i=e?1:0,r=t.isNode,n=this.storage.fetch(r),o=n.getFlexArray("excluded"),a=n.getFlexArray("removed"),s=this.acquireIndexList(r),u=this.getListFactory(r),d=0;d<t._indexes.length;d++){var l=t._indexes[d],h=o.get(l),c=a.get(l);i!==h&&0===c&&s.push(l)}var f=s.sliceAndReset();if(f.length){this.getCacheLists(t.isNode).visible.invalidList();var g=u(f);o.setMultiple(f,i),this._events.fire(ye.EXCLUDED_STATE_CHANGE,{elements:g,value:e})}},xr.prototype.addNode=function(t,e){return _r(this,!0,t,e)},xr.prototype.addEdge=function(t,e){return _r(this,!1,t,e)},xr.prototype.addNodes=function(t,e){return vr(this,!0,t,e)},xr.prototype.addEdges=function(t,e){return vr(this,!1,t,e)},xr.prototype.getExtremityIndex=function(t,e,i){if(e instanceof cr)return e._index;var r=this.storage.nodes.getIndex(e);if(!r)throw new Error("addEdge(s): invalid "+i+' for edge "'+t+'"; node "'+e+'" does not exist');return r},xr.prototype.getNodes=function(t){return this.getElements(!0,t)},xr.prototype.getEdges=function(t){return this.getElements(!1,t)},xr.prototype.getElements=function(t,e){var i=t?this.nodeList:this.edgeList,r=t?gr:Ki,n=t?cr:Yi;if(e&&"string"!=typeof e){var o=this.acquireIndexList(t),a=this.storage.fetch(t);if(e instanceof n)o.push(e._index);else if(O(e))for(var s=0,u=e;s<u.length;s++){var d=u[s];d instanceof n?o.push(d._index):(f=a.getIndex(d))&&o.push(f)}else if(e instanceof r)for(var l=this.getFilter(t,"all"),h=e,c=0;c<h._indexes.length;c++){var f;l(f=h._indexes[c])&&o.push(f)}return i(o.sliceAndReset())}var g=e||"visible",p=this.getCacheLists(t)[g];if(!p)throw new Error('getNodes/getEdges: unexpected argument "'+g+'"');return i(p.getList())},xr.prototype.getNode=function(t){return this._getElement(!0,t)},xr.prototype.getEdge=function(t){return this._getElement(!1,t)},xr.prototype._getElement=function(t,e){if(e instanceof(t?cr:Yi))return e;var i=this.getStorage(t),r=this.getObjectList(t),n=i.getIndex(e);return n?r.get(n):void 0},xr.prototype.clear=function(){this._events.fire(ye.CLEAR_GRAPH),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()},xr.prototype.createAttribute=function(t,e){return this.storage.fetch(t).createFlexArray(e)},xr.prototype.createNodeAttribute=function(t){return this.createAttribute(!0,t)},xr.prototype.createEdgeAttribute=function(t){return this.createAttribute(!1,t)},xr.prototype.getAttribute=function(t,e){return this.storage.fetch(t).getFlexArray(e)},xr.prototype.getAttributes=function(t,e){var i=this;return e.map((function(e){return i.getAttribute(t,e)}))},xr.prototype.getNodeAttribute=function(t){return this.storage.nodes.getFlexArray(t)},xr.prototype.getNodeAttributes=function(t){return this.getAttributes(!0,t)},xr.prototype.getEdgeAttribute=function(t){return this.storage.edges.getFlexArray(t)},xr.prototype.getEdgeAttributes=function(t){return this.getAttributes(!1,t)},xr.prototype.getAllNodeAttributes=function(){return this.storage.nodes.getAllFlexArrays()},xr.prototype.getAllEdgeAttributes=function(){return this.storage.edges.getAllFlexArrays()},xr.prototype.setSource=function(t,e){var i=this.getNode(e);i&&this.topology.setExtremities(t._indexes,i._indexes,null)},xr.prototype.setTarget=function(t,e){var i=this.getNode(e);i&&this.topology.setExtremities(t._indexes,null,i._indexes)},xr.prototype.getParallelEdges=function(t,e){return void 0===e&&(e={}),this.topology.getParallelEdges(t,e)},xr.prototype.getEdgesBetweenTwoNodes=function(t,e){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(t._index,e._index))},xr.prototype.getAdjacentDirections=function(t){return this.topology.getAdjacentDirections(t)},xr.prototype.getEdgeIndexesInDirection=function(t){return this.topology.getEdgeIndexesInDirection(t)},xr.prototype.fastGetNodesAdjacentElements=function(t){return this.topology.fastGetNodesAdjacentElements(t._indexes)},xr.prototype.fastGetEdgesAdjacentElements=function(t){return this.topology.fastGetEdgesAdjacentElements(t._indexes)},xr.prototype.getAdjacentNodes=function(t,e){return this.nodeList(this.topology.getAdjacentElements(!0,t._indexes,e))},xr.prototype.getAdjacentEdges=function(t,e){return this.edgeList(this.topology.getAdjacentElements(!1,t._indexes,e))},xr.prototype.getDegree=function(t,e){return this.topology.getDegree(t._indexes,e)},xr.prototype.degrees=function(t,e){return this.topology.degrees(t,e)},xr.prototype.getAdjacencyList=function(t){var e=void 0===t?{}:t,i=e.directed,r=void 0!==i&&i,n=e.internalIndexes,o=void 0!==n&&n,a=e.weight,s=void 0===a?1:a,u=e.nodes,d=e.indexes;return this.topology.getAdjacencyList({directed:r,weight:s,ids:!o,nodes:d||this.getNodes(u)._indexes})},xr.prototype.getConnectedComponents=function(t,e){return this.topology.getConnectedComponents(t._indexes,e)},xr.prototype.getConnectedComponentByNode=function(t,e){return this.topology.getConnectedComponents(t._indexes,e)},xr);function xr(t,e){var i=t.dom,r=t.events,n=yr.call(this)||this;return n.storage={nodes:new ti(!0),edges:new ti(!1),fetch:function(t){return t?this.nodes:this.edges}},n._promisesToResolve=[],n._indexFreeStep=0,n._nodeIndexLists=[],n._edgeIndexLists=[],n._onNewFrame=function(){1===n._indexFreeStep?n._indexFreeStep=2:2===n._indexFreeStep&&(n.storage.nodes.freeIndexes(),n.storage.edges.freeIndexes(),n._indexFreeStep=0)},n._events=r,n._dom=i,n._events.register([ye.ADD_NODES,ye.ADD_EDGES,ye.EXCLUDED_STATE_CHANGE],[ye.CLEAR_GRAPH,ye.BEFORE_REMOVE_NODES,ye.REQUEST_ELEMENTS_TO_DELETE,ye.REMOVE_NODES,ye.BEFORE_REMOVE_EDGES,ye.REMOVE_EDGES]),[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach((function(t){n.createNodeAttribute(t),n.createEdgeAttribute(t)})),n.node=e.node,n.edge=e.edge,n.nodeList=e.nodeList,n.edgeList=e.edgeList,n._nodes=n.createAttribute(!0,{name:"object",storage:"any"}),n._edges=n.createAttribute(!1,{name:"object",storage:"any"}),n.createAttribute(!1,{name:"source",storage:32}),n.createAttribute(!1,{name:"target",storage:32}),n._nodeFilters=Ii(n.storage.nodes),n._edgeFilters=Ii(n.storage.edges),n._initialize(),n._events.on(ye.NEW_FRAME,n._onNewFrame),n}var Er=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],Ar=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function Sr(t,e){void 0===e&&(e=[0,0,0,0]);var i=Ar.exec(t);return i?(e[0]=parseInt(i[1])/255,e[1]=parseInt(i[2])/255,e[2]=parseInt(i[3])/255,e[3]=void 0===i[4]?1:parseFloat(i[4]),e):null}function wr(t){return t<16?"0"+t.toString(16):t.toString(16)}function Tr(t){var e=t[0],i=t[1],r=t[2],n=t[3];return"rgba("+(256*e|0)+","+(256*i|0)+","+(256*r|0)+","+(void 0===n?1:n)+")"}function Cr(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,i,r){return e+e+i+i+r+r}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255,1]:null}var Mr=[0,0,0,0],Ir=(Lr.prototype.parseColor=function(t){var e=this._colorByName.get(t);if(void 0===e){var i=t+"",r=("#"===i.charAt(0)?Cr:Sr)(i);this._colorByName.set(t,r),e=r}return e},Lr.prototype.toHexa=function(t){var e=this.parseColor(t);if(!e)return null;var i=e[0],r=e[1],n=e[2];return"#"+wr(255*i)+wr(255*r)+wr(255*n)},Lr.prototype.rgbaToRgb=function(t){var e=1,i=t;return i&&Sr(t,Mr)&&(i="rgb("+255*Mr[0]+","+255*Mr[1]+","+255*Mr[2]+")",e=parseFloat(Mr[3].toString())),{color:i,opacity:e}},Lr);function Lr(){this._colorByName=new Map,this._colorByName.set(null,[0,0,0,0]),this._colorByName.set("transparent",[0,0,0,0]);for(var t=0;t<Er.length;t+=2){var e=Er[t].toLowerCase(),i=Er[t+1];this._colorByName.set(e,Cr(i))}}var Nr,kr=((Nr={})[2]="image",Nr[4]="piechart",Nr[3]="text",Nr[5]="icon",Nr[6]="badge",Nr),Or=(Fr.prototype.reset=function(){this._init_()},Fr.prototype._init_=function(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:1,attributes:{}}},Fr.prototype._increaseNextId=function(){var t=this._nextPatternId++;for(t%256==255&&(t=this._nextPatternId++);this._patterns.length<=t;)this._patterns.push(void 0);return t},Fr.prototype._createPattern=function(t){var e=t.type,i=t.attributes,r={id:this._increaseNextId(),type:e,attributes:this._cloneAttributes(e,i)};return this._patterns[r.id]=r,this._mustUpdate=!0,r},Fr.prototype._cloneAttributes=function(t,e){return 2===t?{image:e.image,scaled:e.scaled,duplicated:e.duplicated}:3===t||5===t||6===t?{font:e.font,size:e.size,style:e.style,text:e.text,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,align:e.align||"center",offset:e.offset||0}:4===t&&e.colors?{colors:e.colors,colorArray:e.colors.split(";").map((function(t){return t.trim()}))}:{}},Fr.prototype.getPatternList=function(){return this._patterns.filter((function(t){return t}))},Fr.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},Fr.prototype.setPixelRatio=function(t){t!==this._pixelRatio&&(this._pixelRatio=t,this._mustUpdate=!0)},Fr.prototype.getPixelRatio=function(){return this._pixelRatio},Fr.prototype.notifyUpdate=function(){this._mustUpdate=!0},Fr.prototype.getIdFromDefinition=function(t){var e=t.type,i=t.attributes,r=3===e||5===e||6===e,n=0;return e&&1!==e&&7!==e&&(2!==e||i.image)&&(!r||i.text&&i.font)&&(n=this._addPattern(t),3===e&&"normal"===i.style&&(i.style="bold",this._addPattern(t))),n},Fr.prototype._addPattern=function(t){var e=this._getPatternHash(t),i=this._patternsByHash[e];return i||(65500<this._nextPatternId?Si("maximum number of pattern exceeded"):(i=this._createPattern(t).id,this._patternsByHash[e]=i)),i},Fr.prototype._getPatternHash=function(t){var e=t.type,i=t.attributes,r=[kr[e]];return 2===e?r.push(i.scaled?"scaled":"non-scaled",i.duplicated?"duplicated":"non-duplicated",i.image.src||i.image.toDataURL()):3===e?r.push(i.text,i.font,i.style,i.size,i.align||"center",i.offset||0):5===e||6===e?r.push(i.text,i.font,i.style,i.size,i.paddingLeft,i.paddingTop):r.push(i.colors),r.join("+")},Fr.prototype.getDefinitionFromId=function(t){if(t&&this._patterns[t]){var e=this._patterns[t];if(e)return e}return this._nullPattern},Fr.prototype.getVersion=function(){return this._version},Fr);function Fr(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}var Rr=Math.round(Math.log2(512)),Pr=Math.round(Math.log2(128)),Dr=Rr+Pr,zr=Math.round(Math.sqrt(16)),Br=128*zr,Ur=256;function Vr(t){return t.map((function(t){var e=t.x,i=t.y,r=t.r;return{x:e,y:i,r:void 0===r?0:r}}))}var jr=(Gr.prototype.register=function(t,e){var i=e.getDistanceFromStrokeVertically,r=e.getDistanceFromStrokeHorizontally,n=e.points,o=e.hole,a=e.isSimple;if(!this._byName[t]){for(var s=a?1:8,u=a?7:15;this._byId[s];)s+=1;if(u<s)throw new Error("max number of shape exceeded");var d={id:s,name:t,getDistanceFromStrokeVertically:i,getDistanceFromStrokeHorizontally:r,points:Vr(n.slice()),hole:o?Vr(o.slice()):null,isSimple:!!a};return this._mustUpdate=!0,this._byId[s]=d,this._byName[t]=d}},Gr.prototype.getIdFromName=function(t){return this._byName[t].id},Gr.prototype.getNameFromId=function(t){var e=this._byId[t];return e?e.name:""},Gr.prototype.getDefinitionFromName=function(t){return this._byName[t]},Gr.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},Gr.prototype.getVersion=function(){return this._version},Gr.prototype.getShapeList=function(){return this._byId.filter((function(t){return t}))},Gr);function Gr(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(16)}var Hr=(Wr.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))},Wr.prototype.allocate=function(t){var e=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+t<=this._capacity?(e=this._nbCellsAllocated,this._nbCellsAllocated+=t,this._mustUpdate=!0):this._isFullyAllocated=!0,e},Wr.prototype.free=function(t,e){for(var i=0;i<e;i++){var r=(t+i)*this._elementSize;if(0===this._dataView.getUint16(r))throw new Error('"free": invalid address provided');this._dataView.setUint16(r,0)}this._mustUpdate=!0,this._nbCellsFreed+=e},Wr.prototype.triggerUpdate=function(){this._mustUpdate=!0},Wr.prototype.isEmpty=function(){return this._nbCellsFreed===this._nbCellsAllocated},Wr.prototype.isFullyFreed=function(){return this._isFullyFreed},Wr.prototype.getId=function(){return this._id},Wr.prototype.getDepth=function(){return this._depth},Wr.prototype.getElementType=function(){return this._elementType},Wr.prototype.getDataView=function(){return this._dataView},Wr.prototype.getByteArray=function(){return this._byteArray},Wr.prototype.getElementSize=function(){return this._elementSize},Wr.prototype.isAnimated=function(){return this._animated},Wr.prototype.getCapacity=function(){return this._capacity},Wr.prototype.getSize=function(){return this._nbCellsAllocated},Wr.prototype.getNbSideElementsPerMainElement=function(){return this._nbSideElementsPerMainElement},Wr.prototype.hasSideData=function(){return 0<this._nbSideElementsPerMainElement},Wr.prototype.getSideDataView=function(){return this._sideDataView},Wr.prototype.getSideByteArray=function(){return this._sideByteArray},Wr.prototype.getTotalSideElementsSize=function(){return this._totalSideElementsSize},Wr.prototype.getVersion=function(){return this._version},Wr.prototype.getStencilUsage=function(){return this._stencilUsage},Wr);function Wr(t){var e=t.elementSize,i=t.sideElementSize,r=t.nbSideElementsPerMainElement,n=t.id,o=t.depth,a=t.elementType,s=t.animated,u=t.stencilUsage;this._version=0,this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=512,this._id=n,this._depth=o,this._elementType=a,this._animated=s,this._stencilUsage=u,this._elementSize=e,this._sideElementSize=i,this._nbSideElementsPerMainElement=r,this._totalSideElementsSize=r*i,this._byteCapacity=this._capacity*this._elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}var qr=(Xr.prototype.reset=function(){this._init_()},Xr.prototype._init_=function(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0},Xr.prototype._fillBlockInfo=function(t,e,i,r){return this._blockInfo.buffer=t,this._blockInfo.offset=e,this._blockInfo.size=i,this._blockInfo.address=r,this._blockInfo},Xr.prototype._createBuffer=function(t,e,i,r,n){var o=e?128:56,a=this._buffersById.length,s=new Hr({elementSize:o,sideElementSize:6,nbSideElementsPerMainElement:r,id:a,depth:i,elementType:t,animated:e,stencilUsage:n});return this._buffersById.push(s),s},Xr.prototype.getBlockInfo=function(t){return this._getBlockInfo(t)},Xr.prototype._getBlockInfo=function(t){return this._fillBlockInfo(this._buffersById[t>>Dr],(t>>Pr)%512,t%128,t)},Xr.prototype.allocateBlock=function(t,e,i,r,n,o,a){var s=function(t,e){for(var i=0;i<t;)i+=8;return i}(o);this._mustUpdate=!0;var u=null,d=-1;if(t){var l=this._getBlockInfo(t),h=l.buffer,c=l.offset,f=l.size,g=l.size===n,p=h.getDepth()===r,_=h.getElementType()===e,v=h.isAnimated()===i,m=h.getNbSideElementsPerMainElement()===s,y=h.getStencilUsage()===a;g&&p&&_&&v&&m&&y?(h.triggerUpdate(),u=h,d=c):h.free(c,f)}if(-1===d){var b=+i,x=s/8,E=this._buffersByDepth[r]||Array(2),A=(this._buffersByDepth[r]=E)[b]||[],S=(E[b]=A)[e]||Array(16),w=(A[e]=S)[x]||Array(4),T=(S[x]=w)[a]||[],C=(w[a]=T)[T.length-1];C&&(d=(u=C).allocate(n)),-1===d&&(d=(u=this._createBuffer(e,i,r,s,a)).allocate(n),T.push(u))}var M=((u.getId()<<Rr)+d<<Pr)+n;return this._fillBlockInfo(u,d,n,M)},Xr.prototype.freeBlock=function(t){if(t){this._mustUpdate=!0;var e=this._getBlockInfo(t);e.buffer.free(e.offset,e.size)}return 0},Xr.prototype._sortBuffersByDepth=function(){for(var t=[],e=0;e<this._buffersByDepth.length;e++){var i=this._buffersByDepth[e];if(i)for(var r=0;r<i.length;r++){var n=i[r];if(n)for(var o=0;o<n.length;o++){var a=n[o];if(a)for(var s=0;s<a.length;s++){var u=a[s];if(u)for(var d=0;d<u.length;d++){var l=u[d];if(l)for(var h=0;h<l.length;h++){var c=l[h];c.update(),c.isFullyFreed()?(this._buffersById[c.getId()]=void 0,l.splice(h,1),--h):t.push(c)}}}}}}this._buffersByAscendingDepth=t,this._buffersByDescendingDepth=t.slice().reverse()},Xr.prototype.update=function(){this._mustUpdate&&(this._sortBuffersByDepth(),this._version+=1,this._mustUpdate=!1)},Xr.prototype.getBuffers=function(){return this._buffersById},Xr.prototype.getBuffersByAscendingDepth=function(){return this._buffersByAscendingDepth},Xr.prototype.getBuffersByDescendingDepth=function(){return this._buffersByDescendingDepth},Xr.prototype.getVersion=function(){return this._version},Xr);function Xr(){this._version=0,this._version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}var Yr=(Object.defineProperty(Zr.prototype,"__dummy",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(Zr.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),Zr.prototype.getContext=function(t){return"2d"===t?this.__context:null},Zr.prototype.toDataURL=function(t){return void 0===t&&(t="png"),"data:image/"+t+";base64,"},Zr.prototype.addEventListener=function(){},Zr.prototype.removeEventListener=function(){},Zr.prototype.getBoundingClientRect=function(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}},Zr);function Zr(){this.style={},this.width=300,this.height=150,this.__context=new Kr,this.style={},this.width=300,this.height=150}var Kr=(Object.defineProperty(Qr.prototype,"font",{set:function(t){var e=t.match(/\d+/);e&&(this._fontSize=parseFloat(e[0]))},enumerable:!0,configurable:!0}),Object.defineProperty(Qr.prototype,"fillStyle",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(Qr.prototype,"textBaseline",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(Qr.prototype,"textAlign",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(Qr.prototype,"strokeStyle",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(Qr.prototype,"lineWidth",{set:function(t){},enumerable:!0,configurable:!0}),Qr.prototype.fill=function(){},Qr.prototype.stroke=function(){},Qr.prototype.clearRect=function(){},Qr.prototype.fillRect=function(){},Qr.prototype.strokeRect=function(){},Qr.prototype.beginPath=function(){},Qr.prototype.closePath=function(){},Qr.prototype.moveTo=function(){},Qr.prototype.lineTo=function(){},Qr.prototype.rect=function(){},Qr.prototype.arc=function(){},Qr.prototype.save=function(){},Qr.prototype.restore=function(){},Qr.prototype.clip=function(){},Qr.prototype.translate=function(){},Qr.prototype.rotate=function(){},Qr.prototype.fillText=function(){},Qr.prototype.setLineDash=function(){},Qr.prototype.quadraticCurveTo=function(){},Qr.prototype.bezierCurveTo=function(){},Qr.prototype.drawImage=function(){},Qr.prototype.measureText=function(t){return{width:t.length*Math.ceil(.625*this._fontSize)}},Qr.prototype.getImageData=function(){return{width:0,height:0,data:new Uint8ClampedArray(0)}},Qr);function Qr(){this._fontSize=10}var Jr=N("canvas")||N("canvas-prebuilt");function $r(){if(gt)return document.createElement("canvas");if(Jr){var t=null;return(t="createCanvas"in Jr?Jr.createCanvas(300,150):new Jr(300,150)).style={},t}return new Yr}function tn(t,e,i,r){void 0===i&&(i=t.width),void 0===r&&(r=t.height),e.clearRect(0,0,i,r)}function en(t,e,i,r){void 0===r&&(r=""),t.font=r+" "+i+"px "+e}function rn(){return null!==nn($r(),{})}function nn(t,e){var i=t.getContext("webgl",e);return(i=i||t.getContext("experimental-webgl",e))||null}function on(t){return void 0===t&&(t={}),t.pieceId=0,t.shape="",t.x1=0,t.y1=0,t.x2=0,t.y2=0,t.rectWidthOrSourceRadiusScaled=0,t.rectWidthOrSourceRadiusFixed=0,t.rectHeightOrTargetRadiusScaled=0,t.rectHeightOrTargetRadiusFixed=0,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern=t.pattern||{type:0,attributes:{}},t.pattern.type=0,t.opacity=1,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1,t.isSelfLoop=!1,t.isText=!1,t.adjustTextAngle=!1,t.isBadge=!1,t.unusedFlag2=!1,t.unusedFlag3=!1,t}function an(t,e,i,r){t.width=e*r,t.height=i*r,t.style.width=e+"px",t.style.height=i+"px"}var sn=(un.createInitData=function(){return null},un.getName=function(){return null},un.isAvailable=function(){return!0},un.prototype.getDomElement=function(){return null},un.prototype._initCanvas=function(t){t.style.touchAction="none"},un.prototype.export=function(t){return Promise.resolve()},un.prototype.extractElement=function(t,e){return this._memoryManager.extractGenericElement(t,e,this._scales)},un.prototype._compareDimensions=function(t,e,i){return(t!==this._width||e!==this._height||i!==this._pixelRatio)&&(this._width=t,this._height=e,this._pixelRatio=i,!0)},un.prototype._compareView=function(t,e,i,r){return(t!==this._viewX||e!==this._viewY||i!==this._viewZoom||r!==this._viewAngle)&&(this._viewX=t,this._viewY=e,this._viewZoom=i,this._viewAngle=r,this._viewAngleCos=Math.cos(r),this._viewAngleSin=Math.sin(r),!0)},un.prototype._compareCurrentTime=function(t){return t!==this._currentTime&&(this._currentTime=t,!0)},un.prototype._compareBackgroundColor=function(t,e){return(t!==this._backgroundColor||e!==this._renderBackground)&&(this._renderBackground=e,this._backgroundColor=t,this._backgroundRgba=this._colorManager.parseColor(this._backgroundColor),!0)},un.prototype._compareShapes=function(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)},un.prototype._comparePatterns=function(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)},un.prototype._compareBoundaries=function(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)},un.prototype._compareTexts=function(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)},un.prototype._compareIsDisplayableBuffer=function(t){return this._isBufferDisplayable!==t&&(this._isBufferDisplayable=t,!0)},un.prototype._compareHideImages=function(t){return this._hideImages!==t&&(this._hideImages=t,!0)},un.prototype.renderFrame=function(t){var e=t.x,i=t.y,r=t.zoom,n=t.angle,o=t.width,a=t.height,s=t.pixelRatio,u=t.backgroundColor,d=t.currentTime,l=t.isBufferDisplayable,h=t.hideImages,c=t.renderBackground,f=this._compareShapes(),g=this._comparePatterns(),p=this._compareBoundaries(),_=this._compareTexts(),v=this._compareDimensions(o,a,s),m=this._compareView(e,i,r,n),y=this._compareCurrentTime(d),b=this._compareBackgroundColor(u,c),x=this._compareIsDisplayableBuffer(l),E=this._compareHideImages(h);if(p){var A=this._boundariesManager,S=this._scales;S.bytesToActualCoord=1,S.bytesToActualScaledSize=A.maxScaledSize/65535,S.bytesToActualMinVisibleSize=A.maxMinVisibleSize/15,S.bytesToActualSymbolicSize=A.maxSymbolicSize/255,S.bytesToActualDashLength=A.maxDashLength/3,S.bytesToActualGapLength=A.maxGapLength/3,S.bytesToActualPatternScale=A.maxPatternScale/255}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:f,patternsChanged:g,boundariesChanged:p,textsChanged:_,dimensionsChanged:v,viewChanged:m,currentTimeChanged:y,backgroundColorChanged:b,isBufferDisplayableChanged:x,isHideImagesChanged:E}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)},un.prototype._render=function(t){},un.prototype._beforeFirstFrame=function(){},un.prototype._afterFirstFrame=function(){},un.prototype.destroy=function(){},un.prototype.ensureAnimationsReady=function(){},un.prototype.getImageData=function(){return null},un.prototype.setViewportClipping=function(t){},un);function un(t){var e=t.bufferList,i=t.patternManager,r=t.boundariesManager,n=t.colorManager,o=t.shapeManager,a=t.textManager,s=t.easingManager,u=t.memoryManager;this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._hideImages=!1,this._genericObject={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}},this._littleEndian=U(),this._bufferList=e,this._shapeManager=o,this._patternManager=i,this._boundariesManager=r,this._textManager=a,this._colorManager=n,this._easingManager=s,this._memoryManager=u}var dn,ln,hn="#define D3D9_FIX 0\n#define ANIMATED 0\nprecision highp float;\nprecision mediump int;\nattribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_final_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec4 a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft;\nattribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_prev_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec4 a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft;\nattribute /*float*/ vec2 a_animationBeginTime_animationDuration; \nattribute /*ushort*/ vec4 a_animationEasing; \nattribute /*ushort*/ vec3 a_text_charId_charOffsetXY; \nattribute vec3 a_vertexInfo;\nuniform float u_viewWidth;\nuniform float u_viewHeight;\nuniform float u_viewX;\nuniform float u_viewY;\nuniform float u_viewAngle;\nuniform float u_viewZoom;\nuniform float u_currentTime;\nuniform float u_pixelRatio;\nuniform sampler2D u_patternInfoTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float EPSILON = 0.000001;\nconst float INFINITY = 10000000.0;\nconst float PI = 3.14159265359;\nconst float P2_17 = 131072.0;\nconst float P2_16 = 65536.0;\nconst float P2_14 = 32768.0;\nconst float P2_12 = 4096.0;\nconst float P2_8 = 256.0;\nconst float P2_7 = 128.0;\nconst float P2_6 = 64.0;\nconst float P2_5 = 32.0;\nconst float P2_4 = 16.0;\nconst float P2_3 = 8.0;\nconst float P2_2 = 4.0;\nconst float P2_1 = 2.0;\nuniform float BYTES_TO_COORD;\nuniform float BYTES_TO_SCALED_SIZE;\nuniform float BYTES_TO_MIN_VISIBLE_SIZE;\nuniform float BYTES_TO_SYMBOLIC_SIZE;\nuniform float BYTES_TO_CURVATURE;\nuniform float BYTES_TO_DASH_LENGTH;\nuniform float BYTES_TO_GAP_LENGTH;\nuniform float BYTES_TO_PATTERN_SCALE;\nuniform float PATTERN_POSITION_GRANULARITY;\nuniform float PATTERN_INFO_TEXTURE_SIZE;\nuniform float PATTERN_NEAREST_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nuniform float PATTERN_MIPMAP_TEXTURE_SIZE;\nconst float BYTES_TO_OFFSET_ANGLE = 0.0;\nconst float BYTES_TO_COLOR = 0.0;\nconst float SDF_FONT_SIZE = 0.0;\nconst float SDF_GAMMA = 0.0;\nconst float CURVATURE_RATIO = 0.0;\nconst float PATTERN_MARGIN = 0.0;\nconst float TEXT_WIDTH_MULTIPLIER = 0.0;\nconst float TEXT_HEIGHT_MULTIPLIER = 0.0;\nconst float SELF_LOOP_CURVATURE_MULTIPLIER = 0.0;\nconst float EDGE_ARROW_SIZE_RATIO = 0.0;\nconst float NB_PIECES_PER_CURVE = 0.0;\nconst float PIECE_NODE_COMPONENT = 0.0;\nconst float PIECE_EDGE_BODY = 0.0;\nconst float PIECE_EDGE_HEAD = 0.0;\nconst float PIECE_EDGE_TAIL = 0.0;\nconst float PIECE_EDGE_TEXT = 0.0;\nconst float MAX_TEXT_SIZE = 0.0;\nconst float BYTES_TO_TEXT_OFFSET_X = 0.0;\nconst float BYTES_TO_TEXT_OFFSET_Y = 0.0;\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SHAPE_TEXTURE_SIZE = 0.0;\nconst float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;\nconst float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;\nconst float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;\nconst float MAX_NB_SHAPES = 0.0;\nconst float FIRST_COMPLEX_SHAPE_ID = 0.0;\nconst float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;\nconst float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;\nconst float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;\nconst float T_STEP_PER_CURVE_PIECE = 1.0 / NB_PIECES_PER_CURVE;\nconst float HEAD_TAIL_PX_ADJUST = 1.5;\nconst float SDF_SMOOTH_FACTOR = 2.0;\nstruct nv {\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nfloat oc;\nfloat od;\n};\nstruct oe {\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\n};\nstruct om {\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nfloat oc;\nfloat od;\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\nfloat bu;\nfloat on;\nfloat oo;\nfloat op;\nfloat oq;\nfloat or;\nfloat os;\nvec4 bd;\nvec4 be;\nvec4 bz;\nfloat ot;\nfloat ou;\nfloat ov;\nfloat ow;\nfloat ox;\nfloat oy;\nfloat oz;\nfloat pa;\nfloat pb;\nfloat pc;\nfloat pd;\nfloat pe;\nfloat pf;\nfloat pg;\nfloat ph;\nfloat pi;\nfloat pj;\nfloat pk;\nfloat pl;\n};\nstruct pm {\nfloat pn;\nvec2 po;\nvec4 bd;\nvec4 be;\nfloat bu;\nfloat pp;\nfloat pq;\nfloat ny;\nfloat pr;\nvec2 ps;\nfloat pt;\nvec2 bi;\nvec2 pu;\nvec2 pv;\nfloat pw;\nfloat px;\nvec4 bz;\nvec2 py;\nfloat pz;\nfloat qa;\nvec2 qb;\nvec2 qc;\nvec2 qd;\n};\nfloat qe(float ly, float qf, float qg) {\nfloat qh = mod(ly, pow(2.0, qg));\nreturn floor(qh / pow(2.0, qf));\n}\nnv qi(float ly) {\nnv qj;\nqj.nw = qe(ly, 0.0, 4.0);\nqj.nx = qe(ly, 4.0, 8.0);\nqj.ny = qe(ly, 8.0, 10.0);\nqj.nz = qe(ly, 10.0, 12.0);\nqj.oa = qe(ly, 12.0, 13.0);\nqj.ob = qe(ly, 13.0, 14.0);\nqj.oc = qe(ly, 14.0, 15.0);\nqj.od = qe(ly, 15.0, 16.0);\nreturn qj;\n}\noe qk(float ly) {\noe qj;\nqj.of = qe(ly, 0.0, 8.0);\nqj.og = qe(ly, 8.0, 11.0);\nqj.oh = qe(ly, 11.0, 12.0);\nqj.oi = qe(ly, 12.0, 13.0);\nqj.oj = qe(ly, 13.0, 14.0);\nqj.ok = qe(ly, 14.0, 15.0);\nqj.ol = qe(ly, 15.0, 16.0);\nreturn qj;\n}\nvec4 ql(in float ly) {\nreturn vec4(\nqe(ly, 0.0, 4.0),\nqe(ly, 4.0, 8.0),\nqe(ly, 8.0, 12.0),\nqe(ly, 12.0, 16.0)\n);\n}\nvec2 qm(in float ly) {\nreturn vec2(mod(ly, 256.0), floor(ly / 256.0));\n}\nvec2 qn(in float ly) {\nfloat qo = floor(ly / P2_6);\nfloat qp = ly - (qo * P2_6);\nreturn vec2(qo, qp);\n}\nvec2 qq(in float ly) {\nfloat qr = floor(ly / P2_7);\nfloat qs = ly - (qr * P2_7);\nreturn vec2(qr, qs);\n}\nvec2 qt(in vec2 qu, in float qv) {\nfloat qw = cos(qv);\nfloat qx = sin(qv);\nreturn vec2(qw * qu.x + qx * qu.y, -qx * qu.x + qw * qu.y);\n}\nvec4 qy(in vec4 qz) {\nreturn floor(qz / 256.0) - 128.0;\n}\nvec4 ra(in vec4 qz) {\nreturn mod(qz, 256.0) - 128.0;\n}\nfloat rb(float ly) {\nreturn ly - 128.0;\n}\nvec2 rb(vec2 ly) {\nreturn ly - 128.0;\n}\nvec2 rc(vec2 rd) {\nreturn vec2(-rd.y, rd.x);\n}\nvec2 re(vec2 rf, vec2 gj, vec2 rg, float t) {\nfloat rh = 1.0 - t;\nreturn (rh * rh * rf) + (2.0 * rh * t * gj) + (t * t * rg);\n}\nvec2 ri(vec2 rf, vec2 rj, vec2 rk, vec2 rg, float t) {\nfloat rh = 1.0 - t;\nfloat rl = rh * rh;\nfloat rm = rl * rh;\nfloat rn = t * t;\nfloat ro = rn * t;\nreturn (rm * rf) + (3.0 * rl * t * rj) + (3.0 * rh * rn * rk) + (ro * rg);\n}\nvec2 rp(vec2 rf, vec2 gj, vec2 rg, float t) {\nfloat rh = (1.0 - t);\nvec2 qu = (rh * gj + t * rg) - (rh * rf + t * gj);\nreturn normalize(qu);\n}\nvec2 rq(vec2 rf, vec2 gj, vec2 rg, float t) {\nreturn rc(rp(rf, gj, rg, t));\n}\nvec2 rr(vec2 rf, vec2 rj, vec2 rk, vec2 rg, float t) {\nfloat rh = 1.0 - t;\nfloat rl = rh * rh;\nfloat rn = t * t;\nvec2 qu = rl * (rj - rf) + 2.0 * rh * t * (rk - rj) + rn * (rg - rk);\nreturn normalize(qu);\n}\nvec2 rs(vec2 rf, vec2 rj, vec2 rk, vec2 rg, float t) {\nreturn rc(rr(rf, rj, rk, rg, t));\n}\nfloat sd(float or, float se, float t) {\nfloat y = abs(or) / CURVATURE_RATIO + EPSILON;\nfloat ow = y * y;\nfloat rh = t - 0.5;\nfloat rl = rh * rh;\nfloat sf = 1.0 / (16.0 * ow);\nfloat sg = sqrt(rl + sf);\nfloat sh = (0.5 / y) * sqrt(ow + 0.25);\nfloat si = (abs(2.0 * y)) * ((rh * sg) + (0.5 * sh) + (sf * log(abs((rh + sg) / (-0.5 + sh)))));\nreturn si * se;\n}\nfloat sj(vec2 rf, vec2 sk, vec2 sl, vec2 rg, float sm) {\nvec2 py = (rf + sk + sl) / 3.0;\nvec2 sn = py - sk;\nvec2 so = sk - sl;\nfloat sp = dot(sn, sn);\nfloat sq = dot(so, so) / 4.0;\nfloat sy = sqrt(sp - sq) * SELF_LOOP_TO_CIRCLE_APPROX * 1.55;\nreturn 2.0 * PI * sy * sm;\n}\nfloat sz(float ly) {\nreturn ly - 32.0;\n}\nfloat ta(float ly) {\nreturn ly - 512.0;\n}\nfloat tb(float ly) {\nreturn ly - P2_14;\n}\nvoid tc() {\ngl_Position = vec4(-10.0, -10.0, 1.0, 1.0);\n}\nvec4 td(vec2 te) {\nreturn vec4(((vec2(te.x, u_viewHeight - te.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);\n}\nfloat ti(float ap, float aq) {\nreturn step(ap - EPSILON, aq) * step(aq, ap + EPSILON);\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nbool tj(float ly) {\nreturn ly > 0.5;\n}\nvec2 tk(vec2 tl) {\nreturn qt((tl - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;\n}\nfloat tm(float qa) {\nreturn qa * EDGE_ARROW_SIZE_RATIO;\n}\nfloat tn(float to, float tp) {\nreturn to * BYTES_TO_SCALED_SIZE * u_viewZoom + tp;\n}\nfloat tv(float pp, float tt, float tu) {\nfloat tw = tu - tt;\nfloat a = 1.0 / tw;\nfloat b = -tt / tw;\nreturn pp * a + b;\n}\nstruct tx {\nvec2 ty;\nvec2 tz;\n};\ntx ua(vec2 ub, float sy, float or) {\ntx ma;\nfloat uc = (sy + sy / SELF_LOOP_CURVATURE_MULTIPLIER * or) * SELF_LOOP_CURVATURE_MULTIPLIER;\nfloat ud = -u_viewAngle + PI;\nfloat ue = -u_viewAngle + PI / 2.0;\nma.ty = ub + vec2(cos(ud), sin(ud)) * uc;\nma.tz = ub + vec2(cos(ue), sin(ue)) * uc;\nreturn ma;\n}\nfloat uj(vec2 uk, vec2 sk, vec2 sl, vec2 ul, float um) {\nvec2 un = uk;\nfloat t = 0.0;\nfloat uo = 0.0;\nfloat up = sj(uk, sk, sl, ul, 1.0);\nreturn um / up;\n}\nom uq(\nvec4 ur,\nvec4 us,\nvec4 ut,\nvec4 uu,\nvec4 uv,\nvec4 uw,\nvec3 ux\n) {\nom a;\nnv ax = qi(ur.x);\noe uy = qk(ur.y);\nvec4 uz = ql(ur.z);\nvec2 va = qm(ur.w);\na.nw = ax.nw;\na.nx = ax.nx;\na.ny = ax.ny;\na.nz = ax.nz;\na.oa = ax.oa;\na.ob = ax.ob;\na.oc = ax.oc;\na.od = ax.od;\na.of = uy.of;\na.og = uy.og;\na.oh = uy.oh;\na.oi = uy.oi;\na.oj = uy.oj;\na.ok = uy.ok;\na.ol = uy.ol;\na.bu = uz.x;\na.on = uz.y;\na.oo = uz.z;\na.op = uz.w;\na.oq = va.x;\na.or = va.y;\na.os = us.x;\na.bd = ql(us.y);\na.be = ql(us.z);\na.bz = ql(us.w);\na.ot = ut.x;\na.ou = ut.y;\na.ov = ut.z;\na.ow = ut.w;\na.ox = uu.x;\na.oy = uu.y;\na.oz = uu.z;\na.pa = uu.w;\na.pb = uv.x;\na.pc = uv.y;\na.pd = uv.z;\na.pe = uv.w;\na.pf = uw.x;\na.pg = uw.y;\na.pk = tb(uw.z);\na.pl = tb(uw.w);\na.ph = ux.x;\nfloat x = ux.y;\nfloat y = mod(x, P2_8);\nif (ux.z > 0.0) x += ux.z * P2_16;\na.pi = ((x - y) / P2_8) - P2_16;\na.pj = (y - P2_7) * BYTES_TO_TEXT_OFFSET_Y;\nreturn a;\n}\n/**\n* vq a pm cj aa vr om.\n* dw dx cy dm vs vt, aa vr om ds dm\n* vu fx aa vv bg vw vx cy aa vt,\n* vy dj aa vz wa.\n*/\nbool wb(const in om a, out pm ma) {\nfloat nw = a.nw;\nfloat nx = a.nx;\nfloat ny = a.ny * BYTES_TO_DASH_LENGTH;\nfloat nz = a.nz * BYTES_TO_GAP_LENGTH;\nfloat oa = a.oa;\nfloat ob = a.ob;\nfloat oc = a.oc;\nfloat od = a.od;\nfloat of = a.of * BYTES_TO_PATTERN_SCALE;\nfloat og = a.og * BYTES_TO_OFFSET_ANGLE;\nfloat oh = a.oh;\nfloat oi = a.oi;\nfloat oj = a.oj;\nfloat ok = a.ok;\nfloat ol = a.ol;\nfloat bu = a.bu * BYTES_TO_COLOR;\nfloat on = a.on * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat oo = a.oo * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat op = a.op * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat oq = a.oq * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom + step(a.oq, EPSILON) * INFINITY;\nfloat or = rb(a.or);\nfloat os = a.os;\nvec4 bd = a.bd * BYTES_TO_COLOR;\nvec4 be = a.be * BYTES_TO_COLOR;\nvec4 bz = a.bz * BYTES_TO_COLOR;\nvec2 wc = vec2(a.ot, a.ou) * BYTES_TO_COORD;\nvec2 wd = vec2(a.ov, a.ow) * BYTES_TO_COORD;\nvec2 uk = tk(wc);\nvec2 ul = tk(wd);\nfloat we = tn(a.ox, a.oy);\nfloat wf = tn(a.oz, a.pa);\nfloat wg = tn(a.pb, a.pc);\nfloat pn = tn(a.pd, a.pe);\nfloat vb = tn(a.pf, a.pg);\nvec2 wh = a_vertexInfo.xy;\nvec2 wi = vec2(0.0, 0.0);\nfloat wj = we;\nfloat wk = wf;\nfloat wl = wf * of;\nif (oh > EPSILON) {\nif (a.ph < EPSILON) return false;\nwl = wg;\nos = a.ph;\nwe = wl * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;\nwf = wl * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;\n}\nbool xe = abs(or) > EPSILON && ti(nx, PIECE_EDGE_BODY) < EPSILON;\nbool xf = xe && a_vertexInfo.z > EPSILON;\nif (nw < EPSILON || nx < EPSILON || oq < on || xf) {\nreturn false;\n}\npn *= step(oo, oq);\nfloat xs = 0.0;\nfloat xt = 1.0;\nfloat xp = 0.0;\nfloat xr = 1.0;\nfloat xu = 0.0;\nfloat ye = 1.0;\nfloat yg = 1.0;\nfloat yr = 0.0;\nfloat ys = 0.0;\nvec2 py;\nvec2 qb;\nvec2 qc;\nvec2 qd;\nfloat qa;\nfloat pz;\nfloat zl = 0.0;\nfloat zm = 1.0;\nif (ti(nx, PIECE_NODE_COMPONENT) > EPSILON) {\npy = ceil((uk + ul) / 2.0);\nqb = normalize(vec2(wd.x - wc.x + 0.001, wc.y - wd.y));\nqc = rc(qb);\nqd = qc;\nqa = we;\npz = wf;\n} else {\nyg = 0.0;\nfloat aaa = distance(uk, ul);\nvec2 aab = normalize(ul - uk);\nvec2 aac = (uk + ul) / 2.0;\nvec2 aad = rc(aab);\nvec2 aae = aac + (aad * aaa * -or / CURVATURE_RATIO);\nif (ti(nx, PIECE_EDGE_TEXT) > 0.0) {\nfloat aaf;\nfloat aag = pn;\npn = 0.0;\nif (od > EPSILON) {\ntx gj = ua(uk, aag / 2.0, or);\npy = ri(uk, gj.ty, gj.tz, ul, 0.5);\nqb = rr(uk, gj.ty, gj.tz, ul, 0.5);\nqc = rc(qb);\nqd = qc;\naaf = sj(uk, gj.ty, gj.tz, ul, 0.5);\n} else if (abs(or) > EPSILON) {\npy = re(uk, aae, ul, 0.5);\nqb = rp(uk, aae, ul, 0.5);\nqc = rc(qb);\nqd = qc;\naaf = sd(or, aaa, 1.0);\n} else {\npy = aac;\nqb = aab;\nqc = aad;\nqd = aad;\naaf = aaa;\n}\nqa = we;\npz = wf;\nif (oi > EPSILON\n&& od < EPSILON\n&& wj > aaf - aag) {\nqb = vec2(1.0, 0.0);\nqc = vec2(0.0, 1.0);\nqd = vec2(0.0, 1.0);\n} else {\nfloat qv = -atan(qb.y, qb.x);\nzl = qv;\nog -= qv;\nif ((qv > PI / 2.0 || qv < -PI / 2.0)) {\nog += (1.0 - od) * PI;\nzm = -1.0;\nqb *= -1.0;\nqc *= -1.0;\nqd *= -1.0;\n}\n}\n} else {\nfloat yk = wg;\nfloat aao = we;\nfloat aap = wf;\nfloat aaq = oa + ob;\nfloat aar = tm(yk);\nfloat aas = oa * aar;\nfloat aat = ob * aar;\nfloat aau = ti(nx, PIECE_EDGE_HEAD);\nfloat aav = ti(nx, PIECE_EDGE_TAIL);\nfloat aaw = INFINITY * od + aaa - aao - aap;\nfloat aax = min(aaw / aaq, aar);\nfloat abg =\nob * (aar + max(aao + aax - aat, 0.0))\n+ (1.0 - ob) * oc * aao;\nfloat abh =\noa * (aar + max(aap + aax - aas, 0.0))\n+ (1.0 - oa) * oc * aap;\nif (aau > EPSILON || aav > EPSILON) {\nvec2 abk = aau * ul + aav * uk;\nfloat vb = aau * abh + aav * abg + (HEAD_TAIL_PX_ADJUST - 0.5);\nfloat abl = aau * aas + aav * aat;\nvec2 abm;\nif (od > EPSILON) {\ntx gj = ua(uk, aao, or);\nfloat aaf = sj(uk, gj.ty, gj.tz, ul, 1.0);\nfloat um = aau * (aaf - abh) + aav * abg;\nfloat t = uj(uk, gj.ty, gj.tz, ul, um);\nabm = ri(uk, gj.ty, gj.tz, ul, t);\n} else {\nfloat aaf = sd(or, aaa, 1.0);\nfloat t = (aau * (aaf - abh) + aav * abg) / aaf;\nabm = re(uk, aae, ul, t);\n}\nqb = normalize(abk - abm);\nqc = rc(qb);\nqd = qc;\npy = abk - qb * (vb - abl / 2.0);\nqa = abl;\npz = abl;\nny = 0.0;\nnz = 0.0;\n} else {\nfloat abq;\nfloat abr;\nfloat abt;\nif (abs(or) < EPSILON) {\npy = aac;\nqb = aab;\nqc = aad;\nqd = qc;\nqa = aaa;\nabq = aaa;\nabr = 0.0;\nabt = aaa;\n} else {\nfloat abv = a_vertexInfo.z;\nfloat abw = abv * T_STEP_PER_CURVE_PIECE;\nfloat rn = abw + T_STEP_PER_CURVE_PIECE;\nif (od < EPSILON) {\nvec2 abx = re(uk, aae, ul, abw);\nvec2 aby = re(uk, aae, ul, rn);\npy = (abx + aby) / 2.0;\nqb = normalize(aby - abx);\nqc = rq(uk, aae, ul, abw);\nqd = rq(uk, aae, ul, rn);\nqa = distance(abx, aby);\nabq = sd(or, aaa, 1.0);\nabr = sd(or, aaa, abw);\nabt = sd(or, aaa, rn);\n} else {\ntx gj = ua(uk, aao, or);\nvec2 sk = gj.ty;\nvec2 sl = gj.tz;\nvec2 abx = ri(uk, sk, sl, ul, abw);\nvec2 aby = ri(uk, sk, sl, ul, rn);\npy = (abx + aby) / 2.0;\nqb = normalize(aby - abx);\nqc = rs(uk, sk, sl, ul, abw);\nqd = rs(uk, sk, sl, ul, rn);\nqa = distance(abx, aby);\nabq = sj(uk, sk, sl, ul, 1.0);\nabr = sj(uk, sk, sl, ul, abw);\nabt = sj(uk, sk, sl, ul, rn);\n}\n}\npz = wg;\nxp = (abg - 1.0) / abq;\nxr = 1.0 - (abh - HEAD_TAIL_PX_ADJUST) / abq;\nxs = abr / abq;\nxt = abt / abq;\nxu = abq;\nif (oc > 0.0 && aaw > 5.0) {\nfloat ace = (abq * pz) / (abq - abg);\nfloat up = abq;\nfloat ot = abg;\nfloat ov = abq - abh;\nfloat a = -ace / up;\nfloat b = ace;\nfloat ou = a * ot + b;\nfloat ow = a * ov + b;\nfloat acf = ou / (ot - ov);\nfloat acg = -acf * ov;\npz = acg;\nys = acf * up + acg + 1.0;\n}\n}\n}\n}\nvec2 bi = vec2(0.0, 0.0);\nvec2 pu = vec2(EPSILON, EPSILON);\nvec2 pv = vec2(-EPSILON, -EPSILON);\nfloat pw = -1.0;\nfloat px = 0.0;\nbool ach = false;\nvec2 aci = vec2(0,0);\nvec2 acj = vec2(0,0);\nvec2 ack = vec2(0,0);\nif (os > EPSILON && oq > op) {\nfloat acn = floor(os / PATTERN_INFO_TEXTURE_SIZE);\nfloat aco = os - (acn * PATTERN_INFO_TEXTURE_SIZE);\nvec4 acp = texture2D(u_patternInfoTexture, vec2(aco, acn) / 255.0) * 255.0;\nvec2 acq = qq(acp.z);\nvec2 acr = qq(acp.w);\npw = acq.x * 2.0 + acr.x;\nfloat acs = 0.0;\nif (ao(pw, FILTER_NEAREST)) { \nacs = PATTERN_NEAREST_TEXTURE_SIZE;\n} else if (ao(pw, FILTER_LINEAR)) { \nacs = PATTERN_LINEAR_TEXTURE_SIZE;\n} else if (ao(pw, FILTER_LINEAR_SDF)) { \nacs = PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nach = true;\n} else if (ao(pw, FILTER_MIPMAP)) { \nacs = PATTERN_MIPMAP_TEXTURE_SIZE;\n}\nfloat acv = 1.0 / acs;\nvec2 acw = (vec2(acq.y, acr.y) * PATTERN_POSITION_GRANULARITY) * acv / 2.0;\nacj += (acp.xy * PATTERN_POSITION_GRANULARITY * acv) + acw;\nacj += PATTERN_MARGIN * acv;\nacw -= PATTERN_MARGIN * acv * 2.0;\nvec2 acx = vec2(qa / 2.0, pz / 2.0) * acv;\nvec2 acy = vec2(pn, pn) * acv;\nfloat ada = 1.0 * u_pixelRatio;\nfloat adb = SDF_SMOOTH_FACTOR;\nif (of > EPSILON) {\nif (ach) { \nif (a.oj > EPSILON) {\nadb = SDF_SMOOTH_FACTOR * u_pixelRatio / SDF_GAMMA;\naci = vec2(-a.pl,-a.pk) / (1.0 /of);\n}\npx = adb * SDF_GAMMA / wl / u_pixelRatio;\nada = SDF_FONT_SIZE / wl;\n} else { \nada = (acw.y / acx.y) / of;\n}\n}\nack = (acx + acy) * ada;\nacw += PATTERN_MARGIN * acv;\npu = acj - acw;\npv = acj + acw;\n}\nif (oh > EPSILON) {\nwi.y = (a.pj) * wl;\nye = 0.0;\nyg = 0.0;\nwi.x = a.pi * wl * BYTES_TO_TEXT_OFFSET_X;\nwi += vec2(1.0, 1.0);\nwi = qt(wi, zl);\nwi *= zm;\n}\nvec2 adg = vec2(cos(og), sin(og)) * vb;\nvec2 adh = py + adg + wi;\nfloat adi = pn * 2.0;\nfloat adj = qa + yg * (adi + 1.0);\nfloat adk = pz + ye * (adi + 1.0);\nvec2 adl = qb * adj / 2.0;\nvec2 adm = qc * adk / 2.0;\nvec2 adn = qd * adk / 2.0;\nfloat ado = (xt - xs);\nfloat adp = wh.x / 2.0 + 0.5;\nfloat pp = xs + ado * adp;\nfloat pt = yr + (ys - yr) * pp / 2.0;\nfloat adq = step(nw, FIRST_COMPLEX_SHAPE_ID - EPSILON);\nfloat adr = adq * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - adq) * COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat ads = adr / COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat adt = ads * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;\nfloat adu = ads * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);\nvec2 aec = vec2(\nmod(nw, NB_SHAPES_BY_SIDE),\nfloor(nw / NB_SHAPES_BY_SIDE)\n);\nvec2 aed = aec + vec2(adt) +\nvec2(xs * adu, 0.0);\nvec2 aeg = vec2(ado, 1.0) * adu;\nvec2 po = (aed + aeg * (wh / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;\nvec2 ps = vec2(adj / ado, adk) / 2.0;\nfloat aen = ny * wg;\nfloat aeo = nz * wg;\nfloat pq = aen + aeo;\nfloat pr = (pp * xu) / pq;\nbi = acj \n+ ack \n* (wh + aci/ps* u_viewZoom * 2.0);\nma.po = po;\nma.ps = ps;\nma.pn = pn;\nma.bd = bd;\nma.be = be;\nma.bu = bu;\nma.pp = tv(pp, xp, xr);\nma.pq = pq;\nma.ny = aen;\nma.pr = pr;\nma.pt = pt;\nma.bi = bi;\nma.pu = pu;\nma.pv = pv;\nma.pw = pw;\nma.px = px;\nma.bz = bz;\nma.py = adh;\nma.qa = adj;\nma.pz = adk;\nma.qb = qb;\nma.qc = qc;\nma.qd = qd;\nreturn true;\n}\nfloat aer(float aes, float aet, vec4 aeu) {\nfloat aev = clamp(((u_currentTime - aes) / aet), 0.0, 1.0);\nfloat r = aev;\nfloat aew = r * r;\nfloat aex = aew * r;\nvec4 aey = aev < 0.5 ? qy(aeu) : ra(aeu);\nfloat aez = aey.x;\nfloat afa = aey.y;\nfloat afb = aey.z;\nfloat afc = aey.w;\nfloat afd = aez + afa * r + afb * aew + afc * aex;\nreturn afd;\n}\nvoid main() {\nom a_final = uq(\na_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_final_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_final_x1_y1_x2_y2,\na_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_final_offsetScaled_offsetFixed_paddingTop_paddingLeft,\na_text_charId_charOffsetXY\n);\n#if ANIMATED\nfloat aes = a_animationBeginTime_animationDuration.x;\nfloat aet = a_animationBeginTime_animationDuration.y;\nvec4 aeu = a_animationEasing;\nfloat wa = aer(aes, aet, aeu);\nom a_prev = uq(\na_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_prev_x1_y1_x2_y2,\na_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft,\na_text_charId_charOffsetXY\n);\nconst float ONE = 1.0;\na_final.nw = mix(a_prev.nw, a_final.nw, ONE);\na_final.ny = mix(a_prev.ny, a_final.ny, wa);\na_final.nz = mix(a_prev.nz, a_final.nz, wa);\na_final.oa = mix(a_prev.oa, a_final.oa, ONE);\na_final.ob = mix(a_prev.ob, a_final.ob, ONE);\na_final.nx = mix(a_prev.nx, a_final.nx, ONE);\na_final.of = mix(a_prev.of, a_final.of, ONE);\na_final.oh = mix(a_prev.oh, a_final.oh, ONE);\na_final.oi = mix(a_prev.oi, a_final.oi, ONE);\na_final.oj = mix(a_prev.oj, a_final.oj, ONE);\na_final.ok = mix(a_prev.ok, a_final.ok, ONE);\na_final.od = mix(a_prev.od, a_final.od, ONE);\na_final.og = mix(a_prev.og, a_final.og, wa);\na_final.bu = mix(a_prev.bu, a_final.bu, wa);\na_final.on = mix(a_prev.on, a_final.on, wa);\na_final.oo = mix(a_prev.oo, a_final.oo, wa);\na_final.op = mix(a_prev.op, a_final.op, wa);\na_final.oq = mix(a_prev.oq, a_final.oq, wa);\na_final.or = mix(a_prev.or, a_final.or, wa);\na_final.os = mix(a_prev.os, a_final.os, ONE);\na_final.bd = mix(a_prev.bd, a_final.bd, wa);\na_final.be = mix(a_prev.be, a_final.be, wa);\na_final.bz = mix(a_prev.bz, a_final.bz, wa);\na_final.ot = mix(a_prev.ot, a_final.ot, wa);\na_final.ou = mix(a_prev.ou, a_final.ou, wa);\na_final.ov = mix(a_prev.ov, a_final.ov, wa);\na_final.ow = mix(a_prev.ow, a_final.ow, wa);\na_final.ox = mix(a_prev.ox, a_final.ox, wa);\na_final.oy = mix(a_prev.oy, a_final.oy, wa);\na_final.oz = mix(a_prev.oz, a_final.oz, wa);\na_final.pa = mix(a_prev.pa, a_final.pa, wa);\na_final.pb = mix(a_prev.pb, a_final.pb, wa);\na_final.pc = mix(a_prev.pc, a_final.pc, wa);\na_final.pd = mix(a_prev.pd, a_final.pd, wa);\na_final.pe = mix(a_prev.pe, a_final.pe, wa);\na_final.pf = mix(a_prev.pf, a_final.pf, wa);\na_final.pg = mix(a_prev.pg, a_final.pg, wa);\na_final.ph = mix(a_prev.ph, a_final.ph, ONE);\na_final.pi = mix(a_prev.pi, a_final.pi, ONE);\na_final.pj = mix(a_prev.pj, a_final.pj, ONE);\n#endif\npm ma;\nbool afh = wb(a_final, ma);\nif (!afh) {\ntc();\nreturn;\n}\nvec2 wh = a_vertexInfo.xy;\na = ma.bd;\nb = ma.be;\nc = ma.bz;\nd = ma.po;\ne = ma.bi;\n#if D3D9_FIX\n#else\nj = ma.pn;\nk = ma.pu;\nl = ma.pv;\nm = vec2(ma.bu, ma.pt);\nn = ma.pp;\no = ma.pq;\np = vec2(ma.ny, ma.pr);\nq = ma.ps;\nr = ma.px;\ns = ma.pw;\n#endif\nfloat afk = step(wh.x, 0.0);\nfloat afl = 1.0 - afk;\nvec2 te = ma.py\n+ (ma.qb * (ma.qa / 2.0) * wh.x)\n+ ((afk * ma.qc + afl * ma.qd) * (ma.pz / 2.0) * wh.y);\ngl_Position = td(te);\n}\n",cn="#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SDF_GAMMA = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 ax = texture2D(u_shapeTexture, d);\nfloat ay = aj(ax.b, ax.a) * q.x;\nfloat az = aj(ax.r, ax.g) * q.y;\naz += as;\nfloat bc = min(ay, az);\nvec4 bd = a;\nvec4 be = b;\nif (s > -EPSILON) {\nvec2 bi = e;\nfloat bv =\nstep(k.x, bi.x) *\nstep(bi.x, l.x) *\nstep(k.y, bi.y) *\nstep(bi.y, l.y);\nfloat bw = bv;\nvec4 bz;\nif (ao(s, FILTER_NEAREST)) {\nbz = texture2D(u_patternNearestTexture, bi);\n} else if (ao(s, FILTER_LINEAR)) { \nbz = texture2D(u_patternLinearTexture, bi);\n} else if (ao(s, FILTER_LINEAR_SDF)) { \nbz = texture2D(u_patternLinearSdfTexture, bi);\nbz.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bz.a);\n} else if (ao(s, FILTER_MIPMAP)) { \nbz = texture2D(u_patternMipmapTexture, bi);\n}\nbz.rgb += c.rgb;\nbz.a *= bw;\nbd = ad(bd, bz);\n}\nfloat cl = clamp(bc, 0.0, 1.0);\nfloat cm = clamp(bc - j, 0.0, 1.0);\nfloat cn = cl - cm;\ncn = 1.0 - clamp(bc - j, 0.0, 1.0);\nbd.a *= cm;\nbe.a *= cn;\nvec4 co = ad(bd, be);\nfloat cp = cl;\nco.rgb = mix(u_backgroundColor, co.rgb, ar);\nif (o > EPSILON) {\nfloat de = fract(au) * o;\nfloat df = clamp(min(de, at - de), 0.0, 1.0);\ncp *= df;\n}\nif (n < 0.0 || n > 1.0 || cp < EPSILON) {\ndiscard;\n}\nco.a *= cp;\nco.rgb *= co.a;\ngl_FragColor = co;\n}\n";(ln=dn=dn||{})[ln.INIT=0]="INIT",ln[ln.COMPILING=1]="COMPILING",ln[ln.DONE=2]="DONE";var fn=(gn.prototype.setConstant=function(t,e){this._constants[t]=e},gn.prototype.setMacro=function(t,e){this._macros[t]=e},gn.prototype.getState=function(){return this._state},gn.prototype.getProgram=function(){return this._program},gn.prototype.compile=function(){var t=this._gl,e=pn(this._vertexSource,this._macros,this._constants),i=pn(this._fragmentSource,this._macros,this._constants);this._program&&(t.deleteProgram(this._program),t.deleteShader(this._vertexShader),t.deleteShader(this._fragmentShader));var r=t.createProgram(),n=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER);if(!(r&&n&&o))throw new Error("Error instantiating WebGL program");this._program=r,this._vertexShader=n,this._fragmentShader=o,t.shaderSource(this._vertexShader,e),t.compileShader(this._vertexShader),t.attachShader(this._program,this._vertexShader),t.shaderSource(this._fragmentShader,i),t.compileShader(this._fragmentShader),t.attachShader(this._program,this._fragmentShader),t.linkProgram(this._program),this._state=dn.COMPILING},gn.prototype.getError=function(){var t=this._gl;return t.getShaderParameter(this._vertexShader,t.COMPILE_STATUS)?t.getShaderParameter(this._fragmentShader,t.COMPILE_STATUS)?t.getProgramParameter(this._program,t.LINK_STATUS)?(this._state=dn.DONE,null):{step:"link",message:t.getProgramInfoLog(this._program)||""}:{step:"fragment",message:t.getShaderInfoLog(this._fragmentShader)||""}:{step:"vertex",message:t.getShaderInfoLog(this._vertexShader)||""}},gn);function gn(t,e){var i=e.vertex,r=e.fragment,n=e.constants,o=e.macros;this._state=dn.INIT,this._gl=t,this._vertexSource=i,this._fragmentSource=r,this._constants=q(n||{}),this._macros=q(o||{})}function pn(t,e,i){for(var r=Object.keys(e),n=Object.keys(i),o=0;o<r.length;++o){var a=r[o],s=e[a];t=t.replace("#define "+a+" 0","#define "+a+" "+s)}for(o=0;o<n.length;++o){var u=n[o],d=i[u],l=d+(d%1==0?".0":"");t=t.replace("const float "+u+" = 0.0;","const float "+u+" = "+l+";")}return t}var _n,vn,mn=((_n={})[0]={min:"NEAREST",mag:"NEAREST",mipmap:!1},_n[1]={min:"LINEAR",mag:"LINEAR",mipmap:!1},_n[2]={min:"LINEAR",mag:"LINEAR",mipmap:!1},_n[3]={min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0},_n),yn=((vn={})[0]="ALPHA",vn[1]="RGBA",vn);function bn(t){return 16*Math.ceil((t+2)/16)}function xn(t,e,i,r,n){for(var o=0,a=t.length;o<a;++o){var s=t[o],u=s.x,d=s.y,l=u+r,h=d+n,c=l<i&&h<i;if(c)for(var f=u;f<l;++f)if(1===e[f+d*i]){c=!1;break}if(c)for(f=d;f<h;++f)if(1===e[u+f*i]){c=!1;break}if(c){for(f=u;f<l;++f)for(var g=d;g<h;++g)e[f+g*i]=1;return t.splice(o,1),t.push({x:u,y:h},{x:l,y:d}),s}}return null}function En(t,e,i,r,n,o,a){var s=4*t,u=e>>1<<7,d=e%2<<7;a[s]=i/16,a[1+s]=r/16,a[2+s]=u+n/16,a[3+s]=d+o/16}function An(t,e,i,r,n,o,a){r|=0,n|=0,o|=0,a|=0,e|=0;for(var s=0;s<o;++s)for(var u=0;u<a;++u){var d=4*(r+s+(n+u)*e),l=4*(s+u*o);t[d]=i[l],t[1+d]=i[1+l],t[2+d]=i[2+l],t[3+d]=i[3+l]}}function Sn(t,e){for(var i=0,r=4,n=0;n<t.length;++n){var o=t[n],a=o.width,s=o.height,u=bn(a),d=bn(s);i+=u*d,r=Math.max(r,Math.max(u,d))}var l=He(Math.max(r,Math.sqrt(i)));return Math.min(l,e)}function wn(t,e){return Math.floor((e-t)/2)}function Tn(t,e,i,r,n,o,a){var s=mn[o],u=s.min,d=s.mag,l=s.mipmap,h=t[yn[a]];if(0===a){for(var c=new Uint8Array(n*n),f=0;f<c.length;++f)c[f]=r[4*f+3];r=c}t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,h,n,n,0,h,t.UNSIGNED_BYTE,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[d]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[u]),l&&t.generateMipmap(t.TEXTURE_2D)}function Cn(t,e,i,r,n){for(var o=new Uint8Array(i*i*4),a=Math.ceil(i/16),s=new Uint8Array(a*a),u=[{x:0,y:0}],d=0;d<e.length;++d){var l=e[d],h=l.id,c=bn(l.width)/16,f=bn(l.height)/16,g=xn(u,s,a,c,f);if(g){var p=l.width,_=l.height,v=l.pixels,m=16*c,y=16*f,b=16*g.x+wn(p,m),x=16*g.y+wn(_,y);An(o,i,v,b,x,p,_),En(h,t,b,x,m,y,n)}else{if(i<r)return Cn(t,e,2*i,r,n);Si("exceeded max WebGL texture size of "+r+"; some texts/icons/images won't be displayed"),En(h,t,0,0,0,0,n)}}return{texture:o,size:i}}function Mn(t,e,i,r){for(var n=t.getDistanceFromStrokeVertically,o=t.getDistanceFromStrokeHorizontally,a=e*(1-i)/2,s=(e-1)/2,u=0;u<e;++u)for(var d=0;d<e;++d){var l=4*(d*e+u),h=(u-s)/a,c=(d-s)/a,f=qe(n(h,c),-1,1),g=qe(o(h,c),-1,1);Ln(r,l,In(f),In(g))}}function In(t){return(t+1)/2*32768}function Ln(t,e,i,r){t[e]=i>>8,t[e+1]=i%256,t[e+2]=r>>8,t[e+3]=r%256}function Nn(t,e){for(var i=-Math.PI/2,r=2*Math.PI/t.length,n=0,o=t;n<o.length;n++){var a=i+r;e(o[n],i,a),i=a}}function kn(t,e,i,r,n){Nn(e,(function(e,o,a){t.beginPath(),t.moveTo(i,r),t.arc(i,r,n,o,a),t.fillStyle=e,t.fill()}))}var On=(Fn.prototype.refresh=function(t){for(var e=0,i=t.getShapeList();e<i.length;e++){var r=i[e];if(!this._shapesWritten.includes(r.id)){var n=r.isSimple?32:128,o=r.isSimple?this._simpleShapePixels:this._complexShapePixels;Mn(r,n,1/16,o),this._loadShapeInGpu(r.id,n,o),this._shapesWritten.push(r.id)}}},Fn.prototype._loadShapeInGpu=function(t,e,i){var r=this._gl,n=Br,o=t%zr*128,a=128*Math.floor(t/zr);if(this._texture)r.bindTexture(r.TEXTURE_2D,this._texture);else{var s=new Uint8Array(n*n*4);this._texture=r.createTexture(),r.activeTexture(r.TEXTURE0+this._glTextureUnit),r.bindTexture(r.TEXTURE_2D,this._texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n,n,0,r.RGBA,r.UNSIGNED_BYTE,s)}r.texSubImage2D(r.TEXTURE_2D,0,o,a,e,e,r.RGBA,r.UNSIGNED_BYTE,i)},Fn.prototype.getTextureSize=function(){return Br},Fn.prototype.getSamplingSize=function(){return 128},Fn.prototype.getBufferRatio=function(){return 1/16},Fn.prototype.getTextureUnit=function(){return this._glTextureUnit},Fn);function Fn(t,e){this._gl=t,this._glTextureUnit=e,this._simpleShapePixels=new Uint8Array(4096),this._complexShapePixels=new Uint8Array(65536),this._shapesWritten=[]}var Rn=1e20,Pn=(Dn.prototype.setOptions=function(t){var e=t.fontSize,i=void 0===e?24:e,r=t.buffer,n=void 0===r?8:r,o=t.cutoff,a=void 0===o?.25:o,s=t.radius,u=void 0===s?6:s;this._fontSize=i,this._buffer=n,this._cutoff=a,this._radius=u,this._height=Math.ceil(this._fontSize+2*this._buffer*1.5)},Dn.prototype.draw=function(t,e,i){en(this._ctx,e,this._fontSize,i);var r,n=(r=this._ctx.measureText(t).width+2*this._buffer,16*Math.ceil((r+2)/16)-2),o=this._height,a=n*o,s=Math.max(n,o);this._canvas.width<n&&(this._canvas.width=n,en(this._ctx,e,this._fontSize,i),this._ctx.textAlign="center",this._ctx.fillStyle="black"),a>this._gridSize&&(this._gridOuter=new Float64Array(a),this._gridInner=new Float64Array(a),this._gridSize=a),s>this._maxDimension&&(this._f=new Float64Array(s),this._d=new Float64Array(s),this._z=new Float64Array(s+1),this._v=new Int16Array(s),this._maxDimension=s);var u=this._ctx.measureText(")").actualBoundingBoxAscent/2;this._ctx.clearRect(0,0,n,o),this._ctx.fillText(t,n/2,o/2+u);for(var d=this._ctx.getImageData(0,0,n,o),l=new Uint8ClampedArray(a),h=0;h<a;h++){var c=d.data[4*h+3]/255;this._gridOuter[h]=1==c?0:0==c?Rn:Math.pow(Math.max(0,.5-c),2),this._gridInner[h]=1==c?Rn:0==c?0:Math.pow(Math.max(0,c-.5),2)}for(zn(this._gridOuter,n,o,this._f,this._d,this._v,this._z),zn(this._gridInner,n,o,this._f,this._d,this._v,this._z),h=0;h<a;h++){var f=this._gridOuter[h]-this._gridInner[h];l[h]=Math.max(0,Math.min(255,Math.round(255-255*(f/this._radius+this._cutoff))))}return{height:o,width:n,distance:l}},Dn);function Dn(t){var e=void 0===t?{}:t,i=e.fontSize,r=void 0===i?24:i,n=e.buffer,o=void 0===n?8:n,a=e.radius,s=void 0===a?6:a,u=e.cutoff,d=void 0===u?.25:u;this._maxDimension=1,this._gridSize=1,this._fontSize=r,this._buffer=o,this._radius=s,this._cutoff=d,this._height=Math.ceil(this._fontSize+2*this._buffer*1.5),this._canvas=$r(),this._canvas.height=this._height,this._canvas.width=1;var l=this._canvas.getContext("2d");(this._ctx=l).textBaseline="middle",l.textAlign="center",l.fillStyle="black"}function zn(t,e,i,r,n,o,a){for(var s=0;s<e;s++){for(var u=0;u<i;u++)r[u]=t[u*e+s];for(Bn(r,n,o,a,i),u=0;u<i;u++)t[u*e+s]=n[u]}for(u=0;u<i;u++){for(s=0;s<e;s++)r[s]=t[u*e+s];for(Bn(r,n,o,a,e),s=0;s<e;s++)t[u*e+s]=Math.sqrt(n[s])}}function Bn(t,e,i,r,n){r[i[0]=0]=-Rn,r[1]=+Rn;for(var o=1,a=0;o<n;o++){for(var s=(t[o]+o*o-(t[i[a]]+i[a]*i[a]))/(2*o-2*i[a]);s<=r[a];)a--,s=(t[o]+o*o-(t[i[a]]+i[a]*i[a]))/(2*o-2*i[a]);i[++a]=o,r[a]=s,r[a+1]=+Rn}for(o=0,a=0;o<n;o++){for(;r[a+1]<o;)a++;e[o]=(o-i[a])*(o-i[a])+t[i[a]]}}var Un={fontSize:24,cutoff:.275,radius:6},Vn={fontSize:24,cutoff:.25,radius:8},jn=(Gn.prototype.refresh=function(t){this._pixelRatio=t.getPixelRatio();for(var e=this._gl,i=this._getPatternsByFilter(t.getPatternList()),r=0;r<i.length;++r){var n=r,o=i[r],a=Cn(n,o,Sn(o,this._maxTextureSize),this._maxTextureSize,this._patternIdToInfoTexture),s=a.texture,u=a.size,d=this._glTextures[n]||(this._glTextures[n]=e.createTexture()),l=0===n?0:1;Tn(e,d,this._glUnit+1+n,s,u,n,l),this._textureSizes[n]=u}var h=this._glTextureInfo||(this._glTextureInfo=e.createTexture()),c=this._patternIdToInfoTexture;Tn(e,h,this._glUnit,c,256,0,1)},Gn.prototype.bindMetDataTexture=function(){var t=this._gl;t.activeTexture(t.TEXTURE0+this._glUnit),t.bindTexture(t.TEXTURE_2D,this._glTextureInfo)},Gn.prototype.getGranularity=function(){return 16},Gn.prototype.getInfoTextureUnit=function(){return this._glUnit},Gn.prototype.getNearestTextureUnit=function(){return this._glUnit+1+0},Gn.prototype.getLinearTextureUnit=function(){return this._glUnit+1+1},Gn.prototype.getLinearSdfTextureUnit=function(){return this._glUnit+1+2},Gn.prototype.getMipmapTextureUnit=function(){return this._glUnit+1+3},Gn.prototype.getInfoTextureSize=function(){return 256},Gn.prototype.getNearestTextureSize=function(){return this._textureSizes[0]},Gn.prototype.getLinearTextureSize=function(){return this._textureSizes[1]},Gn.prototype.getLinearSdfTextureSize=function(){return this._textureSizes[2]},Gn.prototype.getMipmapTextureSize=function(){return this._textureSizes[3]},Gn.prototype._getPatternsByFilter=function(t){for(var e=new Array(4),i=0;i<4;++i)e[i]=[];for(i=0;i<t.length;++i){var r=this._getPatternPixels(t[i]);e[r.filter].push(r)}return e},Gn.prototype._getPatternPixels=function(t){var e,i=t.id,r=t.type,n=t.attributes,o=n.text,a=n.font,s=n.style,u=n.image,d=n.scaled,l=n.duplicated,h=n.colorArray;switch(r){case 2:e=l?this._getDuplicatedImagePixels(u):d?this._getScaledImagePixels(u):this._getNonScaledImagePixels(u);break;case 3:e=this._getSdfTextPixels(o,a,s);break;case 5:e=this._getIconPixels(o,a,s);break;case 6:e=this._getBadgeIconPixels(o,a,s);break;case 4:e=this._getPieChartPixels(h);break;default:throw new Error('pattern type "'+r+'" does not exist')}return e.id=i,e},Gn.prototype._getScaledImagePixels=function(t){var e=t.width,i=t.height;if(Ur<e||Ur<i){var r=Ur/Math.max(t.width,t.height);e*=r,i*=r}return e&&i&&(e=bn(e),i=bn(i)),e-=2,i-=2,this._getImagePixels(t,e,i)},Gn.prototype._getNonScaledImagePixels=function(t){return this._getImagePixels(t,t.width,t.height)},Gn.prototype._getDuplicatedImagePixels=function(t){if(0===t.width||0===t.height)return this._getImagePixels(t,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=$r(),this._canvasForDuplicatedImage.width=Ur,this._canvasForDuplicatedImage.height=Ur);for(var e=this._canvasForDuplicatedImage,i=e.getContext("2d"),r=t.width,n=t.height,o=(Ur-r)/2,a=(Ur-n)/2;0<o;)o-=r;for(;0<a;)a-=n;for(var s=o;s<Ur;s+=r)for(var u=a;u<Ur;u+=n)i.drawImage(t,s,u);return this._getImagePixels(e,Ur,Ur)},Gn.prototype._getImagePixels=function(t,e,i){var r;if(0===e||0===i)r=new Uint8Array(0);else{(this._imageCanvas.width<e||this._imageCanvas.height<i)&&(this._imageCanvas.width=e,this._imageCanvas.height=i);var n=this._imageCanvasContext;tn(this._imageCanvas,n,e,i);try{n.drawImage(t,0,0,e,i)}catch(t){}r=n.getImageData(0,0,e,i).data}return{width:e,height:i,pixels:r,filter:3}},Gn.prototype._getPieChartPixels=function(t){var e=126,i=this._imageCanvasContext;return tn(this._imageCanvas,i,e,e),i.save(),i.rect(0,0,e,e),i.clip(),kn(i,t,63,63,e),i.restore(),{width:e,height:e,pixels:i.getImageData(0,0,e,e).data,filter:1}},Gn.prototype._getTextPixels=function(t,e,i,r,n,o){var a=this._imageCanvasContext,s=n*this._pixelRatio;en(a,i,s,r);var u=Math.ceil(a.measureText(e).width);0===u&&(u=s);var d=0,l=0;3===t||(d=2*Math.ceil(1.5*s/2),l=2*Math.ceil(u/2));var h=Math.ceil(u+l),c=Math.ceil(s+d),f=this._imageCanvas.height<c||this._imageCanvas.width<h;return this._imageCanvas.height<c&&(this._imageCanvas.height=c),this._imageCanvas.width<h&&(this._imageCanvas.width=h),f&&en(a,i,s,r),a.clearRect(0,0,h,c),a.fillStyle="black",a.textBaseline="middle",a.textAlign="left",a.fillText(e,o+l/2,c/2),{width:h,height:c,pixels:a.getImageData(0,0,h,c).data,filter:t}},Gn.prototype._getIconPixels=function(t,e,i){return this._getTextPixels(3,t,e,i,126,0)},Gn.prototype._getBadgeIconPixels=function(t,e,i){return this._sdfGenerator.setOptions(Vn),this._getSdfPixels(t,e,i)},Gn.prototype._getSdfTextPixels=function(t,e,i){return this._sdfGenerator.setOptions(Un),this._getSdfPixels(t,e,i)},Gn.prototype._getSdfPixels=function(t,e,i){for(var r=this._sdfGenerator.draw(t,e,i),n=r.width,o=r.height,a=r.distance,s=new Uint8Array(n*o*4),u=0;u<a.length;++u)s[4*u+3]=a[u];return{width:n,height:o,pixels:s,filter:2}},Gn);function Gn(t,e){this._patternIdToInfoTexture=new Uint8Array(262144),this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=t,this._glUnit=e;var i=$r();i.width=Ur,i.height=Ur,this._imageCanvasContext=i.getContext("2d"),this._imageCanvas=i,this._canvasForDuplicatedImage,this._sdfGenerator=new Pn(Un),this._maxTextureSize=Math.min(4096,t.getParameter(t.MAX_TEXTURE_SIZE))}function Hn(){var t=Et(),e=t.styleSheets;if(!e||!t.location)return Promise.resolve([]);for(var i=Yt(t),r=[],n=[],o=0;o<e.length;o++){var a=e[o];null===a.href?r.push({href:i,content:a.ownerNode.textContent}):n.push(a.href)}var s=/@font-face\s*\{[^}]+\}/g;return Promise.all(n.map((function(t){return Vt(t).then((function(e){return{href:t,content:e}})).catch((function(){return null}))}))).then((function(t){return t.concat(r)})).then((function(t){for(var e=[],i=0;i<t.length;i++){var r=t[i];if(null!==r){var n=r.href,o=r.content.match(s);if(o){var a=Xn(o,n);e.push.apply(e,a)}}}return e}))}function Wn(t,e){return Promise.all(t.map((function(t){var i=t.formats,r=t.originalRule;return Promise.all(i.map((function(t){var i=t.format,r=t.url;return e?Wt(r).then((function(t){return{format:i,src:t}})).catch((function(){return null})):{format:i,src:r}}))).then((function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];null!==n&&e.push("url('"+n.src+"') format('"+n.format+"')")}if(0===e.length)return r;var o="src: "+e.join(",")+";";return r.replace(/src\s*:[^;]+;/g,o)}))})))}var qn={"embedded-opentype":!0,svg:!0};function Xn(t,e){for(var i=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,r=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,n=[],o=0;o<t.length;o++){var a=t[o],s=a.match(r);if(s){for(var u=s[1],d=[],l=void 0;l=i.exec(a);){var h=l[1],c=l[2];qn[c.toLowerCase()]||d.push({format:c,url:Yn(h,e)})}n.push({name:u,formats:d,originalRule:a})}}return n}function Yn(t,e){if(/^http(s)?:/.test(t))return t;if("/"===t[0]){var i=e.match(/((\w+:\/\/)([^/]+))/);return i?i[1]+t:t}var r=t.split("/"),n=e.split("/");for("/"!==e[e.length-1]&&n.pop();".."===r[0];)r.shift(),n.pop();return n.concat(r).join("/").replace(/[\w](\/{2,})/g,(function(t){return t[0]+"/"}))}function Zn(t){if(t.keys)return Array.from(t.keys());var e=[];return t.forEach((function(t,i){return e.push(i)})),e}function Kn(t){if(t.values)return Array.from(t.values());var e=[];return t.forEach((function(t){return e.push(t)})),e}var Qn=(Jn.prototype.reserve=function(t){if(this._capacity<t){t=Math.pow(2,Math.ceil(Math.log2(t+1)));var e=new Uint32Array(t);e.set(this._array),this._capacity=t,this._array=e}},Jn.prototype.has=function(t){var e=$n(this._array,t,0,this.length);return e<this.length&&this._array[e]===t},Jn.prototype.add=function(t){var e=$n(this._array,t,0,this.length),i=e<this.length&&this._array[e]===t;return i||(this.length===this._capacity&&this.reserve(this.length+1),this._array.copyWithin(e+1,e,this.length),this._array[e]=t,this.length+=1),!i},Jn.prototype.remove=function(t){var e=$n(this._array,t,0,this.length),i=e<this.length&&this._array[e]===t;return i&&(this._array.copyWithin(e,e+1,this.length),--this.length),i},Jn.prototype.removeByPosition=function(t){return!(t>=this.length||(this._array.copyWithin(t,t+1,this.length),--this.length,0))},Jn.prototype.get=function(t){return this._array[t]},Jn.prototype.clear=function(){this.length=0},Jn.prototype.slice=function(){return this._array.slice(0,this.length)},Jn);function Jn(){this._array=new Uint32Array(8),this._capacity=8,this.length=0,this._array=new Uint32Array(8),this._capacity=8,this.length=0}function $n(t,e,i,r){if(i===r)return i;var n=i+((r-i)/2|0),o=e-t[n];return 0==o?n:o<0?$n(t,e,i,n):$n(t,e,n+1,r)}var to="undefined"==typeof HTMLElement?function(t){return!1}:function(t){return t instanceof HTMLElement};function eo(t,e,i){if(void 0===e&&(e=[]),void 0===i&&(i=[]),!to(t)){if(function(t){return"object"!=typeof t||null===t||O(t)||(e=t)instanceof RegExp||e instanceof Date;var e}(t))e.push({path:i.slice(),value:t});else for(var r=Object.keys(t),n=0;n<r.length;++n){var o=r[n],a=i.slice();a.push(o),eo(t[o],e,a)}return e}}var io=(Object.defineProperty(ro.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),ro.prototype.set=function(t,e){var i=this._getIndex(t);-1!==i?this._values[i]=e:(no(this._cachedPath,t)&&(this._cachedIndex=this._keys.length),this._keys.push(t),this._values.push(e),this._size+=1)},ro.prototype.get=function(t){var e=this._getIndex(t);if(-1!==e)return this._values[e]},ro.prototype.has=function(t){return-1!==this._getIndex(t)},ro.prototype.keys=function(){return this._keys.slice()},ro.prototype._getIndex=function(t){if(no(t,this._cachedPath))return this._cachedIndex;this._cachedPath=t.slice();for(var e=this._keys,i=0;i<e.length;++i)if(no(e[i],t))return this._cachedIndex=i;return this._cachedIndex=-1},ro);function ro(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}function no(t,e){if(t.length===e.length){for(var i=0;i<t.length;++i)if(t[i]!==e[i])return;return 1}}var oo=Set.prototype.keys?function(t){return Array.from(t.keys())}:function(t){var e=[];return t.forEach((function(t){return e.push(t)})),e},ao=Set.prototype.values?function(t){return Array.from(t.values())}:function(t){var e=[];return t.forEach((function(t,i){return e.push(i)})),e},so=N("webworker-threads"),uo=so?so.Worker:null;function lo(t){return uo?function t(e){if(ArrayBuffer.isView(e))return Array.from(e);if(Array.isArray(e)){for(var i=0;i<e.length;++i)e[i]=t(e[i]);return e}if(et(e)){for(var r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];e[o]=t(e[o])}return e}return e}(t):t}function ho(t){return uo?function(t){if(uo)return new uo(new Function(t))}(t):"undefined"==typeof URL||-1!==navigator.appVersion.indexOf("MSIE 10")?new co(t):function(t){try{var e=new Blob([t],{type:"application/javascript"}),i=URL.createObjectURL(e);return new Worker(i)}catch(e){return new co(t)}}(t)}var co=(fo.prototype.terminate=function(){this._terminated=!1,this._otherSide._terminated=!0},fo.prototype.addEventListener=function(t,e){this._listeners.push(e)},fo.prototype.postMessage=function(t){setTimeout(vo,0,this._otherSide,{data:t})},fo);function fo(t){this._main=!0,this._listeners=[],this._terminated=!1,this._f=new Function("self",t),this._otherSide=new po(this),this._f(this._otherSide)}var go,po=(_o.prototype.addEventListener=function(t,e){this._listeners.push(e)},_o.prototype.postMessage=function(t){setTimeout(vo,0,this._otherSide,{data:t})},_o);function _o(t){this._listeners=[],this._main=!1,this._terminated=!1,this._otherSide=t}function vo(t,e){if(!t._terminated)for(var i=0;i<t._listeners.length;++i)t._listeners[i](e)}var mo=N("xmldom");go="undefined"!=typeof XMLSerializer?XMLSerializer:mo?mo.XMLSerializer:null;var yo=(bo.prototype.setAttribute=function(t,e){this._attributes[t]=e},bo.prototype.appendChild=function(t){this._children.push(t)},Object.defineProperty(bo.prototype,"tagName",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(bo.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(bo.prototype,"childNodes",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(bo.prototype,"firstChild",{get:function(){return this._children[0]||null},enumerable:!0,configurable:!0}),bo.prototype.serialize=function(){var t=this._name,e=this._attributes,i=this._children,r=Object.keys(e).filter((function(t){return void 0!==e[t]})).map((function(t){return" "+t+'="'+e[t]+'"'})).join(""),n=i.map((function(t){return t.serialize()})).join("");return n.length?"<"+t+r+">"+n+"</"+t+">":"<"+t+r+"/>"},bo.prototype.cloneNode=function(t){for(var e=new bo(this._name),i=0,r=Object.keys(this._attributes);i<r.length;i++){var n=r[i];e.setAttribute(n,this._attributes[n])}if(t)for(var o=0;o<this._children.length;o++)e.appendChild(this._children[o].cloneNode(t));return e},bo);function bo(t){this._attributes={},this._children=[],this._name=t}var xo=(Eo.prototype.serialize=function(){return this._text},Eo.prototype.cloneNode=function(){return new Eo(this._text)},Eo);function Eo(t){this._text=t}var Ao=(So.prototype.appendChild=function(t){this._children.push(t)},So.prototype.serialize=function(){return this._meta.concat(this._children.map((function(t){return t.serialize()}))).join("")},So.prototype.createElement=function(t){return new yo(t)},So.prototype.createTextNode=function(t){return new xo(t)},So);function So(){this._children=[],this._meta=[],this._children=[],this._meta=[]}function wo(){return new Ao}function To(t){if(go)return(new go).serializeToString(t)}function Co(){return Et().implementation.createDocument("","",null)}var Mo=(Io.prototype.add=function(t){var e=this._keyToIndex[t];-1===e&&(e=this._size++,this._heap[e]=t),this._keyToIndex[t]=this._bubble(e)},Io.prototype.removeMin=function(){if(0===this._size)return NaN;var t=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),t},Io.prototype.isEmpty=function(){return 0===this._size},Io.prototype.has=function(t){return-1!==this._keyToIndex[t]},Io.prototype._bubble=function(t){var e=this._indexToValue(t),i=this._getParentIndex(t),r=this._indexToValue(i),n=t;if(0!==t&&e<r)n=this._swap(t,i);else{var o=this._getLeftChildIndex(t),a=this._getRightChildIndex(t),s=this._indexToValue(o),u=this._indexToValue(a),d=Math.min(e,s,u);d===e||(n=d===s?this._swap(t,o):this._swap(t,a))}return n===t?t:this._bubble(n)},Io.prototype._indexToValue=function(t){return t>=this._size?1/0:this._keyToValue[this._heap[t]]},Io.prototype._getParentIndex=function(t){return(t-1)/2|0},Io.prototype._getLeftChildIndex=function(t){return 2*t+1},Io.prototype._getRightChildIndex=function(t){return 2*t+2},Io.prototype._swap=function(t,e){var i=this._heap[t],r=this._heap[e];return this._heap[t]=r,this._heap[e]=i,this._keyToIndex[i]=e,this._keyToIndex[r]=t,e},Io);function Io(t){this._heap=[],this._size=0,this._keyToValue=t,this._keyToIndex=new Int32Array(t.length),this._keyToIndex.fill(-1)}var Lo=(No.prototype._get=function(t){return t.isNode?this._nodes:this._edges},No.prototype.addOrRemoveElements=function(t,e){return e?this.addElements(t):this.removeElements(t)},No.prototype.addElements=function(t){for(var e=this._get(t),i=e.elementList,r=e.flexArray,n=e.indexList,o=n.getLength(),a=0;a<t._indexes.length;a++){var s=t._indexes[a];1!==r.get(s)&&(r.set(s,1),n.pushUnchecked(s))}return i(n.slice(o))},No.prototype.removeElements=function(t){for(var e=this._get(t),i=e.elementList,r=e.flexArray,n=e.indexList,o=n.getLength(),a=n.getBuffer(),s=0,u=0;u<t._indexes.length;u++){var d=t._indexes[u];0!==r.get(d)&&(r.set(d,0),s+=1)}if(s===o)return i(n.sliceAndReset());if(0===s)return i();var l=this._graph.acquireIndexList(t.isNode),h=0;for(u=0;u<o;++u)d=a[u],0===r.get(d)?(h+=1,l.pushUnchecked(d)):a[u-h]=d;return n.setLength(o-s),i(l.sliceAndReset())},No.prototype.hasElement=function(t){return!!this._get(t).flexArray.get(t._index)},No.prototype.clear=function(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())},No.prototype.isEmpty=function(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()},No.prototype.getElements=function(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}},No);function No(t,e){this._graph=t,this._nodes={elementList:t.nodeList,flexArray:t.createNodeAttribute({storage:1,name:e}),indexList:t.createIndexList(!0)},this._edges={elementList:t.edgeList,flexArray:t.createEdgeAttribute({storage:1,name:e}),indexList:t.createIndexList(!1)}}var ko=(Oo.prototype.reset=function(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this},Oo.prototype.addPoint=function(t,e,i,r){return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,e),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,e),void 0!==i&&void 0!==r&&("scaled"===r?(this.minScaledSize=Math.min(this.minScaledSize,i),this.maxScaledSize=Math.max(this.maxScaledSize,i)):(this.minFixedSize=Math.min(this.minFixedSize,i),this.maxFixedSize=Math.max(this.maxFixedSize,i))),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY,this},Oo.prototype.computeForZoom=function(t){var e=Math.max(this.maxScaledSize,this.maxFixedSize/t);return Oo.from({minX:this.minX-e/2,minY:this.minY-e/2,maxX:this.maxX+e/2,maxY:this.maxY+e/2,width:this.width+e,height:this.height+e})},Oo.from=function(t){var e=void 0===t?{}:t,i=e.minX,r=e.minY,n=e.maxX,o=e.maxY,a=e.width,s=e.height,u=new Oo;return null!=i&&(u.minX=i),null!=r&&(u.minY=r),null!=n&&(u.maxX=n),null!=o&&(u.maxY=o),null!=n&&null!=i&&(u.width=a||(n-i)/2,u.cx=(i+n)/2),null!=o&&null!=r&&(u.height=s||(o-r)/2,u.cy=(r+o)/2),u},Oo.fromValues=function(t,e,i){for(var r=1/0,n=1/0,o=-1/0,a=-1/0,s=-1/0,u=0;u<t.length;u++){var d=t[u],l=e[u],h=i[u];d-h<r&&(r=d-h),l-h<n&&(n=l-h),o<d+h&&(o=d+h),a<l+h&&(a=l+h),s<h&&(s=h)}var c=Oo.from({minX:r,minY:n,maxX:o,maxY:a});return c.maxScaledSize=s,c},Oo.prototype.pad=function(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,this.width+=2*t,this.height+=2*t,this},Oo.prototype.isValid=function(){return isFinite(this.width)&&isFinite(this.height)},Oo.prototype.extend=function(t){return this.addPoint(t.minX,t.minY),this.addPoint(t.maxX,t.maxY),this},Oo.prototype.bottomLeft=function(){return{x:this.minX,y:this.minY}},Oo.prototype.topRight=function(){return{x:this.maxX,y:this.maxY}},Oo);function Oo(t){void 0===t&&(t={});var e=t.xValues,i=void 0===e?[]:e,r=t.yValues,n=void 0===r?[]:r,o=t.scaledSizeValues,a=void 0===o?[]:o,s=t.fixedSizeValues,u=void 0===s?[]:s;this.minX=Ke(i),this.minY=Ke(n),this.maxX=Ze(i),this.maxY=Ze(n),this.minScaledSize=Ke(a),this.maxScaledSize=Ze(a),this.minFixedSize=Ke(u),this.maxFixedSize=Ze(u),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}var Fo=(Ro.prototype.on=function(t,e){if("string"!=typeof t)throw new TypeError("Event name must be string");if("function"!=typeof e)throw new TypeError("Event handler must be function");var i=this._events=this._events||{};return(i[t]=i[t]||[]).push(e),this},Ro.prototype.off=function(t,e){if("string"!=typeof t)throw new TypeError("Event name must be string");var i=this._events=this._events||{},r=i[t];if(O(r))if("function"!=typeof e)i[t]=null;else{var n=r.indexOf(e);-1!==n&&r.splice(n,1),0===r.length&&(i[t]=null)}return this},Ro.prototype.fire=function(t){for(var e=arguments,i=[],r=1;r<arguments.length;r++)i[r-1]=e[r];if("string"!=typeof t)throw new TypeError("Event name must be string");var n=(this._events=this._events||{})[t];if(O(n))for(var o=i,a=0;a<n.length;a++){var s=n[a];s&&s.apply(this,o)}return this},Ro.prototype.once=function(t,e){var i=this,r=function(){for(var n=arguments,o=[],a=0;a<arguments.length;a++)o[a]=n[a];e.apply(i,o),i.off(t,r)};return r.handler=e,this.on(t,r)},Ro.prototype.hasListener=function(t,e){if(!t||!e)return!1;var i=(this._events=this._events||{})[t];if(O(i))for(var r=0,n=i.length;r<n;r++){var o=i[r];if(o===e||o.handler===e)return!0}return!1},Ro.prototype.getListeners=function(t){return(this._events=this._events||{})[t]},Ro);function Ro(){}var Po=Object.freeze({__proto__:null,BoundingBox:ko,FlexArray:Ue,EventTarget:Fo,ColorManager:Ir,Table:ii,requestAnimFrame:st,cancelAnimFrame:ut,getDocument:Et,getStyle:At,DummyDomElement:St,createDummyDomElement:Tt,getPixelRatio:Ct,dataUrlToBlob:Mt,createBlob:Lt,isBlob:function(t){return"undefined"!=typeof Blob&&t instanceof Blob||t instanceof It},promptDownload:Nt,resizeElement:kt,setAttributes:Ot,SVG_NS:Ft,XML_NS:Rt,XLINK:Pt,createSvgElement:Dt,createTextNode:zt,getImage:Bt,fetch:Vt,isHTMLElement:jt,applyCursorStyle:Gt,fetchBinary:Ht,fetchBinaryAsBase64:Wt,escapeDOMAttribute:qt,BUTTON_MAPPING:Xt,baseURI:Yt,fadeElement:Zt,DummyCanvas:Yr,DummyCanvasRenderingContext2D:Kr,createCanvas:$r,clearCanvas:tn,setCtxFont:en,isWebGLSupported:rn,getWebglContext:nn,getDocumentFontRules:Hn,getEmbeddedFontRules:Wn,resolvePath:Yn,IndexList:Je,mapKeys:Zn,mapValues:Kn,isInteger:function(t){return"number"==typeof t&&t%1==0},toPropertyPath:z,throttle:B,debounce:function(t,e,i){var r,n,o,a,s,u=0===e||void 0===e?100:e;function d(){var e=Date.now()-a;e<u&&0<=e?r=setTimeout(d,u-e):(r=null,i||(s=t.apply(o,n),o=n=null))}function l(){o=this,n=arguments,a=Date.now();var u=i&&!r;return r=r||setTimeout(d,e),u&&(s=t.apply(o,n),o=n=null),s}return l.clear=function(){r&&(clearTimeout(r),r=null)},l.flush=function(){r&&(s=t.apply(o,n),o=n=null,clearTimeout(r),r=null)},l},processQueue:function(t,e){return new Promise((function(i,r){return function t(e,i,r,n,o){r(e[i],i,e,n,o).then((function(a){i===e.length-1?n(a):t(e,i+1,r,n,o)})).catch(o)}(t,0,e,i,r)}))},isLittleEndian:U,promiseQueue:V,hash8:j,unorderedHash:function(t,e){return t<e?t*e+Math.pow(e-t-1,2)/4:t*e+Math.pow(t-e-1,2)/4},isRawObject:G,getValues:H,forEach:W,deepCopy:q,updateObject:function t(e,i){W(i,(function(i,r){"object"==typeof r&&null!==r?("object"==typeof e[i]&&null!==e[i]||(e[i]={}),t(e[i],r)):e[i]=r}))},extendList:function(t,e){e.forEach((function(e){-1===t.indexOf(e)&&t.push(e)}))},setProperty:X,getProperty:Y,flatten:Z,unflatten:K,getFlattenedKeys:Q,getLeafValues:J,ensureTransferable:$,getOptions:tt,isObject:et,mergeValues:it,pick:rt,objToValueList:eo,PathMap:io,smartRequire:N,setKeys:oo,setValues:ao,getCurrentTime:Jt,getDate:$t,getTime:te,formatWorkerMessage:lo,createWorker:ho,insertSortAsc:k,insertSortDesc:function(t,e){for(var i=1,r=t.length;i<r;i++){for(var n=t[i],o=i;0<o&&e.get(t[o-1])<e.get(n);)t[o]=t[o-1],--o;t[o]=n}return t},isArray:O,toArray:F,flattenArray:R,concatenateArrays:function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(0===e.length)return[];for(var r=e[0].constructor,n=0,o=0,a=e;o<a.length;o++)n+=(h=a[o]).length;for(var s=new r(n),u=0,d=0,l=e;d<l.length;d++){for(var h=l[d],c=0;c<h.length;c++)s[u+c]=h[c];u+=h.length}return s},removeFromArray:P,binaryIndexOf:D,parseColorRgba:Sr,toHexa:wr,componentsToRGBA:Tr,parseColorHex:Cr,createDummyXmlDocument:wo,serializeXMLDocument:To,createXmlDocument:Co,PrioritySet:Mo,nextPowerOfTwo:He,computeSum:We,clamp:qe,mix:Xe,lerp:Ye,computeMax:Ze,computeMin:Ke,getBaseLog:Qe,ElementSet:Lo,displayPixelsOnScreen:function(t,e,i,r){void 0===r&&(r=0),void 0===e&&(e=i=Math.sqrt(t.length/4)),void 0===i&&(i=e);var n=document.createElement("canvas"),o=n.getContext("2d");if(o){var a=o.createImageData(e,i);n.style.imageRendering="pixelated",n.style.border="1px solid black",n.style.margin="2px",n.style.position="absolute",n.style.top=n.style.left="0px",n.width=e,n.height=i,a.data.set(t),o.putImageData(a,0,0);var s=document.getElementById("graph-container");s&&(s.style.position="static"),setTimeout((function(){return document.body.appendChild(n)}),r)}}}),Do={byte:1,ubyte:1,short:2,ushort:2,ulong:4,float:4},zo={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",ulong:"UNSIGNED_LONG",float:"FLOAT"},Bo=(Uo.prototype._finishInit=function(){var t=this,e=this._gl,i=this._ext,r=this._programWrapper.getError();if(r)throw new Error('WebGL compilation at step "'+r.step+":\n"+r.message+'"');var n=this._programWrapper.getProgram();this._program=n,e.useProgram(n),this._metaData.attributes.forEach((function(i){i.location=e.getAttribLocation(t._program,i.name),i.byteSize=i.size*Do[i.type],i.glType=zo[i.type]})),this._specialAttributes=this._createSpecialAttributesFunctions();for(var o=[],a=[],s=0,u=this._metaData.attributes;s<u.length;s++){var d=u[s];-1!==d.location&&(d.name.startsWith("a_text")?a.push(d):o.push(d))}this._baseAttributes=jo(o,e,i),this._textAttributes=jo(a,e,i),this._setupUniforms=function(t,e,i){for(var r={},n=[],o=0;o<t.length;++o){var a=t[o],s=a.id,u=a.name,d=a.type,l=e.getUniformLocation(i,u),h=Vo[d](s);l&&(r[s]=l,n.push(h))}var c=new Function("gl","l","u",n.join("\n"));return function(t){return c(e,r,t)}}(this._metaData.uniforms,e,n)},Uo.prototype._createSpecialAttributesFunctions=function(){return jo([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)},Uo.prototype.startPass=function(t){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(t),this._specialAttributes.enable(),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)},Uo.prototype._setupAttributes=function(t,e){var i=e.glBuffer,r=e.dataBuffer,n=e.divisor;t.enabled&&!i?t.disable():!t.enabled&&i&&t.enable(),i&&t.setup(i,r,n)},Uo.prototype.setupBaseAttributes=function(t){this._setupAttributes(this._baseAttributes,t)},Uo.prototype.setupTextAttributes=function(t){this._setupAttributes(this._textAttributes,t)},Uo.prototype._resetStencil=function(){var t=this._gl;this._stencilUsage=1,t.disable(t.STENCIL_TEST)},Uo.prototype.setupStencil=function(t){if(t!==this._stencilUsage){var e=this._gl;1!==t?(e.enable(e.STENCIL_TEST),2===t?(e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.stencilFunc(e.ALWAYS,1,1)):3===t&&(e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.stencilFunc(e.EQUAL,0,1))):e.disable(e.STENCIL_TEST),this._stencilUsage=t}},Uo.prototype.endPass=function(){this._specialAttributes.disable(),this._baseAttributes.disable(),this._textAttributes.disable()},Uo);function Uo(t){var e=t.gl,i=t.ext,r=t.specialGlBuffers,n=t.metaData,o=t.programWrapper;this._stencilUsage=1,this._gl=e,this._ext=i,this._specialGlBuffers=r,this._metaData=q(n),this._programWrapper=o}var Vo={int:function(t){return"gl.uniform1i(l."+t+", u."+t+");"},sampler2D:function(t){return"gl.uniform1i(l."+t+", u."+t+");"},float:function(t){return"gl.uniform1f(l."+t+", u."+t+");"},vec2:function(t){return"gl.uniform2f(l."+t+", u."+t+"[0], u."+t+"[1]);"},vec3:function(t){return"gl.uniform3f(l."+t+", u."+t+"[0], u."+t+"[1], u."+t+"[2]);"},vec4:function(t){return"gl.uniform4f(l."+t+", u."+t+"[0], u."+t+"[1], u."+t+"[2], u."+t+"[3]);"}};function jo(t,e,i){var r,n,o,a,s,u,d,l,h,c,f,g,p,_=(r=e,n=t.map((function(t){return"gl.enableVertexAttribArray("+t.location+");"})).join("\n"),o=new Function("gl",n),function(){return o(r)}),v=(a=e,s=t.map((function(t){return"gl.disableVertexAttribArray("+t.location+");"})).join("\n"),u=new Function("gl",s),function(){return u(a)});return{enable:function(){_(),this.enabled=!0},disable:function(){v(),this.enabled=!1},setup:(l=e,h=i,c=(d=t).reduce((function(t,e){return t+e.byteSize}),0),f=0,g=w(["gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);","if (dataBuffer) gl.bufferData(gl.ARRAY_BUFFER, dataBuffer, gl.STATIC_DRAW);"],d.map((function(t){var e=t.location,i=t.size,r=t.glType,n=t.byteSize,o="gl.vertexAttribPointer(\n        "+e+", "+i+", gl."+r+",\n        false, "+c+", "+f+"\n      );";return f+=n,o})),d.map((function(t){return"ext.vertexAttribDivisorANGLE("+t.location+", divisor);"}))).join("\n"),p=new Function("gl","ext","glBuffer","dataBuffer","divisor",g),function(t,e,i){return p(l,h,t,e,i)}),enabled:!1}}var Go=(Ho.prototype.setDataBuffer=function(t){this._dataBuffer!==t&&(this._program=t.isAnimated()?this._animationProgram:this._staticProgram,this._dataBuffer=t,this._dataBufferChanged=!0,t.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!t.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),delete this._sideGlBuffer))},Ho.prototype.markAsUnused=function(){return this._used=!1,this},Ho.prototype.getProgram=function(){return this._program},Ho.prototype.markAsUsed=function(){return this._used=!0,this},Ho.prototype.isUsed=function(){return this._used},Ho.prototype.draw=function(){var t=this._gl,e=this._dataBuffer.getElementType(),i=2===e,r=i?this._dataBuffer.getNbSideElementsPerMainElement():1,n=3===e?41:1,o=this._dataBuffer.getSize(),a=this._dataBuffer.getStencilUsage(),s=this._dataBuffer.getVersion(),u=this._version!==s||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:u?this._dataBuffer.getByteArray():null,divisor:r}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:u&&i?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(a),u&&(this._version=s,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(t.TRIANGLES,0,6*n,o*r)},Ho.prototype.destroy=function(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)},Ho);function Ho(t){var e=t.gl,i=t.ext,r=t.staticProgram,n=t.animationProgram;this._version=0,this._used=!1,this._dataBufferChanged=!1,this._gl=e,this._ext=i,this._staticProgram=r,this._animationProgram=n,this._glBuffer=this._gl.createBuffer()}function Wo(t,e){if(e<2)return t;for(var i=t.split("\n"),r=[],n=0;n<i.length;++n){var o=i[n];if(o.length<e)r.push(o);else for(var a=qo(i[n],e),s=0;s<a.length;++s)r.push(a[s])}return r.join("\n")}function qo(t,e){for(var i=t.split(" "),r=[],n=0,o=-1,a=!0,s=0;s<i.length;++s)if(a){if(i[s].length>e){for(var u=Xo(i[s],e),d=0;d<u.length;++d)r.push([u[d]]),++o;n=u[u.length-1].length}else r.push([i[s]]),++o,n=i[s].length+1;a=!1}else n+i[s].length<=e?(r[o].push(i[s]),n+=i[s].length+1):(a=!0,--s);var l=[];for(s=0;s<r.length;++s)l.push(r[s].join(" "));return l}function Xo(t,e){for(var i=[],r=0;r<t.length;r+=e-1)i.push(t.substr(r,e-1)+"-");var n=i[i.length-1].length;return i[i.length-1]=i[i.length-1].substr(0,n-1)+" ",i}function Yo(t,e){if(null===t)return null;for(var i=(t=t.toString()).split("\n"),r=[],n=0,o=0;o<i.length;o++){var a=i[o];if(!e||e<=1||a.length<e)r.push(a),n=Math.max(n,a.length);else for(var s=qo(i[o],e),u=0;u<s.length;u++)a=s[u],r.push(a),n=Math.max(n,a.length)}return{data:r,maxLength:n,lines:r.length}}function Zo(){var t=N("@mapbox/mapbox-gl-rtl-text")||N("mapbox-gl-rtl-text"),e=t?t.processBidirectionalText:pt?window.processBidirectionalText:null,i=t?t.applyArabicShaping:pt?window.applyArabicShaping:null;return{processBidirectionalText:e?function(t){return e(t,[]).join("")}:function(t){return t},applyArabicShaping:i?function(t){return null===t?null:"number"==typeof t?t.toString():i(t)}:function(t){return null===t?null:t.toString()}}}var Ko=U(),Qo="\n".charCodeAt(0),Jo=($o.prototype._init=function(){this._mustClear=!1,this._clear()},$o.prototype.reset=function(){this._init()},$o.prototype.clear=function(){this._mustClear=!0},$o.prototype._measureChar=function(t,e,i){return en(this._ctx,e,24,i),this._ctx.measureText(t).width/24},$o.prototype._getAtlas=function(t,e,i){var r=-1===i?0:i,n=this._byFont[t]||(this._byFont[t]={}),o=n[e]||(n[e]=new Array(50));return o[r]||(o[r]=new Array(256))},$o.prototype._getMeasurementAtlas=function(t,e){var i=this._widthAtlases[e];return i[t]||(i[t]=new Array(256))},$o.prototype.measureText=function(t,e,i,r){if(void 0===r&&(r=1),!e)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;for(var n=this._getMeasurementAtlas(e,i),o=0,a=0,s=1,u=0;u<t.length;++u){var d=t.charCodeAt(u);if(d===Qo)o<a&&(o=a),a=0,s+=1;else{var l=n[d];void 0===l&&(l=this._measureChar(t[u],e,i),n[d]=l),a+=l}}return o<a&&(o=a),this._textDimensions.width=o*r,this._textDimensions.height=s*r,this._textDimensions},$o.prototype._getCharInfo=function(t,e,i,r,n,o){var a=t[e];if(!a){var s=String.fromCharCode(e);a={ratio:this._measureChar(s,i,r),patternId:new Array(1)};for(var u=0;u<1;++u){var d=+u;a.patternId[u]=this._patternManager.getIdFromDefinition({id:0,type:3,attributes:{text:s,font:i,style:r,size:n,align:o,offset:d}})}t[e]=a}return a},$o.prototype.storeTextInDataView=function(t,e,i,r){var n=e;if(r&&7===r.type){for(var o=r.attributes,a=o.font,s=o.style,u=o.size,d=o.align,l="center"===d,h=this._getAtlas(a,s,u),c=0,f=1,g=0,p=0,_=this._lineWidthList,v=this._processBidirectionalText(r.attributes.text),m=0;m<v.length;++m)(E=v.charCodeAt(m))===Qo?(c<g&&(c=g),_[p]=g,p++,g=0,f++):g+=(A=this._getCharInfo(h,E,a,s,u,d)).ratio;c<(_[p]=g)&&(c=g),p=0;var y=-(l?_[p]:c)/2,b=(1-f)/2,x=0;for(m=0;m<v.length;++m){var E,A=h[E=v.charCodeAt(m)];if(E===Qo)p+=1,y=-(l?_[p]:c)/2,b+=1,x=0;else{var S=A.ratio,w=A.patternId[0];y+=(S+x)/2,x=S;var T=(qe(1e3*y+65536,0,131071)<<8)+qe(2*b+128,0,255);t.setUint16(n,w,Ko),t.setUint32(n+2,T,Ko),n+=6}}}this._fillWithZeros(t,n,i)},$o.prototype.extractTextFromDataView=function(t,e,i){for(var r=t,n=Ko,o=r.getUint16(e,n),a=this._textPattern,s=this._patternManager.getDefinitionFromId(o).attributes,u=s.font,d=s.style,l=s.size,h=s.align,c=this._getAtlas(u,d,l),f=[],g=0,p=0,_=0,v=null,m=e;m<i;m+=6){var y=r.getUint16(m,n);if(!y)break;var b=(r.getUint8(m+2)-128)/2,x=this._patternManager.getDefinitionFromId(y);if(!x||!x.attributes||!x.attributes.text)break;var E=x.attributes.text.charCodeAt(0),A=c[E];null===v?v=b:v<b&&(p<g&&(p=g),g=0,_+=1,f.push(Qo),v=b),f.push(E),A&&(g+=A.ratio)}p<g&&(p=g);var S=String.fromCharCode.apply(null,f);return a.attributes.style=d,a.attributes.font=u,a.attributes.size=l,a.attributes.align=h,a.attributes.text=this._processBidirectionalText(S),a.dimensions&&(a.dimensions.width=p,a.dimensions.height=_),a},$o.prototype._fillWithZeros=function(t,e,i){for(var r=e;r<i;r+=6)t.setUint16(r,0)},$o.prototype._clear=function(){this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}},$o.prototype.update=function(){this._mustClear&&(this._clear(),this._mustClear=!1)},$o.prototype.getVersion=function(){return 0},$o);function $o(t){this._patternManager=t,this._canvas=$r(),this._ctx=this._canvas.getContext("2d"),this._processBidirectionalText=Zo().processBidirectionalText,this._textPattern={id:0,type:7,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init()}var ta,ea=rn(),ia={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!("undefined"!=typeof window&&window.FORCE_WEBGL)},ra={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},na=(E(oa,ta=Error),oa);function oa(){return null!==ta&&ta.apply(this,arguments)||this}function aa(t,e){if(!t&&e){var i=new na(ra[e]);throw i.code=e,i}}var sa,ua=(E(da,sa=sn),da.isAvailable=function(){return ea||aa(null,"NO_WEBGL"),ea},da.createInitData=function(){var t=$r(),e=nn(t,ia),i=e&&"function"==typeof e.getExtension?e.getExtension("ANGLE_instanced_arrays"):null,r={BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:24,CURVATURE_RATIO:5,PATTERN_MARGIN:1,TEXT_WIDTH_MULTIPLIER:1,TEXT_HEIGHT_MULTIPLIER:1.5,SELF_LOOP_CURVATURE_MULTIPLIER:5,EDGE_ARROW_SIZE_RATIO:3,NB_PIECES_PER_CURVE:41,PIECE_NODE_COMPONENT:1,PIECE_EDGE_BODY:2,PIECE_EDGE_HEAD:3,PIECE_EDGE_TAIL:4,PIECE_EDGE_TEXT:5,MAX_TEXT_SIZE:25,BYTES_TO_TEXT_OFFSET_X:.001,BYTES_TO_TEXT_OFFSET_Y:.5,FILTER_NEAREST:0,FILTER_LINEAR:1,FILTER_LINEAR_SDF:2,FILTER_MIPMAP:3,SHAPE_TEXTURE_SIZE:Br,SIMPLE_SHAPE_SAMPLING_SIZE:32,COMPLEX_SHAPE_SAMPLING_SIZE:128,SHAPE_SAMPLING_BUFFER_RATIO:1/16,MAX_NB_SHAPES:15..toString(),FIRST_COMPLEX_SHAPE_ID:8,SELF_LOOP_TO_CIRCLE_APPROX:.9721,SDF_GAMMA:1.4142},n=new fn(e,{vertex:hn,fragment:cn,constants:r,macros:{ANIMATED:0}}),o=new fn(e,{vertex:hn,fragment:cn,constants:r,macros:{ANIMATED:1}});return e&&i&&(n.compile(),e.flush()),{canvas:t,gl:e,ext:i,staticProgramWrapper:n,animationProgramWrapper:o}},da.getName=function(){return"WebGL"},da.prototype._afterFirstFrame=function(){this._animationProgramWrapper.getState()===dn.INIT&&this._animationProgramWrapper.compile()},da.prototype.ensureAnimationsReady=function(){var t=this._animationProgramWrapper.getState();t!==dn.DONE&&(t===dn.INIT&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())},da.prototype.getDomElement=function(){return this._glCanvas},da.prototype._initGl=function(){var t=this._gl;t.clearColor(0,0,0,0),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},da.prototype._computeShaderInfo=function(){var t;this._shaderMetadata=(ha(t={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]},hn),ha(t,"#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SDF_GAMMA = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 ax = texture2D(u_shapeTexture, d);\nfloat ay = aj(ax.b, ax.a) * q.x;\nfloat az = aj(ax.r, ax.g) * q.y;\naz += as;\nfloat bc = min(ay, az);\nvec4 bd = a;\nvec4 be = b;\nif (s > -EPSILON) {\nvec2 bi = e;\nfloat bv =\nstep(k.x, bi.x) *\nstep(bi.x, l.x) *\nstep(k.y, bi.y) *\nstep(bi.y, l.y);\nfloat bw = bv;\nvec4 bz;\nif (ao(s, FILTER_NEAREST)) {\nbz = texture2D(u_patternNearestTexture, bi);\n} else if (ao(s, FILTER_LINEAR)) { \nbz = texture2D(u_patternLinearTexture, bi);\n} else if (ao(s, FILTER_LINEAR_SDF)) { \nbz = texture2D(u_patternLinearSdfTexture, bi);\nbz.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bz.a);\n} else if (ao(s, FILTER_MIPMAP)) { \nbz = texture2D(u_patternMipmapTexture, bi);\n}\nbz.rgb += c.rgb;\nbz.a *= bw;\nbd = ad(bd, bz);\n}\nfloat cl = clamp(bc, 0.0, 1.0);\nfloat cm = clamp(bc - j, 0.0, 1.0);\nfloat cn = cl - cm;\ncn = 1.0 - clamp(bc - j, 0.0, 1.0);\nbd.a *= cm;\nbe.a *= cn;\nvec4 co = ad(bd, be);\nfloat cp = cl;\nco.rgb = mix(u_backgroundColor, co.rgb, ar);\nif (o > EPSILON) {\nfloat de = fract(au) * o;\nfloat df = clamp(min(de, at - de), 0.0, 1.0);\ncp *= df;\n}\nif (n < 0.0 || n > 1.0 || cp < EPSILON) {\ndiscard;\n}\nco.a *= cp;\nco.rgb *= co.a;\ngl_FragColor = co;\n}\n"),t)},da.prototype._initGlPrograms=function(){this._staticProgram=new Bo({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new Bo({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})},da.prototype._initSpecialGlBuffers=function(){for(var t=this._gl,e=t.createBuffer(),i=new Int8Array(738),r=0;r<41;++r)for(var n=[-1,-1,r,1,-1,r,1,1,r,-1,-1,r,-1,1,r,1,1,r],o=r*n.length,a=0;a<n.length;a++)i[a+o]=n[a];t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),this._specialGlBuffers={vertexInfo:e}},da.prototype._computeUniforms=function(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_GRANULARITY:this._patternTexture.getGranularity(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}},da.prototype._render=function(t){var e=t.shapesChanged,i=t.patternsChanged,r=t.dimensionsChanged,n=t.backgroundColorChanged,o=this._gl;if(e&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetDataTexture()),i&&this._patternTexture.refresh(this._patternManager),r&&(this._mustResize=!0),n){var a=this._renderBackground?this._backgroundRgba:[0,0,0,0],s=a[0],u=a[1],d=a[2],l=a[3];o.clearColor(s*l,u*l,d*l,l)}var h=this._computeUniforms(),c=this._startFrame();this._mustResize&&c.length&&(kt(this._glCanvas,this._width,this._height,this._pixelRatio),o.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),o.clear(o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT);for(var f=0;f<c.length;++f)this._displayBuffer(c[f],h);this._endFrame()},da.prototype._displayBuffer=function(t,e){var i=t.getProgram();i!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=i,this._currentProgram.startPass(e)),t.markAsUsed(),t.draw()},da.prototype._startFrame=function(){for(var t=this._bufferList.getBuffersByAscendingDepth(),e=[],i=0;i<this._glBuffers.length;++i)(n=this._glBuffers[i])&&n.markAsUnused();for(i=0;i<t.length;++i){var r=t[i];(n=this._getAssociatedGlBuffer(r)).markAsUsed(),!r.isEmpty()&&this._isBufferDisplayable(r)&&e.push(n)}for(i=0;i<this._glBuffers.length;++i){var n;(n=this._glBuffers[i])&&!n.isUsed()&&(n.destroy(),this._glBuffers[i]=void 0)}return e},da.prototype._endFrame=function(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)},da.prototype._getAssociatedGlBuffer=function(t){var e=t.getId(),i=this._glBuffers[e];if(!i){for(;this._glBuffers.length<=e;)this._glBuffers.push(void 0);i=new Go({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._glBuffers[e]=i}return i.setDataBuffer(t),i},da.prototype.destroy=function(){var t=this._gl.getExtension("WEBGL_lose_context");t&&t.loseContext()},da.prototype.getImageData=function(){var t=this._glCanvas.width,e=this._glCanvas.height;return(this._2dcanvas.width<t||this._2dcanvas.height<e)&&(this._2dcanvas.width=t,this._2dcanvas.height=e),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,t,e)},da.prototype._getImageDataFlippedYAxis=function(){var t=this._gl,e=this._glCanvas.width,i=this._glCanvas.height,r=this._ctx.createImageData(e,i),n=new Uint8Array(r.data.buffer);return t.readPixels(0,0,e,i,t.RGBA,t.UNSIGNED_BYTE,n),r},da);function da(t){var e=sa.call(this,t)||this;e._2dcanvas=$r(),e._ctx=e._2dcanvas.getContext("2d"),e._glBuffers=[],e._mustResize=!1;var i=t.initData||da.createInitData(),r=i.canvas,n=i.gl,o=i.ext,a=i.staticProgramWrapper,s=i.animationProgramWrapper;return aa(n,"NO_WEBGL"),aa(o,"NO_ANGLE_INSTANCED_ARRAYS"),e._glCanvas=r,e._gl=n,e._ext=o,e._staticProgramWrapper=a,e._animationProgramWrapper=s,e._shapeTexture=new On(e._gl,0),e._patternTexture=new jn(e._gl,1),e._initCanvas(e._glCanvas),e._computeShaderInfo(),e._initSpecialGlBuffers(),e._initGlPrograms(),e._initGl(),e}var la={float:1,vec2:2,vec3:3,vec4:4};function ha(t,e){for(var i=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,r=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,n=[],o=i.exec(e);o;){var a=o[0];"#endif"===a?n.pop():a.startsWith("#if")?n.push(o[4]):t.attributes.push({name:o[3],size:la[o[2]],type:o[1],tags:n.slice(),location:null,byteSize:0,glType:null}),o=i.exec(e)}for(o=r.exec(e);o;){if(!t.uniforms.some((function(t){return t.id===o[1]}))){var s=o[1],u=o[2],d=u.replace("u_","");t.uniforms.push({id:d,name:u,type:s})}o=r.exec(e)}}var ca=Math.PI,fa=2*Math.PI,ga=ca*(5/4),pa=ca*(7/4),_a=.75*ca,va=.25*ca,ma=-ca/2,ya=ca/2,ba={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},xa={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},Ea={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0};function Aa(t,e,i,r,n){var o=1-n;return o*o*o*t+3*n*o*o*e+3*n*n*o*i+n*n*n*r}function Sa(t,e,i,r){var n=1-r;return n*n*t+2*n*r*e+r*r*i}function wa(t,e,i,r,n,o){var a=o||{x:0,y:0},s=(t+i)/2,u=(e+r)/2,d=t-i,l=e-r,h=Math.sqrt(d*d+l*l);if(0===h)return a.x=s,a.y=u,a;var c=l/h,f=-d/h,g=-h*n/5;return a.x=s+c*g,a.y=u+f*g,a}function Ta(t,e,i,r,n,o){var a=o||{x1:0,y1:0,x2:0,y2:0},s=5*(r+r/5*i),u=-n+ca,d=ca/2-n;return a.x1=t+Math.cos(u)*s,a.y1=e+Math.sin(u)*s,a.x2=t+Math.cos(d)*s,a.y2=e+Math.sin(d)*s,a}var Ca,Ma=(E(Ia,Ca=sn),Ia.prototype._resetCachePoints=function(){this._nextCachePoint=0},Ia.prototype._point=function(t,e){var i=this._cachePoints[this._nextCachePoint++];return i||(i={x:0,y:0},this._cachePoints.push(i)),i.x=t,i.y=e,i},Ia.prototype.setViewportClipping=function(t){this._clipViewport=t},Ia.prototype._formatAngle=function(t){return t<-Math.PI?t+2*Math.PI:t>Math.PI?t-2*Math.PI:t},Ia.prototype._computeAnimationRatio=function(t){var e=t.beginTime,i=t.duration,r=t.easing,n=(this._currentTime-e)/i,o=n*n,a=o*n,s=this._easingManager.getCoefficients(r),u=n<.5?0:4;return qe(s[u]+s[1+u]*n+s[2+u]*o+s[3+u]*a,0,1)},Ia.prototype._mixColor=function(t,e,i,r){if(t===e)return t;var n=this._colorManager.parseColor(t),o=n[0],a=n[1],s=n[2],u=n[3],d=this._colorManager.parseColor(e),l=d[0],h=d[1],c=d[2],f=d[3];return"rgba("+Math.round(255*Ye(o,l,i))+","+Math.round(255*Ye(a,h,i))+","+Math.round(255*Ye(s,c,i))+","+Ye(u,f,r)+")"},Ia.prototype._displayBuffer=function(t){for(var e=t.getSize(),i=t.isAnimated(),r=0;r<e;++r){var n=this.extractElement(t,r);n.valid&&this._displayElement(n,i)}},Ia.prototype._mixAttributes=function(t,e,i){var r=this._computeAnimationRatio(i);return t.dashLength=Ye(e.dashLength,t.dashLength,r),t.gapLength=Ye(e.gapLength,t.gapLength,r),t.offsetAngle=Ye(e.offsetAngle,t.offsetAngle,r),t.opacity=Ye(e.opacity,t.opacity,r),t.globalMinVisibleSize=Ye(e.globalMinVisibleSize,t.globalMinVisibleSize,r),t.strokeMinVisibleSize=Ye(e.strokeMinVisibleSize,t.strokeMinVisibleSize,r),t.patternMinVisibleSize=Ye(e.patternMinVisibleSize,t.patternMinVisibleSize,r),t.symbolicSize=Ye(e.symbolicSize,t.symbolicSize,r),t.curvature=Ye(e.curvature,t.curvature,r),t.fillColor=this._mixColor(e.fillColor,t.fillColor,r,r),t.strokeColor=this._mixColor(e.strokeColor,t.strokeColor,r,r),t.patternColor=this._mixColor(e.patternColor,t.patternColor,r,r),t.x1=Ye(e.x1,t.x1,r),t.y1=Ye(e.y1,t.y1,r),t.x2=Ye(e.x2,t.x2,r),t.y2=Ye(e.y2,t.y2,r),t.rectWidthOrSourceRadiusScaled=Ye(e.rectWidthOrSourceRadiusScaled,t.rectWidthOrSourceRadiusScaled,r),t.rectWidthOrSourceRadiusFixed=Ye(e.rectWidthOrSourceRadiusFixed,t.rectWidthOrSourceRadiusFixed,r),t.rectHeightOrTargetRadiusScaled=Ye(e.rectHeightOrTargetRadiusScaled,t.rectHeightOrTargetRadiusScaled,r),t.rectHeightOrTargetRadiusFixed=Ye(e.rectHeightOrTargetRadiusFixed,t.rectHeightOrTargetRadiusFixed,r),t.thicknessOrFontSizeScaled=Ye(e.thicknessOrFontSizeScaled,t.thicknessOrFontSizeScaled,r),t.thicknessOrFontSizeFixed=Ye(e.thicknessOrFontSizeFixed,t.thicknessOrFontSizeFixed,r),t.strokeWidthScaled=Ye(e.strokeWidthScaled,t.strokeWidthScaled,r),t.strokeWidthFixed=Ye(e.strokeWidthFixed,t.strokeWidthFixed,r),t.offsetScaled=Ye(e.offsetScaled,t.offsetScaled,r),t.offsetFixed=Ye(e.offsetFixed,t.offsetFixed,r),t},Ia.prototype._computeRenderInfo=function(t){var e=this._viewZoom,i=this._point(t.x1,t.y1),r=this._point(t.x2,t.y2);return{shape:this._shapeManager.getDefinitionFromName(t.shape),pieceId:t.pieceId,dashLength:t.dashLength,gapLength:t.gapLength,hasHead:t.hasHead,hasTail:t.hasTail,isBodyTriangle:t.isBodyTriangle,isSelfLoop:t.isSelfLoop,patternScale:t.patternScale,offsetAngle:this._formatAngle(t.offsetAngle),isText:t.isText,adjustTextAngle:t.adjustTextAngle,isBadge:t.isBadge,unusedFlag2:t.unusedFlag2,unusedFlag3:t.unusedFlag3,opacity:t.opacity,globalMinVisibleSize:t.globalMinVisibleSize,strokeMinVisibleSize:t.strokeMinVisibleSize,patternMinVisibleSize:t.patternMinVisibleSize,symbolicSize:0===t.symbolicSize?1/0:t.symbolicSize*e,curvature:t.curvature,pattern:t.pattern,fillColor:t.fillColor,strokeColor:t.strokeColor,patternColor:t.patternColor,pos1OnGraph:i,pos2OnGraph:r,pos1:this._graphToScreenCoordinates(i),pos2:this._graphToScreenCoordinates(r),rectWidthOrSourceRadius:t.rectWidthOrSourceRadiusScaled*e+t.rectWidthOrSourceRadiusFixed,rectHeightOrTargetRadius:t.rectHeightOrTargetRadiusScaled*e+t.rectHeightOrTargetRadiusFixed,thicknessOrFontSize:t.thicknessOrFontSizeScaled*e+t.thicknessOrFontSizeFixed,strokeWidth:t.strokeWidthScaled*e+t.strokeWidthFixed,offset:t.offsetScaled*e+t.offsetFixed}},Ia.prototype._applyBackgroundBlending=function(t){1!==t.opacity&&(t.fillColor=this._blendColor(t.fillColor,t.opacity),t.strokeColor=this._blendColor(t.strokeColor,t.opacity),t.textColor=this._blendColor(t.textColor,t.opacity))},Ia.prototype._pointArray=function(t){var e=this._pointCopies[t];if(!e){e=new Array(t),this._pointCopies[t]=e;for(var i=0;i<t;++i)e[i]={x:0,y:0,r:0}}return e},Ia.prototype._scalePoints=function(t,e,i,r){for(var n=t.shape.points.length,o=this._pointArray(n),a=0;a<n;++a){var s=t.shape.points[a],u=o[a];u.x=e.x+s.x*i,u.y=e.y+s.y*r,u.r=s.r*i}var d=t.pos2OnGraph.x-t.pos1OnGraph.x,l=t.pos2OnGraph.y-t.pos1OnGraph.y;if(0!=d||0!=l)for(var h=Math.sqrt(d*d+l*l),c=d/h,f=l/h,g=0,p=o;g<p.length;g++){var _=p[g],v=_.x-e.x,m=_.y-e.y;_.x=e.x+c*v+f*m,_.y=e.y-f*v+c*m}return o},Ia.prototype._drawPoints=function(t){1===t.length?this._drawCircle(t[0],t[0].r):this._drawPolygon(t)},Ia.prototype._computeCenter=function(t){var e=Math.cos(t.offsetAngle),i=Math.sin(t.offsetAngle),r=(t.pos1.x+t.pos2.x)/2+e*t.offset,n=(t.pos1.y+t.pos2.y)/2+i*t.offset;return this._point(r,n)},Ia.prototype._displayNodeComponent=function(t,e,i,r){var n=this,o=this._computeCenter(t);if(7!==t.pattern.type){var a=t.rectWidthOrSourceRadius/2,s=t.rectHeightOrTargetRadius/2,u=this._scalePoints(t,o,a,s);if((e||r)&&this._drawPoints(u),e&&this._fill(t.fillColor),r){if(this._startClip(),4===t.pattern.type){var d=t.pattern.attributes.colorArray;1!==t.opacity&&(d=d.map((function(e){return n._blendColor(e,t.opacity)}))),this._displayPieChart(o,a,d)}else if(5===t.pattern.type||6===t.pattern.type){var l=0,h=Math.round(t.rectHeightOrTargetRadius*t.patternScale),c=t.pattern.attributes.text,f=t.patternColor,g=t.pattern.attributes.font,p=t.pattern.attributes.style,_=t.pattern.attributes.align,v=t.rectWidthOrSourceRadius,m=t.pattern.attributes.paddingTop,y=t.pattern.attributes.paddingLeft;this._displayText(o,l,c,f,g,h,p,_,v,y,m)}else if(2===t.pattern.type){var b=t.pattern.attributes.image;if(b.isDummy||b.width&&b.height){var x=t.pattern.attributes.duplicated,E=x?1:t.patternScale,A=t.rectWidthOrSourceRadius*E,S=t.rectHeightOrTargetRadius*E,w=t.pattern.attributes.scaled,T=t.opacity;this._displayImage(o,A,S,b,w,x,T)}}this._endClip()}if(i){var C=t.strokeWidth/2,M=this._scalePoints(t,o,a+C,s+C);this._drawPoints(M),this._stroke(t.strokeColor,t.strokeWidth)}}else r&&(l=0,h=t.thicknessOrFontSize,c=t.pattern.attributes.text,f=t.patternColor,g=t.pattern.attributes.font,p=t.pattern.attributes.style,_=t.pattern.attributes.align,v=t.rectWidthOrSourceRadius,this._displayText(o,l,c,f,g,h,p,_,v))},Ia.prototype._displayElement=function(t,e){if(t.end&&t.end.shape&&t.end.pieceId&&(!e||t.start&&t.animation)){this._resetCachePoints();var i=e?this._mixAttributes(t.end,t.start,t.animation):t.end,r=this._computeRenderInfo(i);if(!(r.symbolicSize<r.globalMinVisibleSize||0===r.opacity)){this._applyBackgroundBlending(r);var n=!!(r.strokeColor&&0<r.strokeWidth&&r.symbolicSize>=r.strokeMinVisibleSize),o=!!(1!==r.pattern.type&&r.symbolicSize>=r.patternMinVisibleSize),a=!!r.fillColor;if(1===r.pieceId)return this._displayNodeComponent(r,a,n,o);var s,u,d,l,h,c,f,g,p,_,v,m,y,b,x,E,A,S,w,T,C=r.pos2.x-r.pos1.x,M=r.pos2.y-r.pos1.y,I=Math.sqrt(C*C+M*M),L=null,N=null;if(r.isSelfLoop){var k=5===r.pieceId?r.strokeWidth/2:r.rectWidthOrSourceRadius,O=this._getSelfLoopControlPoints(r.pos1,r.curvature,k),F=O.x1,R=O.y1,P=O.x2,D=O.y2;L=this._point(F,R),N=this._point(P,D),_=r.pos1,v=L,m=N,r.pos2,y=(_.x+v.x+m.x)/3,b=(_.y+v.y+m.y)/3,w=(x=y-v.x)*x+(E=b-v.y)*E,T=((A=v.x-m.x)*A+(S=v.y-m.y)*S)/4,s=1.9442*Math.sqrt(w-T)*3.14159265359*1}else s=r.curvature?(L=this._getQuadraticCurveControlPoint(r),u=r.curvature,d=I,c=.25,f=1/(16*(h=(l=Math.abs(u)/5+1e-6)*l)),g=Math.sqrt(c+f),p=.5/l*Math.sqrt(.25+h),Math.abs(2*l)*(.5*g+.5*p+f*Math.log(Math.abs((.5+g)/(p-.5))))*d):I;if(5===r.pieceId){var z=r.strokeWidth,B=this._getPointOnLine(r.pos1,L,N,r.pos2,.5),U=this._getTangentOnLine(r.pos1,L,N,r.pos2,.5);r.adjustTextAngle&&!r.isSelfLoop&&r.rectWidthOrSourceRadius>=s-z&&(U.x=1,U.y=0,r.offset=0);var V=-Math.atan2(U.y,U.x),j=this._formatAngle(r.offsetAngle-V);(!r.isSelfLoop&&j<0||r.isSelfLoop&&r.offsetAngle<0)&&(U.x*=-1,U.y*=-1),(V>Math.PI/2||V<-Math.PI/2)&&(V+=Math.PI);var G=this._getOrthogonal(U),H=B.x+G.x*r.offset,W=B.y+G.y*r.offset;if(r.fillColor){var q=this._pointArray(4),X=r.rectWidthOrSourceRadius/2,Y=r.rectHeightOrTargetRadius/2,Z=U.x*X,K=U.y*X,Q=G.x*Y,J=G.y*Y,$=q[0],tt=q[1],et=q[2],it=q[3];$.x=H+Z+Q,$.y=W+K+J,tt.x=H+Z-Q,tt.y=W+K-J,et.x=H-Z-Q,et.y=W-K-J,it.x=H-Z+Q,it.y=W-K+J,this._drawPoints(q),this._fill(r.fillColor)}else{var rt=this._point(H,W),nt=V,ot=r.thicknessOrFontSize,at=r.pattern.attributes.text,st=r.patternColor,ut=r.pattern.attributes.font,dt=r.pattern.attributes.style,lt=r.pattern.attributes.align,ht=r.rectWidthOrSourceRadius;this._displayText(rt,nt,at,st,ut,ot,dt,lt,ht)}}else{var ct=3===r.pieceId,ft=4===r.pieceId,gt=Math.cos(r.offsetAngle),pt=Math.sin(r.offsetAngle);r.pos1.x+=gt*r.offset,r.pos1.y+=pt*r.offset,r.pos2.x+=gt*r.offset,r.pos2.y+=pt*r.offset;var _t="line"===r.shape.name,vt=r.thicknessOrFontSize,mt=r.rectWidthOrSourceRadius,yt=r.rectHeightOrTargetRadius,bt=+r.hasHead,xt=+r.hasTail,Et=+r.isBodyTriangle,At=bt+xt,St=3*vt,wt=bt*St,Tt=xt*St,Ct=r.isSelfLoop?1/0:I-mt-yt,Mt=Math.min(Ct/At,St),It=xt*(St+Math.max(mt+Mt-Tt,0))+(1-xt)*Et*mt,Lt=bt*(St+Math.max(yt+Mt-wt,0))+(1-bt)*Et*yt;if(ct||ft){var Nt=ft?-1:1,kt=(ct?s-Lt:It)-Nt,Ot=null,Ft=null;if(r.isSelfLoop&&L&&N){var Rt=this._getTFromLengthOnCubicCurve(r.pos1,L,N,r.pos2,kt-r.strokeWidth/2*Nt);Ot=this._getPointOnCubicCurve(r.pos1,L,N,r.pos2,Rt),Ft=this._getTangentOnCubicCurve(r.pos1,L,N,r.pos2,Rt)}else Ft=r.curvature&&L?(Rt=this._getTFromLengthOnQuadraticCurve(r.pos1,L,r.pos2,kt-r.strokeWidth/2*Nt),Ot=this._getPointOnQuadraticCurve(r.pos1,L,r.pos2,Rt),this._getTangentOnQuadraticCurve(r.pos1,L,r.pos2,Rt)):(Rt=kt/s,Ot=this._mixPoints(r.pos1,r.pos2,Rt),this._point(C/I,M/I));if(Ft.x*=Nt,Ft.y*=Nt,a){if(r.shape.hole){var Pt=this._makeEdgeExtremityPoints(Ot,Ft,St,r.shape.hole);this._drawPoints(Pt),this._startReverseClip()}q=this._makeEdgeExtremityPoints(Ot,Ft,St,r.shape.points),this._drawPoints(q),this._fill(r.fillColor),r.shape.hole&&this._endReverseClip()}if(n){r.shape.hole&&(Pt=this._makeEdgeExtremityPoints(Ot,Ft,St,r.shape.hole),this._drawPoints(Pt),this._stroke(r.strokeColor,r.strokeWidth));var Dt=St+r.strokeWidth/2;q=this._makeEdgeExtremityPoints(Ot,Ft,Dt,r.shape.points),this._drawPoints(q),this._stroke(r.strokeColor,r.strokeWidth)}}else{if(s-It-Lt<=0)return;if(_t){var zt=function(t,e,i,r,n,o){var a=[];if(i&&a.push(0,i),n&&o){for(var s=n*e,u=o*e,d=s+u,l=t-r-i-d,h=0;h<l;)a.push(s,u),h+=d;var c=t-r-i-h,f=Math.min(s,c),g=Math.max(c-f,0);a.push(f,g)}else a.push(t-r-i,0);return r&&a.push(0,r),a}(s,vt,It,Lt,r.dashLength,r.gapLength);n&&(this._drawLine(r.pos1,L,N,r.pos2),this._stroke(r.strokeColor,vt+2*r.strokeWidth,zt)),a&&(this._drawLine(r.pos1,L,N,r.pos2),this._stroke(r.fillColor,vt,zt))}else{var Bt=It,Ut=s-Lt;n&&(q=this._makeTriangleEdgeBody(r.pos1,L,N,r.pos2,Bt,Ut,vt+r.strokeWidth/2,r.strokeWidth/2),this._drawPoints(q),this._stroke(r.strokeColor,r.strokeWidth)),a&&(q=this._makeTriangleEdgeBody(r.pos1,L,N,r.pos2,Bt,Ut,vt,0),this._drawPoints(q),this._fill(r.fillColor))}}}}}},Ia.prototype._makeTriangleEdgeBody=function(t,e,i,r,n,o,a,s){return e?i?this._makeSelfLoopTriangleEdge(t,e,i,r,n,o,a,s):this._makeCurveTriangleEdge(t,e,r,n,o,a,s):this._makeStraightTriangleEdge(t,r,n,o,a,s)},Ia.prototype._makeCurveTriangleEdge=function(t,e,i,r,n,o,a){for(var s=this._pointArray(84),u=this._getTFromLengthOnQuadraticCurve(t,e,i,r),d=(this._getTFromLengthOnQuadraticCurve(t,e,i,n)-u)/41,l=(a-o)/41/2,h=o/2,c=u,f=0;f<=41;++f){var g=this._getPointOnQuadraticCurve(t,e,i,c),p=this._getTangentOnQuadraticCurve(t,e,i,c),_=this._getOrthogonal(p),v=_.x*h,m=_.y*h,y=s[f],b=s[83-f];y.x=g.x+v,y.y=g.y+m,b.x=g.x-v,b.y=g.y-m,c+=d,h+=l}return s},Ia.prototype._makeSelfLoopTriangleEdge=function(t,e,i,r,n,o,a,s){for(var u=this._pointArray(84),d=this._getTFromLengthOnCubicCurve(t,e,i,r,n),l=(this._getTFromLengthOnCubicCurve(t,e,i,r,o)-d)/41,h=(s-a)/41/2,c=a/2,f=d,g=0;g<=41;++g){var p=this._getPointOnCubicCurve(t,e,i,r,f),_=this._getTangentOnCubicCurve(t,e,i,r,f),v=this._getOrthogonal(_),m=v.x*c,y=v.y*c,b=u[g],x=u[83-g];b.x=p.x+m,b.y=p.y+y,x.x=p.x-m,x.y=p.y-y,f+=l,c+=h}return u},Ia.prototype._makeStraightTriangleEdge=function(t,e,i,r,n,o){var a=e.x-t.x,s=e.y-t.y,u=Math.sqrt(a*a+s*s),d=this._point(a/u,s/u),l=this._getOrthogonal(d),h=n/2,c=o/2,f=this._pointArray(4),g=f[0],p=f[1],_=f[2],v=f[3],m=t.x+d.x*i,y=t.y+d.y*i,b=t.x+d.x*r,x=t.y+d.y*r,E=l.x*h,A=l.y*h,S=l.x*c,w=l.y*c;return g.x=m+E,g.y=y+A,p.x=m-E,p.y=y-A,_.x=b-S,_.y=x-w,v.x=b+S,v.y=x+w,f},Ia.prototype._makeEdgeExtremityPoints=function(t,e,i,r){for(var n=this._pointArray(r.length),o=i/2,a=t.x+e.x*o,s=t.y+e.y*o,u=e.x,d=e.y,l=0;l<r.length;++l){var h=r[l],c=n[l],f=(u*h.x-d*h.y)*o,g=(d*h.x+u*h.y)*o;c.x=a+f,c.y=s+g,c.r=h.r*o}return n},Ia.prototype._drawLine=function(t,e,i,r){e?i?this._drawCubicCurve(t,e,i,r):this._drawQuadraticCurve(t,e,r):this._drawStraightLine(t,r)},Ia.prototype._getSelfLoopControlPoints=function(t,e,i){return Ta(t.x,t.y,e,i,this._viewAngle,this._tmp)},Ia.prototype._getQuadraticCurveControlPoint=function(t){return wa(t.pos1.x,t.pos1.y,t.pos2.x,t.pos2.y,t.curvature,this._point(0,0))},Ia.prototype._graphToScreenCoordinates=function(t){var e=this._width/2,i=this._height/2,r=(t.x-this._viewX)*this._viewZoom,n=(t.y-this._viewY)*this._viewZoom,o=this._viewAngleCos,a=this._viewAngleSin,s=o*r+a*n+e,u=-a*r+o*n+i;return this._point(s,u)},Ia.prototype._blendColor=function(t,e){return t&&this._backgroundColor?this._mixColor(this._backgroundColor,t,e,1):null},Ia.prototype._getTangentOnLine=function(t,e,i,r,n){return e?i?this._getTangentOnCubicCurve(t,e,i,r,n):this._getTangentOnQuadraticCurve(t,e,r,n):this._getTangentOnStraightLine(t,r)},Ia.prototype._getTangentOnStraightLine=function(t,e){var i=e.x-t.x,r=e.y-t.y,n=Math.sqrt(i*i+r*r);return this._point(i/n,r/n)},Ia.prototype._getTangentOnQuadraticCurve=function(t,e,i,r){var n=1-r,o=n*e.x+r*i.x-(n*t.x+r*e.x),a=n*e.y+r*i.y-(n*t.y+r*e.y),s=Math.sqrt(o*o+a*a);return this._point(o/s,a/s)},Ia.prototype._getTangentOnCubicCurve=function(t,e,i,r,n){var o=1-n,a=o*o,s=n*n,u=a*(e.x-t.x)+2*o*n*(i.x-e.x)+s*(r.x-i.x),d=a*(e.y-t.y)+2*o*n*(i.y-e.y)+s*(r.y-i.y),l=Math.sqrt(u*u+d*d);return this._point(u/l,d/l)},Ia.prototype._mixPoints=function(t,e,i){var r=Ye(t.x,e.x,i),n=Ye(t.y,e.y,i);return this._point(r,n)},Ia.prototype._getOrthogonal=function(t){return this._point(-t.y,t.x)},Ia.prototype._getPointOnLine=function(t,e,i,r,n){return e?i?this._getPointOnCubicCurve(t,e,i,r,n):this._getPointOnQuadraticCurve(t,e,r,n):this._mixPoints(t,r,n)},Ia.prototype._getPointOnQuadraticCurve=function(t,e,i,r){var n=Sa(t.x,e.x,i.x,r),o=Sa(t.y,e.y,i.y,r);return this._point(n,o)},Ia.prototype._getPointOnCubicCurve=function(t,e,i,r,n){var o=Aa(t.x,e.x,i.x,r.x,n),a=Aa(t.y,e.y,i.y,r.y,n);return this._point(o,a)},Ia.prototype._getTFromLengthOnCubicCurve=function(t,e,i,r,n){for(var o=t.x,a=t.y,s=0,u=0,d=0;d<41;++d){s+=1/41;var l=Aa(t.x,e.x,i.x,r.x,s),h=Aa(t.y,e.y,i.y,r.y,s),c=l-o,f=h-a,g=Math.sqrt(c*c+f*f),p=u+g;if(n<p)return s-1/41*((p-n)/g);u=p,o=l,a=h}return 1},Ia.prototype._getTFromLengthOnQuadraticCurve=function(t,e,i,r){for(var n=t.x,o=t.y,a=0,s=0,u=0;u<41;++u){a+=1/41;var d=Sa(t.x,e.x,i.x,a),l=Sa(t.y,e.y,i.y,a),h=d-n,c=l-o,f=Math.sqrt(h*h+c*c),g=s+f;if(r<g)return a-1/41*((g-r)/f);s=g,n=d,o=l}return 1},Ia);function Ia(t){var e=Ca.call(this,t)||this;return e._cachePoints=[],e._nextCachePoint=0,e._tmp={x1:0,y1:0,x2:0,y2:0},e._pointCopies=Array(128),e._clipViewport=!0,e}var La,Na=!$r().__dummy,ka=(E(Oa,La=Ma),Oa.getName=function(){return"Canvas"},Oa.isAvailable=function(){return Na},Oa.prototype.getDomElement=function(){return this._canvas},Oa.prototype._render=function(t){t.dimensionsChanged&&an(this._canvas,this._width,this._height,this._pixelRatio);var e=this._ctx,i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;e.clearRect(0,0,i,r),this._backgroundColor&&this._renderBackground&&(e.fillStyle=this._backgroundColor,e.fillRect(0,0,i,r));for(var n=this._bufferList.getBuffersByAscendingDepth(),o=0;o<n.length;++o){var a=n[o];this._isBufferDisplayable(a)&&this._displayBuffer(a)}},Oa.prototype._drawCircle=function(t,e){var i=this._ctx,r=this._pixelRatio,n=t.x*r,o=t.y*r,a=e*r;i.beginPath(),i.arc(n,o,a,0,2*Math.PI)},Oa.prototype._drawPolygon=function(t){var e=this._ctx,i=this._pixelRatio;e.beginPath();var r=t[0];e.moveTo(r.x*i,r.y*i);for(var n=1;n<t.length;++n){var o=t[n];e.lineTo(o.x*i,o.y*i)}e.closePath()},Oa.prototype._drawStraightLine=function(t,e){var i=this._ctx,r=this._pixelRatio;i.beginPath(),i.moveTo(t.x*r,t.y*r),i.lineTo(e.x*r,e.y*r)},Oa.prototype._drawQuadraticCurve=function(t,e,i){var r=this._ctx,n=this._pixelRatio;r.beginPath(),r.moveTo(t.x*n,t.y*n),r.quadraticCurveTo(e.x*n,e.y*n,i.x*n,i.y*n)},Oa.prototype._drawCubicCurve=function(t,e,i,r){var n=this._ctx,o=this._pixelRatio;n.beginPath(),n.moveTo(t.x*o,t.y*o),n.bezierCurveTo(e.x*o,e.y*o,i.x*o,i.y*o,r.x*o,r.y*o)},Oa.prototype._fill=function(t){var e=this._ctx;e.fillStyle=t,e.fill()},Oa.prototype._stroke=function(t,e,i){var r=this;void 0===i&&(i=[]);var n=this._ctx,o=this._pixelRatio;n.setLineDash(i.map((function(t){return t*r._pixelRatio}))),n.lineWidth=e*o,n.strokeStyle=t,n.stroke()},Oa.prototype._startClip=function(){this._ctx.save(),this._ctx.clip()},Oa.prototype._endClip=function(){this._ctx.restore()},Oa.prototype._startReverseClip=function(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")},Oa.prototype._endReverseClip=function(){this._ctx.restore()},Oa.prototype._displayText=function(t,e,i,r,n,o,a,s,u,d,l){void 0===d&&(d=0),void 0===l&&(l=0);var h=this._ctx,c=this._pixelRatio,f=t.x*c,g=t.y*c,p=o*c,_="center"===s?0:-u/2;if(l=l*this._viewZoom*this._pixelRatio,d=d*this._viewZoom*this._pixelRatio,h.save(),h.translate(f,g),h.rotate(-e),h.textBaseline="middle",h.textAlign=s,en(h,n,p,a),h.fillStyle=r,-1!==i.indexOf("\n"))for(var v=i.split("\n"),m=v.length,y=(1-m)/2*p,b=0;b<m;++b)h.fillText(v[b],d+_,l+y),y+=p;else h.fillText(i,d+_,l-1);h.restore()},Oa.prototype._displayImage=function(t,e,i,r,n,o,a){if(!this._hideImages&&!("isDummy"in r)){var s=r;1!==a&&(s=this._blendImageOnBackground(r,a));var u=this._ctx,d=this._pixelRatio,l=t.x*d,h=t.y*d,c=e*d,f=i*d,g=s.width*d,p=s.height*d;if(n)u.drawImage(s,l-c/2,h-f/2,c,f);else if(o){for(var _=l-c/2,v=h-f/2,m=l+c/2,y=h+f/2,b=l-g/2,x=h-p/2;_<b;)b-=g;for(;v<x;)x-=p;for(var E=x;b<m;){for(;x<y;)u.drawImage(s,b,x,g,p),x+=p;b+=g,x=E}}else u.drawImage(s,l-g/2,h-p/2,g,p)}},Oa.prototype._displayPieChart=function(t,e,i){var r=this._ctx,n=this._pixelRatio,o=t.x*n,a=t.y*n,s=e*n*2,u=2*s;1===i.length&&(r.fillStyle=i[0],r.fillRect(o-s,a-s,u,u)),1<i.length&&kn(r,i,o,a,s)},Oa.prototype._blendImageOnBackground=function(t,e){var i=this._backgroundRgba,r="rgb("+Math.round(255*i[0])+","+Math.round(255*i[1])+","+Math.round(255*i[2])+")";return this._imgCanvas.width=t.width,this._imgCanvas.height=t.height,this._imgCtx.clearRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=r,this._imgCtx.fillRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=e,this._imgCtx.drawImage(t,0,0),this._imgCanvas},Oa.prototype.getImageData=function(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)},Oa);function Oa(t){var e=La.call(this,t)||this;return e._canvas=$r(),e._imgCanvas=$r(),e._initCanvas(e._canvas),e._ctx=e._canvas.getContext("2d"),e._imgCtx=e._imgCanvas.getContext("2d"),e}var Fa=[1/0,1/0,-1/0,-1/0];function Ra(t,e,i,r,n,o){void 0===o&&(o={x:0,y:0});var a=Math.cos(n),s=Math.sin(n),u=t-i,d=e-r;return o.x=a*u-s*d+i,o.y=s*u+a*d+r,o}function Pa(t,e,i,r){return Math.sqrt((t-i)*(t-i)+(e-r)*(e-r))}function Da(t,e,i,r){var n=t-i,o=e-r;return n*n+o*o}function za(t){return 180*t/Math.PI}function Ba(t,e){return t.minX-=e,t.minY-=e,t.maxX+=e,t.maxY+=e,void 0===t.width&&(t.width=t.maxX-t.minX),void 0===t.height&&(t.height=t.maxY-t.minY),t.width+=2*e,t.height+=2*e,t}var Ua=!1;try{Ua=!!Dt("svg")}catch(l){}var Va="none",ja={left:"start",center:"middle",right:"end"},Ga="data-element-id";function Ha(t){return Math.round(1e3*t)/1e3}function Wa(t,e,i,r,n,o){var a=Dt("image");return a.setAttribute("width",Ha(r)),a.setAttribute("height",Ha(n)),a.setAttribute("x",Ha(e)),a.setAttribute("y",Ha(i)),a.setAttribute("href",t),o&&o.appendChild(a),a}var qa,Xa=(E(Ya,qa=Ma),Ya.getName=function(){return"SVG"},Ya.isAvailable=function(){return Ua},Ya.prototype.getDomElement=function(){return this._svg},Ya.prototype._render=function(t){if(t.dimensionsChanged&&Ot(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){var e=this._colorManager.rgbaToRgb(this._backgroundColor);this._background.setAttribute("fill",e.color),this._background.setAttribute("fill-opacity",e.opacity)}var i=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(var r=0;r<i.length;++r){var n=i[r];this._isBufferDisplayable(n)&&this._displayBuffer(n)}this._svg.appendChild(this._container)},Ya.prototype._clear=function(){this._container&&this._svg.removeChild(this._container),this._container=Dt("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=Dt("g"),this._defs.appendChild(this._clipPaths),this._filters&&this._defs.removeChild(this._filters),this._filters=Dt("g"),this._defs.appendChild(this._filters)},Ya.prototype._displayElement=function(t,e){this._currentElementId=0<=t.id?"n"+t.id:"e"+-t.id,qa.prototype._displayElement.call(this,t,e)},Ya.prototype._addBackgroundBlendingFilter=function(t){var e=this._colorManager.parseColor(this._backgroundColor),i=1-t,r=[t,0,0,0,e[0]*i,0,t,0,0,e[1]*i,0,0,t,0,e[2]*i,0,0,0,1,0].join(" "),n="filter-"+this._currentElementId,o=Dt("filter",{id:n}),a=Dt("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:r});return o.appendChild(a),this._filters.appendChild(o),n},Ya.prototype._drawCircle=function(t,e){var i="M "+(t.x-e)+", "+t.y+" a "+e+","+e+" 0 1,0 "+2*e+",0 a "+e+","+e+" 0 1,0 -"+2*e+",0",r=Dt("path");r.setAttribute("d",i),r.setAttribute("fill",Va),r.setAttribute(Ga,this._currentElementId),this._container.appendChild(r),this._element=r},Ya.prototype._drawPolygon=function(t){for(var e=Dt("path"),i="",r=0;r<t.length;r++){var n=t[r];i+=(0===r?"M":"L")+n.x+","+n.y+" "}i+="Z",e.setAttribute("d",i),e.setAttribute(Ga,this._currentElementId),e.setAttribute("fill",Va),this._container.appendChild(e),this._element=e},Ya.prototype._drawStraightLine=function(t,e){var i=Dt("path"),r="M "+t.x+","+t.y+" L"+e.x+","+e.y;i.setAttribute("d",r),i.setAttribute(Ga,this._currentElementId),this._container.appendChild(i),this._element=i},Ya.prototype._drawQuadraticCurve=function(t,e,i){var r=Dt("path"),n="M "+t.x+","+t.y+" Q"+e.x+","+e.y+" "+i.x+","+i.y;r.setAttribute("d",n),r.setAttribute("fill",Va),r.setAttribute(Ga,this._currentElementId),this._container.appendChild(r),this._element=r},Ya.prototype._drawCubicCurve=function(t,e,i,r){var n=Dt("path"),o="M "+t.x+","+t.y+" C"+e.x+","+e.y+" "+i.x+","+i.y+" "+r.x+","+r.y;n.setAttribute("d",o),n.setAttribute("fill",Va),n.setAttribute(Ga,this._currentElementId),this._container.appendChild(n),this._element=n},Ya.prototype._fill=function(t){var e=this._colorManager.rgbaToRgb(t);this._element.setAttribute("fill",e.color),this._element.setAttribute("fill-opacity",e.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path","url(#"+this._currentClipPathId+")")},Ya.prototype._stroke=function(t,e,i){void 0===i&&(i=[]);var r=this._element;r.setAttribute("stroke-width",e);var n=this._colorManager.rgbaToRgb(t);r.setAttribute("stroke",n.color),r.setAttribute("stroke-opacity",n.opacity),0<i.length&&r.setAttribute("stroke-dasharray",i.map(Ha).toString())},Ya.prototype._startClip=function(){var t=Dt("clipPath"),e=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+this._clipPathCounter++,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)},Ya.prototype._endClip=function(){this._currentClipPathId=null},Ya.prototype._startReverseClip=function(){var t=Dt("clipPath"),e=this._element.cloneNode(!1),i=e.getAttribute("d");e.setAttribute("clip-rule","evenodd"),e.setAttribute("d",i+" M 0 0 L "+this._width+" 0 L "+this._width+" "+this._height+" L 0 "+this._height),this._currentClipPathId="clip-path-"+this._clipPathCounter++,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)},Ya.prototype._endReverseClip=function(){this._currentClipPathId=null},Ya.prototype._displayText=function(t,e,i,r,n,o,a,s,u,d,l){void 0===d&&(d=0),void 0===l&&(l=0);var h=Dt("text");h.setAttribute(Ga,this._currentElementId);var c=this._colorManager.rgbaToRgb(r),f=c.opacity,g=this._colorManager.rgbaToRgb(c.color),p=t.x+d*this._viewZoom,_=t.y+l*this._viewZoom;a=a||"normal";var v=Ha(p);h.setAttribute("x",v),h.setAttribute("font-family",n),h.setAttribute("font-size",o),"bold"===a?h.setAttribute("font-weight",a):h.setAttribute("font-style",a),h.setAttribute("fill",g.color),h.setAttribute("fill-opacity",f),e&&h.setAttribute("transform","rotate("+za(-e)+" "+p+", "+_+")"),h.setAttribute("text-anchor",ja[s]||"middle");var m=i.split("\n"),y=m.length,b=(y+1)/2-1/3;h.setAttribute("y",Ha(_-b*o));for(var x="center"===s?0:-u/2,E=0;E<y;E++){var A=Dt("tspan");A.appendChild(zt(m[E])),A.setAttribute("x",v+x),A.setAttribute("dy",o),h.appendChild(A)}this._currentClipPathId&&h.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(h)},Ya.prototype._displayImage=function(t,e,i,r,n,o,a){var s=t.x,u=t.y;if(!this._hideImages&&("isDummy"in r||r.width&&r.height)){var d,l=r.width,h=r.height;if(n&&(l=e,h=i),o){var c=s-e/2,f=u-i/2,g=s+e/2,p=u+i/2,_=s-l/2,v=u-h/2;for((d=Dt("g")).setAttribute(Ga,this._currentElementId);c<_;)_-=l;for(;f<v;)v-=h;for(var m=v;_<g;){for(;v<p;)Wa(r.src,_,v,l,h,d),v+=h;v=m,_+=l}}else(d=Wa(r.src,s-l/2,u-h/2,l,h)).setAttribute(Ga,this._currentElementId);if(this._currentClipPathId&&d.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),1!==a){var y=this._addBackgroundBlendingFilter(a);d.setAttribute("filter","url(#"+y+")")}this._container.appendChild(d)}},Ya.prototype._displayPieChart=function(t,e,i){var r,n=2*e,o=2*n,a=t.x,s=t.y,u=Dt("g");u.setAttribute(Ga,this._currentElementId),1===i.length&&(r=function(t,e,i,r,n,o,a){void 0===o&&(o=1);var s=Dt("rect");return s.setAttribute("x",t),s.setAttribute("y",e),s.setAttribute("width",i),s.setAttribute("height",r),s.setAttribute("fill",n),s.setAttribute("fill-opacity",o),a&&a.appendChild(s),s}(a-n,s-n,o,o,i[0],1,u)),1<i.length&&Nn(i,(function(t,i,n){var o=a+e*Math.cos(n),d=s+e*Math.sin(n),l=a+e*Math.cos(i),h=s+e*Math.sin(i),c=n-i<=Math.PI?0:1,f="M "+o+","+d+" A "+e+","+e+" 0 "+c+" 0 "+l+","+h+" L "+a+","+s+" L "+o+","+d;(r=Dt("path")).setAttribute("d",f),r.setAttribute("fill",t),r.setAttribute("stroke-width",0),u.appendChild(r)})),this._currentClipPathId&&u.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(u)},Ya);function Ya(t){var e=qa.call(this,t)||this;return e._svg=Dt("svg"),e._defs=Dt("defs"),e._styles=Dt("g",{class:"styles"}),e._background=Dt("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),e._currentElementId="0",e._currentClipPathId=null,e._clipPathCounter=1,e._defs.appendChild(e._styles),e._svg.setAttribute("pointer-events","none"),e._svg.style.userSelect="none",e._svg.appendChild(e._defs),e._svg.appendChild(e._background),e._clear(),e}var Za=(Ka.prototype.reset=function(){this._initialize()},Ka.prototype._initialize=function(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0},Ka.prototype.set=function(t){var e=t.maxCoord,i=t.maxScaledSize,r=t.maxMinVisibleSize,n=t.maxSymbolicSize,o=t.maxDashLength,a=t.maxGapLength,s=t.maxPatternScale,u=this.maxCoord<e||this.maxScaledSize<i||this.maxMinVisibleSize<r||this.maxSymbolicSize<n||this.maxDashLength<o||this.maxGapLength<a||this.maxPatternScale<s;return u&&(this.maxCoord=e,this.maxScaledSize=i,this.maxMinVisibleSize=r,this.maxSymbolicSize=n,this.maxDashLength=o,this.maxGapLength=a,this.maxPatternScale=s,this._mustUpdate=!0),u},Ka.prototype.update=function(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this},Ka.prototype.getVersion=function(){return this._version},Ka);function Ka(){this._version=0,this._initialize()}var Qa={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},Ja=($a.prototype.add=function(t){var e=this;Object.keys(t).forEach((function(i){var r=t[i].slice();r.length<8&&(r[4]=r[0],r[5]=r[1],r[6]=r[2],r[7]=r[3]);var n=j(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]);e._nameToPolygon[i]=r,e._polygonToName[n]=i}))},$a.prototype.getCoefficients=function(t){return this._nameToPolygon[t]||this._linearEasing},$a.prototype.getName=function(t,e,i,r,n,o,a,s){var u=j(t,e,i,r,n,o,a,s);return this._polygonToName[u]||"linear"},$a);function $a(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(Qa)}var ts=(es.prototype.resizeBoundaries=function(t,e,i,r,n,o){this._maxScaledSize=t,this._maxMinVisibleSize=e,this._maxSymbolicSize=i,this._maxDashLength=r,this._maxGapLength=n,this._maxPatternScale=o,this._actualScaledSizeToBytes=65535/t,this._actualMinVisibleSizeToBytes=15/e,this._actualSymbolicSizeToBytes=255/i,this._actualDashLengthToBytes=3/r,this._actualGapLengthToBytes=3/n,this._actualPatternScaleToBytes=255/o},es.prototype.storeGenericObject=function(t,e,i){var r=this._shapeManager.getIdFromName(i.shape),n=i.pieceId,o=this._dashLengthToBytes(i.dashLength),a=this._gapLengthToBytes(i.gapLength),s=+i.hasHead,u=+i.hasTail,d=+i.isBodyTriangle,l=+i.isSelfLoop,h=this._patternScaleToBytes(i.patternScale),c=this._offsetAngleToBytes(i.offsetAngle),f=+i.isText,g=+i.adjustTextAngle,p=+i.isBadge,_=+i.unusedFlag2,v=+i.unusedFlag3,m=this._opacityToBytes(i.opacity),y=this._minVisibleSizeToBytes(i.globalMinVisibleSize),b=this._minVisibleSizeToBytes(i.strokeMinVisibleSize),x=this._minVisibleSizeToBytes(i.patternMinVisibleSize),E=this._symbolicSizeToBytes(i.symbolicSize),A=this._curvatureToBytes(i.curvature),S=this._patternManager.getIdFromDefinition(i.pattern),w=this._colorToBytes(i.fillColor),T=this._colorToBytes(i.strokeColor),C=this._colorToBytes(i.patternColor),M=this._coordToBytes(i.x1),I=this._coordToBytes(i.y1),L=this._coordToBytes(i.x2),N=this._coordToBytes(i.y2),k=this._scaledSizeToBytes(i.rectWidthOrSourceRadiusScaled),O=this._fixedSizeToBytes(i.rectWidthOrSourceRadiusFixed),F=this._scaledSizeToBytes(i.rectHeightOrTargetRadiusScaled),R=this._fixedSizeToBytes(i.rectHeightOrTargetRadiusFixed),P=this._scaledSizeToBytes(i.thicknessOrFontSizeScaled),D=this._fixedSizeToBytes(i.thicknessOrFontSizeFixed),z=this._scaledSizeToBytes(i.strokeWidthScaled),B=this._fixedSizeToBytes(i.strokeWidthFixed),U=this._scaledSizeToBytes(i.offsetScaled),V=this._fixedSizeToBytes(i.offsetFixed),j=this._fixedSizeToBytes(i.pattern.attributes.paddingTop||0),G=this._fixedSizeToBytes(i.pattern.attributes.paddingLeft||0),H=r+(n<<4)+(o<<8)+(a<<10)+(s<<12)+(u<<13)+(d<<14)+(l<<15),W=h+(c<<8)+(f<<11)+(g<<12)+(p<<13)+(_<<14)+(v<<15),q=m+(y<<4)+(b<<8)+(x<<12),X=E+(A<<8);this._setUint16(t,e+0,H),this._setUint16(t,e+2,W),this._setUint16(t,e+4,q),this._setUint16(t,e+6,X),this._setUint16(t,e+8,S),this._setUint16(t,e+10,w),this._setUint16(t,e+12,T),this._setUint16(t,e+14,C),this._setFloat32(t,e+16,M),this._setFloat32(t,e+20,I),this._setFloat32(t,e+24,L),this._setFloat32(t,e+28,N),this._setUint16(t,e+32,k),this._setUint16(t,e+34,O),this._setUint16(t,e+36,F),this._setUint16(t,e+38,R),this._setUint16(t,e+40,P),this._setUint16(t,e+42,D),this._setUint16(t,e+44,z),this._setUint16(t,e+46,B),this._setUint16(t,e+48,U),this._setUint16(t,e+50,V),this._setInt16(t,e+52,j),this._setInt16(t,e+54,G)},es.prototype._setUint16=function(t,e,i){t.setUint16(e,i,this._littleEndian)},es.prototype._setInt16=function(t,e,i){t.setUint16(e,this._signedToUnsignedInt16(i),this._littleEndian)},es.prototype._setFloat32=function(t,e,i){t.setFloat32(e,i,this._littleEndian)},es.prototype._colorToBytes=function(t){var e=this._colorParser(t);return Math.round(15*e[0])+(Math.round(15*e[1])<<4)+(Math.round(15*e[2])<<8)+(Math.round(15*e[3])<<12)},es.prototype._coordToBytes=function(t){return t},es.prototype._scaledSizeToBytes=function(t){return Math.ceil(Math.min(t,this._maxScaledSize)*this._actualScaledSizeToBytes)},es.prototype._fixedSizeToBytes=function(t){return t},es.prototype._minVisibleSizeToBytes=function(t){return Math.round(Math.min(t,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)},es.prototype._symbolicSizeToBytes=function(t){return Math.round(Math.min(t,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)},es.prototype._dashLengthToBytes=function(t){return Math.round(Math.min(t,this._maxDashLength)*this._actualDashLengthToBytes)},es.prototype._gapLengthToBytes=function(t){return Math.round(Math.min(t,this._maxGapLength)*this._actualGapLengthToBytes)},es.prototype._patternScaleToBytes=function(t){return Math.round(Math.min(t,this._maxPatternScale)*this._actualPatternScaleToBytes)},es.prototype._offsetAngleToBytes=function(t){return Math.round((t+fa)%fa*(8/fa))},es.prototype._opacityToBytes=function(t){return Math.round(15*Math.min(t,1))},es.prototype._curvatureToBytes=function(t){return this._signedToUnsignedByte(t)},es.prototype._signedToUnsignedByte=function(t){return qe(t,-128,127)+128},es.prototype._signedToUnsignedInt16=function(t){return qe(t,-32768,32767)+32768},es.prototype.storeAnimationInformation=function(t,e,i,r){var n=i.beginTime,o=i.duration;this._setAnimationBeginTime(t,e,n),this._setAnimationDuration(t,e,o),this._setAnimationEasing(t,e,r)},es.prototype._setAnimationBeginTime=function(t,e,i){this._setFloat32(t,e,i)},es.prototype._setAnimationDuration=function(t,e,i){this._setFloat32(t,e+4,i)},es.prototype._setAnimationEasing=function(t,e,i){this._setUint16(t,e+8,(i[0]+128<<8)+(i[4]+128)),this._setUint16(t,e+10,(i[1]+128<<8)+(i[5]+128)),this._setUint16(t,e+12,(i[2]+128<<8)+(i[6]+128)),this._setUint16(t,e+14,(i[3]+128<<8)+(i[7]+128))},es.prototype.extractGenericElement=function(t,e,i){var r=t.getElementType(),n=t.isAnimated(),o=t.getDataView(),a=e*t.getElementSize(),s=this._genericObject;if(s.valid=!1,o.getUint16(a)&&(s.valid=!0,this._extractGenericObject(s.end,o,a,i),n&&(this._extractGenericObject(s.start,o,56+a,i),this._extractAnimationInformation(s.animation,o,112+a)),s.id=this._idRecorder.get(t,e),2===r)){var u=t.getSideDataView(),d=e*t.getTotalSideElementsSize(),l=d+t.getTotalSideElementsSize();s.end.pattern=this._textManager.extractTextFromDataView(u,d,l)}return s},es.prototype._extractGenericObject=function(t,e,i,r){var n=r.bytesToActualCoord,o=r.bytesToActualScaledSize,a=r.bytesToActualMinVisibleSize,s=r.bytesToActualPatternScale,u=r.bytesToActualSymbolicSize,d=r.bytesToActualDashLength,l=r.bytesToActualGapLength,h=e,c=i,f=this._littleEndian,g=h.getUint16(c,f),p=is(g,0,4),_=is(g,4,8),v=is(g,8,10),m=is(g,10,12),y=is(g,12,13),b=is(g,13,14),x=is(g,14,15),E=is(g,15,16),A=h.getUint16(c+2,f),S=is(A,0,8),w=is(A,8,11),T=is(A,11,12),C=is(A,12,13),M=is(A,13,14),I=is(A,14,15),L=is(A,15,16),N=h.getUint16(c+4,f),k=is(N,0,4),O=is(N,4,8),F=is(N,8,12),R=is(N,12,16),P=h.getUint16(c+6,f),D=is(P,0,8),z=is(P,8,16),B=h.getUint16(c+8,f),U=h.getUint16(c+10,f),V=h.getUint16(c+12,f),j=h.getUint16(c+14,f),G=h.getFloat32(c+16,f),H=h.getFloat32(c+20,f),W=h.getFloat32(c+24,f),q=h.getFloat32(c+28,f),X=h.getUint16(c+32,f),Y=h.getUint16(c+34,f),Z=h.getUint16(c+36,f),K=h.getUint16(c+38,f),Q=h.getUint16(c+40,f),J=h.getUint16(c+42,f),$=h.getUint16(c+44,f),tt=h.getUint16(c+46,f),et=h.getUint16(c+48,f),it=h.getUint16(c+50,f),rt=rs(h.getUint16(c+52,f)),nt=rs(h.getUint16(c+54,f));t.pieceId=_,t.shape=this._shapeManager.getNameFromId(p),t.x1=ns(G,n),t.y1=ns(H,n),t.x2=ns(W,n),t.y2=ns(q,n),t.rectWidthOrSourceRadiusScaled=ns(X,o),t.rectWidthOrSourceRadiusFixed=Y,t.rectHeightOrTargetRadiusScaled=ns(Z,o),t.rectHeightOrTargetRadiusFixed=K,t.thicknessOrFontSizeScaled=ns(Q,o),t.thicknessOrFontSizeFixed=J,t.strokeWidthScaled=ns($,o),t.strokeWidthFixed=tt,t.offsetScaled=ns(et,o),t.offsetFixed=it,t.pattern=this._patternManager.getDefinitionFromId(B),t.pattern.attributes.paddingTop=rt,t.pattern.attributes.paddingLeft=nt,t.opacity=k/15,t.fillColor=as(U),t.strokeColor=as(V),t.patternColor=as(j),t.globalMinVisibleSize=ns(O,a),t.strokeMinVisibleSize=ns(F,a),t.patternMinVisibleSize=ns(R,a),t.offsetAngle=w*(2*Math.PI/8),t.patternScale=S*s,t.symbolicSize=D*u,t.curvature=z-128,t.dashLength=v*d,t.gapLength=m*l,t.hasHead=!!y,t.hasTail=!!b,t.isBodyTriangle=!!x,t.isSelfLoop=!!E,t.isText=!!T,t.adjustTextAngle=!!C,t.isBadge=!!M,t.unusedFlag2=!!I,t.unusedFlag3=!!L},es.prototype._extractAnimationInformation=function(t,e,i){var r=this._littleEndian,n=e.getFloat32(i,r),o=e.getFloat32(i+4,r),a=e.getUint16(i+8,r),s=e.getUint16(i+10,r),u=e.getUint16(i+12,r),d=e.getUint16(i+14,r),l=(a>>8)-128,h=(s>>8)-128,c=(u>>8)-128,f=(d>>8)-128,g=a%256-128,p=s%256-128,_=u%256-128,v=d%256-128;t.beginTime=n,t.duration=o,t.easing=this._easingManager.getName(l,h,c,f,g,p,_,v)},es);function es(t,e,i,r,n,o){this._littleEndian=U(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=32767,this._actualMinVisibleSizeToBytes=15,this._actualSymbolicSizeToBytes=255,this._actualDashLengthToBytes=3,this._actualGapLengthToBytes=3,this._actualPatternScaleToBytes=255,this._genericObject={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}},this._shapeManager=e,this._patternManager=t,this._textManager=i,this._idRecorder=r,this._easingManager=n,this._colorParser=o}function is(t,e,i){return t%(1<<i)>>e}function rs(t){return t-32768}function ns(t,e){return t*e}var os=new Array(65535);function as(t){var e=os[t];if(!e){var i=is(t,0,4)/15,r=is(t,4,8)/15,n=is(t,8,12)/15,o=is(t,12,16)/15;e="rgba("+(255*i|0)+", "+(255*r|0)+", "+(255*n|0)+", "+o+")",i+r+n+o==0&&(e=null),os[t]=e}return e}var ss=(us.prototype.setDepth=function(t){return this._depth=t,this},us.prototype.reset=function(t,e,i,r){return this._elementType=t,this._animated=e,this._depth=i,void 0!==r&&(this._id=r),this._stencilUsage=1,this._size=0,this},us.prototype.setStencilUsage=function(t){this._stencilUsage=t},us.prototype.next=function(){if(this._size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this._size++]},us.prototype.nextAndReset=function(){var t,e=this.next();return e.end=on(e.end),e.start=on(e.start),e.animation=(void 0===(t=e.animation)&&(t={}),t.duration=0,t.beginTime=-1,t.easing="linear",t),e},us.prototype.forEach=function(t){this._list.forEach(t)},us.prototype.getElement=function(t){return this._list[t]},us.prototype.getCurrentElement=function(){return this._list[this._size-1]},us.prototype.getSize=function(){return this._size},us.prototype.getDepth=function(){return this._depth},us.prototype.getElements=function(){return this._list},us.prototype.getType=function(){return this._elementType},us.prototype.getId=function(){return this._id},us.prototype.isAnimated=function(){return this._animated},us.prototype.getStencilUsage=function(){return this._stencilUsage},us.prototype.setGlobalAnimation=function(t,e,i){for(var r=0;r<this._size;++r){var n=this._list[r].animation;n.duration=t,n.beginTime=e,n.easing=i}},us);function us(){this._elementType=1,this._animated=!1,this._size=0,this._capacity=128,this._depth=0,this._id=0,this._stencilUsage=1,this._list=Array(this._capacity);for(var t=0;t<this._capacity;++t)this._list[t]={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}}}var ds=(ls.prototype.reset=function(){this._maps=[]},ls.prototype.set=function(t,e,i){for(var r=t.getId();this._maps.length<=r;)this._maps.push(new Array(512));this._maps[r][e]=i},ls.prototype.get=function(t,e){return this._maps[t.getId()][e]},ls);function ls(){this._maps=[]}var hs={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:function(){return!0},hideImages:!1,renderBackground:!1},cs={webgl:ua,canvas:ka,svg:Xa},fs=[0,0,0,0],gs={webgl:null,svg:null,canvas:null},ps=(_s.createInitData=function(){var t={};for(var e in cs)t[e]=cs[e].createInitData();return t},_s.cacheInitData=function(t){gs=t},_s.getCachedInitData=function(){return gs},_s.clearCachedInitData=function(){gs={webgl:null,svg:null,canvas:null}},_s.prototype.addCanvas=function(t){t.style.touchAction="none",t.style.msContentZooming="none",this._resizeCanvas(t),this._additionalCanvases.push(t),this._updateDomElement()},_s.prototype.removeCanvas=function(t){t.style.touchAction="",t.style.msContentZooming="",P(this._additionalCanvases,t),this._updateDomElement()},_s.prototype._ensureDomElementsFitParent=function(){if(this._domElement.offsetWidth!==this._view.width||this._domElement.offsetHeight!==this._view.height){this._domElement.style.width=this._view.width+"px",this._domElement.style.height=this._view.height+"px";for(var t=0;t<this._additionalCanvases.length;++t)this._resizeCanvas(this._additionalCanvases[t])}},_s.prototype._ensureCorrectBackgroundColor=function(){this._backgroundColor!==this._view.backgroundColor&&(this._domElement.style.backgroundColor=this._view.backgroundColor||"",this._backgroundColor=this._view.backgroundColor)},_s.prototype.createBlock=function(){return new ss},_s.prototype.parseColor=function(t){return this._colorManager.parseColor(t)},_s.prototype.clear=function(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._idRecorder.reset()},_s.prototype.notifyFontsReloaded=function(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0},_s.prototype.notifyPatternUpdate=function(){this._patternManager.notifyUpdate()},_s.prototype.getShapePoints=function(t){return this._shapeManager.getDefinitionFromName(t).points},_s.prototype.checkShapeHit=function(t,e,i){var r=this._shapeManager.getDefinitionFromName(t),n=r.getDistanceFromStrokeVertically,o=r.getDistanceFromStrokeHorizontally;return 0<=Math.min(n(e,i),o(e,i))},_s.prototype.setGlobalBoundaries=function(t){var e=t.maxBlockId,i=void 0===e?0:e,r=t.maxScaledSize,n=t.maxMinVisibleSize,o=t.maxSymbolicSize,a=t.maxDashLength,s=t.maxGapLength,u=t.maxPatternScale;return i>this._blockIdToAddress.length&&this._resizeBlockArray(i),!!this._boundariesManager.set(t)&&(this._memoryManager.resizeBoundaries(r,n,o,a,s,u),!0)},_s.prototype._resizeBlockArray=function(t){var e=new Uint32Array(t);e.set(this._blockIdToAddress),this._blockIdToAddress=e},_s.prototype.registerShape=function(t,e){this._shapeManager.register(t,e)},_s.prototype._bindBlock=function(t,e,i,r,n,o,a){this._checkBlockId(t);var s=this._blockIdToAddress[t],u=this._bufferList.allocateBlock(s,e,i,r,n,o,a);return this._blockIdToAddress[t]=u.address,this._currentDataView=u.buffer.getDataView(),this._currentElementSize=u.buffer.getElementSize(),this._currentBlockOffset=u.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=u.buffer.getSideDataView(),this._currentSideElementSize=u.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,u},_s.prototype._setItemIndex=function(t){var e=this._currentBlockOffset+t;this._currentByteOffset=e*this._currentElementSize,this._currentSideByteOffset=e*this._currentSideElementSize},_s.prototype._freeBlock=function(t){this._checkBlockId(t);var e=this._blockIdToAddress[t],i=this._bufferList.freeBlock(e);return this._blockIdToAddress[t]=i},_s.prototype._checkBlockId=function(t){t>=this._blockIdToAddress.length&&this._resizeBlockArray(He(t+1))},_s.prototype._setTextCharacters=function(t){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,t)},_s.prototype._storeElement=function(t,e){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,t.end),e&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+56,t.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+112,t.animation,this._easingManager.getCoefficients(t.animation.easing)))},_s.prototype.storeBlock=function(t,e){if(!e||!e.getSize())return this._freeBlock(t);var i=e.getType(),r=e.getDepth(),n=e.getSize(),o=e.getElements(),a=e.isAnimated(),s=e.getStencilUsage(),u=e.getId(),d=0;if(2===i)for(var l=0;l<n;++l){var h=(_=o[l]).start,c=_.end;if(7===c.pattern.type){var f=c.pattern.attributes.text;d=Math.max(d,f.length)}a&&7===h.pattern.type&&(f=h.pattern.attributes.text,d=Math.max(d,f.length))}var g=this._bindBlock(t,i,a,r,n,d,s);for(l=0;l<n;++l){var p=o[l];this._setItemIndex(l),this._storeElement(p,a),this._idRecorder.set(g.buffer,g.offset+l,u)}if(2===i)for(l=0;l<n;++l){var _=o[l];this._setItemIndex(l),this._setTextCharacters(_.end.pattern)}return g.address},_s.prototype.freeBlock=function(t){return this._freeBlock(t)},_s.prototype._refreshTextElements=function(){for(var t=0,e=this._bufferList.getBuffers();t<e.length;t++){var i=e[t];if(i&&2===i.getElementType()){for(var r=i.getSideDataView(),n=i.getTotalSideElementsSize(),o=i.getSize(),a=0,s=n,u=0;u<o;++u){var d=this._textManager.extractTextFromDataView(r,a,s);this._textManager.storeTextInDataView(r,a,s,d),a=s,s+=n}i.triggerUpdate()}}},_s.prototype.extractElement=function(t,e){if(void 0===e&&(e=0),!t)return null;var i=this._bufferList.getBlockInfo(t);return this._renderer.extractElement(i.buffer,i.offset+e)},_s.prototype.getDomElement=function(){return this._domElement},_s.prototype.measureText=function(t,e,i,r){return void 0===r&&(r=1),this._textManager.measureText(t,e,i,r)},_s.prototype.setRenderType=function(t){this._renderType!==t&&(this._renderType=t,this._switchMainRenderer=!0)},_s.prototype._ensureMainRendererReady=function(){if(this._switchMainRenderer){null===this._renderType&&(this._renderType="canvas");var t=cs[this._renderType];t&&t.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}},_s.prototype._updateDomElement=function(){for(var t=this._renderer&&this._renderer.getDomElement(),e=this._domElement;e.firstChild;)e.removeChild(e.firstChild);t&&this._appendDomChild(t);for(var i=0;i<this._additionalCanvases.length;++i)this._appendDomChild(this._additionalCanvases[i])},_s.prototype._appendDomChild=function(t){t.style.position="absolute",t.style.left="0",t.style.top="0",this._domElement.appendChild(t)},_s.prototype._instanciateRenderer=function(t){return new(null===t?sn:cs[t])({initData:null===t?null:this._initData[t],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,colorManager:this._colorManager,easingManager:this._easingManager,memoryManager:this._memoryManager})},_s.prototype.setView=function(t){this._view=A(A({},this._view),t)},_s.prototype._updateManagers=function(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())},_s.prototype._resizeCanvas=function(t){an(t,this._view.width,this._view.height,this._view.pixelRatio)},_s.prototype.render=function(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)},_s.prototype.ensureAnimationsReady=function(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()},_s.prototype.export=function(t,e,i){var r=this._instanciateRenderer(t),n=A(A({},this._view),e);return"setViewportClipping"in r&&r.setViewportClipping(!1),n.renderBackground=!0,this._updateManagers(),r.renderFrame(n),r.export(i).then((function(){return r.getDomElement()}))},_s.prototype.getCurrentTime=function(){return Jt()},_s.prototype.getImageData=function(){return this._renderer&&this._renderer.getImageData()},_s.prototype.destroy=function(){for(var t=0,e=Object.keys(this._renderersByType);t<e.length;t++){var i=e[t],r=this._renderersByType[i];r&&r.destroy()}},_s.prototype.transparentify=function(t){var e=this.parseColor(t)||fs;return"rgba("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+",0)"},_s.prototype.initDebugRenderingLoop=function(t){var e=this,i=void 0===t?{}:t,r=i.triggerKey,n=void 0===r?"r":r,o=i.start,a=void 0===o||o;document.addEventListener("keydown",(function(t){t.key===n&&(a=!a)}));var s=function(t){(a||t)&&(e.setView({currentTime:Jt()}),e.render()),window.requestAnimationFrame((function(){s()}))};window.requestAnimationFrame((function(){document.body.appendChild(e.getDomElement()),s(!0)}))},_s);function _s(t){var e=this;this._view=q(hs),this._domElement=gt?document.createElement("div"):Tt(),this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._additionalCanvases=[],this._refreshTexts=!1,this._backgroundColor=null,this._initData=t||{},this._colorManager=new Ir,this._easingManager=new Ja,this._patternManager=new Or,this._shapeManager=new jr,this._boundariesManager=new Za,this._textManager=new Jo(this._patternManager),this._idRecorder=new ds,this._memoryManager=new ts(this._patternManager,this._shapeManager,this._textManager,this._idRecorder,this._easingManager,(function(t){return e.parseColor(t)||fs})),this._bufferList=new qr}var vs,ms=(E(ys,vs=Fo),Object.defineProperty(ys.prototype,"src",{get:function(){return this._src},set:function(t){var e=this;t&&(this._src=t,setTimeout((function(){e.onload&&e.onload.call(e),e.width=1,e.height=1,e.fire("load")}),10))},enumerable:!0,configurable:!0}),ys.prototype.addEventListener=function(t,e){this.on(t,e)},ys);function ys(t,e){var i=vs.call(this)||this;return i.isDummy=!0,i.width=0,i.height=0,i}var bs=(xs.prototype.setImgCrossOrigin=function(t){this._crossOrigin=t},xs.prototype.clear=function(){this._images={},this._nbLoaded=0,this._nbToLoad=0},xs.prototype.getImage=function(t){var e=this,i=this._images[t];return void 0===i&&(this._nbToLoad+=1,(i=new("undefined"!=typeof Image?Image:ms)(void 0,void 0)).crossOrigin=this._crossOrigin,i.onload=function(){return e._onImgLoad(t)},i.onerror=function(){e._onImgLoad(t),e._images[t]=null},i.src=t,this._images[t]=i),i},xs.prototype._onImgLoad=function(t){this._nbLoaded+=1,this._onFetch.forEach((function(e){return e(t)})),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach((function(t){return t()})),this._whenReady=[])},xs.prototype.onFetch=function(t){this._onFetch.push(t)},xs.prototype.whenReady=function(){var t=this;return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise((function(e){return t._whenReady.push(e)}))},xs.prototype.destroy=function(){this._whenReady=[],this._onFetch=[]},xs);function xs(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}function Es(t,e,i,r,n,o,a,s,u){void 0===s&&(s=0),void 0===u&&(u=!1);var d=Pa(i,r,n,o),l=(a/2*(u?Pa(t,e,n,o)/d:1)+s)/d,h=(n-i)*l,c=(o-r)*l,f=i+c,g=r-h,p=t-f,_=e-g,v=i-c-f,m=r+h-g,y=n+c-f,b=o-h-g,x=p*v+_*m,E=p*y+_*b;return 0<x&&x<v*v+m*m&&0<E&&E<y*y+b*b}function As(t,e){return t.x===e.x&&t.y===e.y}function Ss(t,e,i,r){return Math.atan2(r-e,i-t)}function ws(t,e,i,r,n,o,a,s){var u=t-i,d=e-r,l=n-a,h=o-s,c=u*h-l*d,f=(d*(t-n)-u*(e-o))/c;if(f<0||1<f)return null;var g=(l*(o-e)+h*(t-n))/c;return 0<=g&&g<=1?{x:t-g*u,y:e-g*d}:null}function Ts(t,e,i,r,n,o,a,s){var u,d=[];return(u=ws(t,e,i,r,n,o,n,s))&&d.push(u),(u=ws(t,e,i,r,n,s,a,s))&&d.push(u),(u=ws(t,e,i,r,a,s,a,o))&&d.push(u),(u=ws(t,e,i,r,a,o,n,o))&&d.push(u),d}function Cs(t,e,i,r,n,o,a,s){var u=((a-n)*(e-o)-(s-o)*(t-n))/((s-o)*(i-t)-(a-n)*(r-e)),d=((i-t)*(e-o)-(r-e)*(t-n))/((s-o)*(i-t)-(a-n)*(r-e));return 0<=u&&u<=1&&0<=d&&d<=1}function Ms(t,e,i,r,n,o,a,s){return n<=t&&o<=e&&t<=a&&e<=s||n<=i&&o<=r&&i<=a&&r<=s||!!Cs(t,e,i,r,n,o,n,s)||!!Cs(t,e,i,r,a,o,a,s)||!!Cs(t,e,i,r,n,o,a,o)||!!Cs(t,e,i,r,n,s,a,s)}function Is(t,e,i){return Math.sqrt(Ls(t.x,t.y,e.x,e.y,i.x,i.y))}function Ls(t,e,i,r,n,o){var a=Da(i,r,n,o);if(0===a)return Da(t,e,i,r);var s=((t-i)*(n-i)+(e-r)*(o-r))/a;return Da(t,e,i+(s=Math.max(0,Math.min(1,s)))*(n-i),r+s*(o-r))}function Ns(t,e,i,r,n,o){var a=n-i,s=o-r;if(0==a&&0==s)return{x:i,y:r};var u=((t-i)*a+(e-r)*s)/(a*a+s*s);return u<0?{x:i,y:r}:1<u?{x:n,y:o}:{x:i+u*a,y:r+u*s}}function ks(){for(var t=arguments,e=t.length-1,i=e,r=[],n=0;n<=e&&Math.abs(t[n])<=1e-12;n++)e--;switch(e){case 1:!function(t,e,i){void 0===i&&(i=[]),0!==e&&i.push(-t/e)}(t[i],t[i-1],r);break;case 2:!function(t,e,i,r){void 0===r&&(r=[]);var n=e/i,o=n*n-t/i*4;if(0<o){var a=Math.sqrt(o);r.push(.5*(-n+a)),r.push(.5*(-n-a))}else 0==o&&r.push(.5*-n)}(t[i],t[i-1],t[i-2],r);break;case 3:!function(t,e,i,r,n){void 0===n&&(n=[]);var o,a,s=i/r,u=e/r,d=(3*u-s*s)/3,l=(2*s*s*s-9*u*s+t/r*27)/27,h=s/3,c=l*l/4+d*d*d/27,f=l/2;if(Math.abs(c)<=1e-6&&(c=0),0<c){var g=Math.sqrt(c);a=0<=(o=-f+g)?Math.pow(o,1/3):-Math.pow(-o,1/3),0<=(o=-f-g)?a+=Math.pow(o,1/3):a-=Math.pow(-o,1/3),n.push(a-h)}else if(c<0){var p=Math.sqrt(-d/3),_=Math.atan2(Math.sqrt(-c),-f)/3,v=Math.cos(_),m=Math.sin(_),y=Math.sqrt(3);n.push(2*p*v-h),n.push(-p*(v+y*m)-h),n.push(-p*(v-y*m)-h)}else o=0<=f?-Math.pow(f,1/3):Math.pow(-f,1/3),n.push(2*o-h),n.push(-o-h)}(t[i],t[i-1],t[i-2],t[i-3],r)}return r}function Os(t,e,i,r,n,o,a,s,u,d,l){for(var h,c,f=Math.min(a,u),g=Math.min(s,d),p=Math.max(a,u),_=Math.max(s,d),v=ks((h=s-d)*(t+-2*i+n)+(c=u-a)*(e+-2*r+o),h*(-2*t+2*i)+c*(-2*e+2*r),h*t+c*e+(a*d-u*s)),m=0;m<v.length;m++){var y=v[m];if(0<=y&&y<=1){var b=t+(i-t)*y,x=e+(r-e)*y,E=b+(i+(n-i)*y-b)*y,A=x+(r+(o-r)*y-x)*y;if(a===u){if(g<=A&&A<=_){if(!l)return 1;l.push(E,A)}}else if(s===d){if(f<=E&&E<=p){if(!l)return 1;l.push(E,A)}}else if(f<=E&&g<=A&&E<=p&&A<=_){if(!l)return 1;l.push(E,A)}}}return l&&l.length/2}function Fs(t,e,i,r,n,o,a,s,u,d,l){return l?(Os(t,e,i,r,n,o,a,s,u,s,l),Os(t,e,i,r,n,o,u,s,u,d,l),Os(t,e,i,r,n,o,a,d,u,d,l),Os(t,e,i,r,n,o,a,s,a,d,l),l.length/2):a<=t&&t<=u&&s<=e&&e<=d||a<=n&&n<=u&&s<=o&&o<=d||Os(t,e,i,r,n,o,a,s,u,s)||Os(t,e,i,r,n,o,u,s,u,d)||Os(t,e,i,r,n,o,a,d,u,d)||Os(t,e,i,r,n,o,a,s,a,d)?1:0}function Rs(t,e,i,r,n,o,a,s,u,d,l,h,c){for(var f,g,p=Math.min(u,l),_=Math.min(d,h),v=Math.max(u,l),m=Math.max(d,h),y=ks((f=d-h)*(-1*t+3*i+-3*n+a)+(g=l-u)*(-1*e+3*r+-3*o+s),f*(3*t+-6*i+3*n)+g*(3*e+-6*r+3*o),f*(-3*t+3*i)+g*(-3*e+3*r),f*t+g*e+(u*h-l*d)),b=0;b<y.length;b++){var x=y[b];if(0<=x&&x<=1){var E=t+(i-t)*x,A=e+(r-e)*x,S=i+(n-i)*x,w=r+(o-r)*x,T=E+(S-E)*x,C=A+(w-A)*x,M=T+(S+(n+(a-n)*x-S)*x-T)*x,I=C+(w+(o+(s-o)*x-w)*x-C)*x;if(u===l){if(_<=I&&I<=m){if(!c)return 1;c.push(M,I)}}else if(d===h){if(p<=M&&M<=v){if(!c)return 1;c.push(M,I)}}else if(p<=M&&_<=I&&M<=v&&I<=m){if(!c)return 1;c.push(M,I)}}}return c&&c.length/2}function Ps(t,e,i,r,n,o,a,s,u,d,l,h,c){return c?(Rs(t,e,i,r,n,o,a,s,u,d,l,d,c),Rs(t,e,i,r,n,o,a,s,l,d,l,h,c),Rs(t,e,i,r,n,o,a,s,u,h,l,h,c),Rs(t,e,i,r,n,o,a,s,u,d,u,h,c),c.length/2):u<=t&&t<=l&&d<=e&&e<=h||u<=a&&a<=l&&d<=s&&s<=h||Rs(t,e,i,r,n,o,a,s,u,d,l,d)||Rs(t,e,i,r,n,o,a,s,l,d,l,h)||Rs(t,e,i,r,n,o,a,s,u,h,l,h)||Rs(t,e,i,r,n,o,a,s,u,d,u,h)?1:0}function Ds(t,e,i,r,n,o,a,s){return void 0===s&&(s={x:0,y:0}),s.x=(1-t)*(1-t)*e+2*(1-t)*t*o+t*t*r,s.y=(1-t)*(1-t)*i+2*(1-t)*t*a+t*t*n,s}function zs(t,e,i,r,n,o,a,s,u,d,l){void 0===d&&(d=0),void 0===l&&(l=!1);var h=i-2*a+n,c=r-2*s+o,f=-((i-t)*c-(r-e)*h)/((2*a-2*i)*c-(2*s-2*r)*h);if(f<0||1<f)return!1;var g=u/2;return l&&(g*=1-f),g+=d,Pa(Sa(i,a,n,f),Sa(r,s,o,f),t,e)<=g}function Bs(t,e,i,r,n,o,a,s,u,d){void 0===d&&(d={x:0,y:0});var l=(1-t)*(1-t)*(1-t),h=3*t*(1-t)*(1-t),c=3*t*t*(1-t),f=t*t*t;return d.x=l*e+h*o+c*s+f*r,d.y=l*i+h*a+c*u+f*n,d}function Us(t,e,i,r,n,o,a,s,u,d,l,h){var c=Pa(i,r,a,s);if(Math.abs(t-i)>c||Math.abs(e-r)>c)return!1;for(var f,g=.5,p=Pa(t,e,i,r)<Pa(t,e,n,o)?-.01:.01,_=100,v=Bs(g,i,r,n,o,a,s,u,d),m=Pa(t,e,v.x,v.y),y=l/2+h;0<_--&&0<=g&&g<=1&&y<m&&(.001<p||p<-.001);)f=m,Bs(g,i,r,n,o,a,s,u,d,v),f<(m=Pa(t,e,v.x,v.y))?g+=p=-p/2:g+p<0||1<g+p?(p/=2,m=f):g+=p;return m<y}function Vs(t,e,i,r,n,o,a){void 0===a&&(a={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});var s=t+2/3*(i-t),u=e+2/3*(r-e);return js(t,e,s,u,s+1/3*(n-t),u+1/3*(o-e),n,o,a)}function js(t,e,i,r,n,o,a,s,u){void 0===u&&(u={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});var d,l,h,c,f,g=Math.min,p=Math.max,_=Math.sqrt;u.minX=g(t,a),u.maxX=p(t,a),u.minY=g(e,s),u.maxY=p(e,s);for(var v=void 0,m=void 0,y=void 0,b=void 0,x=void 0,E=void 0,A=void 0,S=0;S<2;++S)if(f=0===S?(l=t,h=i,c=n,a):(l=e,h=r,c=o,s),m=6*l-12*h+6*c,v=-3*l+9*h-9*c+3*f,y=3*h-3*l,m|=0,y|=0,0!=(v|=0))(x=m*m-4*y*v)<0||(0<(E=(-m+_(x))/(2*v))&&E<1&&(d=Gs(E,l,h,c,f),0===S?(u.minX=g(u.minX,d),u.maxX=p(u.maxX,d)):(u.minY=g(u.minY,d),u.maxY=p(u.maxY,d))),0<(A=(-m-_(x))/(2*v))&&A<1&&(d=Gs(A,l,h,c,f),0===S?(u.minX=g(u.minX,d),u.maxX=p(u.maxX,d)):(u.minY=g(u.minY,d),u.maxY=p(u.maxY,d))));else{if(0===m)continue;0<(b=-y/m)&&b<1&&(d=Gs(b,l,h,c,f),0===S?(u.minX=g(u.minX,d),u.maxX=p(u.maxX,d)):(u.minY=g(u.minY,d),u.maxY=p(u.maxY,d)))}return u}function Gs(t,e,i,r,n){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*i+3*(1-t)*Math.pow(t,2)*r+Math.pow(t,3)*n}var Hs={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}},Ws=(qs.prototype.getDefinition=function(){return this._attributesManager.getAttributeLayerDefinition(this._id)},qs.prototype.update=function(t){this._attributesManager.updateAttributeLayer(this._id,t)},qs.prototype.destroy=function(){this._attributesManager.destroyAttributeLayer(this._id)},qs.prototype.updateElements=function(t){this._attributesManager.updateElementsForAttributeLayer(this._id,t)},qs.prototype.updateAll=function(){this._attributesManager.updateAllForAttributeLayer(this._id)},qs.prototype.setAttributeValues=function(t,e,i){this._attributesManager.setAttributeLayerValues(this._id,t,e,i)},qs.prototype.getUsedAttributeNames=function(t){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,t)},qs.prototype.getFlexArrays=function(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)},qs);function qs(t,e){this._attributesManager=t,this._id=e}var Xs={storage:1,default:0},Ys=(Zs.prototype._getAllIndexes=function(){for(var t=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),e=new Uint32Array(t),i=1;i<=t;++i)e[i-1]=i;return e},Zs.prototype.addAll=function(){this._all=!0},Zs.prototype.add=function(t){if(!this._all)for(var e=0;e<t._indexes.length;e++){var i=t._indexes[e];this.addIndex(i)}},Zs.prototype.addIndex=function(t){0===this._flexArray.get(t)&&(this._flexArray.set(t,1),this._indexList.push(t))},Zs.prototype.isEmpty=function(){return!this._all&&this._indexList.isEmpty()},Zs.prototype.isFull=function(){return this._all},Zs.prototype.getListAndClear=function(){var t=this.getList();return this.clear(),t},Zs.prototype.getList=function(){var t;if(this._all&&!this._includeRemovedElements)t=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{var e=this._all?this._getAllIndexes():this._indexList.slice();t=this._eltList(e)}return t},Zs.prototype.clear=function(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())},Zs.prototype.addSet=function(t){if(t._all)this.addAll();else for(var e=t._indexList.getBuffer(),i=t._indexList.getLength(),r=0;r<i;++r)this.addIndex(e[r])},Zs);function Zs(t){var e=t.graph,i=t.isNode,r=t.includeRemovedElements;this._all=!1,this._isNode=i,this._graph=e,this._includeRemovedElements=r,this._eltList=i?this._graph.nodeList:this._graph.edgeList,this._flexArray=i?this._graph.createNodeAttribute(Xs):this._graph.createEdgeAttribute(Xs),this._all=!1,this._indexList=this._graph.createIndexList(i)}function Ks(t){return"string"==typeof t}function Qs(t,e){return t?t+"."+e:e}function Js(t){return"boolean"==typeof t||0===t||1===t?t:void 0}function $s(t){return"number"==typeof t&&isFinite(t)?t:void 0}function tu(t){return"number"==typeof t&&isFinite(t)&&0<=t?t:void 0}var eu=new Function("x","return (typeof x === 'number' && isFinite(x)\n    && x >= -100\n    && x <= 400)\n    ? x : undefined;");function iu(t){return null===t||"string"==typeof t||"number"==typeof t?t:void 0}function ru(t){return"fixed"===t||"scaled"===t?t:void 0}function nu(t,e){return e.parseColor(t)?t:void 0}function ou(t,e){return"inherit"===t||e.parseColor(t)?t:void 0}function au(t){return null===t?null:"string"==typeof t?t.split(",").map((function(t){var e=t.trim(),i=-1!==e.indexOf(" "),r=e[0];return i&&'"'!==r&&"'"!==r?'"'+e+'"':e})).join(","):void 0}function su(t){return"none"===t?"normal":"normal"===t||"italic"===t||"bold"===t||"italic bold"===t||"bold italic"===t?t:void 0}function uu(t){return"left"===t||"center"===t?t:void 0}function du(t){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(t)?t:void 0}function lu(t){return new Function("x","if (typeof x === 'number') {\n      return (typeof x === 'number' && isFinite(x) && x >= 0) ? x : undefined;\n    }\n    if (typeof x !== 'string' || x.charAt(x.length - 1) !== '%') {\n      return undefined;\n    }\n    var p = parseFloat(x);\n    return isNaN(p) ? undefined : ("+t+" * p / 100);")}function hu(t){return{_check:iu,_set:new Function("flexArrays","index","value",["flexArrays.badges."+t+".text.content.set(index, value);","if (value === null || value === undefined) flexArrays.badges."+t+".image.url.set(index, value);"].join("\n")),_get:new Function("flexArrays","index","return flexArrays.badges."+t+".text.content.get(index);"),color:{_flexArray:"white",_check:ou},scale:{_flexArray:.45,_check:lu(.45)},positionScale:{_flexArray:1,_check:tu},minVisibleSize:{_flexArray:12,_check:lu(12)},image:{_alias:"badges."+t+".image.url",url:{_flexArray:null,_check:iu},scale:{_flexArray:1,_check:lu(1)}},stroke:{color:{_flexArray:"black",_check:ou},width:{_flexArray:2,_check:lu(2)},scalingMethod:{_flexArray:"fixed",_check:ru}},text:{_alias:"badges."+t+".text.content",content:{_flexArray:null,_check:iu},color:{_flexArray:"black",_check:ou},font:{_flexArray:"Arial",_check:au},style:{_flexArray:"normal",_check:su},paddingLeft:{_flexArray:0,_check:$s},paddingTop:{_flexArray:0,_check:$s},scale:{_flexArray:.5,_check:lu(.5)}},threshold:"badges."+t+".minVisibleSize"}}var cu={_check:Js,_get:function(t,e){return 0===t.opacity.get(e)},_set:function(t,e,i){t.opacity.set(e,void 0===i?void 0:+!i)}},fu={x:{_flexArray:0,_check:$s,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:$s,_disableMemoryOptimization:!0},radius:{_flexArray:5,_check:lu(5)},scalingMethod:{_flexArray:"scaled",_check:ru},color:{_flexArray:"grey",_check:function(t,e){if(e.parseColor(t))return t;if(Array.isArray(t)){if(t.length<1)return;for(var i=0;i<t.length;++i)if(!e.parseColor(t[i]))return;return t}}},opacity:{_flexArray:1,_check:tu},hidden:cu,shape:{_flexArray:"circle",_check:function(t){return"equilateral"===t?"pentagon":"circle"===t||"square"===t||"cross"===t||"diamond"===t||"pentagon"===t||"star"===t?t:void 0}},layer:{_flexArray:0,_check:eu},detectable:{_flexArray:!0,_check:Js},draggable:{_flexArray:!0,_check:Js},layoutable:{_flexArray:!0,_check:Js},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:2,_check:lu(2)},scalingMethod:{_flexArray:"fixed",_check:ru},color:{_flexArray:"white",_check:ou},minVisibleSize:{_flexArray:12,_check:lu(12)},threshold:"innerStroke.minVisibleSize"},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:5,_check:lu(5)},scalingMethod:{_flexArray:"fixed",_check:ru},color:{_flexArray:null,_check:ou},minVisibleSize:{_flexArray:0,_check:lu(0)},threshold:"outerStroke.minVisibleSize"},badges:{_check:function(t){return null===t?t:void 0},_set:function(t,e,i){t.badges.topLeft.text.content.set(e,i),t.badges.topLeft.image.url.set(e,i),t.badges.topRight.text.content.set(e,i),t.badges.topRight.image.url.set(e,i),t.badges.bottomLeft.text.content.set(e,i),t.badges.bottomLeft.image.url.set(e,i),t.badges.bottomRight.text.content.set(e,i),t.badges.bottomRight.image.url.set(e,i)},topLeft:hu("topLeft"),topRight:hu("topRight"),bottomLeft:hu("bottomLeft"),bottomRight:hu("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:null,_check:nu},width:{_flexArray:50,_check:lu(50)},scalingMethod:{_flexArray:"fixed",_check:ru},strokeColor:{_flexArray:null,_check:nu},strokeWidth:{_flexArray:1,_check:lu(1)},clustering:{_flexArray:!1,_check:Js},hideNonAdjacentEdges:{_flexArray:!1,_check:Js},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Js},duration:{_flexArray:1e3,_check:tu},interval:{_flexArray:800,_check:tu},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:ou},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:ou},width:{_flexArray:50,_check:tu},startRatio:{_flexArray:1,_check:tu},endRatio:{_flexArray:2,_check:tu}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:iu},font:{_flexArray:"Arial",_check:au},color:{_flexArray:"black",_check:nu},scale:{_flexArray:.7,_check:lu(.7)},style:{_flexArray:"normal",_check:su},minVisibleSize:{_flexArray:12,_check:lu(12)},threshold:"icon.minVisibleSize"},image:{_alias:"image.url",url:{_flexArray:null,_check:iu},scale:{_flexArray:1,_check:lu(1)},fit:{_flexArray:!0,_check:Js},tile:{_flexArray:!1,_check:Js},minVisibleSize:{_flexArray:12,_check:lu(12)},rescale:"image.fit",duplicate:"image.tile",threshold:"image.minVisibleSize"},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Js},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:nu},minVisibleSize:{_flexArray:12,_check:lu(12)}},text:{_alias:"text.content",content:{_flexArray:null,_check:iu},font:{_flexArray:"Arial",_check:au},color:{_flexArray:"black",_check:ou},size:{_flexArray:12,_check:lu(12)},scale:{_flexArray:.1,_check:tu},style:{_flexArray:"normal",_check:su},align:{_flexArray:"center",_check:uu},margin:{_flexArray:10,_check:lu(10)},padding:{_flexArray:2,_check:lu(2)},backgroundColor:{_flexArray:null,_check:ou},tip:{_flexArray:!0,_check:Js},minVisibleSize:{_flexArray:24,_check:lu(24)},scaling:{_flexArray:!1,_check:Js},position:{_flexArray:"bottom",_check:function(t){return"top"===t||"bottom"===t||"left"===t||"right"===t||"center"===t?t:void 0}},maxLineLength:{_flexArray:0,_check:tu},truncateLength:{_flexArray:0,_check:tu},backgroundArrowBaseSize:"text.margin",backgroundMargin:"text.padding",threshold:"text.minVisibleSize",secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:iu},font:{_flexArray:"Arial",_check:au},color:{_flexArray:"black",_check:ou},size:{_flexArray:10,_check:lu(10)},scale:{_flexArray:.08,_check:tu},style:{_flexArray:"normal",_check:su},align:{_flexArray:"center",_check:uu},margin:{_flexArray:5,_check:lu(5)},padding:{_flexArray:2,_check:lu(2)},backgroundColor:{_flexArray:null,_check:ou},minVisibleSize:{_flexArray:24,_check:lu(24)},backgroundArrowBaseSize:"text.secondary.margin",backgroundMargin:"text.secondary.padding",threshold:"text.secondary.minVisibleSize"}}},gu={width:{_flexArray:1,_check:lu(1)},scalingMethod:{_flexArray:"scaled",_check:ru},color:{_flexArray:"grey",_check:function(t,e){return"source"===t||"target"===t||e.parseColor(t)?t:void 0}},opacity:{_flexArray:1,_check:tu},hidden:cu,minVisibleSize:{_flexArray:0,_check:tu},threshold:"minVisibleSize",layer:{_flexArray:0,_check:eu},detectable:{_flexArray:!0,_check:Js},curvature:{_flexArray:0,_check:$s},adjustAnchors:{_flexArray:!0,_check:Js},shape:{_check:function(t){return["line","tapered","arrow","dashed","dotted"].includes(t)?t:void 0},_set:function(t,e,i){var r=void 0,n=void 0,o=void 0,a=void 0;"line"===i?(r="line",n="plain",a=o=null):"arrow"===i?(r="line",n="plain",o="arrow",a=null):"tapered"===i?(r="triangle",n="plain",a=o=null):"dashed"===i?(r="line",n="dashed",a=o=null):"dotted"===i&&(r="line",n="dotted",a=o=null),t.shape.type.set(e,r),t.shape.style.set(e,n),t.shape.head.set(e,o),t.shape.tail.set(e,a)},type:{_flexArray:"line",_check:function(t){return"line"===t||"triangle"===t?t:void 0}},head:{_flexArray:null,_check:du},tail:{_flexArray:null,_check:du},style:{_flexArray:"plain",_check:function(t){return"plain"===t||"dashed"===t||"dotted"===t?t:void 0}}},stroke:{color:{_flexArray:"inherit",_check:ou},width:{_flexArray:0,_check:lu(0)},scalingMethod:{_flexArray:"fixed",_check:ru},minVisibleSize:{_flexArray:0,_check:tu}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:null,_check:nu},width:{_flexArray:10,_check:lu(10)},scalingMethod:{_flexArray:"fixed",_check:ru},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Js},duration:{_flexArray:1e3,_check:tu},interval:{_flexArray:800,_check:tu},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:ou},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:ou},width:{_flexArray:10,_check:tu},startRatio:{_flexArray:1,_check:tu},endRatio:{_flexArray:2,_check:tu}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Js},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:nu},minVisibleSize:{_flexArray:0,_check:tu}},text:{_alias:"text.content",content:{_flexArray:null,_check:iu},font:{_flexArray:"Arial",_check:au},color:{_flexArray:"black",_check:nu},size:{_flexArray:12,_check:lu(12)},scale:{_flexArray:1,_check:tu},style:{_flexArray:"normal",_check:su},align:{_flexArray:"center",_check:uu},margin:{_flexArray:2,_check:$s},padding:{_flexArray:2,_check:lu(2)},backgroundColor:{_flexArray:null,_check:ou},minVisibleSize:{_flexArray:4,_check:tu},threshold:"text.minVisibleSize",adjustAngle:{_flexArray:!0,_check:Js},scaling:{_flexArray:!1,_check:Js},maxLineLength:{_flexArray:0,_check:tu},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:iu},font:{_flexArray:"Arial",_check:au},color:{_flexArray:"black",_check:nu},size:{_flexArray:12,_check:lu(12)},scale:{_flexArray:.8,_check:tu},style:{_flexArray:"normal",_check:su},align:{_flexArray:"center",_check:uu},margin:{_flexArray:2,_check:$s},padding:{_flexArray:2,_check:lu(2)},backgroundColor:{_flexArray:null,_check:ou},minVisibleSize:{_flexArray:4,_check:tu},threshold:"text.secondary.minVisibleSize"}}};function pu(){}function _u(){}function vu(t,e){if(!t._check)throw new Error("error somewhere for "+e);return{check:t._check,set:new Function("flexArrays","index","value","flexArrays."+e+".set(index, value);"),get:new Function("flexArrays","index","return flexArrays."+e+".get(index);"),nested:{}}}function mu(t,e,i){if(void 0!==(e=e||t)._flexArray)return vu(e,i);var r={check:null,get:null,set:null,nested:{}};if(Ks(e)||e._alias){var n=Ks(e)?e:e._alias;r=vu(d=Y(t,n),n)}else{if(e._set?(r.set=e._set,r.check=e._check):(r.set=pu,r.check=_u),e._get)r.get=e._get;else{var o="return "+function t(e,i){if(void 0!==e._flexArray)return"flexArrays."+i+".get(index)";for(var r=[],n=0,o=Object.keys(e);n<o.length;n++){var a=o[n],s=e[a];if(!a.startsWith("_")&&et(s)){var u=t(e[a],Qs(i,a));u&&r.push(a+": "+u)}}return r.length?"{\n"+r.join(",\n").split("\n").map((function(t){return"  "+t})).join("\n")+"\n}":""}(e,i)+";";r.get=new Function("flexArrays","index",o)}r.nested={}}if(!Ks(e))for(var a=0,s=Object.keys(e);a<s.length;a++){var u=s[a],d=e[u];u.startsWith("_")||(r.nested[u]=mu(t,d,Qs(i,u)))}return r}function yu(t){return t}function bu(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}var xu=mu(fu),Eu=mu(gu),Au={name:"animationStart",storage:32,default:0},Su={name:"animationDuration",storage:16,default:0},wu={name:"animationEasing",storage:"resource",default:"linear"},Tu={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},Cu={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},Mu={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1},Iu=Object.freeze({__proto__:null,linear:yu,quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:bu,cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}}),Lu=[];function Nu(t){var e=Lu;return void 0===t.output?("function"==typeof t.attributes&&(e="all"),et(t.attributes)&&(e=Q(t.attributes))):t.output&&(e=t.output.attributes),Du(e,t.allAttributePaths)}function ku(t,e,i,r,n,o){!function(t,e,i,r){if(i<r)for(var n=0,o=e.attributes;n<o.length;n++)for(var a=o[n],s=0,u=t.attributes;s<u.length;s++)if(u[s]===a)return 1;for(var d=0,l=e.tags;d<l.length;d++)for(var h=l[d],c=0,f=t.tags;c<f.length;c++)if(h===f[c])return 1}(i,r,n,o)||t.push(e)}function Ou(t){var e=t.dependencies;void 0===e?e=Tu:et(e)||(e={});var i=J(t.attributes).some((function(t){return"function"==typeof t})),r=t.selector&&!t.standaloneSelector,n=!(!i&&!r),o=e.adjacentEdges;return!o&&e.adjacentNodes&&(o=!0),{self:Ru(e.self,n,t.allAttributePaths),adjacentNodes:Ru(e.adjacentNodes,n,t.allAttributePaths),adjacentEdges:Ru(o,n,t.allAttributePaths),allNodes:Ru(e.allNodes,n,t.allAttributePaths),allEdges:Ru(e.allEdges,n,t.allAttributePaths)}}function Fu(t){var e=t.dependencies;void 0===e?e=Cu:et(e)||(e={});var i=J(t.attributes).some((function(t){return"function"==typeof t})),r=t.selector&&!t.standaloneSelector,n=!(!i&&!r);return{self:Ru(e.self,n,t.allAttributePaths),extremities:Ru(e.extremities,n,t.allAttributePaths),parallelEdges:Ru(e.parallelEdges,n,t.allAttributePaths),allNodes:Ru(e.allNodes,n,t.allAttributePaths),allEdges:Ru(e.allEdges,n,t.allAttributePaths)}}function Ru(t,e,i){if(!e)return{attributes:[],tags:[]};if(!0===t)return{attributes:[],tags:[oi]};var r,n={attributes:Du((t=t||{}).attributes,i),tags:(r=t.tags,Array.isArray(r)?r.filter(Ks):[])};return t.data&&n.tags.push(ai),t.selection&&n.tags.push(di),t.hover&&n.tags.push(si),n}function Pu(t){return Array.isArray(t)?t.join("."):t}function Du(t,e){if("all"===t)return e.slice();if(!Array.isArray(t))return[];var i=function(t){return t.map(Pu).filter(Ks)}(t);return e?e.filter((function(t){return i.some((function(e){return t.startsWith(e)}))})):i}var zu=(Bu.prototype.clear=function(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()},Bu.prototype.getAttributeFlexArrays=function(){return this._finalFlexArraysWrapped},Bu.prototype.getPrevAttributeFlexArrays=function(){return this._prevFlexArrays},Bu.prototype.getAnimationInformation=function(t){for(var e=t._indexes,i=Array(e.length),r=0;r<e.length;r++){var n=e[r];i[r]={duration:this._finalFlexArraysWrapped.animationDuration.get(n),start:this._finalFlexArraysWrapped.animationStart.get(n),easing:this._finalFlexArraysWrapped.animationEasing.get(n)}}return i},Bu.prototype.startUpdate=function(){},Bu.prototype.prepareFlexArraysUpdate=function(t){this._currentFlexArrays=t.inputFlexArrays},Bu.prototype.setLastFlexArrays=function(t){this._lastFlexArrays=t},Bu.prototype.updateFlexArrays=function(t){var e=t.attributes,i=t.selector,r=t.context,n=t.outputFlexArrays,o=t.toUpdate,a=t.formattedOutput;this._elementsUpdated.addSet(o),this._elementsToRedraw.addSet(o);var s=o.getListAndClear();if(e&&s.size){for(var u=Pi(this._graph,s,i,r),d=u.valid,l=u.invalid,h=0,c=a.attributes;h<c.length;h++)for(var f=Y(n,c[h]),g=0;g<l._indexes.length;g++){var p=l._indexes[g];f.set(p,void 0)}this._assignAttributesToFlexArrays(this._accessors,n,d,e,r),this._addUpdatedAttributes(t)}},Bu.prototype.endUpdate=function(){for(var t=this._elementsUpdated.getList(),e=0,i=ao(this._updatedAttributesTmp);e<i.length;e++)for(var r=i[e],n=Y(this._lastFlexArrays,r),o=Y(this._finalFlexArrays,r),a=0;a<t._indexes.length;a++){var s=t._indexes[a];o.set(s,n.get(s))}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays},Bu.prototype.setAttributeValues=function(t,e,i,r,n){var o=t.outputFlexArrays,a=this._accessors;this._assignAttributesToFlexArrays(a,o,e,i,null),this._addUpdatedAttributes(t,r),this._elementsUpdated.add(e),this._elementsToRedraw.add(e)},Bu.prototype.notifyLayerDestroyed=function(t){this._addUpdatedAttributes(t)},Bu.prototype._addUpdatedAttributes=function(t,e){for(var i=t.outputFlexArrays,r=t.formattedOutput,n=0,o=Array.isArray(e)?Du(e):r.attributes;n<o.length;n++){var a=o[n];Y(i,a).isInitialized()&&(this._updatedAttributes.add(a),this._updatedAttributesTmp.add(a),this._allUsedAttributes.add(a))}},Bu.prototype.addUpdatedAttribute=function(t){this._updatedAttributes.add(t),this._updatedAttributesTmp.add(t),this._allUsedAttributes.add(t)},Bu.prototype.getUsedAttributeNames=function(t){return function t(e,i,r){return void 0===i&&(i=[]),void 0===r&&(r=""),e.constructor===Ue?e.isInitialized()&&i.push(r):e.constructor===Object&&Object.keys(e).forEach((function(n){t(e[n],i,Qs(r,n))})),i}(t.outputFlexArrays)},Bu.prototype.redrawElements=function(t){this._elementsToRedraw.add(t)},Bu.prototype.redrawAll=function(){this._elementsToRedraw.addAll()},Bu.prototype.getAndResetElementsToRedraw=function(){return this._elementsToRedraw.getListAndClear()},Bu.prototype.getAndResetElementsUpdated=function(){return this._elementsUpdated.getListAndClear()},Bu.prototype.getAndResetAttributesUpdated=function(){var t=ao(this._updatedAttributes);return this._updatedAttributes.clear(),t},Bu.prototype.getUpdatedAttributes=function(){return this._updatedAttributes},Bu.prototype.getUpdatedElementsList=function(){return this._elementsUpdated.getList()},Bu.prototype.getUpdatedAttributesSet=function(){return new Set(this._updatedAttributes)},Bu.prototype.createFlexArrays=function(){return this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!1})},Bu.prototype.getAttributeValues=function(t,e,i,r){var n=r?this._prevFlexArrays:this._currentFlexArrays;return i?this._getMultipleAttributeValues(t,e,n):this._getSingleAttributeValues(t,e,n)},Bu.prototype._getAccessor=function(t){void 0===t&&(t="");for(var e=this._accessors,i=z(t),r=0,n=i;r<n.length;r++){var o=n[r];if(!(e=e.nested[o]))throw new Error(this._eltName+' attribute "'+i.join("")+'" does not exist')}return e},Bu.prototype._getSingleAttributeValues=function(t,e,i){for(var r=this._getAccessor(e),n=t._indexes,o=Array(n.length),a=0;a<n.length;a++)o[a]=r.get(i,n[a]);return o},Bu.prototype._getMultipleAttributeValues=function(t,e,i){if(!e||"all"===e)return this._getSingleAttributeValues(t,"",i);for(var r=Array(t.size),n=0;n<r.length;++n)r[n]={};for(n=0;n<e.length;n++)for(var o=e[n],a=this._getSingleAttributeValues(t,o,i),s=0;s<r.length;++s)X(r[s],o,a[s]);return r},Bu.prototype.setAnimationAttributes=function(t,e){var i=e.duration,r=e.startTime,n=e.easing,o=t._indexes,a=this._finalFlexArraysWrapped.animationDuration,s=this._finalFlexArraysWrapped.animationStart,u=this._finalFlexArraysWrapped.animationEasing,d=ao(this._allUsedAttributes);if(i){for(var l=!1,h=0,c=d;h<c.length;h++){var f=c[h];if("x"!==f&&"y"!==f)for(var g=Y(this._finalFlexArrays,f),p=Y(this._prevFlexArrays,f),_=0;_<o.length;_++){var v=o[_];p.set(v,g.get(v))}else l=!0}if(l){var m=Jt(),y=this._finalFlexArrays.x,b=this._finalFlexArrays.y,x=this._prevFlexArrays.x,E=this._prevFlexArrays.y;for(_=0;_<o.length;_++){v=o[_];var A=a.get(v);if(A){var S=s.get(v),w=u.get(v),T=(Iu[w]||yu)(Math.min((m-S)/A,1)),C=Xe(x.get(v),y.get(v),T),M=Xe(E.get(v),b.get(v),T);x.set(v,C),E.set(v,M)}else x.set(v,y.get(v)),E.set(v,b.get(v))}}}a.fill(o,i),s.fill(o,r),u.fill(o,n)},Bu.prototype.resetAnimationAttributes=function(t){this._finalFlexArraysWrapped.animationDuration.fill(t._indexes,0)},Bu.prototype.getUsedAttributes=function(){return ao(this._allUsedAttributes)},Bu.prototype.getDefaultFlexArrays=function(){return this._defaultFlexArrays},Bu.prototype._assignAttributesToFlexArrays=function(t,e,i,r,n,o){if(void 0===o&&(o=[]),"function"==typeof r){for(var a=o.join("."),s=0;s<i.size;++s)if(p=i.get(s)){var u=r(p,n,a);this._assignSingleValueToFlexArray(e,p,t,u,o)}}else if(et(r)){var d=Object.keys(r);for(s=0;s<d.length;++s){var l=d[s];o.push(l);var h=this._getNestedAccessor(t,l,o),c=r[l];this._assignAttributesToFlexArrays(h,e,i,c,n,o),o.pop()}}else if((Array.isArray(r)||ArrayBuffer.isView(r))&&"color"!==o[0])if(o.length)for(s=0;s<i.size;++s){var f=i._indexes[s],g=t.check(r[s],this._colorManager);t.set(e,f,g)}else for(s=0;s<i.size;++s)this._assignSingleValueToFlexArray(e,i.get(s),t,r[s],o);else for(g=t.check(r,this._colorManager),s=0;s<i.size;++s){var p=i.get(s);t.set(e,p._index,g)}},Bu.prototype._getNestedAccessor=function(t,e,i){var r=t.nested[e];if(!r)throw new Error(this._eltName+' attribute "'+i.join(".")+'" does not exist');return r},Bu.prototype._assignSingleValueToFlexArray=function(t,e,i,r,n){if(et(r))for(var o=0,a=Object.keys(r);o<a.length;o++){var s=a[o];n.push(s);var u=r[s],d=this._getNestedAccessor(i,s,n);this._assignSingleValueToFlexArray(t,e,d,u,n),n.pop()}else{var l=i.check(r,this._colorManager);i.set(t,e._index,l)}},Bu);function Bu(t,e,i,r){this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._colorManager=e,this._graph=t,this._eltName=i?"node":"edge",this._accessors=i?xu:Eu,this._createFlexArrays=r,this._finalFlexArrays=this._createFlexArrays(t,{named:!0,useDefaultValues:!0}),this._prevFlexArrays=this._createFlexArrays(t,{named:!1,useDefaultValues:!0}),this._defaultFlexArrays=this._createFlexArrays(t,{named:!1,useDefaultValues:!0}),this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new Ys({graph:t,isNode:i,includeRemovedElements:!0}),this._elementsUpdated=new Ys({graph:t,isNode:i,includeRemovedElements:!1}),this._finalFlexArraysWrapped=A(A(A({},this._finalFlexArrays),{excluded:t.getAttribute(i,"excluded"),textHidden:t.getAttribute(i,"textHidden"),animationStart:t.createAttribute(i,Au),animationDuration:t.createAttribute(i,Su),animationEasing:t.createAttribute(i,wu),id:this._graph.getAttribute(i,"id")}),!i&&{source:t.getEdgeAttribute("source"),target:t.getEdgeAttribute("target")})}function Uu(t,e){var i=e.named,r=e.useDefaultValues,n="resource";return{x:t.createAttribute(!0,{storage:"any",default:r?0:void 0,name:i?"x":void 0}),y:t.createAttribute(!0,{storage:"any",default:r?0:void 0,name:i?"y":void 0}),radius:t.createAttribute(!0,{storage:n,default:r?5:void 0,name:i?"radius":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"scaled":void 0,name:i?"scalingMethod":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"grey":void 0,name:i?"color":void 0}),opacity:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"opacity":void 0}),shape:t.createAttribute(!0,{storage:n,default:r?"circle":void 0,name:i?"shape":void 0}),layer:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"layer":void 0}),detectable:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"detectable":void 0}),draggable:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"draggable":void 0}),layoutable:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"layoutable":void 0}),innerStroke:{width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"innerStroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"innerStroke.scalingMethod":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"innerStroke.color":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"innerStroke.minVisibleSize":void 0})},outerStroke:{width:t.createAttribute(!0,{storage:n,default:r?5:void 0,name:i?"outerStroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"outerStroke.scalingMethod":void 0}),color:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"outerStroke.color":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"outerStroke.minVisibleSize":void 0})},badges:{topLeft:{color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"badges.topLeft.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.45:void 0,name:i?"badges.topLeft.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.topLeft.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"badges.topLeft.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.topLeft.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.topLeft.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.topLeft.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"badges.topLeft.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"badges.topLeft.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.topLeft.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.topLeft.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"badges.topLeft.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"badges.topLeft.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.5:void 0,name:i?"badges.topLeft.text.scale":void 0}),paddingLeft:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"badges.topLeft.text.paddging.left":void 0}),paddingTop:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"badges.topLeft.text.paddging.top":void 0})}},topRight:{color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"badges.topRight.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.45:void 0,name:i?"badges.topRight.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.topRight.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"badges.topRight.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.topRight.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.topRight.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.topRight.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"badges.topRight.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"badges.topRight.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.topRight.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.topRight.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"badges.topRight.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"badges.topRight.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.5:void 0,name:i?"badges.topRight.text.scale":void 0}),paddingTop:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"badges.topRight.text.paddging.left":void 0}),paddingLeft:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"badges.topRight.text.paddging.top":void 0})}},bottomLeft:{color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"badges.bottomLeft.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.45:void 0,name:i?"badges.bottomLeft.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.bottomLeft.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"badges.bottomLeft.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.bottomLeft.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.bottomLeft.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.bottomLeft.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"badges.bottomLeft.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.bottomLeft.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.bottomLeft.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"badges.bottomLeft.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"badges.bottomLeft.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.5:void 0,name:i?"badges.bottomLeft.text.scale":void 0}),paddingLeft:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"badges.bottomLeft.text.paddging.left":void 0}),paddingTop:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"badges.bottomLeft.text.paddging.top":void 0})}},bottomRight:{color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"badges.bottomRight.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.45:void 0,name:i?"badges.bottomRight.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.bottomRight.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"badges.bottomRight.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.bottomRight.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.bottomRight.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.bottomRight.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"badges.bottomRight.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.bottomRight.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.bottomRight.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"badges.bottomRight.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"badges.bottomRight.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.5:void 0,name:i?"badges.bottomRight.text.scale":void 0}),paddingLeft:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"badges.bottomRight.text.paddging.left":void 0}),paddingTop:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"badges.bottomRight.text.paddging.top":void 0})}}},halo:{color:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"halo.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?50:void 0,name:i?"halo.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"halo.scalingMethod":void 0}),strokeColor:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"halo.strokeColor":void 0}),strokeWidth:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"halo.strokeWidth":void 0}),clustering:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"halo.clustering":void 0}),hideNonAdjacentEdges:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"halo.hideNonAdjacentEdges":void 0})},pulse:{enabled:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"pulse.enabled":void 0}),duration:t.createAttribute(!0,{storage:n,default:r?1e3:void 0,name:i?"pulse.duration":void 0}),interval:t.createAttribute(!0,{storage:n,default:r?800:void 0,name:i?"pulse.interval":void 0}),startColor:t.createAttribute(!0,{storage:n,default:r?"rgba(0, 0, 0, 0.6)":void 0,name:i?"pulse.startColor":void 0}),endColor:t.createAttribute(!0,{storage:n,default:r?"rgba(0, 0, 0, 0)":void 0,name:i?"pulse.endColor":void 0}),width:t.createAttribute(!0,{storage:n,default:r?50:void 0,name:i?"pulse.width":void 0}),startRatio:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"pulse.startRatio":void 0}),endRatio:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"pulse.endRatio":void 0})},icon:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"icon.content":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"icon.font":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"icon.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.7:void 0,name:i?"icon.scale":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"icon.style":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"icon.minVisibleSize":void 0})},image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"image.scale":void 0}),fit:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"image.fit":void 0}),tile:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"image.tile":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"image.minVisibleSize":void 0})},outline:{enabled:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"outline.enabled":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"rgba(0, 0, 0, 0.36)":void 0,name:i?"outline.color":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"outline.minVisibleSize":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"text.content":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"text.font":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"text.color":void 0}),size:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"text.size":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.1:void 0,name:i?"text.scale":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"text.style":void 0}),align:t.createAttribute(!0,{storage:n,default:r?"center":void 0,name:i?"text.align":void 0}),margin:t.createAttribute(!0,{storage:n,default:r?10:void 0,name:i?"text.margin":void 0}),padding:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"text.padding":void 0}),backgroundColor:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"text.backgroundColor":void 0}),tip:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"text.tip":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?24:void 0,name:i?"text.minVisibleSize":void 0}),scaling:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"text.scaling":void 0}),position:t.createAttribute(!0,{storage:n,default:r?"bottom":void 0,name:i?"text.position":void 0}),maxLineLength:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"text.maxLineLength":void 0}),truncateLength:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"text.truncateLength":void 0}),secondary:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"text.secondary.content":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"text.secondary.font":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"text.secondary.color":void 0}),size:t.createAttribute(!0,{storage:n,default:r?10:void 0,name:i?"text.secondary.size":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.08:void 0,name:i?"text.secondary.scale":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"text.secondary.style":void 0}),align:t.createAttribute(!0,{storage:n,default:r?"center":void 0,name:i?"text.secondary.align":void 0}),margin:t.createAttribute(!0,{storage:n,default:r?5:void 0,name:i?"text.secondary.margin":void 0}),padding:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"text.secondary.padding":void 0}),backgroundColor:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"text.secondary.backgroundColor":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?24:void 0,name:i?"text.secondary.minVisibleSize":void 0})}}}}function Vu(t,e){var i=e.named,r=e.useDefaultValues,n="resource";return{width:t.createAttribute(!1,{storage:n,default:r?1:void 0,name:i?"width":void 0}),scalingMethod:t.createAttribute(!1,{storage:n,default:r?"scaled":void 0,name:i?"scalingMethod":void 0}),color:t.createAttribute(!1,{storage:n,default:r?"grey":void 0,name:i?"color":void 0}),opacity:t.createAttribute(!1,{storage:n,default:r?1:void 0,name:i?"opacity":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"minVisibleSize":void 0}),layer:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"layer":void 0}),detectable:t.createAttribute(!1,{storage:n,default:!!r||void 0,name:i?"detectable":void 0}),curvature:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"curvature":void 0}),adjustAnchors:t.createAttribute(!1,{storage:n,default:!!r||void 0,name:i?"adjustAnchors":void 0}),shape:{type:t.createAttribute(!1,{storage:n,default:r?"line":void 0,name:i?"shape.type":void 0}),head:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"shape.head":void 0}),tail:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"shape.tail":void 0}),style:t.createAttribute(!1,{storage:n,default:r?"plain":void 0,name:i?"shape.style":void 0})},stroke:{color:t.createAttribute(!1,{storage:n,default:r?"inherit":void 0,name:i?"stroke.color":void 0}),width:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"stroke.width":void 0}),scalingMethod:t.createAttribute(!1,{storage:n,default:r?"fixed":void 0,name:i?"stroke.scalingMethod":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"stroke.minVisibleSize":void 0})},halo:{color:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"halo.color":void 0}),width:t.createAttribute(!1,{storage:n,default:r?10:void 0,name:i?"halo.width":void 0}),scalingMethod:t.createAttribute(!1,{storage:n,default:r?"fixed":void 0,name:i?"halo.scalingMethod":void 0})},pulse:{enabled:t.createAttribute(!1,{storage:n,default:!r&&void 0,name:i?"pulse.enabled":void 0}),duration:t.createAttribute(!1,{storage:n,default:r?1e3:void 0,name:i?"pulse.duration":void 0}),interval:t.createAttribute(!1,{storage:n,default:r?800:void 0,name:i?"pulse.interval":void 0}),startColor:t.createAttribute(!1,{storage:n,default:r?"rgba(0, 0, 0, 0.6)":void 0,name:i?"pulse.startColor":void 0}),endColor:t.createAttribute(!1,{storage:n,default:r?"rgba(0, 0, 0, 0)":void 0,name:i?"pulse.endColor":void 0}),width:t.createAttribute(!1,{storage:n,default:r?10:void 0,name:i?"pulse.width":void 0}),startRatio:t.createAttribute(!1,{storage:n,default:r?1:void 0,name:i?"pulse.startRatio":void 0}),endRatio:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"pulse.endRatio":void 0})},outline:{enabled:t.createAttribute(!1,{storage:n,default:!r&&void 0,name:i?"outline.enabled":void 0}),color:t.createAttribute(!1,{storage:n,default:r?"rgba(0, 0, 0, 0.36)":void 0,name:i?"outline.color":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"outline.minVisibleSize":void 0})},text:{content:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"text.content":void 0}),font:t.createAttribute(!1,{storage:n,default:r?"Arial":void 0,name:i?"text.font":void 0}),color:t.createAttribute(!1,{storage:n,default:r?"black":void 0,name:i?"text.color":void 0}),size:t.createAttribute(!1,{storage:n,default:r?12:void 0,name:i?"text.size":void 0}),scale:t.createAttribute(!1,{storage:n,default:r?1:void 0,name:i?"text.scale":void 0}),style:t.createAttribute(!1,{storage:n,default:r?"normal":void 0,name:i?"text.style":void 0}),align:t.createAttribute(!1,{storage:n,default:r?"center":void 0,name:i?"text.align":void 0}),margin:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"text.margin":void 0}),padding:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"text.padding":void 0}),backgroundColor:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"text.backgroundColor":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?4:void 0,name:i?"text.minVisibleSize":void 0}),adjustAngle:t.createAttribute(!1,{storage:n,default:!!r||void 0,name:i?"text.adjustAngle":void 0}),scaling:t.createAttribute(!1,{storage:n,default:!r&&void 0,name:i?"text.scaling":void 0}),maxLineLength:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"text.maxLineLength":void 0}),secondary:{content:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"text.secondary.content":void 0}),font:t.createAttribute(!1,{storage:n,default:r?"Arial":void 0,name:i?"text.secondary.font":void 0}),color:t.createAttribute(!1,{storage:n,default:r?"black":void 0,name:i?"text.secondary.color":void 0}),size:t.createAttribute(!1,{storage:n,default:r?12:void 0,name:i?"text.secondary.size":void 0}),scale:t.createAttribute(!1,{storage:n,default:r?.8:void 0,name:i?"text.secondary.scale":void 0}),style:t.createAttribute(!1,{storage:n,default:r?"normal":void 0,name:i?"text.secondary.style":void 0}),align:t.createAttribute(!1,{storage:n,default:r?"center":void 0,name:i?"text.secondary.align":void 0}),margin:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"text.secondary.margin":void 0}),padding:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"text.secondary.padding":void 0}),backgroundColor:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"text.secondary.backgroundColor":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?4:void 0,name:i?"text.secondary.minVisibleSize":void 0})}}}}function ju(t,e){return new Ws(t,e)}var Gu=(Hu.prototype._getLayerById=function(t){for(var e=0;e<this._layers.length;++e){var i=this._layers[e];if(i.id===t)return i.index=e,i}throw new Error("usage of a destroyed style rule or class")},Hu.prototype._fetch=function(t){return t.isNode?this._nodes:this._edges},Hu.prototype.getFlexArrays=function(){return{nodes:{current:this._nodes.getAttributeFlexArrays(),previous:this._nodes.getPrevAttributeFlexArrays()},edges:{current:this._edges.getAttributeFlexArrays(),previous:this._edges.getPrevAttributeFlexArrays()}}},Hu.prototype.createFlexArrays=function(){return{nodes:this._nodes.createFlexArrays(),edges:this._edges.createFlexArrays()}},Hu.prototype.clear=function(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._nodes.clear(),this._edges.clear(),this.updateAllForAllAttributeLayers()},Hu.prototype.redrawElements=function(t){t.size&&(this._fetch(t).redrawElements(t),this._dom.refresh())},Hu.prototype.redrawAll=function(){this._nodes.redrawAll(),this._edges.redrawAll(),this._dom.refresh()},Hu.prototype._triggerUpdate=function(){this._needUpdate=!0,this._dom.refresh()},Hu.prototype._reconstructAttributeLayersIfNecessary=function(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)},Hu.prototype.getAnimationInformation=function(t){return this._fetch(t).getAnimationInformation(t)},Hu.prototype.update=function(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._nodes.startUpdate(),this._edges.startUpdate();for(var t=0,e=this._destroyedLayers;t<e.length;t++)(n=e[t]).initialized&&(this._nodes.notifyLayerDestroyed(n.nodes),this._edges.notifyLayerDestroyed(n.edges));for(var i=0,r=this._layers;i<r.length;i++){var n,o=(n=r[i]).nodes,a=n.edges;this._nodes.prepareFlexArraysUpdate(o),this._edges.prepareFlexArraysUpdate(a),"function"==typeof n.onBeforeUpdate&&n.onBeforeUpdate(n,this,this._nodes,this._edges),this._nodes.updateFlexArrays(o),this._edges.updateFlexArrays(a)}return this._nodes.endUpdate(),this._edges.endUpdate(),this._updateOngoing=!1,!(this._needUpdate=!1)},Hu.prototype.setAttributeLayerValues=function(t,e,i,r){var n=this._getLayerById(t),o=e.isNode?n.nodes:n.edges;this._reconstructAttributeLayersIfNecessary(),this._fetch(e).setAttributeValues(o,e,i,r,n),this._updateElementsForAttributeLayers([n],e)},Hu.prototype.getAttributeLayerFlexArrays=function(t){var e=this._getLayerById(t);return{nodes:e.nodes.outputFlexArrays,edges:e.edges.outputFlexArrays}},Hu.prototype.getUsedAttributeLayerAttributes=function(t,e){var i=this._getLayerById(t);return this._fetch(e).getUsedAttributeNames(e.isNode?i.nodes:i.edges)},Hu.prototype.getAndResetElementsUpdated=function(){var t=this._nodes,e=this._edges;return{nodes:t.getAndResetElementsUpdated(),edges:e.getAndResetElementsUpdated(),nodeAttributesSet:t.getUpdatedAttributesSet(),nodeAttributes:t.getAndResetAttributesUpdated(),edgeAttributes:e.getAndResetAttributesUpdated()}},Hu.prototype.getAndResetElementsToRedraw=function(){return{nodes:this._nodes.getAndResetElementsToRedraw(),edges:this._edges.getAndResetElementsToRedraw()}},Hu.prototype.addAttributeLayer=function(t){var e=t.name,i=t.tag,r=void 0===i?null:i,n=t.onBeforeUpdate,o=t.standaloneSelectors,a=t.layerFactory,s=void 0===a?ju:a;if(!e)throw new Error("Attribute layer must have a name");if(e&&this._layers.find((function(t){return t.name===e})))throw new Error('attribute layer with name "'+t.name+'" already exists');var u=!!o,d={index:-1,id:++this._layerIdCounter,name:e,tag:r,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,onBeforeUpdate:n,nodes:{type:"node",name:e,standaloneSelector:u,toUpdate:new Ys({graph:this._graph,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this._nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:e,standaloneSelector:u,toUpdate:new Ys({graph:this._graph,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this._edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}};return this._layers.push(d),this._updateLayer(d,t),s(this,this._layerIdCounter)},Hu.prototype._reconstructAttributeLayers=function(){this._layers.sort((function(t,e){return t.priority-e.priority}));for(var t=q(this._nodes.getDefaultFlexArrays()),e=q(this._edges.getDefaultFlexArrays()),i=Q(t),r=Q(e),n=0,o=this._layers;n<o.length;n++)(M=o[n]).nodes.allAttributePaths=i,M.edges.allAttributePaths=r,M.nodes.formattedDependencies=Ou(M.nodes),M.edges.formattedDependencies=Fu(M.edges),M.nodes.formattedOutput={attributes:Nu(M.nodes),tags:M.tag?[M.tag]:[]},M.edges.formattedOutput={attributes:Nu(M.edges),tags:M.tag?[M.tag]:[]},M.nodes.redrawAdjacentEdges=M.nodes.formattedOutput.attributes.some((function(t){return Mu[t]})),M.initialized=!0;for(var a=0,s=this._layers;a<s.length;a++){(M=s[a]).nodes.inputFlexArrays=q(t),M.edges.inputFlexArrays=q(e),M.depsNodeSelf=[],M.depsNodeAdjacentNodes=[],M.depsNodeAdjacentEdges=[],M.depsNodeAllNodes=[],M.depsNodeAllEdges=[],M.depsEdgeSelf=[],M.depsEdgeExtremities=[],M.depsEdgeParallelEdges=[],M.depsEdgeAllNodes=[],M.depsEdgeAllEdges=[],M.nodes.toUpdate.addAll(),M.edges.toUpdate.addAll();for(var u=M.nodes.formattedOutput,d=M.edges.formattedOutput,l=0,h=u.attributes;l<h.length;l++){var c=Y(t,p=h[l]);(_=Y(M.nodes.outputFlexArrays,p)).setFallback(c),X(t,p,_)}for(var f=0,g=d.attributes;f<g.length;f++){var p,_;c=Y(e,p=g[f]),(_=Y(M.edges.outputFlexArrays,p)).setFallback(c),X(e,p,_)}for(var v=0,m=this._layers;v<m.length;v++){var y=m[v];if(M!==y){var b=M.priority,x=y.priority,E=M.nodes.formattedOutput,A=M.edges.formattedOutput,S=y.nodes.formattedDependencies,w=y.edges.formattedDependencies;ku(M.depsNodeSelf,y,E,S.self,b,x),ku(M.depsNodeAdjacentNodes,y,E,S.adjacentNodes,b,x),ku(M.depsNodeAdjacentEdges,y,A,w.extremities,b,x),ku(M.depsNodeAllNodes,y,E,S.allNodes,b,x),ku(M.depsNodeAllEdges,y,A,w.allNodes,b,x),ku(M.depsEdgeSelf,y,A,w.self,b,x),ku(M.depsEdgeExtremities,y,E,S.adjacentEdges,b,x),ku(M.depsEdgeParallelEdges,y,A,w.parallelEdges,b,x),ku(M.depsEdgeAllNodes,y,E,S.allEdges,b,x),ku(M.depsEdgeAllEdges,y,A,w.allEdges,b,x)}}}this._nodes.setLastFlexArrays(t),this._edges.setLastFlexArrays(e);for(var T=0,C=this._layers;T<C.length;T++){var M;(M=C[T]).nodes.needAdjacentElements=M.nodes.redrawAdjacentEdges||0<M.depsNodeAdjacentNodes.length||0<M.depsNodeAdjacentEdges.length,M.edges.needAdjacentElements=0<M.depsEdgeExtremities.length||0<M.depsEdgeParallelEdges.length}},Hu.prototype._updateLayer=function(t,e){var i=void 0===e?{}:e,r=i.priority,n=i.fullOverwrite,o=i.nodeAttributes,a=i.nodeSelector,s=i.nodeContext,u=i.nodeDependencies,d=i.nodeOutput,l=i.edgeAttributes,h=i.edgeSelector,c=i.edgeContext,f=i.edgeDependencies,g=i.edgeOutput;void 0!==o&&(t.nodes.attributes=n?o:it(t.nodes.attributes,o)),void 0!==a&&(t.nodes.selector=a),void 0!==s&&(t.nodes.context=s),void 0!==u&&(t.nodes.dependencies=u),void 0!==d&&(t.nodes.output=d),void 0!==l&&(t.edges.attributes=n?l:it(t.edges.attributes,l)),void 0!==h&&(t.edges.selector=h),void 0!==c&&(t.edges.context=c),void 0!==f&&(t.edges.dependencies=f),void 0!==g&&(t.edges.output=g),void 0!==r&&(t.priority=r),this._triggerLayerUpdate()},Hu.prototype._triggerLayerUpdate=function(){this._layersNeedUpdate=!0,this._triggerUpdate()},Hu.prototype.updateAllForAttributeLayer=function(t){var e=this._getLayerById(t);this._updateAllForAttributeLayer(e)},Hu.prototype.updateAllForAllAttributeLayers=function(){for(var t=0,e=this._layers;t<e.length;t++){var i=e[t];this._updateAllForAttributeLayer(i)}},Hu.prototype._updateAllForAttributeLayer=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=!0),e&&!t.nodes.toUpdate.isFull()){t.nodes.toUpdate.addAll();for(var r=0,n=t.depsNodeSelf;r<n.length;r++){var o=n[r];this._updateAllForAttributeLayer(o,!0,!1)}for(var a=0,s=t.depsNodeAdjacentNodes;a<s.length;a++)o=s[a],this._updateAllForAttributeLayer(o,!0,!1);for(var u=0,d=t.depsNodeAdjacentEdges;u<d.length;u++)o=d[u],this._updateAllForAttributeLayer(o,!1,!0);for(var l=0,h=t.depsNodeAllNodes;l<h.length;l++)o=h[l],this._updateAllForAttributeLayer(o,!0,!1);for(var c=0,f=t.depsNodeAllEdges;c<f.length;c++)o=f[c],this._updateAllForAttributeLayer(o,!1,!0)}if(i&&!t.edges.toUpdate.isFull()){t.edges.toUpdate.addAll();for(var g=0,p=t.depsEdgeSelf;g<p.length;g++)o=p[g],this._updateAllForAttributeLayer(o,!1,!0);for(var _=0,v=t.depsEdgeExtremities;_<v.length;_++)o=v[_],this._updateAllForAttributeLayer(o,!0,!1);for(var m=0,y=t.depsEdgeParallelEdges;m<y.length;m++)o=y[m],this._updateAllForAttributeLayer(o,!1,!0);for(var b=0,x=t.depsEdgeAllNodes;b<x.length;b++)o=x[b],this._updateAllForAttributeLayer(o,!0,!1);for(var E=0,A=t.depsEdgeAllEdges;E<A.length;E++)o=A[E],this._updateAllForAttributeLayer(o,!1,!0)}this._triggerUpdate()},Hu.prototype.updateElementsForAttributeLayer=function(t,e){var i=this._getLayerById(t);this._updateElementsForAttributeLayers([i],e)},Hu.prototype.updateForAllAttributeLayers=function(t){this._updateElementsForAttributeLayers(this._layers,t)},Hu.prototype._updateElementsForAttributeLayers=function(t,e){var i=this._emptySubgraph;if(e.isNode){for(var r=0,n=t;r<n.length;r++)if(!(m=n[r]).nodes.toUpdate.isFull()){m.nodes.needAdjacentElements&&(i=i===this._emptySubgraph?e.fastGetAdjacentElements():i),m.nodes.toUpdate.add(e);for(var o=0,a=m.depsNodeSelf;o<a.length;o++)(f=a[o]).nodes.toUpdate.add(e);for(var s=0,u=m.depsNodeAdjacentNodes;s<u.length;s++)(f=u[s]).nodes.toUpdate.add(i.nodes);for(var d=0,l=m.depsNodeAdjacentEdges;d<l.length;d++)(f=l[d]).edges.toUpdate.add(i.edges);for(var h=0,c=m.depsNodeAllNodes;h<c.length;h++){var f=c[h];this._updateAllForAttributeLayer(f,!0,!1)}for(var g=0,p=m.depsNodeAllEdges;g<p.length;g++)f=p[g],this._updateAllForAttributeLayer(f,!1,!0);m.nodes.redrawAdjacentEdges&&this._edges.redrawElements(i.edges)}}else for(var _=0,v=t;_<v.length;_++){var m;if(!(m=v[_]).edges.toUpdate.isFull()){m.edges.needAdjacentElements&&(i=i===this._emptySubgraph?e.fastGetAdjacentElements():i),m.edges.toUpdate.add(e);for(var y=0,b=m.depsEdgeSelf;y<b.length;y++)(f=b[y]).edges.toUpdate.add(e);for(var x=0,E=m.depsEdgeExtremities;x<E.length;x++)(f=E[x]).nodes.toUpdate.add(i.nodes);for(var A=0,S=m.depsEdgeParallelEdges;A<S.length;A++)(f=S[A]).edges.toUpdate.add(i.edges);for(var w=0,T=m.depsEdgeAllNodes;w<T.length;w++)f=T[w],this._updateAllForAttributeLayer(f,!0,!1);for(var C=0,M=m.depsEdgeAllEdges;C<M.length;C++)f=M[C],this._updateAllForAttributeLayer(f,!1,!0)}}this._triggerUpdate()},Hu.prototype.destroyAttributeLayer=function(t){var e=this._getLayerById(t);this._destroyedLayers.push(e),this._layers.splice(e.index,1),this._triggerLayerUpdate()},Hu.prototype.updateAttributeLayer=function(t,e){var i=this._getLayerById(t);this._updateLayer(i,e)},Hu.prototype.getAttributeLayerDefinition=function(t){var e=this._getLayerById(t),i=e.priority,r=e.nodes,n=e.edges;return{priority:i,nodeAttributes:r.attributes,nodeSelector:r.selector,nodeContext:r.context,nodeDependencies:r.dependencies,nodeOutput:r.output,edgeAttributes:n.attributes,edgeSelector:n.selector,edgeContext:n.context,edgeDependencies:n.dependencies,edgeOutput:n.output}},Hu.prototype.getAttributeValues=function(t,e,i,r){return this.update(),this._fetch(t).getAttributeValues(t,e,i,r)},Hu.prototype.setAnimationAttributes=function(t,e){var i=t.nodes,r=t.edges;this._nodes.setAnimationAttributes(i,e),this._edges.setAnimationAttributes(r,e)},Hu.prototype.resetAnimationAttributes=function(t){var e=t.nodes,i=t.edges;this._nodes.resetAnimationAttributes(e),this._edges.resetAnimationAttributes(i)},Hu.prototype.setTextHidden=function(t,e){var i=this._textHiddenSet.addOrRemoveElements(t,e);this.redrawElements(i)},Hu.prototype.resetTextHidden=function(){var t=this._textHiddenSet.getElements(),e=t.nodes,i=t.edges;this._textHiddenSet.clear(),this._nodes.redrawElements(e),this._edges.redrawElements(i)},Hu.prototype.getUsedNodeAttributes=function(){return this._nodes.getUsedAttributes()},Hu.prototype.getUsedEdgeAttributes=function(){return this._edges.getUsedAttributes()},Object.defineProperty(Hu.prototype,"nodes",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),Object.defineProperty(Hu.prototype,"edges",{get:function(){return this._edges},enumerable:!0,configurable:!0}),Hu);function Hu(t,e,i){this._colorManager=new Ir,this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=i,this._graph=t,this._dom=e,this._emptySubgraph={nodes:i.nodeList(),edges:i.edgeList()},this._textHiddenSet=new Lo(this._graph,"textHidden"),this._nodes=new zu(t,this._colorManager,!0,Uu),this._edges=new zu(t,this._colorManager,!1,Vu)}function Wu(t,e,i){return void 0===i&&(i=0),"inherit"===t?Array.isArray(e)?e[i/(2*Math.PI)*e.length|0]:e:t}function qu(t,e){var i=t(),r=Q(i).map((function(t){var r=Y(i,t);return Array.isArray(r)?"for (var i = 0; i < "+r.length+"; ++i) {\n        target."+t+"[i] = source."+t+"[i]."+e+";\n      }\n      return target;":"target."+t+" = source."+t+"."+e+";"})).join("\n");return new Function("source, target",r)}function Xu(t){var e=t(),i=Q(e).map((function(t){var i=Y(e,t);return Array.isArray(i)?"for (var i = 0; i < "+i.length+"; ++i) {\n        target."+t+"[i] = target."+t+"[i] || source."+t+"[i];\n      }":"target."+t+" = target."+t+" || source."+t+";"})).join("\n");return new Function("target","source",i)}function Yu(t){var e=(t.getDepth()-30)%6;return 0<=e&&0!==e&&3!==e}function Zu(t,e,i,r){var n,o,a,s,u,d,l,h,c,f;n=t,o=e,s=r,u=+("scaled"===(a=i).scalingMethod.get(s)),d=2*a.radius.get(s),l=a.innerStroke.width.get(s),h=+("scaled"===a.innerStroke.scalingMethod.get(s)),c=a.outerStroke.width.get(s),f=+("scaled"===a.outerStroke.scalingMethod.get(s)),o.x=a.x.get(s),o.y=a.y.get(s),o.shape=a.shape.get(s),o.color=a.color.get(s),o.opacity=a.opacity.get(s),o.diameterScaled=d*u,o.diameterFixed=d*(1-u),o.innerStroke.color=Wu(a.innerStroke.color.get(s),o.color),o.innerStroke.widthScaled=l*h,o.innerStroke.widthFixed=l*(1-h),o.innerStroke.minVisibleSize=a.innerStroke.minVisibleSize.get(s),o.outerStroke.color=Wu(a.outerStroke.color.get(s),o.color),o.outerStroke.widthScaled=c*f,o.outerStroke.widthFixed=c*(1-f),o.halo.color=a.halo.color.get(s),o.halo.strokeColor=a.halo.strokeColor.get(s),o.icon.content=n.formatText(a.icon.content.get(s)),o.image.url=a.image.url.get(s),o.outline.enabled=a.outline.enabled.get(s),o.textHidden=!!a.textHidden.get(s),Ku(t,e.texts.primary,i.text,r,e),Ku(t,e.texts.secondary,i.text.secondary,r,e),Qu(t,e.badges.topLeft,i.badges.topLeft,r),Qu(t,e.badges.topRight,i.badges.topRight,r),Qu(t,e.badges.bottomLeft,i.badges.bottomLeft,r),Qu(t,e.badges.bottomRight,i.badges.bottomRight,r)}function Ku(t,e,i,r,n){if(e.hidden=n.textHidden,e.content=t.formatText(i.content.get(r)),e.backgroundColor=Wu(i.backgroundColor.get(r),n.color),e===n.texts.primary){var o=i;e.tip=o.tip.get(r),e.position=o.position.get(r)}else e.position="bottom"}function Qu(t,e,i,r){var n=i.text.content.get(r);e.textContent=t.formatText(n),e.imageUrl=i.image.url.get(r)}function Ju(){return{x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,rescale:!1,duplicate:!1,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:$u(ga),topRight:$u(pa),bottomLeft:$u(_a),bottomRight:$u(va)},textHidden:!1,texts:{primary:{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1},secondary:{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}}}}function $u(t){return{angle:t,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0,textPaddingLeft:0,textPaddingTop:0}}function td(t,e){void 0===e&&(e={edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0});var i=6*(t- -100)+30;return e.edgeHalo=0,e.nodeHaloStroke=1,e.nodeHalo=2,e.edgeBody=i+0,e.edgeTextBackground=i+1,e.edgeText=i+2,e.nodeBody=i+3,e.nodeTextBackground=i+4,e.nodeText=i+5,e}function ed(t,e){var i,r;r=e,(i=t).body=!0,i.icon=!!r.icon.content,i.image=!!r.image.url,i.pieChart=Array.isArray(r.color),i.outerStroke=!!r.outerStroke.color,i.outline=!!r.outline.enabled,i.halo=!!r.halo.color,i.haloStroke=i.halo&&!!r.halo.strokeColor,id(t.texts.primary,e.texts.primary),id(t.texts.secondary,e.texts.secondary),rd(t.badges.topLeft,e.badges.topLeft),rd(t.badges.topRight,e.badges.topRight),rd(t.badges.bottomLeft,e.badges.bottomLeft),rd(t.badges.bottomRight,e.badges.bottomRight)}function id(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor,t.tip=t.background&&e.tip&&"center"!==e.position}function rd(t,e){t.text=!!e.textContent,t.image=!!e.imageUrl}function nd(t,e){t.pieceId=1,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=e.diameterScaled,t.rectWidthOrSourceRadiusFixed=e.diameterFixed,t.rectHeightOrTargetRadiusScaled=e.diameterScaled,t.rectHeightOrTargetRadiusFixed=e.diameterFixed,t.shape=e.shape,t.opacity=e.opacity,t.symbolicSize=e.diameterScaled,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=null,t.strokeColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function od(t,e,i){var r=i.diameterScaled*e.scale,n=i.diameterFixed*e.scale,o=i.diameterScaled*e.positionScale/2,a=i.diameterFixed*e.positionScale/2;t.pieceId=1,t.shape="circle",t.x1=i.x,t.y1=i.y,t.x2=i.x,t.y2=i.y,t.rectWidthOrSourceRadiusScaled=r,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=r,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.strokeWidthScaled,t.strokeWidthFixed=e.strokeWidthFixed,t.offsetScaled=o,t.offsetFixed=a,t.pattern.type=0,t.opacity=i.opacity,t.fillColor=e.color,t.strokeColor=e.strokeColor,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.angle,t.patternScale=0,t.symbolicSize=i.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function ad(t,e,i){var r=0,n=0;if(e.isPositionCenter||(r+=i.innerStroke.widthScaled+i.outerStroke.widthScaled+i.diameterScaled/2,n+=i.innerStroke.widthFixed+i.outerStroke.widthFixed+i.diameterFixed/2+e.margin+e.padding),e.isPositionVertical){if(r+=e.heightScaled/2,n+=e.heightFixed/2,e===i.texts.secondary&&"bottom"===i.texts.primary.position){var o=i.texts.primary;r+=o.heightScaled,n+=o.heightFixed+o.margin+2*o.padding}}else e.isPositionHorizontal&&(r+=e.widthScaled/2,n+=e.widthFixed/2);t.pieceId=1,t.shape="square",t.x1=i.x,t.y1=i.y,t.x2=i.x,t.y2=i.y,t.rectWidthOrSourceRadiusScaled=e.widthScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.padding,t.rectHeightOrTargetRadiusScaled=e.heightScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.padding,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=r,t.offsetFixed=n,t.pattern.type=0,t.pattern.attributes.size=-1,t.opacity=i.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.positionAngle,t.patternScale=1,t.symbolicSize=i.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function sd(t,e,i,r,n,o){var a=n.badges,s=r.badges,u=o.badges;!function(t,e,i,r,n){if(r.halo){var o=i.halo.width.get(e),a=+("scaled"===i.halo.scalingMethod.get(e));n.halo.widthScaled=o*a,n.halo.widthFixed=o*(1-a),function(t,e){var i=e.diameterScaled+2*e.halo.widthScaled,r=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=1,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=e.halo.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(r.halo,n),r.haloStroke&&(n.halo.strokeWidthScaled=0,n.halo.strokeWidthFixed=i.halo.strokeWidth.get(e),function(t,e){var i=e.diameterScaled+2*e.halo.widthScaled,r=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=1,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.halo.strokeWidthScaled,t.strokeWidthFixed=e.halo.strokeWidthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.halo.strokeColor,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(r.haloStroke,n))}if(r.outline&&(n.outline.color=i.outline.color.get(e),n.outline.minVisibleSize=i.outline.minVisibleSize.get(e),function(t,e){var i=1.1*e.diameterScaled,r=1.1*e.diameterFixed,n=.07*e.diameterScaled,o=.07*e.diameterFixed+1;e.outerStroke.color&&(n+=e.outerStroke.widthScaled/2,o+=e.outerStroke.widthFixed/2),t.pieceId=1,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=n,t.offsetFixed=o,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=e.outline.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.outline.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=1.5707963267948966,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(r.outline,n)),r.outerStroke&&(n.outerStroke.minVisibleSize=i.outerStroke.minVisibleSize.get(e),function(t,e){var i=e.diameterScaled+2*e.innerStroke.widthScaled,r=e.diameterFixed+2*e.innerStroke.widthFixed;t.pieceId=1,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.outerStroke.widthScaled,t.strokeWidthFixed=e.outerStroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.outerStroke.color,t.patternColor=null,t.globalMinVisibleSize=e.outerStroke.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(r.outerStroke,n)),r.pieChart&&function(t,e){nd(t,e),Array.isArray(e.color)&&(t.pattern.type=4,t.pattern.attributes.colors=e.color.join(";"),t.patternScale=1,t.patternMinVisibleSize=0,t.patternColor=null)}(r.pieChart,n),r.image&&(n.image.content=t.imageManager.getImage(n.image.url),n.image.fit=i.image.fit.get(e),n.image.tile=i.image.tile.get(e),n.image.scale=i.image.scale.get(e),n.image.minVisibleSize=i.image.minVisibleSize.get(e),function(t,e){var i=e.image.fit&&!e.image.tile;nd(t,e),t.pattern.type=2,t.pattern.attributes.image=e.image.content,t.pattern.attributes.scaled=i,t.pattern.attributes.duplicated=e.image.tile,t.patternScale=i?e.image.scale:0,t.patternMinVisibleSize=e.image.minVisibleSize,t.patternColor=null}(r.image,n)),r.icon&&(n.icon.font=t.fontManager.getFont(i.icon.font.get(e)),n.icon.style=i.icon.style.get(e),n.icon.color=i.icon.color.get(e),n.icon.scale=i.icon.scale.get(e),n.icon.minVisibleSize=i.icon.minVisibleSize.get(e),function(t,e){nd(t,e),t.pattern.type=5,t.pattern.attributes.text=e.icon.content,t.pattern.attributes.font=e.icon.font,t.pattern.attributes.style=e.icon.style,t.pattern.attributes.size=-1,t.patternMinVisibleSize=e.icon.minVisibleSize,t.patternColor=e.icon.color,t.patternScale=e.icon.scale}(r.icon,n)),r.body){var s=!r.pieChart&&!r.image&&!r.icon;!function(t,e,i){nd(t,e),t.fillColor=Array.isArray(e.color)?null:e.color,t.strokeColor=e.innerStroke.color,t.strokeMinVisibleSize=e.innerStroke.minVisibleSize,t.strokeWidthScaled=e.innerStroke.widthScaled,t.strokeWidthFixed=e.innerStroke.widthFixed,i&&(t.pattern.type=0)}(r.body,n,s)}}(e,i,r,n,o),dd(t,e,i,r.text,n.texts.primary,o.texts.primary,o),dd(t,e,i,r.text.secondary,n.texts.secondary,o.texts.secondary,o),ud(t,e,i,s.topLeft,a.topLeft,u.topLeft,o),ud(t,e,i,s.topRight,a.topRight,u.topRight,o),ud(t,e,i,s.bottomLeft,a.bottomLeft,u.bottomLeft,o),ud(t,e,i,s.bottomRight,a.bottomRight,u.bottomRight,o)}function ud(t,e,i,r,n,o,a){if(n.image||n.text){var s=r.stroke.width.get(i),u=+("scaled"===r.stroke.scalingMethod.get(i));o.color=Wu(r.color.get(i),a.color,o.angle),o.strokeColor=r.stroke.color.get(i),o.strokeWidthScaled=s*u,o.strokeWidthFixed=s*(1-u),o.minVisibleSize=r.minVisibleSize.get(i),o.positionScale=r.positionScale.get(i),o.scale=r.scale.get(i)}var d,l,h,c;if(n.image&&(o.imageContent=e.imageManager.getImage(o.imageUrl),o.imageScale=r.image.scale.get(i),od(d=n.image,l=o,a),null!==l.imageContent?(d.pattern.type=2,d.pattern.attributes.image=l.imageContent,d.pattern.attributes.scaled=!0,d.pattern.attributes.duplicated=!1,d.patternScale=l.imageScale,d.patternMinVisibleSize=0,d.patternColor=null):(d.fillColor=null,d.strokeColor=null)),n.text){if(o.textFont=e.fontManager.getFont(r.text.font.get(i)),o.textStyle=r.text.style.get(i),o.textColor=Wu(r.text.color.get(i),a.color),o.textScale=r.text.scale.get(i),o.textPaddingTop=r.text.paddingTop.get(i),o.textPaddingLeft=r.text.paddingLeft.get(i),1<t.measureText(o.textContent,o.textFont,o.textStyle,o.textScale).width){for(var f=0,g=0;g<o.textContent.length&&f<1;)f+=t.measureText(o.textContent[g],o.textFont,o.textStyle,o.textScale).width,g+=1;g!==o.textContent.length&&(o.textContent=o.textContent.substring(0,g-1)+"")}od(h=n.text,c=o,a),c.textContent&&(h.pattern.type=6,h.pattern.attributes.text=c.textContent,h.pattern.attributes.font=c.textFont,h.pattern.attributes.style=c.textStyle,h.pattern.attributes.paddingLeft=c.scale*c.textPaddingLeft*2,h.pattern.attributes.paddingTop=c.scale*c.textPaddingTop*2,h.pattern.attributes.size=-1,h.patternMinVisibleSize=0,h.patternColor=c.textColor,h.patternScale=c.textScale,h.isBadge=!0),!c.imageUrl&&c.textContent||(h.fillColor=null,h.strokeColor=null)}}function dd(t,e,i,r,n,o,a){if(n.text){var s=r,u=s.scaling.get(i);if(o.font=e.fontManager.getFont(s.font.get(i)),o.color=Wu(s.color.get(i),a.color),o.style=s.style.get(i),o.align=s.align.get(i),o.minVisibleSize=s.minVisibleSize.get(i),o.margin=s.margin.get(i),o.padding=s.padding.get(i),o.maxLineLength=s.maxLineLength.get(i),o.content=Wo(o.content,o.maxLineLength),u){var d=s.scale.get(i);o.sizeScaled=a.diameterScaled*d,o.sizeFixed=a.diameterFixed*d}else o.sizeFixed=s.size.get(i),o.sizeScaled=0;var l=t.measureText(o.content,o.font,o.style);o.widthScaled=l.width*o.sizeScaled,o.widthFixed=l.width*o.sizeFixed,o.heightScaled=l.height*o.sizeScaled,o.heightFixed=l.height*o.sizeFixed,o.positionAngle=xa[o.position],o.isPositionCenter="center"===o.position,o.isPositionVertical="top"===o.position||"bottom"===o.position,o.isPositionHorizontal="left"===o.position||"right"===o.position,ad(E=n.text,A=o,a),E.pattern.type=7,E.pattern.attributes.text=A.content,E.pattern.attributes.font=A.font,E.pattern.attributes.style=A.style,E.pattern.attributes.align=A.align,E.patternMinVisibleSize=0,E.patternColor=A.color,E.thicknessOrFontSizeScaled=A.sizeScaled,E.thicknessOrFontSizeFixed=A.sizeFixed,E.isText=!0,n.background&&(ad(b=n.background,x=o,a),b.fillColor=x.backgroundColor,n.tip&&(h=n.tip,c=o,f=a,g=Math.ceil(c.margin/2)+1,p=f.diameterScaled/2+f.innerStroke.widthScaled+f.outerStroke.widthScaled,_=f.diameterFixed/2+f.innerStroke.widthFixed+f.outerStroke.widthFixed+g,v=Ea[c.position],m=Math.cos(v),y=Math.sin(v),h.pieceId=1,h.shape="triangle",h.x1=f.x-m,h.y1=f.y-y,h.x2=f.x+m,h.y2=f.y+y,h.rectWidthOrSourceRadiusScaled=0,h.rectWidthOrSourceRadiusFixed=c.margin,h.rectHeightOrTargetRadiusScaled=0,h.rectHeightOrTargetRadiusFixed=c.margin*(2/3),h.thicknessOrFontSizeScaled=0,h.thicknessOrFontSizeFixed=0,h.strokeWidthScaled=0,h.strokeWidthFixed=0,h.offsetScaled=p,h.offsetFixed=_,h.pattern.type=0,h.opacity=f.opacity,h.fillColor=c.backgroundColor,h.strokeColor=null,h.patternColor=null,h.globalMinVisibleSize=c.minVisibleSize,h.strokeMinVisibleSize=0,h.patternMinVisibleSize=0,h.offsetAngle=c.positionAngle,h.patternScale=0,h.symbolicSize=f.diameterScaled,h.curvature=0,h.dashLength=0,h.gapLength=0,h.hasHead=!1,h.hasTail=!1,h.isSelfLoop=!1))}var h,c,f,g,p,_,v,m,y,b,x,E,A}var ld=qu(_d,"start"),hd=qu(_d,"end"),cd=Xu(_d),fd=(gd.prototype.drawNode=function(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();var e=this._engine,i=this._helper,r=t,n=this._attributes,o=td(n.layer.get(t)-(n.detectable.get(t)?0:1),this._depthInfo),a=n.animationDuration.get(t),s=0<a;if(this._prepareBlocks(s,o,r),Zu(i,this._endInput,n,t),ed(this._endFlags,this._endInput),s&&(Zu(i,this._startInput,this._attributesPrev,t),ed(this._startFlags,this._startInput),cd(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._blocks),hd(this._fullComponents,this._endComponents),sd(e,i,t,n,this._endComponents,this._endInput),s&&(ld(this._fullComponents,this._startComponents),sd(e,i,t,this._attributesPrev,this._startComponents,this._startInput)),s){var u=this._attributes.animationStart.get(t),d=this._attributes.animationEasing.get(t);this._setBlocksAnimation(a,u,d)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(t)&&(this._blocks.halo.setStencilUsage(2),this._blocks.haloStroke.setStencilUsage(2)),this._storeBlocks()},gd.prototype._computeBlockIds=function(t){var e=10*t,i=this._blockIds;i.body=0+e,i.text=1+e,i.textBg=2+e,i.halo=3+e,i.haloStroke=4+e},gd.prototype._prepareBlocks=function(t,e,i){var r=this._blocks;r.body.reset(1,t,e.nodeBody,i),r.text.reset(2,t,e.nodeText,i),r.textBg.reset(1,t,e.nodeTextBackground,i),r.halo.reset(1,t,e.nodeHalo,i),r.haloStroke.reset(1,t,e.nodeHaloStroke,i)},gd.prototype._storeBlocks=function(){var t=this._engine,e=this._blocks,i=this._blockIds;t.storeBlock(i.body,e.body),t.storeBlock(i.text,e.text),t.storeBlock(i.textBg,e.textBg),t.storeBlock(i.halo,e.halo),t.storeBlock(i.haloStroke,e.haloStroke)},gd.prototype._freeBlocks=function(){var t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.text),t.freeBlock(e.textBg),t.freeBlock(e.halo),t.freeBlock(e.haloStroke)},gd.prototype._setBlocksAnimation=function(t,e,i){var r=this._blocks;r.body.setGlobalAnimation(t,e,i),r.text.setGlobalAnimation(t,e,i),r.textBg.setGlobalAnimation(t,e,i),r.halo.setGlobalAnimation(t,e,i),r.haloStroke.setGlobalAnimation(t,e,i)},gd.prototype._initComponents=function(t,e,i){this._nodePatternAssigned=!1,this._initBaseComponents(t,e,i),this._initBadgeComponents(t.badges.topLeft,e.badges.topLeft,i),this._initBadgeComponents(t.badges.topRight,e.badges.topRight,i),this._initBadgeComponents(t.badges.bottomLeft,e.badges.bottomLeft,i),this._initBadgeComponents(t.badges.bottomRight,e.badges.bottomRight,i),this._initTextComponents(t.texts.primary,e.texts.primary,i),this._initTextComponents(t.texts.secondary,e.texts.secondary,i)},gd.prototype._initBaseComponents=function(t,e,i){t.haloStroke=this._nextElement(e.haloStroke,i.haloStroke),t.halo=this._nextElement(e.halo,i.halo),t.outline=this._nextElement(e.outline,i.body),t.outerStroke=this._nextElement(e.outerStroke,i.body),t.body=this._nextElement(e.body,i.body),t.pieChart=this._getNodePatternElement(e.pieChart,i),t.image=this._getNodePatternElement(e.image,i),t.icon=this._getNodePatternElement(e.icon,i)},gd.prototype._initBadgeComponents=function(t,e,i){t.image=this._nextElement(e.image,i.body),t.text=this._nextElement(e.text,i.body)},gd.prototype._initTextComponents=function(t,e,i){t.background=this._nextElement(e.background,i.textBg),t.tip=this._nextElement(e.tip,i.textBg),t.text=this._nextElement(e.text,i.text)},gd.prototype._nextElement=function(t,e){return t?e.next():this._nullElt},gd.prototype._getNodePatternElement=function(t,e){return t?this._nodePatternAssigned?e.body.next():(this._nodePatternAssigned=!0,e.body.getCurrentElement()):this._nullElt},gd);function gd(t){var e=t.engine,i=t.imageManager,r=t.fontManager,n=t.formatText,o=t.attributes,a=t.attributesPrev;this._fullComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._endComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startFlags={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._endFlags={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startInput=Ju(),this._endInput=Ju(),this._depthInfo={edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0},this._engine=e,this._attributes=o,this._attributesPrev=a,this._helper={imageManager:i,fontManager:r,formatText:n},this._blocks=pd((function(){return e.createBlock()})),this._blockIds=pd((function(){return 0}))}function pd(t){return{body:t(),text:t(),textBg:t(),halo:t(),haloStroke:t()}}function _d(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function vd(t,e,i,r,n,o){var a,s,u,d,l,h,c,f,g;return s=r-t,u=n-e,i+o<(d=Math.sqrt(s*s+u*u))||d<Math.abs(i-o)?null:(g=e+u*(a=(i*i-o*o+d*d)/(2*d))/d,[[(f=t+s*a/d)+(h=(l=Math.sqrt(i*i-a*a))/d*-u),g+(c=l/d*s)],[f-h,g-c]])}function md(t,e,i,r,n,o){if(0<=t-n&&i-n<0)return 1;if(t-n<0&&0<=i-n)return-1;if(t-n==0&&i-n==0)return 0<=e-r||0<=r-o?e-r:r-e;var a=(t-n)*(r-o)-(i-n)*(e-o);return a<0?1:0<a?-1:(t-n)*(t-n)+(e-o)*(e-o)-((i-n)*(i-n)+(r-o)*(r-o))}function yd(t,e,i){var r=t[0],n=t[1],o=t[2],a=Math.abs(r-e),s=Math.abs(n-i);return a+s<=o||!(o<a||o<s)&&Math.sqrt(a*a+s*s)<o+1e-12}function bd(t,e,i,r){var n=t[0]-e,o=t[1]-i,a=t[2]-r;return n*n+o*o<a*a+1e-6}function xd(t,e,i,r,n,o,a){var s=t-Math.max(r,Math.min(o,t)),u=e-Math.max(n,Math.min(a,e));return s*s+u*u<i*i}function Ed(t,e,i,r,n,o,a,s){void 0===s&&(s={x:0,y:0});var u,d,l,h,c=s||{x:0,y:0};if(i===t){var f=t-n,g=a*a-f*f;if(g<0)return null;var p=Math.sqrt(g);l=u=t,d=o+p,h=o-p}else{var _=(r-e)/(i-t),v=e-_*t,m=v-o,y=_*_+1,b=2*(_*m-n),x=b*b-4*y*(n*n+m*m-a*a);if(x<0)return null;var E=-b,A=Math.sqrt(x),S=2*y;d=_*(u=(E+A)/S)+v,h=_*(l=(E-A)/S)+v}var w=t-u,T=e-d,C=t-l,M=e-h;return w*w+T*T<C*C+M*M?(c.x=u,c.y=d):(c.x=l,c.y=h),c}function Ad(t,e,i,r,n,o){!function(t,e,i,r,n){var o=r.source,a=r.target,s=e.source.get(i),u=e.target.get(i),d=o.x.get(s),l=o.y.get(s),h=o.radius.get(s),c=o.color.get(s),f=+("scaled"===o.scalingMethod.get(s)),g=a.x.get(u),p=a.y.get(u),_=a.radius.get(u),v=a.color.get(u),m=+("scaled"===a.scalingMethod.get(u)),y=function(t,e,i){return"source"===t?e:"target"===t?i:t}(e.color.get(i),c,v),b=e.width.get(i),x=+("scaled"===e.scalingMethod.get(i)),E=e.stroke.width.get(i),A=+("scaled"===e.stroke.scalingMethod.get(i)),S=ba[e.shape.style.get(i)],w=e.adjustAnchors.get(i);if(t.source=s,t.target=u,t.sourceX=d,t.sourceY=l,t.targetX=g,t.targetY=p,t.sourceRadiusScaled=h*f,t.sourceRadiusFixed=h*(1-f),t.targetRadiusScaled=_*m,t.targetRadiusFixed=_*(1-m),t.widthScaled=b*x,t.widthFixed=b*(1-x),t.curvature=e.curvature.get(i),t.isSelfLoop=s===u,t.color=y,t.opacity=e.opacity.get(i),t.minVisibleSize=e.minVisibleSize.get(i),t.shape.type=e.shape.type.get(i),t.shape.head=e.shape.head.get(i),t.shape.tail=e.shape.tail.get(i),t.shape.dashLength=S.dash,t.shape.gapLength=S.gap,t.shape.isBodyTriangle="triangle"===t.shape.type,t.stroke.color=Wu(e.stroke.color.get(i),y),t.stroke.widthScaled=E*A,t.stroke.widthFixed=E*(1-A),t.stroke.minVisibleSize=e.stroke.minVisibleSize.get(i),t.halo.color=e.halo.color.get(i),t.outline.enabled=e.outline.enabled.get(i),t.textHidden=1===e.textHidden.get(i),w&&(t.shape.head||t.shape.tail||"triangle"===t.shape.type)){var T=t,C=T.curvature,M=T.sourceX,I=T.sourceY,L=T.targetX,N=T.targetY,k=1,O=1;if(C){if(!T.isSelfLoop){var F=wa(M,I,L,N,C/2);k=wd(0,n,o,s,M,I,F.x,F.y),O=wd(0,n,a,u,L,N,F.x,F.y)}}else k=wd(0,n,o,s,M,I,L,N),O=wd(0,n,a,u,L,N,M,I);t.sourceRadiusScaled*=k,t.sourceRadiusFixed*=k,t.targetRadiusScaled*=O,t.targetRadiusFixed*=O}}(e,i,r,n,o),Sd(t,e.texts.primary,i.text,r,e),Sd(t,e.texts.secondary,i.text.secondary,r,e)}function Sd(t,e,i,r,n){e.hidden=n.textHidden,e.content=t.formatText(i.content.get(r)),e.backgroundColor=Wu(i.backgroundColor.get(r),n.color)}function wd(t,e,i,r,n,o,a,s){var u,d=e.angle||0,l=Math.atan2(s-o,a-n)-d,h=1,c=0;l<-ca?l+=fa:ca<l&&(l-=fa),u=l<-ca/2?(c=ga,i.badges.topLeft):l<0?(c=pa,i.badges.topRight):l<ca/2?(c=va,i.badges.bottomRight):(c=_a,i.badges.bottomLeft),c+=d;var f,g=u.text.content&&u.text.content.get(r),p=u.image.url&&u.image.url.get(r);if((f=g)||0===f||p){var _=u.positionScale.get(r),v=u.scale.get(r),m=Ed(a,s,n,o,n+(E=Math.cos(c))*_,o+(A=Math.sin(c))*_,v);if(m){var y=m.x-n,b=m.y-o,x=Math.sqrt(y*y+b*b);h=Math.max(h,x)}}if("square"===i.shape.get(r)){var E=Math.abs(Math.cos(l)),A=Math.abs(Math.sin(l)),S=1/Math.max(E,A);h=Math.max(h,S)}return h}function Td(t,e){Cd(t.body,e,!0,!0),Cd(t.outline,e,e.outline.enabled,!0),Cd(t.halo,e,!!e.halo.color,!1),Md(t.texts.primary,e.texts.primary),Md(t.texts.secondary,e.texts.secondary)}function Cd(t,e,i,r){t.body=i,t.head=i&&r&&!!e.shape.head,t.tail=i&&r&&!!e.shape.tail}function Md(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor}function Id(t,e,i,r){Ld(t,e,i,r),t.thicknessOrFontSizeScaled=e.widthScaled,t.thicknessOrFontSizeFixed=e.widthFixed,t.strokeWidthScaled=e.stroke.widthScaled,t.strokeWidthFixed=e.stroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.color,t.strokeColor=e.stroke.color,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=e.stroke.minVisibleSize,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function Ld(t,e,i,r){t.pieceId=i,t.shape=r,t.x1=e.sourceX,t.y1=e.sourceY,t.x2=e.targetX,t.y2=e.targetY,t.rectWidthOrSourceRadiusScaled=e.sourceRadiusScaled,t.rectWidthOrSourceRadiusFixed=e.sourceRadiusFixed,t.rectHeightOrTargetRadiusScaled=e.targetRadiusScaled,t.rectHeightOrTargetRadiusFixed=e.targetRadiusFixed,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.widthScaled,t.curvature=e.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=e.isSelfLoop,t.isText=!1}function Nd(t,e,i){var r=e.widthScaled+2*e.halo.widthScaled,n=e.widthFixed+2*e.halo.widthFixed;Ld(t,e,i,"line"),t.thicknessOrFontSizeScaled=r,t.thicknessOrFontSizeFixed=n,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.halo.color,t.strokeColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1}function kd(t,e,i,r){Ld(t,e,i,r);var n=.17*e.widthFixed+1;t.thicknessOrFontSizeScaled=1*e.widthScaled,t.thicknessOrFontSizeFixed=1*e.widthFixed,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=.17*e.widthScaled,t.offsetFixed=n,t.fillColor=e.outline.color,t.strokeColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,e.outline.minVisibleSize),t.strokeMinVisibleSize=0,t.offsetAngle=Math.PI/2,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function Od(t,e,i){var r=(i.widthScaled+e.heightScaled)/2+i.stroke.widthScaled,n=(i.widthFixed+e.heightFixed)/2+i.stroke.widthFixed+e.padding+e.margin;t.pieceId=5,t.shape="square",t.x1=i.sourceX,t.y1=i.sourceY,t.x2=i.targetX,t.y2=i.targetY,t.rectWidthOrSourceRadiusScaled=e.widthScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.padding+1,t.rectHeightOrTargetRadiusScaled=e.heightScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.padding,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=i.sourceRadiusScaled+i.targetRadiusScaled,t.strokeWidthFixed=i.sourceRadiusFixed+i.targetRadiusFixed,t.offsetScaled=r,t.offsetFixed=n,t.pattern.type=0,t.opacity=i.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,i.minVisibleSize),t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.offsetAngle,t.patternScale=0,t.symbolicSize=i.widthScaled,t.curvature=i.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=i.isSelfLoop,t.isText=!1,t.adjustTextAngle=e.adjustAngle}function Fd(t,e,i,r,n,o){!function(t,e,i,r){if(Rd(i.body,r,Id),i.halo.body){var n=e.halo.width.get(t),o=+("scaled"===e.halo.scalingMethod.get(t));r.halo.widthScaled=n*o,r.halo.widthFixed=n*(1-o),Rd(i.halo,r,Nd)}i.outline.body&&(r.outline.color=e.outline.color.get(t),r.outline.minVisibleSize=e.outline.minVisibleSize.get(t),Rd(i.outline,r,kd))}(i,r,n,o),Pd(t,e,i,r.text,n.texts.primary,o.texts.primary,o),Pd(t,e,i,r.text.secondary,n.texts.secondary,o.texts.secondary,o)}function Rd(t,e,i){i(t.body,e,2,e.shape.type),t.head&&i(t.head,e,3,e.shape.head),t.tail&&i(t.tail,e,4,e.shape.tail)}function Pd(t,e,i,r,n,o,a){if(n.text){var s=r,u=s.scaling.get(i);if(o.font=e.fontManager.getFont(s.font.get(i)),o.color=Wu(s.color.get(i),a.color),o.style=s.style.get(i),o.minVisibleSize=s.minVisibleSize.get(i),o.margin=s.margin.get(i),o.padding=s.padding.get(i),o.maxLineLength=s.maxLineLength.get(i),o.content=Wo(o.content,o.maxLineLength),o.adjustAngle=s.adjustAngle.get(i),o.align=s.align.get(i),u){var d=s.scale.get(i);o.sizeScaled=a.widthScaled*d,o.sizeFixed=a.widthFixed*d}else o.sizeFixed=s.size.get(i),o.sizeScaled=0;var l=t.measureText(o.content,o.font,o.style);o.widthScaled=l.width*o.sizeScaled,o.widthFixed=l.width*o.sizeFixed,o.heightScaled=l.height*o.sizeScaled,o.heightFixed=l.height*o.sizeFixed,o.offsetAngle=o===a.texts.primary?ma:ya,Od(f=n.text,g=o,a),f.pattern.type=7,f.pattern.attributes.text=g.content,f.pattern.attributes.size=-1,f.pattern.attributes.font=g.font,f.pattern.attributes.style=g.style,f.pattern.attributes.align=g.align,f.patternColor=g.color,f.patternScale=1,f.thicknessOrFontSizeScaled=g.sizeScaled,f.thicknessOrFontSizeFixed=g.sizeFixed,f.isText=!0,n.background&&(Od(h=n.background,c=o,a),h.fillColor=c.backgroundColor)}var h,c,f,g}var Dd=qu(Gd,"start"),zd=qu(Gd,"end"),Bd=Xu(Gd),Ud=(Vd.prototype.drawEdge=function(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();var e=this._engine,i=this._helper,r=-t,n=this._attributes,o=td(n.layer.get(t)-(n.detectable.get(t)?0:1),this._depthInfo),a=n.source.get(t),s=n.target.get(t),u=n.curvature.get(t),d=this._attributesPrev.curvature.get(t),l=n.animationDuration.get(t),h=n.animationStart.get(t),c=n.animationEasing.get(t),f=0<l,g=0!==u||f&&0!==d;this._prepareBlocks(f,o,r,g);var p=this._extremitiesAttributes={source:this._nodeAttributes,target:this._nodeAttributes};if(Ad(i,this._endInput,n,t,p,this._view),Td(this._endFlags,this._endInput),f){var _=0<this._nodeAttributes.animationDuration.get(a),v=0<this._nodeAttributes.animationDuration.get(s);p.source=_?this._nodeAttributesPrev:this._nodeAttributes,p.target=v?this._nodeAttributesPrev:this._nodeAttributes,Ad(i,this._startInput,this._attributesPrev,t,p,this._view),Td(this._startFlags,this._startInput),Bd(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._blocks),zd(this._fullComponents,this._endComponents),Fd(e,i,t,this._attributes,this._endComponents,this._endInput),f&&(Dd(this._fullComponents,this._startComponents),Fd(e,i,t,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(l,h,c)),this._setupHaloMasking(a,s),this._storeBlocks()},Vd.prototype._setupHaloMasking=function(t,e){var i=this._nodeAttributes.halo,r=this._blocks,n=i.color.get(t)&&i.hideNonAdjacentEdges.get(t),o=i.color.get(e)&&i.hideNonAdjacentEdges.get(e),a=n||o?1:3;r.body.setStencilUsage(a),r.text.setStencilUsage(a),r.textBg.setStencilUsage(a)},Vd.prototype._computeBlockIds=function(t){var e=10*t,i=this._blockIds;i.body=5+e,i.halo=8+e,i.text=6+e,i.textBg=7+e},Vd.prototype._prepareBlocks=function(t,e,i,r){var n=this._blocks;n.body.reset(r?3:1,t,e.edgeBody,i),n.halo.reset(r?3:1,t,e.edgeHalo,i),n.text.reset(2,t,e.edgeText,i),n.textBg.reset(1,t,e.edgeTextBackground,i)},Vd.prototype._storeBlocks=function(){var t=this._engine,e=this._blocks,i=this._blockIds;t.storeBlock(i.body,e.body),t.storeBlock(i.halo,e.halo),t.storeBlock(i.text,e.text),t.storeBlock(i.textBg,e.textBg)},Vd.prototype._freeBlocks=function(){var t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.halo),t.freeBlock(e.text),t.freeBlock(e.textBg)},Vd.prototype._setBlocksAnimation=function(t,e,i){var r=this._blocks;r.body.setGlobalAnimation(t,e,i),r.halo.setGlobalAnimation(t,e,i),r.text.setGlobalAnimation(t,e,i),r.textBg.setGlobalAnimation(t,e,i)},Vd.prototype._initComponents=function(t,e,i){this._initEdgeComponents(t.halo,e.halo,i.halo),this._initEdgeComponents(t.outline,e.outline,i.body),this._initEdgeComponents(t.body,e.body,i.body),this._initTextComponents(t.texts.primary,e.texts.primary,i),this._initTextComponents(t.texts.secondary,e.texts.secondary,i)},Vd.prototype._initEdgeComponents=function(t,e,i){t.head=this._nextElement(e.head,i),t.tail=this._nextElement(e.tail,i),t.body=this._nextElement(e.body,i)},Vd.prototype._initTextComponents=function(t,e,i){t.background=this._nextElement(e.background,i.textBg),t.text=this._nextElement(e.text,i.text)},Vd.prototype._nextElement=function(t,e){return t?e.next():this._nullElt},Vd);function Vd(t){var e=t.engine,i=t.imageManager,r=t.fontManager,n=t.formatText,o=t.view,a=t.attributes,s=t.attributesPrev,u=t.nodeAttributes,d=t.nodeAttributesPrev;this._fullComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._endComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startFlags={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._endFlags={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startInput={source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{type:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0},secondary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}},this._endInput={source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{type:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0},secondary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}},this._depthInfo={edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},this._nullElt={id:-1,valid:!0},this._engine=e,this._view=o,this._helper={imageManager:i,fontManager:r,formatText:n},this._attributes=a,this._attributesPrev=s,this._nodeAttributes=u,this._nodeAttributesPrev=d,this._blocks=jd((function(){return e.createBlock()})),this._blockIds=jd((function(){return 0}))}function jd(t){return{body:t(),halo:t(),text:t(),textBg:t()}}function Gd(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}var Hd=vt&&document.fonts,Wd="/qwerty/ [HELLO] ",qd=(Xd.prototype._measureText=function(t,e){return this._ctx.font="12px "+e,this._ctx.measureText(t).width},Xd.prototype.check=function(t){if(this._checkReliable)return this._fontFaceSet.check("12px "+t);var e=this._measureText(Wd,"serif");return this._measureText(Wd,t)!==e},Xd.prototype.load=function(t){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load("12px "+t):(this._ctx.font="12px "+t,this._ctx.fillText(Wd,10,50),Promise.resolve())},Xd);function Xd(){this._fontFaceSet=Hd?document.fonts:null,this._canvas=$r(),this._ctx=this._canvas.getContext("2d"),this._checkReliable=!0===(this._fontFaceSet&&this._fontFaceSet.check&&!this._fontFaceSet.check("12px FontThatDoesNotExist")),this._ctx=this._canvas.getContext("2d")}var Yd=(Zd.prototype._setLoaded=function(){this._loaded=!0,this._value=this._fontName},Zd.prototype.getValue=function(){return this._value},Zd.prototype.isLoaded=function(){return this._loaded},Zd.prototype.destroy=function(){clearTimeout(this._timeout)},Zd.prototype.load=function(){var t=this;return this._tryLoad(200).then((function(){t._setLoaded()}))},Zd.prototype._tryLoad=function(t){var e=this;return this._fontFaceSet.load(this._fontName).then((function(){if(!e._fontFaceSet.check(e._fontName)&&e._fontLoaderCounter<16)return new Promise((function(i){t<6e4&&(e._timeout=setTimeout(i,t))})).then((function(){return e._fontLoaderCounter++,e._tryLoad(1.5*t)}))}))},Zd);function Zd(t,e){this._fontLoaderCounter=0,this._loaded=!1,this._value=null,this._timeout=0,this._fontFaceSet=t,this._fontName=e,this._loaded=!1,this._value=null,this._timeout=0,vt&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}var Kd=(Qd.prototype.setHideUntilFontsLoaded=function(t){this._hideUntilFontsLoaded=t},Qd.prototype.getFont=function(t){var e=this,i=this._fonts[t];return i||(i=new Yd(this._fontFaceSet,t),(this._fonts[t]=i).isLoaded()||i.load().then((function(){return e._triggerFontLoaded(t)}))),!this._hideUntilFontsLoaded&&t||i.getValue()},Qd.prototype.onFontLoaded=function(t){this._onFontLoaded.push(t)},Qd.prototype.destroy=function(){var t=this;this._onFontLoaded=[],Object.keys(this._fonts).forEach((function(e){return t._fonts[e].destroy()}))},Qd.prototype._triggerFontLoaded=function(t){this._onFontLoaded.forEach((function(e){return e(t)}))},Qd);function Qd(){this._fontFaceSet=new qd,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}function Jd(t,e,i){for(var r=i.length,n=r-1,o=!1,a=0;a<r;++a)(i[a].y<e&&i[n].y>=e||i[n].y<e&&i[a].y>=e)&&(i[a].x<=t||i[n].x<=t)&&(o=o!==i[a].x+(e-i[a].y)/(i[n].y-i[a].y)*(i[n].x-i[a].x)<t),n=a;return o}function $d(t){var e=t.x*t.x+t.y*t.y;return{x:t.x/e,y:t.y/e}}function tl(t,e){for(var i=1/0,r=-1/0,n=0,o=t.length;n<o;n++){var a=t[n],s=a.x*e.x+a.y*e.y;s<i&&(i=s),r<s&&(r=s)}return{x:i,y:r}}function el(t,e){for(var i=function(t,e){var i=t[1],r=t[0],n=$d({x:i.x-r.x,y:i.y-r.y}),o=n.x;n.x=-n.y,n.y=o;var a=n;i=t[2],r=t[1],o=(n=$d({x:i.x-r.x,y:i.y-r.y})).x,n.x=-n.y,n.y=o;var s=n;i=e[1],r=e[0],o=(n=$d({x:i.x-r.x,y:i.y-r.y})).x,n.x=-n.y,n.y=o;var u=n;return i=e[2],r=e[1],o=(n=$d({x:i.x-r.x,y:i.y-r.y})).x,n.x=-n.y,n.y=o,[a,s,u,n]}(t,e),r=0,n=i.length;r<n;r++){var o=i[r],a=tl(t,o),s=tl(e,o);if(0==(a.x<=s.y&&a.y>=s.x?Math.min(a.y,s.y)-Math.max(a.x,s.x):0))return!1}return!0}function il(t){var e=0,i=0,r=t.length;if(0===r)throw new Error("Compute centroid: at least one point is required");for(var n=0;n<r;++n){var o=t[n];e+=o.x,i+=o.y}return{x:e/=r,y:i/=r}}var rl,nl,ol=vl(4),al=vl(5),sl=vl(10,.4),ul=1/3,dl=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],ll={circle:{getDistanceFromStrokeVertically:function(t,e){return 1},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.sqrt(t*t+e*e)},points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:function(t,e){return 1-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],isSimple:!0},line:{getDistanceFromStrokeVertically:function(t,e){return 1-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1},points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:function(t,e){return(1-t)/2-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:function(t,e){return(1-t)/2-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:function(t,e){return Math.min(Math.sqrt((t+.4)*(t+.4)+e*e)-.27,(1-t)/2-Math.abs(e))},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:function(t,e){var i=Math.min((1-t)/2-Math.abs(e),1-Math.abs(t)),r=-_l(t,e,dl);return Math.min(i,r)},getDistanceFromStrokeHorizontally:function(t,e){return 1},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:dl,isSimple:!0},"short-arrow":ml([{x:-1,y:-ul},{x:0,y:-ul},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:ul},{x:-1,y:ul}],!1),"sharp-arrow":ml([{x:-1,y:-ul},{x:-.55,y:-ul},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:ul},{x:-1,y:ul}],!1),cross:{getDistanceFromStrokeVertically:function(t,e){return 1},getDistanceFromStrokeHorizontally:function(t,e){var i=Math.abs(t),r=Math.abs(e),n=.31-Math.min(i,r),o=1-Math.max(i,r);return Math.min(n,o)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],isSimple:!1},diamond:ml(ol),pentagon:ml(al),star:ml(sl)},hl=["circle","square","triangle","line"],cl=["cross","diamond","pentagon","star"],fl=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function gl(t,e){for(var i=0,r=hl;i<r.length;i++)pl(t,r[i]);for(var n=e.nodes.current.shape.getValues(),o=e.edges.current.shape.head.getValues(),a=e.edges.current.shape.tail.getValues(),s=0,u=cl;s<u.length;s++){var d=u[s];n.includes(d)&&pl(t,d)}for(var l=0,h=fl;l<h.length;l++){var c=h[l];c&&(o.includes(c)||a.includes(c))&&pl(t,c)}}function pl(t,e){t.registerShape(e,ll[e])}function _l(t,e,i){for(var r=1/0,n={x:t,y:e},o=0;o<i.length;++o){var a=i[o],s=i[(o+1)%i.length];r=Math.min(r,Is(n,a,s))}return r*(Jd(t,e,i)?1:-1)}function vl(t,e){void 0===e&&(e=1);for(var i=-Math.PI/2+1e-6,r=[],n=2*Math.PI/t,o=i,a=0;a<t;++a){var s=a%2==1?e:1;r.push({x:Math.cos(o)*s,y:Math.sin(o)*s}),o+=n}return r}function ml(t,e){return void 0===e&&(e=!1),{getDistanceFromStrokeVertically:function(){return 1},getDistanceFromStrokeHorizontally:function(e,i){return _l(e,i,t)},points:t,isSimple:e}}function yl(t){var e=t.graphWidth,i=t.graphHeight,r=t.viewWidth,n=t.viewHeight;return.2*Math.min(r/e,n/i)}function bl(t){var e=t.smallestNodeSize,i=t.viewWidth,r=t.viewHeight;return e===1/0?1/0:Math.min(i,r)/e*.5}(nl=rl=rl||{}).ROTATION="rotation",nl.PAN="pan",nl.ZOOM="zoom",nl.GESTURE="gesture";var xl,El,Al,Sl=(E(wl,xl=xe),wl.prototype._setupInteractions=function(){var t=this;this._interactions.onMouseWheel({priority:"zoom",check:function(){return!!t._settings.get("interactions.zoom.enabled")},handler:B((function(e){var i=e.x,r=e.y,n=e.delta;return t._smoothZoom(n,i,r)}),50)}),this._interactions.onDoubleClick({priority:"zoom",check:function(){var e=t._settings.get("interactions.zoom.enabled"),i=t._settings.get("interactions.zoom.onDoubleClick");return!(!e||!i)},handler:function(e){var i=e.x,r=e.y;return t._smoothZoom(1,i,r)}}),this._interactions.onDrag({priority:"panning",disableDetection:!0,check:function(e){var i=e.button,r=!!t._settings.get("interactions.pan.enabled");return"left"===i&&r},onStart:function(){return t._updateVisibility(rl.PAN,!0)},onProgress:function(e){var i=e.dx,r=e.dy;return t._camera.move({x:-i,y:-r})},onStop:function(){return t._updateVisibility(rl.PAN,!1)}}),this._interactions.onDrag({priority:"rotation",disableDetection:!0,check:function(e){var i=e.button,r=e.domEvent;return("right"===i||r&&2===r.buttons)&&!!t._settings.get("interactions.rotation.enabled")},onStart:function(e){var i=e.x,r=e.y;t._rotationStart={x:i,y:r},t._updateVisibility(rl.ROTATION,!0)},onProgress:function(e){var i=e.x,r=e.y;return t._rotate({x:i,y:r})},onStop:function(){return t._updateVisibility(rl.ROTATION,!1)}}),this._interactions.onGesture({priority:"gesture",disableDetection:!0,check:function(){return!!t._settings.get("interactions.gesture.enabled")},onStart:function(){return t._updateVisibility(rl.GESTURE,!0)},onProgress:function(e){var i=e.dx,r=e.dy,n=e.rotation,o=e.scale,a=e.x,s=e.y;t._settings.get("interactions.rotation.enabled")&&t._camera.rotate(-n),t._camera.zoomIn(o,void 0,{refX:a,refY:s}),t._camera.move({x:-i,y:-r})},onStop:function(){return t._updateVisibility(rl.GESTURE,!0)}})},wl.prototype._rotate=function(t){var e=t.x,i=t.y,r=this._camera.getSize(),n=r.width/2,o=r.height/2,a=this._rotationStart.x-n,s=this._rotationStart.y-o,u=e-n,d=i-o,l=Math.atan2(s,a)-Math.atan2(d,u);this._rotationStart.x=e,this._rotationStart.y=i,this._camera.rotate(l)},wl.prototype._updateVisibility=function(t,e){var i=!e,r=this._settings,n=r.get("interactions."+t+".hideNodes"),o=r.get("interactions."+t+".hideEdges"),a=r.get("interactions."+t+".hideNodeTexts"),s=r.get("interactions."+t+".hideEdgeTexts");n&&this._graphics.setNodesVisibility(i),a&&this._graphics.setNodeTextsVisibility(i),o&&this._graphics.setEdgesVisibility(i),s&&this._graphics.setEdgeTextsVisibility(i)},wl.prototype._smoothZoom=function(t,e,i){var r=this,n=this._settings,o=n.get("interactions.zoom.modifier")||1.8,a=n.get("interactions.zoom.duration"),s=n.get("interactions.zoom.easing"),u=this._camera.getZoom()*(0<t?o:1/o),d={duration:a,easing:s};this._zooming||(this._zooming=!0,this._updateVisibility(rl.ZOOM,!0)),this._camera.setZoom(u,d,{refX:e,refY:i}).then((function(){r._zooming&&(r._zooming=!1,r._updateVisibility(rl.ZOOM,!1))}))},wl);function wl(t,e){t.locate,t.dom;var i=t.camera,r=t.graphics,n=t.settings,o=t.interactions,a=xl.call(this)||this;return a._zooming=!1,a._camera=i,a._settings=n,a._interactions=o,a._graphics=r,n.register("interactions.zoom.enabled",!0),n.register("interactions.zoom.onDoubleClick",!1),n.register("interactions.zoom.duration",150),n.register("interactions.zoom.modifier",1.8),n.register("interactions.zoom.easing","quadraticOut"),n.register("interactions.zoom.minValue",e?null:yl),n.register("interactions.zoom.maxValue",e?null:bl),n.register("interactions.zoom.hideNodes",!1),n.register("interactions.zoom.hideEdges",!1),n.register("interactions.zoom.hideNodeTexts",!1),n.register("interactions.zoom.hideEdgeTexts",!1),n.register("interactions.pan.enabled",!0),n.register("interactions.pan.hideNodes",!1),n.register("interactions.pan.hideEdges",!1),n.register("interactions.pan.hideNodeTexts",!1),n.register("interactions.pan.hideEdgeTexts",!1),n.register("interactions.rotation.enabled",!0),n.register("interactions.rotation.hideNodes",!1),n.register("interactions.rotation.hideEdges",!1),n.register("interactions.rotation.hideNodeTexts",!1),n.register("interactions.rotation.hideEdgeTexts",!1),n.register("interactions.gesture.enabled",!0),n.register("interactions.gesture.hideNodes",!1),n.register("interactions.gesture.hideEdges",!1),n.register("interactions.gesture.hideNodeTexts",!1),n.register("interactions.gesture.hideEdgeTexts",!1),a._setupInteractions(),a}(Al=El=El||{}).ZOOM="zoom",Al.ROTATE="rotate";var Tl={duration:0,easing:"linear",startAfter:0,ignoreZoomLimits:!(Al.PAN="pan"),callback:function(){}};function Cl(t){return Math.abs(t)<1e-9}var Ml,Il=(E(Ll,Ml=xe),Object.defineProperty(Ll.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"angle",{get:function(){return this._angle},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"width",{get:function(){return this._dimensions.width},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"height",{get:function(){return this._dimensions.height},enumerable:!0,configurable:!0}),Ll.prototype.moveEnd=function(t){var e=this;this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout((function(){e._timeout=0,e._events.fire(ye.VIEW_CHANGED,{type:t})}),80)},Ll.prototype.getSize=function(){return{width:this._dimensions.width,height:this._dimensions.height}},Ll.prototype.getCenter=function(){return{x:this._x,y:this._y}},Ll.prototype.setCenter=function(t,e){var i=this,r=t.x,n=t.y,o=A(A({},Tl),e),a=this._x,s=this._y,u=r-this._x,d=n-this._y;return Cl(u)&&Cl(d)?Promise.resolve():new Promise((function(t){o.callback=function(){i.moveEnd(El.PAN),t()},i._moveAnimation&&i._animations.end(i._moveAnimation,!1);var e=i._animations.play((function(t){i._x=a+u*t,i._y=s+d*t,i._events.fire(ye.CAMERA_MOVE),i._events.fire(ye.CAMERA_PAN)}),o);e&&(i._moveAnimation=e)}))},Ll.prototype.move=function(t,e){var i=Nl({x:t.x,y:t.y},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+i.x,y:this._y+i.y},e)},Ll.prototype.getZoom=function(){return this._zoom},Ll.prototype.setZoom=function(t,e,i){var r=this;void 0===i&&(i={refX:void 0,refY:void 0});var n=A(A({},Tl),e),o=i.refX,a=i.refY,s=qe(t,this._minZoom,this._maxZoom);return n.ignoreZoomLimits||(s=this._applyZoomLimits(s)),Cl(this._zoom-s)?Promise.resolve():new Promise((function(t){var i=r._dimensions.width/2,u=r._dimensions.height/2,d=r._zoom,l=i/d-i/s;if(n.callback=function(){r.moveEnd(El.ZOOM),t()},void 0!==o&&void 0!==a){var h=(o-i)/d-(o-i)/s,c=(a-u)/d-(a-u)/s,f=r._cosAngle,g=r._sinAngle,p=f*h-g*c,_=g*h+f*c;r.setCenter({x:r._x+p,y:r._y+_},e)}r._zoomAnimation&&r._animations.end(r._zoomAnimation,!1),r._dom.setTimeout((function(){r._events.fire(ye.START_ZOOM,{duration:n.duration,easing:n.easing,startZoom:d,endZoom:s})}));var v=r._animations.play((function(t){r._zoom=i/(i/d-l*t),r._events.fire(ye.CAMERA_MOVE),r._events.fire(ye.CAMERA_ZOOM)}),n);v&&(r._zoomAnimation=v)}))},Ll.prototype._applyZoomLimits=function(t){var e=this._settings.get("interactions.zoom.minValue"),i=this._settings.get("interactions.zoom.maxValue"),r=this._modules.locate.getGraphBoundingBox(),n=r.minScaledSize,o=r.maxScaledSize,a=r.width,s=r.height,u=r.cx,d=this._zoom,l=this.getSize(),h=t;if(!isNaN(u)){var c={smallestNodeSize:n,biggestNodeSize:o,graphWidth:a+o,graphHeight:s+o,viewWidth:l.width,viewHeight:l.height},f=e&&e(c),g=i&&i(c);kl(f)&&h<f?h<d&&(h=Math.min(d,f)):kl(g)&&g<h&&d<h&&(h=Math.max(d,g))}return h},Ll.prototype.zoomIn=function(t,e,i){var r;return void 0===i&&(i={refX:void 0,refY:void 0}),r="number"!=typeof t?(i=e,e=t,this._settings.get("interactions.zoom.modifier")||1.8):t,this.setZoom(this._zoom*r,e,i)},Ll.prototype.zoomOut=function(t,e,i){var r;return void 0===i&&(i={refX:void 0,refY:void 0}),r="number"!=typeof t?(i=e,e=t,this._settings.get("interactions.zoom.modifier")||1.8):t,this.setZoom(this._zoom/r,e,i)},Ll.prototype.getAngle=function(){return this._angle},Ll.prototype.setAngle=function(t,e){var i=this,r=A(A({},Tl),e),n=this._angle,o=t-n;return Cl(o)?Promise.resolve():new Promise((function(t){r.callback=function(){i.moveEnd(El.ROTATE),t()},i._rotateAnimation&&i._animations.end(i._rotateAnimation,!1);var e=i._animations.play((function(t){for(i._angle=n+o*t;i._angle>Math.PI;)i._angle-=2*Math.PI;for(;i._angle<-Math.PI;)i._angle+=2*Math.PI;i._sinAngle=Math.sin(i._angle),i._cosAngle=Math.cos(i._angle),i._events.fire(ye.CAMERA_MOVE),i._events.fire(ye.CAMERA_ROTATE)}),r);e&&(i._rotateAnimation=e)}))},Ll.prototype.rotate=function(t,e){return this.setAngle(this._angle+t,e)},Ll.prototype.getScreenCenter=function(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}},Ll.prototype.graphToScreenCoordinates=function(t,e){var i=t.x,r=t.y;void 0===e&&(e={x:0,y:0});var n=this._dimensions.width/2,o=this._dimensions.height/2;return Ra((i-this._x)*this._zoom+n,(r-this._y)*this._zoom+o,n,o,-this._angle,e)},Ll.prototype.screenToGraphCoordinates=function(t,e){var i=t.x,r=t.y;return void 0===e&&(e={x:0,y:0}),Ra(this._x+(i-this._dimensions.width/2)/this._zoom,this._y+(r-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,e)},Ll.prototype.projectBounds=function(t,e){void 0===e&&(e=t);for(var i=t[0],r=t[1],n=t[2],o=t[3],a=this._x,s=this._y,u=this._dimensions.width/2,d=this._dimensions.height/2,l=this._sinAngle,h=this._cosAngle,c=1/this._zoom,f=1/0,g=1/0,p=-1/0,_=-1/0,v=[i,r,i,o,n,o,n,r],m=0;m<v.length;m+=2){var y=v[m],b=v[m+1],x=(y=a+(y-u)*c)-a,E=(b=s+(b-d)*c)-s;(y=h*x-l*E+a)<f&&(f=y),p<y&&(p=y),(b=l*x+h*E+s)<g&&(g=b),_<b&&(_=b)}return e[0]=f,e[1]=g,e[2]=p,e[3]=_,e},Ll.prototype.screenToGraphVector=function(t){return Nl({x:t.x,y:t.y},this._zoom,this._sinAngle,this._cosAngle)},Ll.prototype.getView=function(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}},Ll.prototype.setView=function(t,e){var i=A({x:this._x,y:this._y,zoom:this._zoom,angle:this._angle},t),r=i.x,n=i.y,o=i.zoom,a=i.angle;return Promise.all([this.setCenter({x:r,y:n},e),this.setZoom(o,e),this.setAngle(a,e)]).then((function(){}))},Ll.prototype._reloadDimensions=function(){this._dimensions=this._dom.getDimensions()},Ll.prototype.animationInProgress=function(){var t=this._moveAnimation,e=this._zoomAnimation;return t&&!t.done||e&&!e.done},Ll.prototype.getProjectedScreenBounds=function(t){void 0===t&&(t=0);var e=this._dimensions,i=e.width,r=e.height,n=Math.max(i,r)*t;return this.projectBounds([0-n,0-n,i+n,r+n])},Ll.prototype._reset=function(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this._sinAngle=0,this._cosAngle=1,this._dimensions=this._dom.getDimensions()},Ll);function Ll(t){var e,i=Ml.call(this)||this;i._minZoom=1e-8,i._maxZoom=1e8,i._timeout=0;var r=t.events,n=t.settings;return i._modules=t,i._events=r,i._dom=t.dom,i._animations=t.animations,i._settings=n,i._reset(),n.register("minZoom",1e-8,(function(t){i._minZoom=t,i._zoom<t&&(i._zoom=t,i._events.fire(ye.CAMERA_MOVE))})),n.register("maxZoom",1e8,(function(t){i._maxZoom=t,i._zoom>t&&(i._zoom=t,i._events.fire(ye.CAMERA_MOVE))})),r.on(((e={})[ye.SET_CONTAINER]=function(){i._reset(),i._events.fire(ye.CAMERA_MOVE)},e[ye.RESIZE]=function(){i._reloadDimensions(),i._events.fire(ye.CAMERA_MOVE)},e)),i}function Nl(t,e,i,r){var n=t.x,o=t.y;return{x:r*(n/=e)-i*(o/=e),y:i*n+r*o}}function kl(t){return"number"==typeof t&&isFinite(t)}function Ol(){}var Fl,Rl={maxBlockId:1024,maxCoord:-1/0,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},Pl=_t?"webgl":null,Dl=(E(zl,Fl=xe),zl.prototype.onMounted=function(t,e){var i=this;void 0!==e.renderer&&t.setOptions({renderer:e.renderer}),void 0!==e.imgCrossOrigin&&t.setOptions({imgCrossOrigin:e.imgCrossOrigin}),this._dom.addWindowEventListener("unload",(function(){i.destroy()}))},zl.prototype.getTransparentBackgroundColor=function(){var t=this._settings.get("backgroundColor");return t?this._engine.transparentify(t):null},zl.prototype._render=function(){var t=this._dom.getDimensions(),e=this._camera.getView(),i=Ct(),r=Jt(),n=this._settings.get("backgroundColor"),o=this._isBufferDisplayable;this._engine.setView({x:e.x,y:e.y,zoom:e.zoom,angle:e.angle,width:t.width,height:t.height,pixelRatio:i,currentTime:r,backgroundColor:n,isBufferDisplayable:o});try{this._engine.render(),"requested"===this._rendererState.state&&this._updateRendererState({state:"ok"})}catch(t){if(this._debug)throw t;var a=t.message,s=t.code,u=void 0===s?"OTHER":s,d=this._rendererState.type,l=function(t){return null===t?"none":"webgl"===t?"WebGL":"svg"===t?"SVG":"canvas"===t?"Canvas":t}(d),h="requested"===this._rendererState.state?"Error while initializing the "+l+" renderer":"The "+l+" renderer encountered an unexpected runtime error",c=null;"webgl"===d&&(h+="; fallbacking on canvas renderer",c="canvas"),Si(a||""),Si(h),this._updateRendererState({state:"error",code:u,message:a}),this._settings.set("renderer",c)}},zl.prototype._fireRendererStateChangeEvent=function(){var t=this._rendererState;this._events.fire(ye.RENDERER_STATE_CHANGE,{type:t.type,state:t.state,code:t.code,message:t.message})},zl.prototype._updateRendererState=function(t){var e=t.type,i=t.state,r=t.code,n=t.message,o=!1;void 0!==e&&this._rendererState.type!==e&&(this._rendererState.type=e,o=!0),void 0!==i&&this._rendererState.state!==i&&(this._rendererState.state=i,o=!0),void 0!==r&&this._rendererState.code!==r&&(this._rendererState.code=r,o=!0),void 0!==n&&this._rendererState.message!==n&&(this._rendererState.message=n,o=!0),o&&this._initDone&&this._fireRendererStateChangeEvent()},zl.prototype.getImageData=function(){var t=this;return this._dom.afterNextFrame().then((function(){return t._engine.getImageData()}))},zl.prototype.addCanvas=function(t){this._engine.addCanvas(t)},zl.prototype.removeCanvas=function(t){this._engine.removeCanvas(t)},zl.prototype.getNodeAttributes=function(){return this._attributesManager.getFlexArrays().nodes.current},zl.prototype.getEdgeAttributes=function(){return this._attributesManager.getFlexArrays().edges.current},zl.prototype.getGraphicsEngine=function(){return this._engine},zl.prototype.getImageManager=function(){return this._imageManager},zl.prototype.getFontManager=function(){return this._fontManager},zl.prototype.allocateGraphicsEngineBlockId=function(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():10*this._nextGeIndex+++9},zl.prototype.releaseGraphicsEngineBlockId=function(t){this._engine.freeBlock(t),this._availableGeIndexes.push(t),this._dom.refresh()},zl.prototype.addCursorStyle=function(t){t&&(this._cursorStyle.push(t),this._applyCursorStyle())},zl.prototype.removeCursorStyle=function(t){if(t){var e=this._cursorStyle.lastIndexOf(t);-1!==e&&(this._cursorStyle.splice(e,1),this._applyCursorStyle())}},zl.prototype.reloadFonts=function(){this._events.fire(ye.RELOAD_FONTS),this._engine.notifyFontsReloaded(),this._dom.refresh()},zl.prototype.getDomElement=function(){return this._domElement},zl.prototype.setTextHidden=function(t,e){this._attributesManager.setTextHidden(t,e)},zl.prototype.resetTextHidden=function(){this._attributesManager.resetTextHidden(),this._dom.refresh()},zl.prototype.getAttributesManager=function(){return this._attributesManager},zl.prototype._checkFontsNewlyLoaded=function(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)},zl.prototype._loadGraphInGraphicsEngine=function(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll();var t=this._attributesManager.getAndResetElementsToRedraw(),e=this._attributesManager.getAndResetElementsUpdated(),i=0<e.nodes.size||0<e.edges.size;(e.nodeAttributesSet.has("radius")||e.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=function(t){for(var e=t.getNodeAttribute("radius"),i=t.getEdgeAttribute("width"),r=t.getNodes(),n=t.getEdges(),o=0,a=0,s=0;s<r._indexes.length;s++){var u=r._indexes[s],d=e.get(u);o<d&&(o=d)}for(s=0;s<n._indexes.length;s++){u=n._indexes[s];var l=i.get(u);a<l&&(a=l)}return Math.max(2*o,a)}(this._graph)),(e.nodeAttributesSet.has("shape")||e.edgeAttributes.includes("shape.head")||e.edgeAttributes.includes("shape.tail"))&&gl(this._engine,this._attributesManager.getFlexArrays()),function(t){var e,i,r=t.graph,n=t.elements,o=t.engine,a=t.imageManager,s=t.fontManager,u=t.view,d=t.attributes,l=t.boundaries,h=t.formatText,c={nodeAttributes:i=it((e=d).nodes.current,{text:{secondary:{scaling:e.nodes.current.text.scaling,maxLineLength:e.nodes.current.text.maxLineLength}}}),nodeAttributesPrev:it(e.nodes.previous,{textHidden:i.textHidden,text:{secondary:{scaling:e.nodes.previous.text.scaling,maxLineLength:e.nodes.previous.text.maxLineLength}}}),edgeAttributes:it(e.edges.current,{text:{secondary:{scaling:e.edges.current.text.scaling,maxLineLength:e.edges.current.text.maxLineLength,adjustAngle:e.edges.current.text.adjustAngle}}}),edgeAttributesPrev:it(e.edges.previous,{source:e.edges.current.source,target:e.edges.current.target,textHidden:e.edges.current.textHidden,text:{secondary:{scaling:e.edges.previous.text.scaling,maxLineLength:e.edges.previous.text.maxLineLength,adjustAngle:e.edges.previous.text.adjustAngle}}})},f=c.nodeAttributes,g=c.nodeAttributesPrev,p=c.edgeAttributes,_=c.edgeAttributesPrev,v=n.nodes,m=n.edges,y=l.maxSize,b=l.maxMinVisibleSize;if(v.size||m.size){var x=10*(Math.max(r.getNodeMaxIndex(),r.getEdgeMaxIndex())+1),E=o.setGlobalBoundaries({maxBlockId:He(x),maxScaledSize:He(8*y),maxMinVisibleSize:He(b),maxSymbolicSize:He(y),maxDashLength:3,maxGapLength:1,maxPatternScale:2,maxCoord:-1/0}),A=(E?r.getNodes("_all"):v)._indexes,S=(E?r.getEdges("_all"):m)._indexes;if(A.length)for(var w=new fd({engine:o,imageManager:a,fontManager:s,formatText:h,attributes:f,attributesPrev:g}),T=0;T<A.length;++T)w.drawNode(A[T]);if(S.length){var C=new Ud({engine:o,imageManager:a,fontManager:s,formatText:h,view:u,attributes:p,attributesPrev:_,nodeAttributes:f,nodeAttributesPrev:g});for(T=0;T<S.length;++T)C.drawEdge(S[T])}}}({graph:this._graph,elements:t,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),i&&this._events.fire(ye.UPDATE_ATTRIBUTES,e)},zl.prototype._forceCompleteGraphRefresh=function(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()},zl.prototype.export=function(t,e,i,r){var n,o=this;return Promise.all([this._graph.getNodes().addClass(fi),this._graph.getEdges().addClass(fi)]).then((function(){return o.resolveAtNextFrame()})).then((function(){return o._imageManager.whenReady()})).then((function(){var a;return"all"===i?(a=o._graph,n={nodes:Bl(a,!0),edges:Bl(a,!1)},o._forceCompleteGraphRefresh()):o._loadGraphInGraphicsEngine(),o._engine.export(t,e,r)})).then((function(t){return Promise.all([o._graph.getNodes().removeClass(fi),o._graph.getEdges().removeClass(fi)]).then((function(){return t}))})).then((function(t){var e,r,a;return"all"===i&&(r=(e=n).nodes,a=e.edges,Ul(r),Ul(a),o._forceCompleteGraphRefresh()),t}))},zl.prototype.addAttributeLayer=function(t){return this._attributesManager.addAttributeLayer(t)},zl.prototype.createFlexArrays=function(){return this._attributesManager.createFlexArrays()},zl.prototype.getAttributeValues=function(t,e,i,r){return this._attributesManager.getAttributeValues(t,e,i,r)},zl.prototype.forceAttributesComputation=function(){this._attributesManager.update()},zl.prototype.resolveAtNextFrame=function(t){return this._dom.afterNextFrame().then((function(){return t}))},zl.prototype.animate=function(t,e,i){var r=function(t){return"number"==typeof t?t={duration:t}:"object"==typeof t&&null!==t||(t={duration:0}),{duration:function(t){return"number"!=typeof t||!isFinite(t)||t<0?0:t}(t.duration),easing:t.easing||"linear",chain:!!t.chain}}(i);return r.duration&&this._engine.ensureAnimationsReady(),this._animate(t,e,r)},zl.prototype.isAnimating=function(){return 0<this._animations.length},zl.prototype.getAnimationInformation=function(t){return this._attributesManager.getAnimationInformation(t)},zl.prototype._toSubGraph=function(t){if(t instanceof gr||t instanceof cr)return{nodes:t.toList(),edges:t.getAdjacentEdges()};if(t instanceof Ki||t instanceof Yi)return{nodes:this._graph.nodeList(),edges:t.toList()};var e=t,i={nodes:e.nodes||this._graph.nodeList(),edges:e.edges||this._graph.edgeList()};return i.nodes.size&&(i.edges.size?i.edges=i.edges.concat(i.nodes.getAdjacentEdges()).dedupe():i.edges=i.nodes.getAdjacentEdges()),i},zl.prototype._animate=function(t,e,i){var r=i.duration,n=i.easing;if(!this._animations.length&&!r)return e(t),Promise.resolve(t);var o=this._toSubGraph(t),a=o.nodes,s=o.edges;if(0===a.size&&0===s.size)return Promise.resolve(t);a.size&&this._events.fire(ye.ANIMATE,{elements:a,duration:r,easing:n}),s.size&&this._events.fire(ye.ANIMATE,{elements:s,duration:r,easing:n});for(var u={id:this._nextAnimationId++,startTime:-1,finished:!1,func:function(){return e(t)},duration:r,easing:n,nodes:a,edges:s,resolve:Ol},d=new Promise((function(e){return u.resolve=function(){return e(t)}})),l=0;l<a._indexes.length;l++)this._nodeAnimationList.set(a._indexes[l],u.id);for(l=0;l<s._indexes.length;l++)this._edgeAnimationList.set(s._indexes[l],u.id);return this._animations.push(u),this._dom.refresh(),r||this._processAnimations(),d},zl.prototype._removeFinishedAnimations=function(){this._animations=this._animations.filter((function(t){return!t.finished}))},zl.prototype._getAnimationElements=function(t){for(var e=[],i=[],r=0;r<t.nodes._indexes.length;r++){var n=t.nodes._indexes[r];this._nodeAnimationList.get(n)===t.id&&e.push(n)}for(r=0;r<t.edges._indexes.length;r++)n=t.edges._indexes[r],this._edgeAnimationList.get(n)===t.id&&i.push(n);return{nodes:this._graph.nodeList(new Uint32Array(e)),edges:this._graph.edgeList(new Uint32Array(i))}},zl.prototype._resetAnimationAttributes=function(t){var e=t.nodes,i=t.edges;this._attributesManager.resetAnimationAttributes({nodes:e,edges:i}),this._nodeAnimationList.fill(e._indexes,0),this._edgeAnimationList.fill(i._indexes,0)},zl.prototype._processAnimations=function(){if(this._animations.length){var t=Jt(),e=[];this._attributesManager.update();for(var i=0,r=this._animations;i<r.length;i++)-1===(u=r[i]).startTime&&(u.startTime=t,e.push(u.func),0<u.duration&&this._attributesManager.setAnimationAttributes(this._getAnimationElements(u),u));for(var n=0,o=e;n<o.length;n++)(0,o[n])();for(var a=0,s=this._animations;a<s.length;a++){var u;t>=(u=s[a]).startTime+u.duration&&(this._resetAnimationAttributes(this._getAnimationElements(u)),u.resolve(u.elements),u.finished=!0)}this._removeFinishedAnimations(),this._animations.length&&this._dom.refresh()}},zl.prototype.hideTexts=function(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)},zl.prototype.showTexts=function(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)},zl.prototype.setNodesVisibility=function(t){return this._updateVisibilityCounter("nodes",t)},zl.prototype.setNodeTextsVisibility=function(t){return this._updateVisibilityCounter("nodeTexts",t)},zl.prototype.setEdgesVisibility=function(t){return this._updateVisibilityCounter("edges",t)},zl.prototype.setEdgeTextsVisibility=function(t){return this._updateVisibilityCounter("edgeTexts",t)},zl.prototype._updateVisibilityCounter=function(t,e){this._visibility[t]+=e?-1:1,this._dom.refresh()},zl.prototype.detectNode=function(t){return function(t,e,i,r,n,o){var a=t.x,s=t.y,u=t.margin,d=t.texts,l=t.indexes;l=l||e.getNodes()._indexes;var h=r.getZoom(),c=e.getObjectList(!0),f=i.getFlexArrays().nodes.current,g=1/0,p=0;i.update();for(var _=0;_<l.length;++_){var v=l[_];if(!f.excluded.get(v)&&f.detectable.get(v)&&0===f.animationDuration.get(v)){var m=f.x.get(v),y=f.y.get(v),b=r.graphToScreenCoordinates({x:m,y:y}),x=b.x,E=b.y,A=f.shape.get(v),S="scaled"===f.scalingMethod.get(v),w=f.radius.get(v)*(S?h:1),T=w+u,C=(a-x)/T,M=(s-E)/T;if(n.checkShapeHit(A,C,M))T<=g&&(g=T,p=v);else if(d){var I=o(f.text.content.get(v)||null),L=f.textHidden.get(v),N=f.text.minVisibleSize.get(v);if(!L&&I&&N<=(S?2*w:1/0)){var k=Wo(I,f.text.maxLineLength.get(v)),O=f.innerStroke.width.get(v),F=f.outerStroke.width.get(v),R=f.text.margin.get(v),P=f.text.padding.get(v),D=f.text.size.get(v),z=f.text.scale.get(v),B=f.text.scaling.get(v),U=f.text.font.get(v),V=f.text.style.get(v),j=f.text.position.get(v),G=n.measureText(k,U,V,1),H=B?z*w:D,W=G.width*H/2+P+u,q=G.height*H/2+P+u,X=Hs[j],Y=O+F+R+w,Z=x+(Y+W)*X.x,K=E+(Y+q)*X.y;Z-W<a&&a<Z+W&&K-q<s&&s<K+q&&(p=v)}}}}return c.get(p)||null}(t,this._graph,this._attributesManager,this._camera,this._engine,this._formatText)},zl.prototype.detectEdge=function(t){return function(t,e,i,r){var n=t.margin,o=(t.texts,t.indexes),a=void 0===o?e.getEdges()._indexes:o,s=e.getObjectList(!1),u=r.getFlexArrays(),d=u.edges.current,l=u.nodes.current,h=i.getZoom(),c=n/h,f=i.screenToGraphCoordinates(t),g=f.x,p=f.y,_=0;r.update();for(var v=0;v<a.length;++v){var m=a[v],y=d.source.get(m),b=d.target.get(m),x=d.excluded.get(m),E=d.detectable.get(m),A=0!==d.animationDuration.get(m),S=0!==l.animationDuration.get(y),w=0!==l.animationDuration.get(b);if(!x&&E&&!A&&!S&&!w){var T=y===b,C=d.curvature.get(m),M="triangle"===d.shape.type.get(m),I="scaled"===d.scalingMethod.get(m),L=d.width.get(m)/(I?1:h),N=l.x.get(y),k=l.y.get(y),O=l.x.get(b),F=l.y.get(b);if(T){var R="scaled"===l.scalingMethod.get(y);Us(g,p,N,k,N,k,(P=Ta(N,k,C,l.radius.get(y)/(R?1:h),0)).x1,P.y1,P.x2,P.y2,L,c)&&(_=m)}else if(0!==C){var P;zs(g,p,N,k,O,F,(P=wa(N,k,O,F,C)).x,P.y,L,c,M)&&(_=m)}else Es(g,p,N,k,O,F,L,c,M)&&(_=m)}}return s.get(_)||null}(t,this._graph,this._camera,this._attributesManager)},zl.prototype.getVisibilityCounters=function(){return this._visibility},zl.prototype.destroy=function(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()},zl);function zl(t,e){var i,r=t.dom,n=t.graph,o=t.camera,a=t.events,s=t.settings,u=Fl.call(this)||this;return u._debug=!1,u._initDone=!1,u._boundaries={maxSize:10,maxMinVisibleSize:64},u._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},u._nextAnimationId=1,u._animations=[],u._rendererState={type:null,code:null,state:"ok",message:""},u._cursorStyle=[],u._fontsNewlyLoaded=[],u._nextGeIndex=1,u._availableGeIndexes=[],u._isBufferDisplayable=function(t){var e,i=2===(e=t.getDepth())||1===e||3<=(e-30)%6,r=Yu(t),n=i?u._visibility.nodes:u._visibility.edges,o=i?u._visibility.nodeTexts:u._visibility.edgeTexts;return 0===n&&(!r||0===o)},u._applyCursorStyle=function(){var t=u._cursorStyle[u._cursorStyle.length-1]||u._settings.get("cursor.default");Gt(u._domElement,t)},u._updateImageCrossOrigin=function(){u._imageManager.setImgCrossOrigin(u._settings.get("imgCrossOrigin")||null)},u._debug=e.isDebug(),u._events=a,u._dom=r,u._graph=n,u._camera=o,u._events=a,u._settings=s,u._formatText=Zo().applyArabicShaping,u._attributesManager=new Gu(n,r,e),u._imageManager=new bs,u._fontManager=new Kd,u._engine=new ps(ps.getCachedInitData()),u._domElement=u._engine.getDomElement(),u._nodeAnimationList=u._graph.createNodeAttribute({storage:32,default:0}),u._edgeAnimationList=u._graph.createEdgeAttribute({storage:32,default:0}),u._events.register([ye.RELOAD_FONTS,ye.RENDERER_STATE_CHANGE,ye.BEFORE_UPDATE_ATTRIBUTES,ye.UPDATE_ATTRIBUTES,ye.ANIMATE,ye.CAMERA_MOVE,ye.CAMERA_PAN,ye.CAMERA_ZOOM,ye.CAMERA_ROTATE,ye.VIEW_CHANGED,ye.START_ZOOM]),s.register("renderer",Pl,(function(t){u._updateRendererState({type:t,state:"requested",code:null,message:void 0}),u._engine.setRenderType(t),u._dom.refresh()})),s.register("backgroundColor","white",(function(t){u._engine.parseColor(t)?r.refresh():(Si('Invalid background color "'+t+'" specified; will default to black.'),s.set("backgroundColor","black"))})),s.register("texts.hideUntilFontsLoaded",!0,(function(t){u._fontManager.setHideUntilFontsLoaded(!!t)})),s.register("imgCrossOrigin","anonymous",u._updateImageCrossOrigin),s.register("cursor.default","default",u._applyCursorStyle),r.setLayer("graphics",u._domElement),u._engine.setGlobalBoundaries(Rl),r.beforeNextFrame().then((function(){u._initDone=!0,u._fireRendererStateChangeEvent()})),u._imageManager.onFetch((function(){u._engine.notifyPatternUpdate(),u._dom.refresh()})),u._fontManager.onFontLoaded((function(t){u._fontsNewlyLoaded.push(t),u._engine.notifyPatternUpdate(),u._engine.notifyFontsReloaded(),u._dom.refresh()})),r.addMediaListener("(min-resolution: 2dppx)",(function(){return r.refresh()})),u._visibleAttributeLayer=u._attributesManager.addAttributeLayer({priority:0,name:"internal("+oi+")",tag:oi,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),u._dataAttributeLayer=u._attributesManager.addAttributeLayer({priority:0,name:"internal(_data)",tag:ai,nodeDependencies:void 0,edgeDependencies:void 0}),gl(u._engine,u._attributesManager.getFlexArrays()),a.on(((i={})[ye.CAMERA_MOVE]=function(){return u._dom.refresh()},i[ye.NEW_FRAME]=function(){u._processAnimations(),u._loadGraphInGraphicsEngine(),u._render()},i[ye.CLEAR_GRAPH]=function(){u._nextGeIndex=1,u._availableGeIndexes=[],u._engine.clear(),u._attributesManager.clear(),u._dom.refresh()},i[ye.VIEW_CHANGED]=function(t){if(t.type===El.ROTATE){var e=u._graph.getEdges().filter((function(t){return t.getAttribute("adjustAnchors")}));u._attributesManager.redrawElements(e)}},i[ye.ADD_NODES+" "+ye.ADD_EDGES]=function(t){u._attributesManager.updateForAllAttributeLayers(t.nodes||t.edges)},i[ye.EXCLUDED_STATE_CHANGE]=function(t){u._visibleAttributeLayer.updateElements(t.elements)},i[ye.SET_DATA]=function(t){u._dataAttributeLayer.updateElements(t.elements)},i)),ps.clearCachedInitData(),u}function Bl(t,e){var i=e?t.getNodeAttribute("excluded"):t.getEdgeAttribute("excluded"),r=(e?t.getNodes("all"):t.getEdges("all"))._indexes,n=i.getMultiple(r);return i.fill(r,0),{excludedList:i,indexes:r,values:n}}function Ul(t){var e=t.excludedList,i=t.indexes,r=t.values;e.setMultiple(i,r)}var Vl,jl=(E(Gl,Vl=xe),Gl.prototype.register=function(t,e){var i=this;void 0===e&&(e=[]),t.forEach((function(t){if(i._events[t])throw new Error('event "'+t+'" already exists');i._events[t]=new Hl(!1,t)})),e.forEach((function(t){if(i._events[t])throw new Error('event "'+t+'" already exists');i._events[t]=new Hl(!0,t)}))},Gl.prototype.onAnyEvent=function(t){this._onAnyEvents.push(t)},Gl.prototype.on=function(t,e){var i=this;if("string"==typeof t){var r=e;t.split(" ").filter((function(t){return!!t})).forEach((function(t){return i._getEvent(t).on(r)}))}else W(t,(function(t,e){return i.on(e,t)}));return this},Gl.prototype.removeListener=function(t){W(this._events,(function(e){e.off(t)}))},Gl.prototype.fire=function(t,e){void 0===e&&(e=null);var i=this._getEvent(t);return this._onAnyEvents.forEach((function(i){return i(t,e)})),i.trigger(e),this},Gl.prototype.once=function(t,e){var i=this,r=function(){e.apply(null,arguments),i.removeListener(r)};this.on(t,r)},Gl.prototype._getEvent=function(t){if(!(t in this._events))throw new Error("Event "+t+" does not exist");return this._events[t]},Gl);function Gl(){var t=null!==Vl&&Vl.apply(this,arguments)||this;return t._events={},t._onAnyEvents=[],t}var Hl=(Wl.prototype.trigger=function(t){for(var e=0,i=this._handlers;e<i.length;e++)(0,i[e])(t,this._name);return this},Wl.prototype.on=function(t){if("function"!=typeof t)throw new Error("handler is not a function");var e=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(e,0,t),this._subscribers.splice(e,0,t),this},Wl.prototype.off=function(t){for(var e;-1!==(e=this._subscribers.indexOf(t));)this._subscribers.splice(e,1),this._handlers.splice(e,1);return this},Wl);function Wl(t,e){this._subscribers=[],this._handlers=[],this._reverseOrder=t,this._name=e}var ql,Xl=(E(Yl,ql=xe),Yl.prototype.getOriginalAttributes=function(){return this._originalAttributesLayer.getFlexArrays()},Yl.prototype.setMultipleAttributes=function(t,e,i,r){var n=this;return this._events.fire(ye.SET_MULTIPLE_ATTRIBUTES,{elements:t,values:e,options:i,updatedAttributes:r}),this._graphics.animate(t,(function(){n._individualAttributesLayer.setAttributeValues(t,e,r)}),i)},Yl.prototype.setSingleAttribute=function(t,e,i,r){var n={};return X(n,e,i),this.setMultipleAttributes(t,n,r)},Yl.prototype.resetMultipleAttributes=function(t,e,i){var r=this;e=e||this._individualAttributesLayer.getUsedAttributeNames(t);for(var n={},o=0,a=e;o<a.length;o++){var s=a[o];X(n,s,void 0)}return this._graphics.animate(t,(function(){r._individualAttributesLayer.setAttributeValues(t,n)}),i)},Yl.prototype.getMultipleAttributes=function(t,e){return this._graphics.getAttributeValues(t,e,!0,!1)},Yl.prototype.getSingleAttribute=function(t,e){return this._graphics.getAttributeValues(t,e,!1,!1)},Yl.prototype.replaceOriginalAttributes=function(t,e,i){void 0===i&&(i=[]);for(var r={},n=this._originalAttributesLayer.getUsedAttributeNames(t).filter((function(t){return!i.includes(t)})),o=0;o<n.length;++o)X(r,n[o],void 0);this._originalAttributesLayer.setAttributeValues(t,r),this._originalAttributesLayer.setAttributeValues(t,e)},Yl.prototype.getSinglePreviousAttribute=function(t,e){return this._graphics.getAttributeValues(t,e,!1,!0)},Yl.prototype.getMultiplePreviousAttributes=function(t,e){return this._graphics.getAttributeValues(t,e,!0,!0)},Yl);function Yl(t){var e,i=t.events,r=t.graphics,n=ql.call(this)||this;return n._events=i,n._graphics=r,i.register([ye.SET_MULTIPLE_ATTRIBUTES]),i.on(((e={})[ye.ADD_NODES+" "+ye.ADD_EDGES]=function(t){var e=t.nodes,i=t.edges,r=e||i,o=t.objects.map((function(t){return t.attributes}));n._originalAttributesLayer.setAttributeValues(r,o)},e)),n._originalAttributesLayer=n._graphics.addAttributeLayer({name:"original-attributes",priority:1,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),n._individualAttributesLayer=n._graphics.addAttributeLayer({name:"individual-attributes",priority:4,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),n}var Zl,Kl=(E(Ql,Zl=xe),Ql.prototype.onMounted=function(t,e){e.renderer&&this.update({renderer:e.renderer}),e.options&&this.update(e.options)},Ql.prototype.register=function(t,e,i,r){return void 0===r&&(r=!0),this._keys.push(t),this._currentValue[t]=e,this._defaultValues[t]=e,this._onChange[t]=i||function(){},i&&r&&i(e),this},Ql.prototype.update=function(t){t=Z(t);for(var e=this._keys,i={},r=this._currentValue,n=0;n<e.length;++n){var o=e[n];if(o in t){var a=t[o];void 0===a&&(a=this._defaultValues[o]),i[o]=r[o],r[o]=a}}var s=Object.keys(i);for(n=0;n<s.length;++n){var u=s[n],d=this._currentValue[u],l=i[u];d!==l&&this._onChange[u](d,l)}return K(i)},Ql.prototype.get=function(t){return arguments.length?this._currentValue[t]:K(this._currentValue)},Ql.prototype.set=function(t,e){var i=this._currentValue[t],r=this._onChange[t];this._currentValue[t]=e,r&&r(e,i)},Ql);function Ql(){var t=null!==Zl&&Zl.apply(this,arguments)||this;return t._currentValue={},t._onChange={},t._defaultValues={},t._keys=[],t}var Jl=($l.prototype.getName=function(){return this._name},$l.prototype.getIndex=function(){return this._classes.getIndex(this._name)},$l.prototype.setIndex=function(t){return this._classes.setIndex(this._name,t)},$l.prototype.update=function(t){return this._classes.update(this._name,t),this},$l.prototype.getDefinition=function(){return this._classes.getDefinition(this._name)},$l.prototype.getNodes=function(t){return this._classes.getElementsByClass(this._name,t).nodes},$l.prototype.getEdges=function(t){return this._classes.getElementsByClass(this._name,t).edges},$l.prototype.clearNodes=function(t){this.getNodes(t).removeClass(this._name)},$l.prototype.clearEdges=function(t){this.getEdges(t).removeClass(this._name)},$l.prototype.add=function(t){t.addClass(this._name)},$l.prototype.remove=function(t){t.removeClass(this._name)},$l);function $l(t,e){this._classes=t,this._name=e}var th,eh=(E(ih,th=xe),ih.prototype._getClassList=function(t){return t?this._builtinClasses:this._userClasses},ih.prototype.createClass=function(t){var e=void 0===t?{}:t,i=e.name,r=e.isBuiltin,n=void 0!==r&&r,o=e.after,a=e.nodeAttributes,s=e.nodeDependencies,u=e.nodeOutput,d=e.edgeAttributes,l=e.edgeDependencies,h=e.edgeOutput;if("string"!=typeof i)throw new Error('the "name" argument should be a string');var c=this._getClassList(n),f=o?function(t,e){for(var i=0;i<t.length;++i)if(t[i].name===e)return i;return-1}(c,o)+1:c.length;if(-1===f)throw new Error('createClass: class specified as `after` parameter "'+o+'" does not exist');if(n&&!i.startsWith("_"))throw new Error('invalid builtin class name "'+i+"\": builtin classes should start with '_'");var g=new Lo(this._graph),p=new Jl(this,i),_={name:i,elementSet:g,attributeLayer:this._graphics.addAttributeLayer({name:"class("+i+")",tag:i,standaloneSelectors:!0,nodeAttributes:a||void 0,edgeAttributes:d||void 0,nodeSelector:function(t,e){return e.hasElement(t)},edgeSelector:function(t,e){return e.hasElement(t)},nodeContext:g,edgeContext:g,nodeOutput:u,edgeOutput:h,nodeDependencies:s,edgeDependencies:l}),isBuiltin:n,wrapper:p};return c.splice(f,0,_),n&&c.sort((function(t,e){return mi.indexOf(t.name)-mi.indexOf(e.name)})),this._updatePriorities(n),this._classesByName[i]=_,this._events.register([rh(i,!0,!0),rh(i,!0,!1),rh(i,!1,!0),rh(i,!1,!1)]),p},ih.prototype._updatePriorities=function(t){for(var e=this._getClassList(t),i=5+(t?.5:0),r=0;r<e.length;++r){var n=i+5e-4*r;e[r].attributeLayer.update({priority:n})}},ih.prototype._get=function(t){var e=this._classesByName[t];if(!e)throw new Error('class "'+t+'" does not exist');return e},ih.prototype.getIndex=function(t){var e=this._get(t);return this._getClassList(e.isBuiltin).indexOf(e)},ih.prototype.setIndex=function(t,e){var i=this._get(t),r=this._getClassList(i.isBuiltin),n=r.indexOf(i),o=qe(e,0,r.length-1);r.splice(n,1),r.splice(o,0,i),this._updatePriorities(i.isBuiltin)},ih.prototype.update=function(t,e){var i=void 0===e?{}:e,r=i.nodeAttributes,n=i.edgeAttributes,o=i.nodeDependencies,a=i.edgeDependencies,s=i.nodeOutput,u=i.edgeOutput,d=i.fullOverwrite;this._get(t).attributeLayer.update({nodeAttributes:r,edgeAttributes:n,nodeDependencies:o,edgeDependencies:a,nodeOutput:s,edgeOutput:u,fullOverwrite:d})},ih.prototype.getDefinition=function(t){var e=this._get(t).attributeLayer.getDefinition(),i=e.nodeAttributes,r=e.nodeDependencies,n=e.nodeOutput;return{nodeAttributes:i||void 0,edgeAttributes:e.edgeAttributes||void 0,nodeDependencies:r,edgeDependencies:e.edgeDependencies,nodeOutput:n,edgeOutput:e.edgeOutput}},ih.prototype._addOrRemoveClassesToElements=function(t,e,i){for(var r=e.isNode,n=0;n<t.length;++n){var o=t[n],a=this._get(o),s=a.elementSet,u=a.attributeLayer,d=s.addOrRemoveElements(e,i),l=rh(o,r,i);d.size&&(u.updateElements(d),this._events.fire(l,r?{nodes:d}:{edges:d}))}},ih.prototype.addClassesToElements=function(t,e,i){var r=this,n=e.toList();return this._graphics.animate(e,(function(){r._addOrRemoveClassesToElements(t,n,!0)}),i)},ih.prototype.removeClassesFromElements=function(t,e,i){var r=this,n=e.toList();return this._graphics.animate(e,(function(){r._addOrRemoveClassesToElements(t,n,!1)}),i)},ih.prototype.hasSingleElementClass=function(t,e){return this._get(t).elementSet.hasElement(e)},ih.prototype.getElementsClassList=function(t,e){void 0===e&&(e={});for(var i=e.includeBuiltinClasses,r=void 0!==i&&i,n=new Array(t.size),o=0;o<n.length;++o)n[o]=[];return this._addClassNamesToList(n,t,this._userClasses),r&&this._addClassNamesToList(n,t,this._builtinClasses),n},ih.prototype._addClassNamesToList=function(t,e,i){for(var r=e.toList(),n=0;n<i.length;++n)for(var o=this._userClasses[n],a=o.name,s=o.elementSet,u=0;u<r.size;++u){var d=r.get(u);s.hasElement(d)&&t[u].push(a)}},ih.prototype.getClassByName=function(t,e){void 0===e&&(e=!1);var i=this._classesByName[t]||null;if(e&&!i)throw new Error('class "'+t+'" does not exist');return i&&i.wrapper},ih.prototype.getClassList=function(){return this._userClasses.map((function(t){return t.wrapper}))},ih.prototype.getElementsByClass=function(t,e){void 0===e&&(e="visible");var i=this._get(t).elementSet.getElements(),r=i.nodes,n=i.edges;return"visible"===e?(r=r.filter((function(t){return t.isVisible()})),n=n.filter((function(t){return t.isVisible()}))):"raw"===e&&(r=r.filter((function(t){return!t.isVirtual()})),n=n.filter((function(t){return!t.isVirtual()}))),{nodes:r,edges:n}},ih.prototype._onClassEvent=function(t,e,i,r){var n=rh(t,i,r);this._events.on(n,e)},ih.prototype.onNodeClassAdded=function(t,e){this._onClassEvent(t,e,!0,!0)},ih.prototype.onNodeClassRemoved=function(t,e){this._onClassEvent(t,e,!0,!1)},ih.prototype.onEdgeClassAdded=function(t,e){this._onClassEvent(t,e,!1,!0)},ih.prototype.onEdgeClassRemoved=function(t,e){this._onClassEvent(t,e,!1,!1)},ih);function ih(t){var e,i=t.events,r=t.graphics,n=t.graph,o=th.call(this)||this;return o._builtinClasses=[],o._userClasses=[],o._classesByName={},o._events=i,o._graphics=r,o._graph=n,i.on(((e={})[ye.EXCLUDED_STATE_CHANGE]=function(t){var e=t.elements;if(t.value){var i=o._builtinClasses.map((function(t){return t.name}));o._addOrRemoveClassesToElements(i,e,!1)}},e[ye.CLEAR_GRAPH]=function(){o._builtinClasses.concat(o._userClasses).forEach((function(t){return t.elementSet.clear()}))},e)),o}function rh(t,e,i){return(e?"node":"edge")+"Class"+(i?"Added":"Removed")+"_"+t}for(var nh,oh,ah=[0,1],sh=[0,2],uh=4;uh<65535;uh<<=2)for(var dh=0,lh=ah.length;dh<lh;dh++)ah.push(ah[dh]|uh),sh.push((ah[dh]|uh)<<1);function hh(t,e){return(sh[255&e]|ah[255&t])+65536*(sh[e>>8&255]|ah[t>>8&255])+4294967296*(sh[e>>16&255]|ah[t>>16&255])}function ch(t,e){if(void 0===e&&(e=[]),0xffffffffffff<t)throw"Only morton codes up to 48 bits are supported.";if(!nh){nh={},oh={};for(var i=0;i<256;i++)nh[hh(i,0)]=i,oh[hh(0,i)]=i}var r=nh[21845&t],n=oh[43690&t];return 65535<t&&(r|=nh[21845&(t/=65536)]<<8,n|=oh[43690&t]<<8,65535<t&&(r|=nh[21845&(t/=65536)]<<16,n|=oh[43690&t]<<16)),e[0]=r,e[1]=n,e}function fh(t,e,i){void 0===t&&(t=Int32Array),void 0===e&&(e=16),void 0===i&&(i=8),this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=t,this._capacity=e,this._MAX_LIST_SIZE=i,this._freeIndex=-1,this.clear()}hh.code=function(t,e,i){if(24<t)throw"Morton codes are only supported up to Z=24";var r=1<<24-t;return hh(e*r,i*r)},hh.range=function(t,e,i){if(24<t)throw"Morton ranges are only supported up to Z=24";var r=1<<24-t,n=hh(e*r,i*r);return[n,n+r*r-1]},hh.reverse=ch,hh.decode=function(t,e){var i=ch(e),r=1<<24-t;return[i[0]/r,i[1]/r]},hh.min=function(t,e){var i=1431655765&t,r=1431655765&e,n=2863311530&t,o=2863311530&e;return Math.min(i,r)+Math.min(n,o)};var gh={averageSize:{configurable:!0}};function ph(t,e){var i=new t.constructor(e);return i.set(t),i}function _h(t,e,i){return i|hh(t,e)<<4}function vh(t,e){return void 0===e&&(e=[]),hh.reverse(t>>4,e),e[2]=t&xh,e}function mh(t,e,i,r,n){void 0===i&&(i=16),void 0===r&&(r=65536),void 0===n&&(n=Int32Array),this._intersects=t,this._getBounds=e,this._occupied=0,this._cells=new fh(n),this._objectsAtLevel=new Array(16).fill(0),this._idToCode=new yh,this._codeCache=[],this._offset=r,this._min=-r,this._max=r,this._resolution=65535/(this._max-this._min),this._minCellSize=i*this._resolution,this._bounds=new Array(64);for(var o=0;o<16;o++)this._bounds[4*o]=1/0,this._bounds[4*o+1]=1/0,this._bounds[4*o+2]=-1/0,this._bounds[4*o+3]=-1/0}fh.prototype.clear=function(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex={},this._constList=new Array(this._MAX_LIST_SIZE)},fh.prototype.addEntry=function(t){var e;return-1===this._freeIndex?e=this._nextIndex++:(e=this._freeIndex,this._freeIndex=-1),(this._idToIndex[t]=e)>=this._capacity&&this._expand(e+1),this._sizes[e]=0,e},fh.prototype.getItems=function(t){var e=this._idToIndex[t];if(void 0!==e){var i=this._sizes[e],r=this._MAX_LIST_SIZE*e;if(i<=this._MAX_LIST_SIZE){for(var n=0,o=this._constList.length=i;n<o;++n)this._constList[n]=this._buffer[r+n];return this._constList}if(i===this._BIG_LIST){var a=this._buffer[r];return this._bigLists[a]}}},fh.prototype.removeEntry=function(t){var e=this._idToIndex[t];if(this._sizes[e]===this._BIG_LIST){var i=this._MAX_LIST_SIZE*e,r=this._buffer[i];this._bigLists[r].length=0}this._sizes[e]=0,this._freeIndex=e},fh.prototype.size=function(t){var e=this._idToIndex[t],i=this._sizes[e];return i<=this._MAX_LIST_SIZE?i:this._bigLists[this._buffer[e*this._MAX_LIST_SIZE]].length},fh.prototype.sizes=function(t){for(var e=this._sizes,i=this._bigLists,r=this._buffer,n=this._MAX_LIST_SIZE,o=t.length,a=new Array(o),s=0;s<o;s++){var u=this._idToIndex[t[s]],d=e[u];a[s]=d<=n?d:i[r[u*n]].length}return a},fh.prototype.addTo=function(t,e){var i=this._idToIndex[t],r=this._sizes[i],n=i*this._MAX_LIST_SIZE;if(r<this._MAX_LIST_SIZE)this._buffer[n+r]=e,this._sizes[i]=r+1;else if(r===this._BIG_LIST){var o=this._buffer[n];this._bigLists[o].push(e)}else{for(var a=new Array(this._MAX_LIST_SIZE),s=0;s<this._MAX_LIST_SIZE;++s)a[s]=this._buffer[n+s];a.push(e),this._bigLists.push(a),this._sizes[i]=this._BIG_LIST,this._buffer[n]=this._bigLists.length-1}},fh.prototype.removeFrom=function(t,e){this.removeFromAndGetSize(t,e)},fh.prototype.removeFromAndGetSize=function(t,e){var i=this._idToIndex[t],r=this._sizes[i],n=this._MAX_LIST_SIZE*i;if(r<=this._MAX_LIST_SIZE){for(var o=n,a=n+r;o<a;++o)if(this._buffer[o]===e)return--r,this._buffer[o]=this._buffer[a-1],this._sizes[i]=r}else if(r===this._BIG_LIST){var s=this._buffer[n],u=this._bigLists[s],d=u.indexOf(e);if(-1!==d)return u.splice(d,1),u.length}},fh.prototype.reserve=function(t){this._capacity<t&&this._expand(t)},fh.prototype._expand=function(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t))),this._buffer=ph(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=ph(this._sizes,this._capacity)},fh.prototype.has=function(t){var e=this._idToIndex[t];return!(void 0===e||e>=this._capacity)&&0!==this._sizes[e]},gh.averageSize.get=function(){for(var t=0,e=0;e<this._capacity;e++)t+=this._sizes[e];return t/this._capacity},Object.defineProperties(fh.prototype,gh);var yh="undefined"==typeof Map?function(){function t(){this._values={},this._size=0}var e={size:{configurable:!0}};return e.size.get=function(){return this._size},t.prototype.has=function(t){return!!this._values[t]},t.prototype.set=function(t,e){t in this._values||this._size++,this._values[t]=e},t.prototype.get=function(t){return this._values[t]},t.prototype.delete=function(t){t in this._values&&(delete this._values[t],this._size--)},t.prototype.keys=function(){return Object.keys(this._values)},t.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(t.prototype,e),t}():Map,bh="undefined"==typeof Set?function(){function t(){this._values={},this._size=0}var e={size:{configurable:!0}};return e.size.get=function(){return this._size},t.prototype.has=function(t){return!!this._values[t]},t.prototype.add=function(t){t in this._values||this._size++,this._values[t]=!0},t.prototype.delete=function(t){t in this._values&&(delete this._values[t],this._size--)},t.prototype.keys=function(){return Object.keys(this._values)},t.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(t.prototype,e),t}():Set,xh=(1<<Math.log2(16))-1,Eh={averageCellOccupancy:{configurable:!0},size:{configurable:!0}};mh.prototype.setMinCellSize=function(t){return this._minCellSize=t,this},mh.prototype.setOffset=function(t){return this._offset=t,this._min=-t,this._max=t,this._resolution=65535/(this._max-this._min),this},mh.prototype.setIntersector=function(t){return this._intersects=t,this},mh.prototype.setBoundsGetter=function(t){return this._getBounds=t,this},mh.prototype.insert=function(t,e){void 0===e&&(e=this._getBounds(t));var i,r=Math.max(e[2]-e[0],e[3]-e[1]),n=this._minCellSize;for(i=0;n<r&&i<16;i++)n*=2;var o=this._resolution,a=this._min,s=o*(.5*(e[2]+e[0])-a)/n|0,u=o*(.5*(e[3]+e[1])-a)/n|0,d=_h(s,u,i);this._cells.has(d)||this._cells.addEntry(d),this._cells.addTo(d,t),this._objectsAtLevel[i]++,this._occupied|=1<<i;var l=4*i,h=this._bounds;return s<h[l]&&(h[l]=s),u<h[1+l]&&(h[1+l]=u),s>h[2+l]&&(h[2+l]=s),u>h[3+l]&&(h[3+l]=u),this._idToCode.set(t,d),d},mh.prototype.has=function(t){return this._idToCode.has(t)},mh.prototype.update=function(t,e){return this.remove(t),this.insert(t,e)},mh.prototype.remove=function(t){var e=this._idToCode.get(t);vh(e,this._codeCache);var i=this._codeCache[2];return 0==--this._objectsAtLevel[i]&&(this._occupied&=~(1<<i),this._bounds[4*i]=1/0,this._bounds[4*i+1]=1/0,this._bounds[4*i+2]=-1/0,this._bounds[4*i+3]=-1/0),this._cells.removeFrom(e,t),this._idToCode.delete(t),this},mh.prototype.query=function(t){var e=t[0],i=t[1],r=t[2],n=t[3],o=this._cells,a=this._bounds,s=this._intersects,u=this._min,d=this._resolution,l=this._minCellSize,h=this._occupied,c=[];e=d*(e-u),i=d*(i-u),r=d*(r-u),n=d*(n-u);for(var f=0;f<16&&0!==h;l*=2,h>>=1,f++)if(0!=(1&h))for(var g=1/l,p=4*f,_=Math.max(a[p],e*g-1>>0),v=Math.max(a[1+p],i*g-1>>0),m=Math.min(a[2+p],r*g+1>>0),y=Math.min(a[3+p],n*g+1>>0),b=_;b<=m;b++)for(var x=v;x<=y;x++){var E=_h(b,x,f),A=o.getItems(E);if(void 0!==A)for(var S=0;S<A.length;S++){var w=A[S];s(w,t)&&c.push(w)}}return c},mh.prototype.collisions=function(t,e){if(void 0===e&&(e=this._getBounds),"function"!=typeof e)throw new Error("getBounds function is required to get the object bounds");for(var i=Array.from(this._idToCode.keys()),r=this._min,n=this._resolution,o=this._cells,a=new yh,s=[],u=0;u<i.length;u++){var d=0,l=this._minCellSize,h=this._occupied,c=i[u],f=e(c),g=f[0],p=f[1],_=f[2],v=f[3],m=Math.max(_-g,v-p);for(d=0;l<m;d++)l*=2,h>>=1;g=n*(g-r),p=n*(p-r),_=n*(_-r),v=n*(v-r);for(var y=d;y<16&&0!==h;l*=2,h>>=1,y++)if(0!=(1&h))for(var b=1/l,x=p*b-1>>0,E=_*b+1>>0,A=v*b+1>>0,S=g*b-1>>0;S<=E;S++)for(var w=x;w<=A;w++){var T=_h(S,w,y);if(a.get(T)!==u){a.set(T,u);var C=o.getItems(T);if(void 0!==C)for(var M=0;M<C.length;M++){var I=C[M];I!==c&&t(c,I)&&s.push(c,I)}}}}return function(t){for(var e=new bh,i=[],r=0;r<t.length;r+=2){var n=t[r],o=t[r+1],a=n<o?n*o+(o-n-1)*(o-n-1)/4:n*o+(n-o-1)*(n-o-1)/4;e.has(a)||(e.add(a),i.push(n,o))}return i}(s)},mh.prototype.clear=function(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(16).fill(0),this._bounds=new Array(64);for(var t=0;t<16;t++)this._bounds[4*t]=1/0,this._bounds[4*t+1]=1/0,this._bounds[4*t+2]=-1/0,this._bounds[4*t+3]=-1/0;return this},mh.prototype.keyToBBox=function(t){var e=vh(t),i=e[0],r=e[1],n=e[2],o=this._minCellSize*(1<<n),a=this._min,s=this._resolution;return[i*o/s+a,r*o/s+a,(i+1)*o/s+a,(r+1)*o/s+a]},mh.prototype.keys=function(){return Object.keys(this._cells._idToIndex)},Eh.averageCellOccupancy.get=function(){return this._cells.averageSize},Eh.size.get=function(){return this._idToCode.size},Object.defineProperties(mh.prototype,Eh),mh.code=_h,mh.decode=vh;var Ah,Sh=["x","y","radius"],wh=["width","curvature"],Th=(E(Ch,Ah=xe),Ch.prototype._getIntersector=function(){var t=this._graph,e=t.getNodeAttributes(["x","y","radius"]),i=e[0],r=e[1],n=e[2],o=t.getEdgeAttributes(["source","target","width","curvature"]),a=o[0],s=o[1],u=o[2],d=o[3],l={x:0,y:0,x1:0,y1:0,x2:0,y2:0};return function(t,e){if(t<0){t=-t;var o=a.get(t),h=s.get(t),c=d.get(t),f=u.get(t)/2,g=i.get(o),p=r.get(o),_=i.get(h),v=r.get(h);return o===h?(Ta(g,p,c,n.get(o),0,l),Ps(g,p,l.x1,l.y1,l.x2,l.y2,_,v,e[0]-f,e[1]-f,e[2]+f,e[3]+f)):0===c?Ms(g,p,_,v,e[0]-f,e[1]-f,e[2]+f,e[3]+f):(wa(g,p,_,v,c,l),Fs(g,p,l.x,l.y,_,v,e[0]-f,e[1]-f,e[2]+f,e[3]+f))}return xd(i.get(t),r.get(t),n.get(t),e[0],e[1],e[2],e[3])}},Ch.prototype.reindex=function(){this._graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._graph.getNodes("all")._indexes,this._graph.getEdges("all")._indexes)},Ch.prototype.getSize=function(){return this._index.size},Ch.prototype._updateIndex=function(){if(!this._elementsToUpdate.isEmpty()){var t=this._elementsToUpdate.getElements(),e=t.nodes,i=t.edges;this._updateItems(e._indexes,i._indexes),this._elementsToUpdate.clear()}},Ch.prototype._updateItems=function(t,e){var i=this._index,r=this._removedNodes,n=this._removedEdges,o=this._excludedNodes,a=this._excludedEdges,s=[],u=[];if(r&&o)for(var d=0;d<t.length;d++){var l=t[d];0!==r.get(l)||0!==o.get(l)?s.push(l):(i.has(l)&&s.push(l),u.push(l))}if(n&&a)for(d=0;d<e.length;d++)l=-e[d],0!==n.get(-l)||0!==a.get(-l)?s.push(l):(i.has(l)&&s.push(l),u.push(l));for(var h=0,c=s;h<c.length;h++)l=c[h],i.remove(l);for(var f=0,g=u;f<g.length;f++)l=g[f],i.insert(l)},Ch.prototype.getNodesInScreenByDistance=function(t){var e=t.getPositionOnScreen(),i=e.x,r=e.y;return this._graph.getNodes().filter((function(e){return e.isInScreen()&&e!==t})).sort((function(t,e){var n=t.getPositionOnScreen(),o=e.getPositionOnScreen();return Pa(n.x,n.y,i,r)-Pa(o.x,o.y,i,r)}))},Ch.prototype.getNearestNodesForNode=function(t,e,i){void 0===e&&(e=240);var r=t.getPosition(),n=r.x,o=r.y;return this.getNearestNodes(n,o,e,i,t)},Ch.prototype.getNearestNodes=function(t,e,i,r,n){if(this._updateIndex(),r){var o=this._camera.screenToGraphVector({x:i,y:i});i=Pa(0,0,o.x,o.y)}return this._getNearestNodes(t,e,i,n)},Ch.prototype._getNearestNodes=function(t,e,i,r){for(var n=[],o=i*i,a=r?r._index:0,s=this._graph.getNodes()._indexes,u=this._graph.getNodeAttributes(["x","y"]),d=u[0],l=u[1],h=0,c=s.length;h<c;h++){var f=s[h];if(f!==a){var g=t-d.get(f),p=e-l.get(f);g*g+p*p<=o&&n.push(f)}}return this._graph.nodeList(new Uint32Array(n))},Ch.prototype.queryRaw=function(t,e,i,r){this._updateIndex();var n=this._queryBounds;n[0]=t,n[1]=e,n[2]=i,n[3]=r;var o=this._index.query(n),a=this._queryResult,s=a.nodes,u=a.edges;s.length=u.length=0;for(var d=0;d<o.length;d++){var l=o[d];l<0?u.push(-l):s.push(l)}return this._queryResult},Ch.prototype.queryRawProjected=function(t,e,i,r){var n=this._queryBounds;return n[0]=t,n[1]=e,n[2]=i,n[3]=r,this._camera.projectBounds(n),this.queryRaw(n[0],n[1],n[2],n[3])},Ch.prototype.query=function(t,e,i,r){var n=this._graph,o=this.queryRaw(t,e,i,r),a=o.nodes,s=o.edges;return{nodes:n.nodeList(new Uint32Array(a.slice())),edges:n.edgeList(new Uint32Array(s.slice()))}},Ch.prototype.queryProjected=function(t,e,i,r){var n=this._graph,o=this.queryRawProjected(t,e,i,r),a=o.nodes,s=o.edges;return{nodes:n.nodeList(new Uint32Array(a.slice())),edges:n.edgeList(new Uint32Array(s.slice()))}},Ch.prototype.getNodesByBoundingBox=function(t,e,i,r,n){if(this._updateIndex(),n){var o=void 0;t=(o=this._camera.screenToGraphVector({x:t,y:e})).x,e=o.y,i=(o=this._camera.screenToGraphVector({x:i,y:r})).x,r=o.y}for(var a=this._graph,s=a.getNodes()._indexes,u=[],d=a.getNodeAttribute("excluded"),l=a.getNodeAttributes(["x","y"]),h=l[0],c=l[1],f=0,g=s.length;f<g;f++){var p=s[f];if(!d||!d.get(p)){var _=h&&h.get(p),v=c&&c.get(p);t<=_&&_<=i&&e<=v&&v<=r&&u.push(p)}}return a.nodeList(new Uint32Array(u))},Ch.prototype.toggleDebug=function(t){t?(this._canvas=$r(),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d")):this._canvas&&(this._graphics.removeCanvas(this._canvas),this._canvas=this._ctx=null)},Ch.prototype.renderDebug=function(t){if(!this._canvas||!this._ctx)return this.toggleDebug(!0);!function(t,e,i,r,n,o){function a(t,e){return{x:(t-y)*_,y:(e-x)*_}}var s=void 0===o?{}:o,u=s.cells,d=void 0===u||u,l=s.boxes,h=void 0===l||l,c=s.query,f=void 0===c||c,g=Ct(),p=-i.getAngle(),_=i.getZoom()*g,v=i.getView(),m=v.x,y=void 0===m?0:m,b=v.y,x=void 0===b?0:b,E=v.width,A=void 0===E?0:E,S=v.height,w=A*g/2,T=(void 0===S?0:S)*g/2,C=r.keys().map((function(t){return r.keyToBBox(t)})),M=Array.from(r._idToCode.keys()).map((function(t){return r._getBounds(t)}));if(t.clearRect(0,0,e.width,e.height),t.save(),t.translate(w,T),t.rotate(p),d&&(t.beginPath(),t.lineWidth=1,t.strokeStyle="#707070",C.forEach((function(e){var i=a(e[0],e[1]),r=a(e[2],e[3]);t.rect(i.x,i.y,r.x-i.x,r.y-i.y)})),t.stroke()),h&&(t.beginPath(),t.lineWidth=1,t.strokeStyle="#ff7070",M.forEach((function(e){var i=a(e[0],e[1]),r=a(e[2],e[3]);t.rect(i.x,i.y,r.x-i.x,r.y-i.y)})),t.closePath(),t.stroke()),f&&n){var I=n;t.beginPath(),t.lineWidth=2,t.strokeStyle="#3030ff";var L=a(I[0],I[1]),N=a(I[2],I[3]);t.rect(L.x,L.y,N.x-L.x,N.y-L.y),t.closePath(),t.stroke()}t.restore()}(this._ctx,this._canvas,this._camera,this._index,this._queryBounds,t)},Ch);function Ch(t){var e,i,r,n,o,a,s,u,d,l,h,c,f=t.graph,g=t.camera,p=t.graphics,_=t.events,v=Ah.call(this)||this;return v._minCellSize=8,v._clear=function(){v._index.clear(),v._elementsToUpdate.clear()},v._onGraphUpdate=function(t){if(t.nodes&&(!t.nodeAttributes||t.nodeAttributes.some((function(t){return Sh.includes(t)})))){var e=t.nodes.fastGetAdjacentElements().edges;v._elementsToUpdate.addElements(t.nodes),v._elementsToUpdate.addElements(e)}t.edges&&(t.edgeAttributes&&!t.edgeAttributes.some((function(t){return wh.includes(t)}))||v._elementsToUpdate.addElements(t.edges))},v._graph=f,v._camera=g,v._graphics=p,v._index=new mh(v._getIntersector(),(r=(i=v._graph).getNodeAttributes(["x","y","radius"]),n=r[0],o=r[1],a=r[2],s=i.getEdgeAttributes(["source","target","curvature"]),u=s[0],d=s[1],l=s[2],h={x:0,y:0,x1:0,y1:0,x2:0,y2:0},c={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},function(t){if(t<0){t=-t;var e=u.get(t),i=d.get(t),r=l.get(t),s=n.get(e),f=o.get(e),g=n.get(i),p=o.get(i);e===i?(Ta(s,f,r,a.get(e),0,h),js(s,f,h.x1,h.y1,h.x2,h.y2,g,p,c)):0===r?(c.minX=Math.min(s,g),c.minY=Math.min(f,p),c.maxX=Math.max(s,g),c.maxY=Math.max(f,p)):(wa(s,f,g,p,r,h),Vs(s,f,h.x,h.y,g,p,c))}else{var _=n.get(t),v=o.get(t),m=a.get(t);c.minX=_-m,c.minY=v-m,c.maxX=_+m,c.maxY=v+m}return[c.minX,c.minY,c.maxX,c.maxY]}),v._minCellSize,1e6),v._elementsToUpdate=new Lo(v._graph),v._removedNodes=f.getNodeAttribute("removed"),v._removedEdges=f.getEdgeAttribute("removed"),v._excludedNodes=f.getNodeAttribute("excluded"),v._excludedEdges=f.getEdgeAttribute("excluded"),v._queryResult={edges:[],nodes:[]},v._queryBounds=[0,0,0,0],_.on(((e={})[[ye.ADD_NODES,ye.ADD_EDGES,ye.REMOVE_NODES,ye.REMOVE_EDGES,ye.UPDATE_ATTRIBUTES].join(" ")]=v._onGraphUpdate,e[ye.EXCLUDED_STATE_CHANGE]=function(t){var e=t.elements;v._elementsToUpdate.addElements(e)},e[ye.CLEAR_GRAPH]=v._clear,e)),v}var Mh,Ih,Lh,Nh=(E(kh,Mh=xe),kh.prototype.onMounted=function(){this.locateGraph({},!0)},kh.prototype.locateGraph=function(t,e){var i=this;return void 0===e&&(e=!1),e?this._locateGraph(t):this._transformations.whenApplied().then((function(){return i._locateGraph(t)}))},kh.prototype._locateGraph=function(t){return this._locateBoundingBox(this.getGraphBoundingBox(),t)},kh.prototype.locateElements=function(t,e){var i=this;return this._transformations.whenApplied().then((function(){return i._locateBoundingBox(i.getBoundingBox(t),e)}))},kh.prototype.locateRawGraph=function(t,e){return this._locateBoundingBox(this.getRawGraphBoundingBox(t),e)},kh.prototype.getGraphBoundingBox=function(){return this._cacheValid||this._updateCache(),Object.assign({},this._cachedGraphBoundingBox)},kh.prototype.forceInvalidCache=function(){this._invalidCache()},kh.prototype._updateCache=function(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._graph.getNodes())},kh.prototype.getBoundingBox=function(t,e){return t.isNode?this._getNodesBoundingBox(t.toList()):this._getEdgesBoundingBox(t.toList(),e)},kh.prototype._getNodesBoundingBox=function(t){this._graphics.forceAttributesComputation();for(var e=this._graphics.getNodeAttributes(),i=[],r=[],n=[],o=[],a=0;a<t.size;++a){var s=t._indexes[a];if(0===e.excluded.get(s)){var u=e.x.get(s),d=e.y.get(s),l=2*e.radius.get(s);"scaled"===e.scalingMethod.get(s)?n.push(l):o.push(l),i.push(u),r.push(d)}}return new ko({xValues:i,yValues:r,scaledSizeValues:n,fixedSizeValues:o})},kh.prototype._getEdgesBoundingBox=function(t,e){void 0===e&&(e=!1),this._graphics.forceAttributesComputation();for(var i=this._graphics.getEdgeAttributes(),r=this._graphics.getNodeAttributes(),n={x1:0,y1:0,x2:0,y2:0},o={x:0,y:0},a={minX:0,minY:0,maxX:0,maxY:0},s=[],u=[],d=[],l=[],h=0;h<t.size;++h){var c=t._indexes[h],f=i.source.get(c),g=i.target.get(c),p=i.curvature.get(c),_=r.x.get(f),v=r.y.get(f),m="scaled"===r.scalingMethod.get(f),y=2*r.radius.get(f),b=r.x.get(g),x=r.y.get(g),E="scaled"===r.scalingMethod.get(g),A=2*r.radius.get(g);m?d.push(y):l.push(y),E?d.push(A):l.push(A),e||0===p?(s.push(_,b),u.push(v,x)):(f===g?(Ta(_,v,p,y/2,0,n),js(_,v,n.x1,n.y1,n.x2,n.y2,b,x,a)):(wa(_,v,b,x,p,o),Vs(_,v,o.x,o.y,b,x,a)),s.push(a.minX,a.maxX),u.push(a.minY,a.maxY))}return new ko({xValues:s,yValues:u,scaledSizeValues:d,fixedSizeValues:l})},kh.prototype.getRawGraphBoundingBox=function(t){for(var e=t.nodes.length,i=new Array(e),r=new Array(e),n=new Array(e),o=0;o<e;o++){var a=t.nodes[o].attributes||{};i[o]=a.x||0,r[o]=a.y||0,n[o]=a.radius||5}return new ko({xValues:i,yValues:r,scaledSizeValues:n})},kh.prototype._computeCameraConfig=function(t,e,i){"number"==typeof e&&(e={left:e,right:e,top:e,bottom:e});var r,n=void 0===e.left?40:e.left,o=void 0===e.right?40:e.right,a=void 0===e.top?40:e.top,s=void 0===e.bottom?40:e.bottom,u=this._dom.getDimensions(),d=n+o,l=a+s,h=0===t.width?t.maxFixedSize:t.width,c=0===t.height?t.maxFixedSize:t.height,f=(r=[(u.width-d)/(h+t.maxScaledSize),(u.height-l)/(c+t.maxScaledSize),(u.width-d-t.maxFixedSize)/h,(u.height-l-t.maxFixedSize)/c,i/t.maxScaledSize||NaN].filter((function(t){return isFinite(t)&&0<t}))).length?Ke(r):1;return{x:t.cx+(o-n)/(2*f),y:t.cy+(s-a)/(2*f),zoom:f}},kh.prototype._locateBoundingBox=function(t,e){if(void 0===e&&(e={}),isNaN(t.cx))return Promise.resolve();var i=e.padding,r=void 0===i?{}:i,n=e.easing,o=void 0===n?"quadraticInOut":n,a=e.duration,s=void 0===a?0:a,u=e.maxNodeSizeOnScreen,d=void 0===u?200:u,l=e.ignoreZoomLimits,h=void 0!==l&&l,c=this._computeCameraConfig(t,r,d),f=c.x,g=c.y,p=c.zoom,_=p/this._camera.getZoom();return this._moveCamera(f,g,p,s,o,_,h)},kh.prototype._moveCamera=function(t,e,i,r,n,o,a){return 1.01<o?(this._camera.setCenter({x:t,y:e},{duration:r,easing:n,ignoreZoomLimits:a}),this._camera.setZoom(i,{duration:r,easing:n,ignoreZoomLimits:a,startAfter:.5})):o<.99?(this._camera.setCenter({x:t,y:e},{duration:r,easing:n,ignoreZoomLimits:a,startAfter:.5}),this._camera.setZoom(i,{duration:r,easing:n,ignoreZoomLimits:a})):this._camera.setCenter({x:t,y:e},{duration:r,easing:n,ignoreZoomLimits:a})},kh.prototype.computeConfigForBounds=function(t,e){void 0===e&&(e={});var i=e.padding,r=void 0===i?{}:i,n=e.maxNodeSizeOnScreen,o=void 0===n?200:n;return this._computeCameraConfig(t,r,o)},kh.prototype.layoutDataBoundingBox=function(t){for(var e=t.x,i=t.y,r=t.indexes,n=this._graphics.getNodeAttributes(),o=[],a=[],s=[],u=[],d=0;d<r.length;++d){var l=r[d],h=e[d],c=i[d],f=2*n.radius.get(l),g="scaled"===n.scalingMethod.get(l);o.push(h),a.push(c),g?s.push(f):u.push(f)}return new ko({xValues:o,yValues:a,scaledSizeValues:s,fixedSizeValues:u})},kh.prototype.isEdgeInPolygon=function(t,e){var i=t.getSource(),r=t.getTarget(),n=i.getPositionOnScreen(),o=r.getPositionOnScreen();if(Jd(n.x,n.y,e)||Jd(o.x,o.y,e))return!0;for(var a=Oh(t,this._camera.getZoom()),s=0;s<a.length-1;++s)for(var u=a[s],d=a[s+1],l=0;l<e.length-1;++l){var h=e[l],c=e[l+1];if(Cs(u.x,u.y,d.x,d.y,h.x,h.y,c.x,c.y))return!0}return!1},kh.prototype.isElementInView=function(t,e){var i=(void 0===e?{}:e).margin,r=void 0===i?0:i,n=this._camera.getSize(),o={minX:-r,minY:-r,maxX:n.width+r,maxY:n.height+r};return t.isNode?this.isNodeInRectangle(t,o):this.isEdgeInRectangle(t,o)},kh.prototype.isNodeInRectangle=function(t,e){var i=t.getPositionOnScreen(),r=t.getAttribute("radius")*this._camera.getZoom(),n=i.x-r,o=i.y-r,a=i.x+r,s=i.y+r;return a>=e.minX&&n<=e.maxX&&s>=e.minY&&o<=e.maxY},kh.prototype.isNodeInPolygon=function(t,e){var i=t.getPositionOnScreen();return Jd(i.x,i.y,e)},kh.prototype.isEdgeInRectangle=function(t,e){for(var i=Oh(t,this._camera.getZoom()),r=0;r<i.length-1;++r){var n=i[r],o=i[r+1];if(Ms(n.x,n.y,o.x,o.y,e.minX,e.minY,e.maxX,e.maxY))return!0}return!1},kh);function kh(t){var e,i=t.dom,r=t.events,n=t.camera,o=t.graphics,a=t.graph,s=t.transformations,u=Mh.call(this)||this;return u._cacheValid=!0,u._cachedGraphBoundingBox=new ko,u._invalidCache=function(){u._cacheValid=!1},u._dom=i,u._events=r,u._camera=n,u._graph=a,u._graphics=o,u._transformations=s,u._events.on(((e={})[[ye.ADD_NODES,ye.REMOVE_NODES,ye.ADD_EDGES,ye.REMOVE_EDGES,ye.EXCLUDED_STATE_CHANGE,ye.CLEAR_GRAPH,ye.UPDATE_ATTRIBUTES].join(" ")]=u._invalidCache,e)),u}function Oh(t,e){var i=t.getAttribute("curvature"),r=t.getSource(),n=t.getTarget(),o=r.getPositionOnScreen();if(r===n){var a=5*(i+r.getAttribute("radius"))*e,s=o.x,u=o.y,d=s-a,l=u,h=s,c=u+a;return w([o],[.2,.4,.6,.8].map((function(t){return Bs(t,s,u,s,u,d,l,h,c)})),[o])}var f=n.getPositionOnScreen();if(0===i)return[o,f];var g=f.x-o.x,p=f.y-o.y,_=Math.sqrt(g*g+p*p),v=(o.x+f.x)/2,m=(o.y+f.y)/2,y=i*(_/5)*2,b=v+p/_*y,x=m+-g/_*y;return w([o],[.25,.5,.75].map((function(t){return Ds(t,o.x,o.y,f.x,f.y,b,x)})),[f])}(Lh=Ih=Ih||{}).LEFT="left",Lh.MIDDLE="middle",Lh.RIGHT="right";var Fh,Rh=pt&&"msLaunchUri"in navigator&&!("documentMode"in document),Ph=(E(Dh,Fh=xe),Object.defineProperty(Dh.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(Dh.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(Dh.prototype,"left",{get:function(){return this._left},enumerable:!0,configurable:!0}),Object.defineProperty(Dh.prototype,"right",{get:function(){return this._right},enumerable:!0,configurable:!0}),Object.defineProperty(Dh.prototype,"middle",{get:function(){return this._middle},enumerable:!0,configurable:!0}),Dh.prototype._isEnabled=function(){return this._settings.get("mouse.enabled")},Dh.prototype._isWheelEnabled=function(){return this._settings.get("mouse.wheelEnabled")},Dh.prototype._disableWheelUntilMouseDown=function(){return this._settings.get("mouse.disableWheelUntilMouseDown")},Dh.prototype._getDoubleClickTimer=function(){return this._settings.get("mouse.doubleClickTimer")},Dh.prototype._resetClickCounter=function(t,e){void 0===e&&(e=0),t?this._clickCounter[t]=e:(this._clickCounter.left=e,this._clickCounter.middle=e,this._clickCounter.right=e),this._dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null},Dh.prototype._setXY=function(t){var e=this._domElt.getBoundingClientRect();return!!(this._bounds=e)&&(this._evt=t,this._button=Xt[t.button],this._px=this._position.x,this._py=this._position.y,this._position.x=t.clientX-e.left,this._position.y=t.clientY-e.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)},Dh.prototype._applyMouseWheelZoom=function(t){var e;this._setXY(t)&&this._events.fire(ye.MOUSE_WHEEL,{delta:(e=t,Rh?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/Ct():e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0),x:this._position.x,y:this._position.y,domEvent:this._evt})},Dh.prototype._initializeListeners=function(){var t=this,e=this._domElt,i=this._dom;vt&&this._dom.addElementEventListener(document,"contextmenu",(function(e){t._lastMouseDownTarget&&e.target!==t._lastMouseDownTarget&&e.preventDefault()})),i.addElementEventListener(e,"contextmenu",(function(e){t._setXY(e),t._dom.hasFocus()&&t._settings.get("mouse.enabled")&&e.preventDefault()}),!1);var r="onwheel"in e?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll";i.addElementEventListener(e,r,this._onMouseWheel),i.addElementEventListener(e,"mousemove",this._onMouseMove),i.addElementEventListener(e,"mouseleave",(function(){t._isEnabled()&&(t._dom.blur(),t._events.fire(ye.MOUSE_LEAVE,{domEvent:t._evt}))})),i.addElementEventListener(e,"mousedown",this._onMouseDown),i.addElementEventListener(e,"mouseup",this._onMouseUp),i.addElementEventListener(e,"dragover",(function(t){t.preventDefault()})),i.addElementEventListener(e,"drop",this._onDrop)},Dh);function Dh(t){var e=t.dom,i=t.position,r=t.settings,n=t.events,o=t.graphics,a=t.camera,s=Fh.call(this)||this;return s._px=0,s._py=0,s._pressX=0,s._pressY=0,s._left=!1,s._middle=!1,s._right=!1,s._clickCounter={left:0,middle:0,right:0},s._buttons={left:!1,middle:!1,right:!1},s._skipNextMove=!1,s._onMouseWheel=function(t){s._isEnabled()&&s._isWheelEnabled()&&(!s._disableWheelUntilMouseDown()||s._dom.hasFocus())&&(t.preventDefault(),t.stopPropagation(),s._applyMouseWheelZoom(t))},s._onMouseMove=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,i=s._position.y,r=e-s._px,n=i-s._py;0==r&&0==n||(s._skipNextMove?s._skipNextMove=!1:6<=Pa(e,i,s._pressX,s._pressY)&&(s._resetClickCounter(),s._events.fire(ye.MOUSE_MOVE,{x:e,y:i,dx:r,dy:n,domEvent:s._evt})))}},s._onDocumentMouseMove=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,i=s._position.y,r=s._bounds,n=e-s._px,o=i-s._py;(e<0||e>r.width||i<0||i>r.height)&&s._events.fire(ye.DOCUMENT_MOUSE_MOVE,{x:e,y:i,dx:n,dy:o,domEvent:s._evt})}},s._onMouseUp=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,i=s._position.y,r=s._button,n=s._evt;s._buttons[r]=!1,1===s._clickCounter[s._button]?s._events.fire(ye.MOUSE_CLICK,{button:r,x:e,y:i,domEvent:n}):1<s._clickCounter[r]&&(s._events.fire(ye.MOUSE_DOUBLE_CLICK,{button:r,x:e,y:i,domEvent:n}),s._resetClickCounter(r)),s._events.fire(ye.MOUSE_UP,{button:r,x:e,y:i,domEvent:n})}},s._onDocumentMouseup=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,i=s._position.y,r=s._button;s._buttons[r]=!1;var n=s._dom;s._events.fire(ye.DOCUMENT_MOUSE_UP,{button:r,x:e,y:i,domEvent:s._evt}),n.removeDirectWindowEventListener("mousemove",s._onDocumentMouseMove),n.removeDirectWindowEventListener("mouseup",s._onDocumentMouseup)}},s._onMouseDown=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,i=s._position.y,r=s._button,n=s._dom;s._skipNextMove=!0,s._pressX=e,s._pressY=i,s._lastMouseDownTarget=t.target,n.focus(),s._buttons[r]=!0,s._clickCounter[r]+=1;var o=r;s._dbclickTimer=n.setTimeout((function(){s._resetClickCounter(o,0)}),s._getDoubleClickTimer()),s._events.fire(ye.MOUSE_DOWN,{button:r,x:e,y:i,domEvent:s._evt}),n.addDirectWindowEventListener("mousemove",s._onDocumentMouseMove),n.addDirectWindowEventListener("mouseup",s._onDocumentMouseup)}},s._onDrop=function(t){if(s._isEnabled()&&s._setXY(t)){t.preventDefault();var e=s._camera.screenToGraphCoordinates(s._position),i=e.x,r=e.y;s._events.fire(ye.DROP,{domEvent:s._evt,x:i,y:r})}},s._dom=e,s._settings=r,s._events=n,s._graphics=o,s._position=i,s._camera=a,s._domElt=s._graphics.getDomElement(),r.register("mouse.enabled",!0),r.register("mouse.wheelEnabled",!0),r.register("mouse.disableWheelUntilMouseDown",!1),r.register("mouse.doubleClickTimer",500),n.register([ye.MOUSE_DOWN,ye.MOUSE_UP,ye.MOUSE_MOVE,ye.MOUSE_WHEEL,ye.MOUSE_CLICK,ye.MOUSE_DOUBLE_CLICK,ye.MOUSE_LEAVE,ye.DOCUMENT_MOUSE_UP,ye.DOCUMENT_MOUSE_MOVE,ye.DROP]),e.afterNextFrame().then((function(){return s._initializeListeners()})),s}var zh,Bh=(E(Uh,zh=xe),Object.defineProperty(Uh.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(Uh.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(Uh.prototype,"pressed",{get:function(){return this._pressed},enumerable:!0,configurable:!0}),Uh.prototype._listen=function(t,e,i){if(oe){if(e===ie.START)return function(t,e,i){function r(t){ce(t)||(fe(t)&&t.preventDefault(),ve(t,i))}return t(e,ae,r,!1),r}(this._addEvent,t,i);if(e===ie.MOVE)return function(t,e,i){function r(t){ce(t)&&0===t.buttons||ve(t,i)}return t(e,se,r,!1),r}(this._addWinEvent,t,i);if(e===ie.END)return function(t,e,i){function r(t){return ve(t,i)}return t(e,ue,r,!1),t(e,de,r,!1),r}(this._addWinEvent,t,i);if(e===ie.CANCEL)return function(t,e,i){function r(t){fe(t)&&t.preventDefault(),ve(t,i)}return t(e,de,r,!1),r}(this._addWinEvent,t,i)}return this._dom.addElementEventListener(t,e,i)},Uh.prototype._initialize=function(t){function e(){s._position.x=u,s._position.y=d,s._pressed=c}function i(t,i){var r=s._domElt.getBoundingClientRect();if(!r||null==t.touches)return null;var n=t.touches[0].clientX-r.left,o=t.touches[0].clientY-r.top,a=t.touches[1].clientX-r.left,l=t.touches[1].clientY-r.top,h=(n+a)/2,c=(o+l)/2,f=h-u,g=c-d,p=Pa(n,o,a,l),_=p/v,y=Ss(n,o,a,l),b={dx:f,dy:g,rotation:y-m,scale:_};return v=p,m=y,u=h,d=c,e(),b}function r(t){if(f=Xt[t.button],t.touches){if(1!==t.touches.length)return c=!1,1<t.touches.length&&s._events.fire(ye.TOUCH_UP,{x:u,y:d,domEvent:y,button:f}),0;var i=s._domElt.getBoundingClientRect();return i&&(l=u,h=d,u=t.touches[0].clientX-i.left|0,d=t.touches[0].clientY-i.top|0,c=!0,y=t,e()),1}}function n(){g=0,s._dom.clearTimeout(b)}function o(t){if(t.preventDefault(),t.touches){if(2!==t.touches.length&&_&&(_=!1,s._events.fire(ye.TOUCH_END_GESTURE,{domEvent:y})),r(t),0===t.touches.length){var e={x:u,y:d,domEvent:y,button:f};1===g&&s._events.fire(ye.TOUCH_TAP,e),1<g&&(s._events.fire(ye.TOUCH_DOUBLE_TAP,e),n()),s._events.fire(ye.TOUCH_UP,e)}var i=Et().documentElement;me(s._removeWinEvent,i,ie.MOVE,s._onMove),me(s._removeWinEvent,i,ie.END,s._onEnd)}}function a(t){!function(t){if(t.touches&&2===t.touches.length&&_){var e=i(t);if(e){var r=e.dx,n=e.dy,o=e.rotation,a=e.scale;s._events.fire(ye.TOUCH_PROGRESS_GESTURE,{dx:r,dy:n,rotation:o,scale:a,x:u,y:d,domEvent:y,button:f})}}}(t),p?p=!1:(n(),r(t)&&s._events.fire(ye.TOUCH_MOVE,{x:u,y:d,dx:u-l,dy:d-h,domEvent:y,button:f}))}var s=this,u=0,d=0,l=0,h=0,c=!1,f=Ih.LEFT,g=0,p=!1,_=!1,v=1,m=0,y=null,b=null;this._listen(this._domElt,ie.START,(function(t){if(t.touches){2!==t.touches.length||_||i(t)&&(_=!0,s._events.fire(ye.TOUCH_START_GESTURE,{domEvent:y})),r(t)&&(s._dom.focus(),s._events.fire(ye.TOUCH_DOWN,{x:u,y:d,domEvent:y,button:f}),g+=1,b=s._dom.setTimeout(n,500),p=!0);var e=Et().documentElement;s._onMove=s._listen(e,ie.MOVE,a),s._onEnd=s._listen(e,ie.END,o)}}))},Uh);function Uh(t){var e=t.dom,i=t.events,r=t.settings,n=t.graphics,o=t.position,a=zh.call(this)||this;return a._pressed=!1,a._addEvent=function(t,e,i,r){a._dom.addElementEventListener(t,e,i,r)},a._addWinEvent=function(t,e,i,r){a._dom.addDirectWindowEventListener(e,i,r)},a._removeWinEvent=function(t,e,i){a._dom.removeDirectWindowEventListener(e,i)},a._dom=e,a._events=i,a._settings=r,a._graphics=n,a._position=o,a._domElt=a._graphics.getDomElement(),a._settings.register("touch.enabled",!0),a._events.register([ye.TOUCH_DOWN,ye.TOUCH_UP,ye.TOUCH_TAP,ye.TOUCH_DOUBLE_TAP,ye.TOUCH_MOVE,ye.TOUCH_START_GESTURE,ye.TOUCH_PROGRESS_GESTURE,ye.TOUCH_END_GESTURE,ye.DOCUMENT_TOUCH_MOVE,ye.DOCUMENT_TOUCH_UP]),a._dom.afterNextFrame().then((function(){a._initialize(a)})),a}function Vh(t,e,i,r){var n;if(r)n=r;else{n=new Uint32Array(t.length);for(var o=0,a=t.length;o<a;o++)n[o]=o}var s=i?function(t,e,i,r,n,o){var a=i-t,s=r-e,u=o-n,d=Math.sqrt(a*a+s*s);return[(t+i+a/d*u)/2,(e+r+s/d*u)/2,(d+n+o)/2]}:function(t,e,i,r){var n=t-i,o=e-r;return[(t+i)/2,(e+r)/2,Math.sqrt(n*n+o*o)/2]},u=i?function(t,e,i,r,n,o,a,s,u){var d=2*(t-i),l=2*(e-r),h=2*(s-a),c=t*t+e*e-a*a-i*i-r*r+s*s,f=2*(t-n),g=2*(e-o),p=2*(u-a),_=t*t+e*e-a*a-n*n-o*o+u*u,v=f*l-d*g,m=(l*_-g*c)/v-t,y=(g*h-l*p)/v,b=(f*c-d*_)/v-e,x=(d*p-f*h)/v,E=y*y+x*x-1,A=2*(m*y+b*x+a),S=m*m+b*b-a*a,w=(-A-Math.sqrt(A*A-4*E*S))/(2*E);return[m+y*w+t,b+x*w+e,w]}:function(t,e,i,r,n,o){var a=2*(t*(r-o)+i*(o-e)+n*(e-r));if(0==a)return null;var s=((t*t+e*e)*(r-o)+(i*i+r*r)*(o-e)+(n*n+o*o)*(e-r))/a,u=((t*t+e*e)*(n-i)+(i*i+r*r)*(t-n)+(n*n+o*o)*(i-t))/a,d=s-t,l=u-e;return[s,u,Math.sqrt(d*d+l*l)]},d=i?bd:yd;return i=i||[],function t(e,i,r,n,o,a,s,u,d){if(0===r||3===i.length)return h=n,c=o,f=a,g=u,p=d,1===(y=(l=i).length)?[h[_=l[0]],c[_],f[_]||0]:2===y?(_=l[0],v=l[1],g(h[_],c[_],h[v],c[v],f[_],f[v])):3===y?(_=l[0],v=l[1],m=l[2],p(h[_],c[_],h[v],c[v],h[m],c[m],f[_],f[v],f[m])):null;var l,h,c,f,g,p,_,v,m,y,b=e[r-1],x=t(e,i,r-1,n,o,a,s,u,d);return null!==x&&s(x,n[b],o[b],a[b])||(i.push(b),x=t(e,i,r-1,n,o,a,s,u,d),i.pop()),x}(n=function(t){for(var e=t.length-1;0<=e;e--){var i=Math.floor(Math.random()*(e+1));i=Math.max(Math.min(i,e),0);var r=t[e];t[e]=t[i],t[i]=r}return t}(n),[],n.length,t,e,i,d,s,u)}var jh,Gh=["x","y","radius"],Hh=(E(Wh,jh=xe),Wh.prototype.animateChildren=function(t,e,i){var r=this;t.getSubNodes().forEach((function(t){var n=r._subNodeOffsetX.get(t._index),o=r._subNodeOffsetY.get(t._index),a={x:i.x+n,y:i.y+o};t.setAttributes(a,e),t.getSubNodes()&&r.animateChildren(t,e,a)}))},Wh.prototype.resetOffsets=function(){this._recursiveGuard=!0;var t=this._graph.getNodes(),e=this._topologyLayer.getFlexArrays().nodes;t.setAttribute("x",e.x.getMultiple(t._indexes)),t.setAttribute("y",e.y.getMultiple(t._indexes)),e.x.reset(),e.y.reset(),this._recursiveGuard=!1},Wh.prototype.addVisibleGroup=function(t,e){this._visualGroupsLayers.set(t._index,e),this._visibleGroups.add(t._index)},Wh.prototype.getNodeDepth=function(t){return this._visualGroupsLayers.get(t._index)||0},Wh.prototype.removeVisibleGroup=function(t){var e=t._index;this._visibleGroups.delete(e),this._groupsToHide.push(e),this._visualGroupsLayers.delete(e)},Wh.prototype._getAllSubNodes=function(t){for(var e=Array.from(t._indexes),i=[],r=this._visibleGroups,n=this._subNodesList;0!==e.length;){var o=e.pop();if(null!=o&&r.has(o)){var a=n.get(o),s=Array.from(a._indexes);i.push.apply(i,s),e.unshift.apply(e,s)}}return this._graph.nodeList(new Uint32Array(i))},Wh.prototype._getAllMetaNodes=function(t){for(var e=Array.from(t._indexes),i=this._visibleGroups,r=this._metaNodeList,n=[],o=new Set;0!==e.length;){var a=e.pop();if(null!=a){var s=r.get(a);null!==s&&!o.has(s._index)&&i.has(s._index)&&(o.add(s._index),n.push(s._index),e.unshift(s._index))}}return this._graph.nodeList(new Uint32Array(n))},Wh.prototype.isVisibleGroup=function(t){return this._visibleGroups.has(t._index)},Wh.prototype.getSubNodeOffset=function(t){return{x:this._subNodeOffsetX.get(t._index),y:this._subNodeOffsetY.get(t._index)}},Wh.prototype._fetchSubEltsList=function(t){return t?this._subNodesList:this._subEdgesList},Wh.prototype._fetchMetaEltList=function(t){return t?this._metaNodeList:this._metaEdgeList},Wh.prototype.setSubElements=function(t,e){this._fetchSubEltsList(t.isNode).setMultiple(t._indexes,e)},Wh.prototype.setMetaElement=function(t,e){this._fetchMetaEltList(t.isNode).setMultiple(t._indexes,e)},Wh.prototype.getSubElements=function(t){return this._fetchSubEltsList(t.isNode).getMultiple(t._indexes)},Wh.prototype.getMetaElement=function(t){return this._fetchMetaEltList(t.isNode).getMultiple(t._indexes)},Wh);function Wh(t){var e=t.graph,i=t.graphics,r=t.dom,n=t.events,o=jh.call(this)||this;return o._visibleGroups=new Set,o._visualGroupsLayers=new Map,o._groupsToHide=[],o._updateVisualGroups=function(t,e,i){var r=i.getUpdatedElementsList(),n=t.nodes.outputFlexArrays,a=t.nodes.inputFlexArrays,s=o._visibleGroups;if(0===r.size||0===s.size)return t.nodes.toUpdate.clear(),t.edges.toUpdate.clear(),t.nodes.formattedOutput&&(t.nodes.formattedOutput.attributes=[]),void(t.nodes.output&&(t.nodes.output.attributes=[]));for(var u=i.getUpdatedAttributes();0<o._groupsToHide.length;){var d=o._groupsToHide.pop();n.radius.set(d,void 0),n.x.set(d,void 0),n.y.set(d,void 0)}if(u.has("x")||u.has("y")||u.has("radius")){var l=o._getAllSubNodes(r),h=o._getAllMetaNodes(r),c=t.nodes.toUpdate,f=t.edges.toUpdate,g=o._subNodeOffsetX,p=o._subNodeOffsetY;t.nodes.formattedOutput&&t.nodes.output&&(t.nodes.formattedOutput.attributes=Gh,t.nodes.output.attributes=Gh);var _=new Set;r.forEach((function(t){var e=t._index;n.x.set(e,void 0),n.y.set(e,void 0),_.add(e)})),l.forEach((function(t){if(a){var e=t.getMetaNode(),i=t._index,r=a.x.get(i),o=a.y.get(i);if(e&&s.has(e._index)){var u=g.get(i),d=p.get(i),l=n.x.get(e._index),v=n.y.get(e._index),m=r-l,y=o-v;if(-1e7===u||-1e7===d)return g.set(i,m),p.set(i,y),void(h.includes(e)||(h=h.concat(e.toList())));c.addIndex(i),f.add(t.getAdjacentEdges()),_.has(i)||u===m&&d===y||(r=l+u,o=v+d,n.x.set(i,r),n.y.set(i,o)),g.set(i,r-l),p.set(i,o-v)}}})),h.forEach((function(t){var e=t.getSubNodes();if(e){var i=n.x.getMultiple(e._indexes),r=n.y.getMultiple(e._indexes),o=n.radius.getMultiple(e._indexes),a=Vh(i,r,o),s=a[0],u=a[1],d=a[2];e.forEach((function(t,e){g.set(t._index,i[e]-s),p.set(t._index,r[e]-u)})),n.x.set(t._index,s),n.y.set(t._index,u),n.radius.set(t._index,d),c.addIndex(t._index),f.add(t.getAdjacentEdges())}})),i.addUpdatedAttribute("radius"),i.addUpdatedAttribute("x"),i.addUpdatedAttribute("y"),i.redrawElements(h)}},o._graph=e,o._graphics=i,o._dom=r,o._subNodesList=e.createNodeAttribute({storage:"any",default:null}),o._subEdgesList=e.createEdgeAttribute({storage:"any",default:null}),o._metaNodeList=e.createNodeAttribute({storage:"any",default:null}),o._metaEdgeList=e.createEdgeAttribute({storage:"any",default:null}),o._subNodeOffsetX=e.createNodeAttribute({storage:"float",default:-1e7}),o._subNodeOffsetY=e.createNodeAttribute({storage:"float",default:-1e7}),o._recursiveGuard=!1,n.on(ye.SET_MULTIPLE_ATTRIBUTES,(function(t){var e=t.elements,i=t.values,r=t.options;if(!o._recursiveGuard){var n=e.toList().map((function(t,e){return{group:t,translation:i.constructor===Array?{x:i[e]&&i[e].x||0,y:i[e]&&i[e].y||0}:{x:i.x||0,y:i.y||0},isGroup:t.isNode&&t.getSubNodes()}})).filter((function(t){return t.isGroup}));n.length&&(o._recursiveGuard=!0,n.forEach((function(t){var e=t.group,i=t.translation;o.animateChildren(e,r,i)})),o._recursiveGuard=!1)}})),o._groupAttributeLayer=i.addAttributeLayer({name:"internal(_compound)",priority:7,nodeSelector:function(t){return o._visibleGroups.has(t._index)},edgeSelector:function(t){return t.isVirtual()},nodeAttributes:{layer:function(t){return o._visualGroupsLayers.get(t._index)}},nodeOutput:{attributes:["layer"]},nodeDependencies:{self:{data:!1,hover:!0},adjacentNodes:{attributes:"all"},adjacentEdges:{attributes:"all"}}}),o._topologyLayer=o._graphics.addAttributeLayer({name:"internal(position-forcer)",priority:6.9,nodeDependencies:{self:{attributes:["x","y","radius"]},adjacentNodes:{attributes:"all"}},onBeforeUpdate:o._updateVisualGroups,nodeOutput:{attributes:["x","y","radius","layer"]}}),o}var qh=(Xh.prototype.getName=function(){return this._module.getName(this._id)},Xh.prototype.getId=function(){return this._id},Xh.prototype.whenApplied=function(){return this._whenApplied},Xh.prototype.isEnabled=function(){return this._module.isEnabled(this._id)},Xh.prototype.enable=function(t){return this._module.enable(this._id,t)},Xh.prototype.disable=function(t){return this._module.disable(this._id,t)},Xh.prototype.toggle=function(t){return this._module.toggle(this._id,t)},Xh.prototype.getIndex=function(){return this._module.getIndex(this._id)},Xh.prototype.setIndex=function(t){var e=this;return this._module.setIndex(this._id,t).then((function(){return e}))},Xh.prototype.destroy=function(t){return this._module.remove(this._id,t||0)},Xh.prototype.refresh=function(){return this._module.refresh()},Xh.prototype.delete=function(t){return this.destroy(t)},Xh);function Xh(t,e){var i=this;this._module=t,this._id=e,this._whenApplied=t.whenApplied().then((function(){return i}))}var Yh=(Zh.prototype.cleanup=function(t){return Promise.resolve()},Zh);function Zh(t){}var Kh,Qh=(E(Jh,Kh=xe),Jh.prototype._invalidState=function(){var t=this;this._afterCurrentUpdate.then((function(){(t._list.length||t._currentPipeline.length)&&(t._mustRefresh=!0,t._dom.refresh())}))},Jh.prototype._onUpdate=function(){var t=this;return this._afterCurrentUpdate.then((function(){return t._dom.refresh(),new Promise((function(e,i){return t._resolvers.push({resolve:e,reject:i})}))}))},Jh.prototype._getSubElements=function(t){var e=this;return t.reduce((function(t,i){var r=e._ogma.modules.grouping.getSubElements(i)[0];return r?t.concat(e._getSubElements(r)):t.concat(i)}),t.slice(0,0))},Jh.prototype._assignTransformationIds=function(t,e,i){null!==e&&this._nodeTransformationIdList.setMultiple(e._indexes,t),null!==i&&this._nodeTransformationIdList.setMultiple(i._indexes,t)},Jh.prototype._resolveTransformations=function(t,e,i){var r=this;i||(t.forEach((function(t){return t.duration=0})),e.forEach((function(t){return t.duration=0})));for(var n=this._selection.getSelectedNodes().getId(),o=this._selection.getSelectedEdges().getId(),a=Promise.resolve(),s=function(i){var r=t[i];null!==r.context&&(a=a.then((function(){return r.methods.undo(r)}))),e.some((function(t){return t.id===r.id}))||(a=a.then((function(){return r.methods.cleanup(r)})).then((function(){r.context=null})))},u=t.length-1;0<=u;--u)s(u);var d=function(t){var i=e[t];a=a.then((function(){return i.methods.run(i)})).catch((function(t){return i.error=t,!0})).then((function(t){if(!0!==t){var e=t;return r._assignTransformationIds(i.id,e.virtualNodes,e.virtualEdges),i.context=e,i.methods.cleanup(i)}}))};for(u=0;u<e.length;++u)d(u);return a=a.then((function(){r._destroyed||(r._graph.getNodes(n).setSelected(!0),r._graph.getEdges(o).setSelected(!0))}))},Jh.prototype.getList=function(){return this._list.map((function(t){return t.wrapper}))},Jh.prototype.clear=function(){var t=this;return this._list=[],this._invalidState(),this._onUpdate().then((function(){return t._dom.afterNextFrame()}))},Jh.prototype._get=function(t,e){void 0===e&&(e=!0);for(var i=0;i<this._list.length;++i){var r=this._list[i];if(r.id===t)return r.index=i,r}if(e)throw new Error("calling a method on a destroyed transformation");return null},Jh.prototype.getName=function(t){var e=this._get(t);if(e)return e.methods.getName()},Jh.prototype.enable=function(t,e){var i=this;return this._afterCurrentUpdate.then((function(){var r=i._get(t);return r&&!r.enabled&&(r.enabled=!0,r.duration=e,i._invalidState()),i._onUpdate()}))},Jh.prototype._setRemovalDuration=function(t,e){for(var i=0;i<this._currentPipeline.length;++i){var r=this._currentPipeline[i];r.id===t&&(r.duration=e)}},Jh.prototype.disable=function(t,e){var i=this;return this._afterCurrentUpdate.then((function(){var r=i._get(t);return r&&r.enabled&&(r.enabled=!1,i._setRemovalDuration(t,e),i._invalidState()),i._onUpdate()}))},Jh.prototype.remove=function(t,e){var i=this;return this._afterCurrentUpdate.then((function(){var r=i._get(t);return r&&(i._list.splice(r.index,1),i._setRemovalDuration(t,e),i._invalidState()),i._onUpdate()}))},Jh.prototype.toggle=function(t,e){var i=this;return this._afterCurrentUpdate.then((function(){var r=i._get(t);return r&&r.enabled?i.disable(t,e):i.enable(t,e)}))},Jh.prototype.setIndex=function(t,e){var i=this;return this._afterCurrentUpdate.then((function(){var r=i._get(t);return r&&(i._list.splice(r.index,1),i._list.splice(qe(e,0,i._list.length),0,r),i._invalidState()),i._onUpdate()}))},Jh.prototype.getIndex=function(t){var e=this._get(t);return e?e.index:-1},Jh.prototype.add=function(t,e){var i=void 0===e?{}:e,r=i.duration,n=void 0===r?0:r,o=i.enabled,a=void 0===o||o;t.cleanup||(t.cleanup=function(){return Promise.resolve()});var s={ogma:this._ogma,id:++this._idCounter,methods:t,duration:n,enabled:a,context:null,wrapper:new qh(this,this._idCounter),index:-1,error:null};return this._list.push(s),this._invalidState(),s.wrapper},Jh.prototype.whenApplied=function(){return this._onUpdate()},Jh.prototype.refresh=function(){return this._invalidState(),this._onUpdate()},Jh.prototype.isEnabled=function(t){var e=this._get(t);return e&&e.enabled||!1},Jh.prototype._getElementTransformationId=function(t){return(t.isNode?this._nodeTransformationIdList:this._edgeTransformationIdList).get(t._index)},Jh.prototype.isElementVirtual=function(t){return 0!==this._graph.getAttribute(t.isNode,"virtual").get(t._index)},Jh.prototype.getElementTransformation=function(t){var e=this._get(this._getElementTransformationId(t),!1);return e&&e.wrapper},Jh.prototype.destroy=function(){this._destroyed=!0},Jh);function Jh(t,e){var i,r=t.settings,n=t.dom,o=t.events,a=t.captor,s=t.selection,u=t.classes,d=t.graph,l=Kh.call(this)||this;return l._list=[],l._currentPipeline=[],l._idCounter=0,l._mustRefresh=!1,l._safeGuard=!1,l._resolvers=[],l._afterCurrentUpdate=Promise.resolve(),l._destroyed=!1,l._computeTransformations=function(){if(l._safeGuard)return Promise.resolve();if(l._safeGuard=!0,l._afterCurrentUpdate=Promise.resolve(),l._mustRefresh){l._captor.setDetectionEnabled(!1);var t,e,i=l._currentPipeline.filter((function(t){return t.enabled})),r=l._list.filter((function(t){return t.enabled})),n=!1;if(i.length===r.length+1&&$h(i,r,r.length)){var o=i.pop();t=o?[o]:[],e=[],n=!0}else if(r.length===i.length+1&&$h(i,r,i.length)){t=[];var a=r.pop();e=a?[a]:[],n=!0}else t=i,e=r,n=!1;l._afterCurrentUpdate=l._afterCurrentUpdate.then((function(){return l._resolveTransformations(t,e,n)})).then((function(){return l._captor.setDetectionEnabled(!0),l._currentPipeline=l._list.map((function(t){return A({},t)})),l._mustRefresh=!1,l._dom.afterNextFrame()}))}return l._afterCurrentUpdate=l._afterCurrentUpdate.then((function(){l._safeGuard=!1,l._resolvers.forEach((function(t,e){var i=t.resolve,r=t.reject,n=l._list[e];return n&&n.error?r(n.error):i()})),l._resolvers=[]})),l._afterCurrentUpdate},l._settings=r,l._dom=n,l._events=o,l._graph=d,l._captor=a,l._classes=u,l._selection=s,l._ogma=e,u.createClass({name:gi,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0,width:0}}),l._classes.createClass({name:pi,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),l._nodeTransformationIdList=d.createNodeAttribute({storage:16,default:0}),l._edgeTransformationIdList=d.createEdgeAttribute({storage:16,default:0}),r.register("transformations.updateOnDataChange",!0),o.on(((i={})[[ye.ADD_NODES,ye.ADD_EDGES,ye.REMOVE_NODES,ye.REMOVE_EDGES].join(" ")]=function(t){t.virtual||l._invalidState()},i[ye.REQUEST_ELEMENTS_TO_DELETE]=function(t){t.virtual||(t.elementsToRemove=l._getSubElements(t.elementsToRemove))},i[ye.UPDATE_NODE_DATA+" "+ye.UPDATE_EDGE_DATA]=function(){l._settings.get("transformations.updateOnDataChange")&&!l._safeGuard&&l._invalidState()},i[ye.AFTER_NEW_FRAME]=l._computeTransformations,i)),l}function $h(t,e,i){for(var r=0;r<i;++r)if(t[r].id!==e[r].id)return;return 1}var tc,ec={layer:2,outline:!0,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},ic={layer:2,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0},stroke:{width:2}},rc=(E(nc,tc=xe),nc.prototype.onMounted=function(t){function e(){i._selectionExtremityHighlightedClass.clearNodes(),i._selectedClass.getEdges().getExtremities().addClass(li)}var i=this;t.events.onEdgesClassAdded(di,e),t.events.onEdgesClassRemoved(di,e)},nc.prototype.setNodeAttributes=function(t,e){this._selectedClass.update({nodeAttributes:t,fullOverwrite:e}),this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},nc.prototype.setEdgeAttributes=function(t,e){this._selectedClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},nc.prototype._updateExtremityHighlightLayer=function(){var t=this._selectedClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})},nc.prototype.setActive=function(t,e){if(O(e)){var i=[],r=[];t.toList().forEach((function(t,n){(e[n]?i:r).push(t.getId())})),0!==i.length&&this._graph.getElements(t.isNode,i).addClass(di),0!==r.length&&this._graph.getElements(t.isNode,r).removeClass(di)}else t[e?"addClass":"removeClass"](di)},nc.prototype.areActive=function(t){return t.hasClass(di)},nc.prototype.getSelectedNodes=function(){return this._selectedClass.getNodes()},nc.prototype.getSelectedEdges=function(){return this._selectedClass.getEdges()},nc.prototype.getNonSelectedNodes=function(){return this._graph.getNodes().filter((function(t){return!t.hasClass(di)}))},nc.prototype.getNonSelectedEdges=function(){return this._graph.getEdges().filter((function(t){return!t.hasClass(di)}))},nc.prototype.clear=function(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()},nc);function nc(t){var e=t.events,i=t.settings,r=t.graph,n=t.keyboard,o=t.graphics,a=t.interactions,s=t.classes,u=tc.call(this)||this;return u._events=e,u._settings=i,u._graph=r,u._keyboard=n,u._graphics=o,u._selectionExtremityHighlightedClass=s.createClass({name:li,isBuiltin:!0,nodeAttributes:ec}),u._selectedClass=s.createClass({name:di,isBuiltin:!0,nodeAttributes:ec,edgeAttributes:ic}),i.register("interactions.selection.enabled",!0),i.register("interactions.selection.multiSelectionKey","ctrl"),a.onClick({priority:"selection",check:function(t){var e=t.button,i=u._settings.get("interactions.selection.enabled");return"left"===e&&i&&!u._graphics.isAnimating()},handler:function(t){var e=t.target;if(e){var i=u._settings.get("interactions.selection.multiSelectionKey"),r=i&&u._keyboard.isPressed(i);e.isNode?u._selectedClass.clearEdges():u._selectedClass.clearNodes(),r?e.hasClass(di)?e.removeClass(di):e.addClass(di):((e.isNode?u._selectedClass.getNodes():u._selectedClass.getEdges()).filter((function(t){return t!==e})).removeClass(di),e.hasClass(di)||e.addClass(di))}else u._selectedClass.clearNodes(),u._selectedClass.clearEdges()}}),u._events.on(ye.BEFORE_REMOVE_EDGES,(function(t){return t.edges.setSelected(!1)})),u}var oc,ac=(E(sc,oc=xe),sc.prototype._nextTimeIdle=function(t){var e=this,i=new uc(this._dom,this._idIdle,t);return this._delayedCalls.push(i),i.whenDone().then((function(){e._delayedCalls.splice(e._delayedCalls.indexOf(i),1)}))},sc.prototype.debounceIdle=function(t,e){var i=this;function r(){var e=o;n=!1,o=[],t(),e.forEach((function(t){return t()}))}void 0===e&&(e=0);var n=!1,o=[];return function(){return new Promise((function(t){o.push(t),n||(n=!0,i._nextTimeIdle(e).then(r))}))}},sc);function sc(t){var e,i=t.dom,r=t.events,n=t.captor,o=oc.call(this)||this;return o._dom=i,o._events=r,o._captor=n,o._delayedCalls=[],o._idIdle=function(){return!o._captor.isAnyButtonPressed()&&!o._dom.isPlayingFrame()},o._events.on(((e={})[[ye.DOWN,ye.UP,ye.BEFORE_NEW_FRAME,ye.NEW_FRAME].join(" ")]=function(){o._delayedCalls.forEach((function(t){return t.reset()}))},e)),o}var uc=(dc.prototype._startTimeout=function(){var t=this;this._timeout=this._dom.setTimeout((function(){t._isIdle()?(t._done=!0,t._resolve()):t._startTimeout()}),this._delay)},dc.prototype.reset=function(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())},dc.prototype.whenDone=function(){return this._promise},dc);function dc(t,e,i){var r=this;this._timeout=null,this._done=!1,this._dom=t,this._promise=new Promise((function(t){return r._resolve=t})),this._isIdle=e,this._delay=i,this._startTimeout()}var lc,hc={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2,enabled:!1},cc={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2,enabled:!1},fc=(E(gc,lc=xe),gc.prototype._onElementsAttributeChange=function(t,e){if(e.includes("pulse.enabled")){var i=Pi(this._graph,t,(function(t){return t.getAttribute("pulse.enabled")})),r=i.valid,n=i.invalid;this._hasPulses.removeElements(n),this._hasPulses.addElements(r),this._removePulses(n)}},gc.prototype._removePulses=function(t){for(var e=t.isNode?this._nodePulses:this._edgePulses,i=0;i<t._indexes.length;i++){var r=t._indexes[i],n=e.get(r);if(n){for(var o=0;o<n.length;o++){var a=n[o];this._graphics.releaseGraphicsEngineBlockId(a.blockId)}e.set(r,null)}}},gc.prototype._refreshElementsPulses=function(t,e){for(var i=t.isNode,r=i?this._nodePulses:this._edgePulses,n=i?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,o=i?"_createNodePulseBlock":"_createEdgePulseBlock",a=i?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,s=i?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,u=0;u<t._indexes.length;u++){var d=t._indexes[u],l=r.get(d);l||(l=[],r.set(d,l));for(var h=0;h<l.length;h++){var c=l[h],f=c.startTime,g=c.duration,p=c.blockId;f+g<=e&&(this._graphics.releaseGraphicsEngineBlockId(p),l.splice(h--,1))}var _=l[l.length-1];if(!_||e>=_.startTime+a.get(d)){g=n.get(d);var v=s.get(d);0!==v&&l.push({blockId:this[o](d,e,g),startTime:e,duration:g}),0<v&&s.set(d,v-1)}}},gc.prototype._createNodePulseBlock=function(t,e,i){var r=this._nodeFlexArrays,n=r.color.get(t),o=r.layer.get(t),a=r.x.get(t),s=r.y.get(t),u=r.radius.get(t),d="scaled"===r.scalingMethod.get(t),l=r.pulse.startRatio.get(t),h=r.pulse.endRatio.get(t),c=r.pulse.width.get(t),f=2*u*l,g=2*u*h,p=td(o).nodeBody,_=r.pulse.startColor.get(t),v=r.pulse.endColor.get(t),m=this._graphics.allocateGraphicsEngineBlockId(),y=this._block.reset(1,!0,p),b=y.nextAndReset(),x=Wu(_,n),E=Wu(v,n);return b.end.shape="circle",b.end.pieceId=1,b.end.x1=a,b.end.y1=s,b.end.x2=a,b.end.y2=s,b.end.rectWidthOrSourceRadiusScaled=d?g:0,b.end.rectHeightOrTargetRadiusScaled=d?g:0,b.end.rectWidthOrSourceRadiusFixed=d?0:g,b.end.rectHeightOrTargetRadiusFixed=d?0:g,b.end.strokeWidthFixed=c,b.end.strokeColor=E,b.start.shape="circle",b.start.pieceId=1,b.start.x1=a,b.start.y1=s,b.start.x2=a,b.start.y2=s,b.start.rectWidthOrSourceRadiusScaled=d?f:0,b.start.rectHeightOrTargetRadiusScaled=d?f:0,b.start.rectWidthOrSourceRadiusFixed=d?0:f,b.start.rectHeightOrTargetRadiusFixed=d?0:f,b.start.strokeWidthFixed=c,b.start.strokeColor=x,b.animation.duration=i,b.animation.beginTime=e,this._engine.storeBlock(m,y),m},gc.prototype._createEdgePulseBlock=function(t,e,i){var r=this._edgeFlexArrays,n=this._nodeFlexArrays,o=r.pulse.startRatio.get(t),a=r.pulse.endRatio.get(t),s=r.pulse.startColor.get(t),u=r.pulse.endColor.get(t),d=td(r.layer.get(t)).edgeBody,l=this._edgeSourceList.get(t),h=this._edgeTargetList.get(t),c=r.curvature.get(t),f=0!==c,g=this._graphics.allocateGraphicsEngineBlockId(),p=this._block.reset(f?3:1,!0,d),_=p.nextAndReset(),v={isSelfLoop:l===h,curvature:c,sourceX:n.x.get(l),sourceY:n.y.get(l),targetX:n.x.get(h),targetY:n.y.get(h),sourceRadius:n.radius.get(l),targetRadius:n.radius.get(h),isSourceRadiusScaled:"scaled"===n.scalingMethod.get(l),isTargetRadiusScaled:"scaled"===n.scalingMethod.get(h),width:r.width.get(t),isWidthScaled:"scaled"===r.scalingMethod.get(t),strokeWidth:r.pulse.width.get(t)};return pc(_.start,v),pc(_.end,v),_.start.strokeColor=s,_.end.strokeColor=u,_.start.thicknessOrFontSizeScaled*=o,_.start.thicknessOrFontSizeFixed*=o,_.end.thicknessOrFontSizeScaled*=a,_.end.thicknessOrFontSizeFixed*=a,_.animation.duration=i,_.animation.beginTime=e,this._engine.storeBlock(g,p),g},gc.prototype.pulse=function(t,e){var i=t.isNode,r=A(A({},i?hc:cc),e),n=r.number,o=r.interval,a=r.duration,s=i?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,u=(n-1)*o+a;delete r.number,r.enabled=!0,t.setAttributes({pulse:r}),s.setMultiple(t._indexes,n),this._dom.setTimeout((function(){t.setAttribute("pulse.enabled",!1),s.setMultiple(t._indexes,-1)}),u)},gc);function gc(t){var e,i=t.graphics,r=t.graph,n=t.dom,o=t.events,a=lc.call(this)||this;return a._onAttributeChange=function(t){var e=t.nodes,i=t.edges,r=t.nodeAttributes,n=t.edgeAttributes;a._onElementsAttributeChange(e,r),a._onElementsAttributeChange(i,n)},a._refreshPulses=function(){var t=a._hasPulses.getElements(),e=t.nodes,i=t.edges;if(0!==e.size||0!==i.size){var r=a._engine.getCurrentTime();a._refreshElementsPulses(e,r),a._refreshElementsPulses(i,r),a._dom.refresh()}},a._graph=r,a._dom=n,a._graphics=i,o.on(((e={})[ye.UPDATE_ATTRIBUTES]=a._onAttributeChange,e[ye.NEW_FRAME]=a._refreshPulses,e[ye.BEFORE_REMOVE_NODES+" "+ye.BEFORE_REMOVE_EDGES]=function(t){var e=t.nodes,i=t.edges;(e||i).setAttribute("pulse.enabled",!1)},e[ye.CLEAR_GRAPH]=function(){return a._hasPulses.clear()},e)),a._engine=a._graphics.getGraphicsEngine(),a._block=a._engine.createBlock(),a._nodePulses=r.createNodeAttribute({storage:"any"}),a._edgePulses=r.createEdgeAttribute({storage:"any"}),a._nodeNbPulsesRemaining=r.createNodeAttribute({storage:"int16",default:-1}),a._edgeNbPulsesRemaining=r.createEdgeAttribute({storage:"int16",default:-1}),a._nodeFlexArrays=a._graphics.getNodeAttributes(),a._edgeFlexArrays=a._graphics.getEdgeAttributes(),a._edgeSourceList=r.getEdgeAttribute("source"),a._edgeTargetList=r.getEdgeAttribute("target"),a._hasPulses=new Lo(a._graph),a}function pc(t,e){var i=e.sourceX,r=e.sourceY,n=e.targetX,o=e.targetY,a=e.isSourceRadiusScaled,s=e.isTargetRadiusScaled,u=e.targetRadius,d=e.sourceRadius,l=e.isWidthScaled,h=e.width,c=e.strokeWidth,f=e.curvature,g=e.isSelfLoop;t.pieceId=2,t.shape="line",t.x1=i,t.y1=r,t.x2=n,t.y2=o,t.rectWidthOrSourceRadiusScaled=a?d:0,t.rectWidthOrSourceRadiusFixed=a?0:d,t.rectHeightOrTargetRadiusScaled=s?u:0,t.rectHeightOrTargetRadiusFixed=s?0:u,t.thicknessOrFontSizeScaled=l?h:0,t.thicknessOrFontSizeFixed=l?0:h,t.strokeWidthFixed=c,t.curvature=f,t.isSelfLoop=g}var _c,vc={duration:0,easing:"linear",callback:function(){},startAfter:0},mc=(E(yc,_c=xe),yc.prototype.play=function(t,e){var i=tt(e,vc),r=i.duration,n=i.easing,o=i.callback,a=i.startAfter,s=null;return r<=0?(t(1),o()):(s={func:t,easing:"function"==typeof n?n:Iu[n],duration:r,callback:o,startAfter:a,creationDate:Jt(),done:!1},this._animationList.push(s),this._dom.refresh()),s},yc.prototype.end=function(t,e){void 0===e&&(e=!0);var i=this._animationList.indexOf(t);-1!==i&&(t.func(1),this._animationList.splice(i,1),t.done=!0,e&&t.callback(!0))},yc);function yc(t){var e=t.dom,i=t.events,r=_c.call(this)||this;return r._animationList=[],r._update=function(){if(0!==r._animationList.length){for(var t=Jt(),e=[],i=0;i<r._animationList.length;++i){var n=r._animationList[i],o=(t-n.creationDate)/n.duration,a=n.startAfter,s=n.easing(o);1<=o?(n.func(1),n.done=!0,r._animationList.splice(i,1),--i,e.push(n.callback)):a<=s&&(s=1/(1-a)*(s-a),n.func(s))}for(var u=0;u<e.length;++u)e[u](!1);r._dom.refresh()}},r._dom=e,r._events=i,r._animationList=[],r._events.on(ye.BEFORE_NEW_FRAME,r._update),r}function bc(t){return t+(-1===t.indexOf("?")?"?":"&")+"noCache="+Date.now()}var xc,Ec={tileLayers:function(t,e,i,r,n){var o=i._getMapPanePos(),a=t.getContainer();if(!a)throw new Error("Trying to access the container of "+t+" but it does not exist.");var s=r.DomUtil.getPosition(a);i.removeLayer(t),t.options.crossOrigin="anonymous";var u=[],d=[];return t.on("tileload",(function(t){var e=t.tile,i=r.DomUtil.getPosition(e),a=i.x,l=i.y;u.push(e),d.push({x:a-s.x+o.x-n.x,y:l-s.y+o.y-n.y})})),i.addLayer(t),new Promise((function(i){t.once("load",(function(){var r=t.getTileSize();u.forEach((function(t,i){var n=d[i],o=n.x,a=n.y;e.drawImage(t,o,a,r.x,r.y)})),i()}))}))},imageOverlays:function(t,e,i,r,n){return new Promise((function(r){i.removeLayer(t),t.setUrl(bc(t.getUrl())),t.options.crossOrigin="anonymous",t.once("load",(function(){var o=t.getBounds(),a=i.latLngToContainerPoint(o.getNorthWest()),s=i.latLngToContainerPoint(o.getSouthEast()),u=s.x-a.x,d=s.y-a.y;e.drawImage(t._image,a.x-n.x,a.y-n.y,u,d),r()})),i.addLayer(t)}))},vectorLayers:function(t,e,i,r,n,o){return new Promise((function(a){var s=t.options.renderer;i.removeLayer(t),t.options.renderer=o,i.addLayer(t),o._updatePaths();var u=i._getMapPanePos(),d=o._container,l=r.DomUtil.getPosition(d),h=Ct();e.drawImage(o._container,l.x+u.x-n.x,l.y+u.y-n.y,d.width/h,d.height/h),i.removeLayer(t),t.options.renderer=s,i.addLayer(t),a()}))},markers:function(t,e,i,r,n){return new Promise((function(r){var o=i.getPixelBounds().min,a=i.project(t.getLatLng(),i.getZoom()),s=/^data\:/.test(t._icon.src),u=s?t._icon.src:bc(t._icon.src),d=new Image,l=t.options.icon;if(l){var h=l.options,c=h.iconSize||[24,24],f=a.subtract(o),g=h.iconAnchor||[0,0];Array.isArray(c)||(c=[c.x,c.y]),Array.isArray(g)||(g=[g.x,g.y]);var p=Math.round(f.x-c[0]+g[0])-n.x,_=Math.round(f.y-g[1])-n.y;d.crossOrigin="";var v=function(){e.drawImage(d,p,_,c[0],c[1]),r()};d.onload=v,d.src=u,s&&v()}}))},vectorMap:function(t,e,i,r,n){var o=i._getMapPanePos(),a=t.getMapboxMap(),s=t.getCanvas(),u=t.getSize().round(),d=r.DomUtil.getPosition(t.getContainer()),l=d.x+o.x-n.x,h=d.y+o.y-n.y;return new Promise((function(t){function i(){e.drawImage(s,l,h,u.x,u.y),t()}if(a.loaded())return i();a.once("idle",i)}))}},Ac={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},Sc={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},wc={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:void 0},Tc=(E(Cc,xc=xe),Cc.prototype.set=function(t,e){var i=A(A({},wc),e),r=i.position,n=i.horizontalMargin,o=i.verticalMargin,a=i.className;Ac[r]||(r=wc.position),this.remove();var s=document.createElement("div");return s.innerHTML=t,s.style.position="absolute",Mc(s,r,n,o),s.style.padding="0px 0px 0px 0px",s.style.zIndex="10",a&&s.setAttribute("class",a),this._brand=s,this._dom.setLayer("brand",this._brand),s},Cc.prototype.remove=function(){this._dom.setLayer("brand",null),this._brand=null},Cc);function Cc(t){var e=t.dom,i=xc.call(this)||this;return i._dom=e,i._brand=null,i}function Mc(t,e,i,r){var n=void 0===i?"":i+"px",o=void 0===r?"":r+"px";t.style[Ac[e]]=n,t.style[Sc[e]]=o}var Ic,Lc=(E(Nc,Ic=xe),Nc.prototype._onDataChange=function(t){var e=this,i=t.filter((function(t){var i=t.property;return i===e.latitudePath||i===e.longitudePath}));if(i.length){var r=i.reduce((function(t,e){var i=e.nodes,r=e.newValues;if(!i)return t;var n=i.filter((function(t,e){return null!=r[e]}));return t?t.concat(n):n}),null);r&&this._refreshOrAddNodes(r)}},Nc.prototype._refreshOrAddNodes=function(t){this._updateNodesCoordinates(t),this._enabled&&(this._filter.refresh(),this._updatePrevNodesCoordinates(t))},Nc.prototype._updatePrevNodesCoordinates=function(t){lr(this._graph,t,Ji,"geo.prevLat"),lr(this._graph,t,$i,"geo.prevLng")},Nc.prototype._restorePrevNodesCoordinates=function(t){lr(this._graph,t,"geo.prevLat",Ji),lr(this._graph,t,"geo.prevLng",$i)},Nc.prototype._updateNodesCoordinates=function(t){!function(t,e,i){for(var r=i.longitudePath,n=i.latitudePath,o=i.wrapCoordinates,a=t.getAttributes(!0,[Ji,$i]),s=a[0],u=a[1],d=e._indexes,l=e.getId(),h=d.length,c=e.getData(n),f=e.getData(r),g=0;g<h;g++){var p=f[g],_=c[g],v=d[g],m=l[g];null!=_&&null!=p&&(ar(m,p),sr(m,_),o&&(p%=180,_=qe(+_,-tr,tr)),u.set(v,p),s.set(v,_))}}(this._graph,t,this._settings)},Nc.prototype._createMapTileLayer=function(t,e){if(t&&!et(t))return t;var i=t.wms?this.L.tileLayer.wms:this.L.tileLayer,r=(null==e&&t.url===er.tiles.url?'Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>':null)||"";return i(t.url,A({attribution:r},t))},Nc.prototype._setupTileLayer=function(t,e){var i=this,r=this._createMapTileLayer(t,e);return r.once("load",(function(){i._events.fire(ye.GEO_LOADED)})),r.addTo(this._map),r},Nc.prototype._onSettingsChanged=function(t,e){var i,r,n=t.wrapCoordinates!==e.wrapCoordinates,o=t.latitudePath!==e.latitudePath||t.longitudePath!==e.longitudePath;(n||o)&&this._updateNodesCoordinates(this._graph.getNodes("all")),this._enabled&&(r=e,(i=t).attribution===r.attribution&&i.tiles===r.tiles||!this._map||(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(e.tiles,e.attribution)),t.sizeRatio!==e.sizeRatio&&this._updateSizes(),t.maxZoomLevel!==e.maxZoomLevel&&this._settingsModule.update({minZoom:1,maxZoom:Math.pow(2,e.maxZoomLevel)}),t.disableNodeDragging!==e.disableNodeDragging&&this._setDragging(!e.disableNodeDragging),t.attributionOptions!==e.attributionOptions&&this._setAttributionOptions(e.attributionOptions,e.attribution))},Nc.prototype._setMapDragging=function(t){if(this._map){var e=t?"enable":"disable";this._map.dragging[e]()}},Nc.prototype._fromLatLngToPoint=function(t,e){return this._map.options.crs.latLngToPoint(this.L.latLng(t,e),1)},Nc.prototype._fromPointToLatLng=function(t,e){var i=this._map.options.crs.pointToLatLng(this.L.point({x:t,y:e}),1);return{latitude:i.lat,longitude:i.lng}},Nc.prototype._updateSizes=function(){this._enabled&&this._projection&&this._projection.updateAll()},Nc.prototype.enable=function(t){return this.setEnabled(!0,t)},Nc.prototype.getMap=function(){if(this._enabled)return this._map},Nc.prototype.getOptions=function(){return this._enabled?A(A({},this._settings),{tiles:A({},this._settings.tiles)}):A({},er)},Nc.prototype.setOptions=function(t){if(this._enabled){!function(t,e){void 0===t&&(t={});var i=t.tileUrlSubdomains,r=t.tileUrlTemplate,n=t.attribution,o=t.attributionOptions,a=t.latitudePath,s=t.longitudePath,u=t.sizeRatio,d=t.tiles;if(null!=r&&"string"!=typeof r)throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(null!=i&&"string"!=typeof i)throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(null!=d){if(!(et(d)||d instanceof e.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");var l=d;if(null!=l.url&&"string"!=typeof l.url)throw new TypeError("Geo mode: tiles.url must be a string");if(null!=l.subdomains&&"string"!=typeof l.subdomains)throw new TypeError("Geo mode: tiles.subdomains must be a string");if(l.tms&&"boolean"!=typeof l.tms)throw new TypeError("Geo mode: tiles.tms must be a boolean");if(l.wms&&"boolean"!=typeof l.wms)throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(null!=n&&"string"!=typeof n)throw new TypeError("Geo mode: Map attribution must be a string");if(null!=o&&!et(o))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(null!=a&&"string"!=typeof a&&!Array.isArray(a))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(null!=s&&"string"!=typeof s&&!Array.isArray(s))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(null!=u&&(!isFinite(u)||u<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}(t,this.L);var e=this._settings;this._settings=A(A(A({},er),t),{tiles:function(t,e){if(void 0===e&&(e={}),void 0===e.tiles||e.tileUrlTemplate||e.tileUrlSubdomains){var i=er.tiles;return A(A(A({},e.tiles||{}),er.tiles),{url:e.tileUrlTemplate||i.url,subdomains:e.tileUrlSubdomains||i.subdomains})}return et(e.tiles)?A(A({},t.tiles),e.tiles):e.tiles}(er,t)}),this._onSettingsChanged(e,this._settings)}},Nc.prototype.disable=function(t){return this.setEnabled(!1,t)},Nc.prototype.isEnabled=function(){return this._enabled},Nc.prototype.toggle=function(t){return void 0===t&&(t={}),this.setEnabled(!this._enabled,t)},Nc.prototype.getContainerCoords=function(t){var e=this;return t.getGeoCoordinates().map((function(t){var i=t.latitude,r=t.longitude;return e._map.latLngToContainerPoint([i,r])}))},Nc.prototype.setEnabled=function(t,e){var i=this;if(!rr())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||t===this._enabled)return Promise.resolve();this._enabled=t,this._transition=!0,this.setOptions(e);var r=this._settingsModule,n=this._settings;return t?(this._nodeDraggingSetting=r.get("interactions.drag.enabled"),this._setDragging(!n.disableNodeDragging),this._show().then((function(){return i._registerTextStyle(),i._setDragging(!n.disableNodeDragging),i._setMapDragging(n.disableNodeDragging),i._transition=!1,i._updating=!1,i._events.fire(ye.GEO_ENABLED),i._events.fire(ye.GEO_READY),i._adjustMinvisibleSizes()}))):this._hide().then((function(){return i._transition=!1,i._events.fire(ye.GEO_DISABLED),i._setDragging(i._nodeDraggingSetting,!0),i._restoreTextStyle()}))},Nc.prototype._registerTextStyle=function(){var t,e,i,r,n,o,a=this;this._edgesOriginalTextStyle=(e=(t=this._graph.getEdges()).getAttributes(["text.minVisibleSize","text.size","text.scale","minVisibleSize","width"]),i={},e.forEach((function(e,r){var n=e.text,o=e.minVisibleSize,a=e.width;i[t.get(r).getId()]={"text.minVisibleSize":n.minVisibleSize,"text.size":n.size,"text.scale":n.scale,minVisibleSize:o,size:Math.max(1,a)}})),i),this._nodesOriginalTextStyle=(n=(r=this._graph.getNodes()).getAttributes(["text.minVisibleSize","text.size","text.scale","radius"]),o={},n.forEach((function(t,e){var i=t.text,n=t.radius;o[r.get(e).getId()]={"text.minVisibleSize":i.minVisibleSize,"text.size":i.size,"text.scale":i.scale,minVisibleSize:i.minVisibleSize,size:Math.max(1,n)}})),o);var s=this._hover.getHoverClassDefinition(),u=s.nodeAttributes,d=s.edgeAttributes;this._hoverEdgesOriginalTextStyle=d||void 0,this._hoverNodesOriginalTextStyle=u||void 0,this._hover.updateEdgeAttributes({text:{size:function(t){return a._edgesOriginalTextStyle[t.getId()]["text.size"]}}}),this._hover.updateNodeAttributes({text:{size:function(t){return a._nodesOriginalTextStyle[t.getId()]["text.size"]}}})},Nc.prototype._restoreTextStyle=function(){return this._hoverEdgesOriginalTextStyle&&this._hover.updateEdgeAttributes(this._hoverEdgesOriginalTextStyle),Promise.all([(t=this._graph.getEdges(),e=this._edgesOriginalTextStyle,i=t.getId().map((function(t){return+(e[t]||{})["text.size"]})),t.setAttribute("text.size",i))]);var t,e,i},Nc.prototype._setDragging=function(t,e){void 0===e&&(e=!1),this._settingsModule.update({interactions:{drag:{enabled:t,applyResult:e}}})},Nc.prototype._setAttributionOptions=function(t,e){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),et(t)){this._attribution.setPrefix(""),t.position=t.position||"bottom-right";var i=t.position.replace("-","");this._attribution.setPosition(i);var r=this._attribution.getContainer();r&&(t.className&&this.L.DomUtil.addClass(r,t.className),Mc(r,t.position||"bottom-right",t.horizontalMargin,t.verticalMargin))}null!=e&&this._attribution.addAttribution(e)},Nc.prototype._nodeIsVisible=function(t){return e=t,i=this._settings,r=this._hasCustomProjection(),n=i.longitudePath,o=i.latitudePath,a=i.wrapCoordinates,s=e.getData(n),u=e.getData(o),null!=s&&null!=u&&(!(!a&&!r)||Math.abs(u)<=tr&&Math.abs(s)<=180);var e,i,r,n,o,a,s,u},Nc.prototype._updateSettingsForMap=function(){var t=this._graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);t[3]=0,this._prevSettings=this._settingsModule.update({backgroundColor:Tr(t),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})},Nc.prototype.getGraphPosition=function(t){var e,i=this.L.latLngBounds((e=[[1/0,1/0],[-1/0,-1/0]],t.getGeoCoordinates().reduce((function(t,e){var i=e.latitude,r=e.longitude,n=t[0],o=t[1];return n[0]=Math.min(n[0],i),n[1]=Math.min(n[1],r),o[0]=Math.max(o[0],i),o[1]=Math.max(o[1],r),t}),e)));return{center:0<t.size?i.getCenter():this.L.latLng([0,0]),zoom:this._clampZoom(this._map.getBoundsZoom(i))}},Nc.prototype._initMap=function(){this._updateSettingsForMap(),this._mapContainer=function(t){var e=Et().createElement("div");e.className="ogma-geo-container",e.style.width=e.style.height="100%";var i=t||dr;return i.insertBefore(e,i.firstChild),e}(this._dom.getContainer());var t=A(A({},ir),{minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel});this._hasCustomProjection()&&(t.crs=this._settings.crs,t.worldCopyJump=!1,t.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,t),this._hasCustomProjection()||this._map.setMaxBounds(this.L.latLngBounds([[tr,-180],[-tr,180]])),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()},Nc.prototype._clampZoom=function(t){var e=this._tileLayer.options.maxZoom;return void 0===e&&(e=1/0),Math.min(t,e)},Nc.prototype._show=function(){var t=this;return this._filter=this._filters.addNodeFilter((function(e){return t._nodeIsVisible(e)})),this._filter.whenApplied().then((function(){t._initMap();var e=t._graph.getNodes(),i=t._graph.getEdges(),r=t.getGraphPosition(e),n=r.center,o=r.zoom;t._zoom=o;var a=t._transformToGeo(),s=a.offset,u=a.newCameraView;return t._camera.setView(u,{ignoreZoomLimits:!0}).then((function(){return t._updatePrevNodesCoordinates(e),t._map.setView(n,o),t._zoom=o,t._graphics.animate({nodes:e,edges:i},(function(){t._projection=t._createFinalPositionLayer()}),t._settings.duration)})).then((function(){return s.destroy()}))}))},Nc.prototype._hasCustomProjection=function(){return null!=this._settings.crs},Nc.prototype._setupLayers=function(){var t=this;this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution)),this._layer=new this.L.OgmaOverlay({container:this._graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:function(){return t._onMapUpdate()}}),this._layer.addTo(this._map)},Nc.prototype._onMapUpdate=function(){var t=this,e=this._map.getCenter(),i=e.lat,r=e.lng,n=this._fromLatLngToPoint(i,r);this._x=n.x,this._y=n.y;var o,a=(o=this._map.getZoom(),Math.pow(2,o-1));return this._camera.setView({zoom:a,x:n.x,y:n.y},{ignoreZoomLimits:!0}).then((function(){return t._adjustMinvisibleSizes()}))},Nc.prototype._adjustMinvisibleSizes=function(){return Promise.all([function(t,e,i){if(!e)return Promise.resolve();var r=t.getId().map((function(t){var r=+e[t]["text.minVisibleSize"],n=+e[t].minVisibleSize,o=+e[t]["text.size"],a=+e[t]["text.scale"],s=e[t].size*a*i;return s<=n||s<=r?0:o}));return t.setAttribute("text.size",r)}(this._graph.getEdges(),this._edgesOriginalTextStyle,this._map.getZoom())])},Nc.prototype._hide=function(){var t=this;if(!this._map)return Promise.resolve();this._settingsModule.update(this._prevSettings),this._map.removeLayer(this._layer);var e=this._dom.getContainer(),i=this._graphics.getDomElement();e&&e.appendChild(i),this._map.getContainer().style.zIndex=0;var r=this._graph.getNodes("all"),n=this._graph.getEdges("all"),o=this._transformToGraph(),a=o.offset,s=o.newCameraView;return this._camera.setView(s||{}).then((function(){return Promise.all([Zt(t._map.getContainer(),1,0,t._settings.duration/2).then((function(){t._map.remove();var e=t._mapContainer.parentNode;e&&e.removeChild(t._mapContainer)})),t._graphics.animate({nodes:r,edges:n},(function(){return a&&a.destroy()}),t._settings.duration)])})).then((function(){return t._map=null,t._filter.delete()}))},Nc.prototype._transformToGeo=function(){var t=this,e=function(t,e,i,r){var n=t.filter((function(t){return t.isVisible()})),o=0===n.size,a=n.reduce((function(t,e){var i=e.getGeoCoordinates(),n=i.latitude,o=i.longitude,a=r(n,o),s=a.x,u=a.y;return t.mapX.push(s),t.mapY.push(u),t}),{mapX:[],mapY:[]}),s=a.mapX,u=a.mapY,d=n.getAttribute("x"),l=n.getAttribute("y"),h=n.getAttribute("radius"),c=new ko({xValues:d,yValues:l,scaledSizeValues:h}),f=new ko({xValues:s,yValues:u});o&&(c.cx=c.cy=0,c.width=c.height=0),isFinite(f.width)&&isFinite(f.height)||(f.cx=f.cy=0,f.width=f.height=0);var g=f.cx-c.cx,p=f.cy-c.cy,_=o?1:Math.max(f.width,f.height)/Math.max(c.width,c.height),v=h.reduce((function(t,e){return t[0]=Math.min(t[0],e*_),t[1]=Math.max(t[1],e*_),t}),[1/0,0]),m=v[0],y=v[1];f.pad(y),f.minScaledSize=m,f.maxScaledSize=y;var b,x=i.computeConfigForBounds(f),E=e.zoom/(b=x.zoom,Math.pow(2,Math.ceil(Math.log2(b))));g+=(c.cx-e.x)*E,p+=(c.cy-e.y)*E;var S=c.cx+g,w=c.cy+p;return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:function(t){return t.getAttribute("radius")*E},x:function(t){return(t.getAttribute("x")+g-S)*E+S},y:function(t){return(t.getAttribute("y")+p-w)*E+w}},edgeAttributes:{width:function(t){return t.getAttribute("width")*E}}},camera:A({zoom:e.zoom/E,x:(e.x+g-S)*E+S,y:(e.y+p-w)*E+w,angle:0},e.getSize())}}(this._graph.getNodes(),this._camera,this._locate,(function(e,i){return t._fromLatLngToPoint(e,i)})),i=e.offsetChanges,r=e.camera;return{offset:this._addGraphAttributesLayer(i),newCameraView:r}},Nc.prototype._addGraphAttributesLayer=function(t){return this._graphics.addAttributeLayer(A({priority:6,nodeSelector:function(t){return t.isVisible()},edgeSelector:function(t){return t.isVisible()}},t))},Nc.prototype._transformToGraph=function(){var t=this,e=function(t,e,i,r){var n=t.getAttributes(["x","y","radius"]),o=t.getBoundingBox(),a=0===t.size,s=t.reduce((function(t,e,i){return t[e._index]=i,t}),{});r();var u=t.getAttribute("x"),d=t.getAttribute("y"),l=t.getAttribute("radius"),h=new ko({xValues:u,yValues:d,scaledSizeValues:l.map((function(t){return 2*t}))});a&&(o.reset(),h.reset());var c,f,g=h.cx-o.cx,p=h.cy-o.cy,_=0,v=0,m=i.computeConfigForBounds(h),y=e.zoom/m.zoom;return f=isNaN(o.cx)||isNaN(o.cy)?(o.cx=e.x,o.cy=e.y,c=m.x,m.y):(g+=(o.cx-e.x)*y,p+=(o.cy-e.y)*y,_=o.cx+g,v=o.cy+p,c=(e.x+g-_)*y+_,(e.y+p-v)*y+v),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:function(t){return(n[s[t._index]].x+g-_)*y+_},y:function(t){return(n[s[t._index]].y+p-v)*y+v}}},camera:A({zoom:m.zoom,x:c,y:f,angle:0},e.getSize())}}(this._graph.getNodes("all"),this._camera,this._locate,(function(){t._projection&&(t._projection.destroy(),t._projection=null)})),i=e.offsetChanges,r=e.camera;return{offset:this._addGraphAttributesLayer(i),newCameraView:r}},Nc.prototype.getPointFromLatLng=function(t){var e=t.getGeoCoordinates(),i=e.latitude,r=e.longitude;return null==i?t.getAttributes(["x","y"]):this._fromLatLngToPoint(i,r)},Nc.prototype._createFinalPositionLayer=function(){var t=this;return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:function(e){return e.getAttribute("radius")*t._settings.sizeRatio},x:function(e){return t.getPointFromLatLng(e).x},y:function(e){return t.getPointFromLatLng(e).y}},edgeAttributes:{scalingMethod:"fixed",width:function(e){return e.getAttribute("width")*t._settings.sizeRatio}}})},Nc.prototype.destroy=function(){return Promise.resolve()},Nc.prototype.setCenter=function(t,e){return this._enabled?this.setView(t,e,nr(this._camera.getZoom())):Promise.resolve()},Nc.prototype.setZoom=function(t){return this._enabled?(t=this._clampZoom(t),this._zoom=t,this._map.setZoom(t),this._onMapUpdate()):Promise.resolve()},Nc.prototype.setView=function(t,e,i){return this._enabled?(i=this._clampZoom(i),this._map.setView(this.L.latLng([t,e]),i,{animate:!1}),this._zoom=i,this._onMapUpdate()):Promise.resolve()},Nc.prototype.getView=function(){if(this._enabled){var t=this._map.getCenter();return{zoom:this._zoom,latitude:t.lat,longitude:t.lng}}},Nc.prototype.getCenter=function(){if(this._enabled){var t=this._map.getCenter();return{latitude:t.lat,longitude:t.lng}}},Nc.prototype.getZoom=function(){if(this._enabled)return this._zoom},Nc.prototype.resetCoordinates=function(){if(this._enabled&&this._projection){var t=this._graph.getNodes();this._restorePrevNodesCoordinates(this._graph.getNodes());var e=this._graph.getNodeAttribute(Ji).getMultiple(t._indexes),i=this._graph.getNodeAttribute($i).getMultiple(t._indexes);t.setData(this._settings.latitudePath,e),t.setData(this._settings.longitudePath,i),this._projection.update()}},Nc.prototype.updateCoordinates=function(){Si("The ogma.geo.updateCoordinates() API has been deprecated. The coordinates are updated by default now.")},Nc.prototype.getUnprojectedCoordinates=function(t){Si("The ogma.geo.getUnprojectedCoordinates() API has been deprecated. Original graph coordinates are only available when in graph mode."),this._projection&&this._projection.destroy();var e=t.getPosition();return this._projection=this._createFinalPositionLayer(),e},Object.defineProperty(Nc.prototype,"latitudePath",{get:function(){return this._settings.latitudePath},enumerable:!0,configurable:!0}),Object.defineProperty(Nc.prototype,"longitudePath",{get:function(){return this._settings.longitudePath},enumerable:!0,configurable:!0}),Nc.prototype.exportBackground=function(t){var e=this,i=$r();i.width=t.width,i.height=t.height;var r=i.getContext("2d");if(!r)throw new Error("Unable to get 2d context from  "+i);var n=this._map.getSize(),o=this.getView(),a=A({zoom:nr(t.zoom)},this._fromPointToLatLng(t.x,t.y)),s={x:(n.x-t.width)/2,y:(n.y-t.height)/2},u=new this.L.Canvas;this._map.addLayer(u);var d=function(t,e,i,r,n,o){var a={vectorMap:[],tileLayers:[],vectorLayers:[],imageOverlays:[],markers:[]};return e.eachLayer((function(s){if(s!==t){var u=(l=s)instanceof(h=r).TileLayer?"tileLayers":l instanceof h.ImageOverlay?"imageOverlays":l instanceof h.Path?"vectorLayers":l instanceof h.Marker?"markers":"MapboxGL"in h&&l instanceof h.MapboxGL?"vectorMap":void 0;if(u&&u in a){var d=Ec[u];a[u].push((function(){return d(s,i,e,r,n,o)}))}}var l,h})),a}(this._layer,this._map,r,this.L,s,u),l=d.vectorMap,h=d.tileLayers,c=d.vectorLayers,f=d.imageOverlays,g=d.markers,p=this._map.options.zoomSnap;return this.setView(a.latitude,a.longitude,a.zoom).then((function(){return e._map._onResize()})).then((function(){return V(w(l,h,f,c,g))})).then((function(){e._map._onResize(),e.setView(o.latitude,o.longitude,o.zoom),e._map.options.zoomSnap=p})).then((function(){return new Promise((function(t){return e.L.Util.requestAnimFrame(t)}))})).then((function(){return e._map.removeLayer(u)})).then((function(){return i}))},Nc);function Nc(t){var e,i=t.camera,r=t.graph,n=t.settings,o=t.filters,a=t.events,s=t.hover,u=t.dom,d=t.graphics,l=t.locate,h=Ic.call(this)||this;return h._enabled=!1,h._settings=A({},er),h._zoom=0,h._nodeDraggingSetting=!1,h._transition=!1,h._attribution=null,h._updating=!1,h._updateRate=50,h._x=0,h._y=0,h._onCameraUpdate=function(){if(h.L&&h._enabled&&h._map&&h._map._loaded){var t=h._x-h._camera.x,e=h._y-h._camera.y;if(t||e){h._updating||(h._updating=!0,h._layer.setLocked(!0),h._map._moveStart(!0,!1));var i=h._fromPointToLatLng(h._camera.x,h._camera.y),r=nr(h._camera.zoom),n=h.L.latLng(i.latitude,i.longitude);h._map._move(n,r,{pinch:!0,round:!1}),clearTimeout(h._updateRequest),h._updateRequest=h._dom.setTimeout((function(){h._updating=!1,h._layer.setLocked(!1),h._map&&h._map._move(n,r,{pinch:!0})._moveEnd(!0)}),h._updateRate)}}},h._onNodesDragStart=function(){h._enabled&&(h._setMapDragging(!1),h._nodeDragOffsetX=h._nodeDragOffsetY=0)},h._onNodesDragged=function(t){var e=t.nodes,i=t.dx,r=t.dy;if(h._enabled){var n=e.map((function(t){var e=t.getAttributes(["x","y"]),n=e.x,o=e.y;return h._fromPointToLatLng(n+i-h._nodeDragOffsetX,o+r-h._nodeDragOffsetY)}));return h._nodeDragOffsetX=i,h._nodeDragOffsetY=r,e.setGeoCoordinates(n)}return Promise.resolve(h._graph.nodeList())},h._graph=r,h._camera=i,h._settingsModule=n,h._filters=o,h._events=a,h._dom=u,h._graphics=d,h._locate=l,h._hover=s,h._events.register(["geoEnabled","geoDisabled","geoLoaded","geoReady"]),rr()&&(h.L=N("L")||N("leaflet"),h.L&&function(t){t.TileLayer.prototype.getUrl=function(){return this._url},t.ImageOverlay.prototype.getUrl=function(){return this._url};var e="leaflet-zoom-animated";t.OgmaOverlay||(t.OgmaOverlay=t.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:function(){}},initialize:function(e){var i=e.container;t.Util.setOptions(this,e),this._container=i},setLocked:function(t){return this._locked=t,this},onAdd:function(i){this._map=i,this.getPane().appendChild(this._container),this._wgsOrigin=t.latLng([0,0]),this._wgsInitialShift=i.project(this._wgsOrigin,this._initialZoom),t.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(t.DomUtil.addClass(this._container,e),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds:function(){var e=this.options.padding,i=this._map.getSize(),r=this._map.containerPointToLayerPoint(i.multiplyBy(-e));this._bounds=new t.Bounds(r,r.add(i.multiplyBy(1+2*e))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update:function(e){var i=this;this._updateBounds(),this._redraw(this._bounds.min,e),this._positionTimer=t.Util.requestAnimFrame((function(){return t.DomUtil.setPosition(i._container,i._bounds.min)}))},_redraw:function(t,e){this.options.onUpdate()},_updateTransform:function(e,i){if(!this._locked){var r=this._map.getZoomScale(i,this._zoom),n=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,i),a=n.multiplyBy(-r).add(o).subtract(this._map._getNewPixelOrigin(e,i));t.Browser.any3d?t.DomUtil.setTransform(this._container,a,r):t.DomUtil.setPosition(this._container,a)}},_onZoom:function(t){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd:function(t){this._update(t)},_onAnimZoom:function(t){var e=t.center,i=t.zoom;this._updateTransform(e,i)},bringToFront:function(){t.DomUtil.toFront(this._container)},getEvents:function(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){t.DomUtil.removeClass(this._container,e);var i=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach((function(t){return i.style[t]=null})),t.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}(h.L)),h._graph.createNodeAttribute({name:"geo.prevLat",storage:"float"}),h._graph.createNodeAttribute({name:"geo.prevLng",storage:"float"}),h._graph.createNodeAttribute({name:Ji,storage:"float"}),h._graph.createNodeAttribute({name:$i,storage:"float"}),h._events.on(((e={})[ye.ADD_NODES]=function(t){return h._refreshOrAddNodes(t.nodes)},e[ye.UPDATE_NODE_DATA]=function(t){h._enabled&&h._onDataChange(t.changes)},e[ye.NODES_DRAG_PROGRESS]=h._onNodesDragged,e[ye.NODES_DRAG_START]=h._onNodesDragStart,e[ye.NODES_DRAG_END]=function(){return h._setMapDragging(!0)},e[ye.CAMERA_MOVE]=h._onCameraUpdate,e[ye.VIEW_CHANGED]=h._onCameraUpdate,e)),h}function kc(t,e,i,r,n,o){for(var a=0,s=0;s<r;s++)for(var u=0;u<r;u++){var d=o[s],l=o[u];if(d!==l){var h=t[d][l]*n,c=1/(h*h);if(c){var f=e[d]-e[l],g=i[d]-i[l];a+=c*Math.pow(h-Math.sqrt(f*f+g*g),2)}}}return a}function Oc(t,e,i,r,n,o,a){var s=0;if(-1===n)return 0;for(var u=0;u<r;u++)for(var d=0;d<r;d++){var l=a[u],h=a[d];if(l!==h&&(l===n||h===n)){var c=t[l][h]*o,f=1/(c*c);if(f){var g=e[l]-e[h],p=i[l]-i[h];s+=f*Math.pow(c-Math.sqrt(g*g+p*p),2)}}}return s}function Fc(t,e,i,r,n,o,a,s){a=a||0;for(var u=0,d=0,l=0;l<r;l++)for(var h=0;h<r;h++){var c=s[l],f=s[h];if(c!==f){var g=t[c][f]*o,p=1/(g*g);if(p){var _=e[c]-e[f],v=i[c]-i[f],m=p*Math.pow(g-Math.sqrt(_*_+v*v),2);u+=m,c!==n&&f!==n||(d+=m)}}}return(1-a)*u+a*d}function Rc(t,e,i,r,n,o,a,s,u){a=a||0;var d=e,l=i;-1===(n=void 0===n?-1:n)&&(a=0);for(var h=e[n],c=i[n],f=0;f<r;f++){var g=s[f],p=u(t[n][f]),_=a/(p*p);if(0!==p){for(var v=0,m=0,y=0,b=e[g],x=i[g],E=0;E<r;E++){var A=s[E];if(A!==g){var S=t[g][A]*o,w=1/(S*S),T=e[A],C=i[A];if(0!=w){var M=(k=(L=b-T)*L+(N=x-C)*N)<1e-6?0:1/Math.sqrt(k);m+=(1-a)*w*(T+S*(b-T)*M),y+=(1-a)*w*(C+S*(x-C)*M)}v+=w}}var I=(1-a)*v+_;if(0!=I){var L,N,k;k=(k=(L=b-h)*L+(N=x-c)*N)<1e-6?0:1/Math.sqrt(k);var O=0===p?0:p*k*_;d[g]=(m+O*e[g])/I,l[g]=(y+O*i[g])/I}}}return{x:d,y:l}}function Pc(t,e,i,r){void 0===t&&(t=function(t,e){return t-e}),void 0===e&&(e=[]),void 0===i&&(i={}),void 0===r&&(r=function(t){return t});var n=e.length;function o(o){for(;;){var a=2*o+1,s=1+a,u=o;if(a<n&&t(e[a],e[u])<0&&(u=a),s<n&&t(e[s],e[u])<0&&(u=s),u===o)return o;var d=e[u];e[u]=e[o],e[o]=d,i[r(e[u])]=u,i[r(d)]=o,o=u}}return{get keys(){return i},get size(){return n},heapify:o,pop:function(){if(!(n<=0)){if(1===n)return n--,e[0];var t=e[0];return e[0]=e[n-1],n--,o(0),t}},decreaseKey:function(n,o){for(void 0!==o&&(e[n]=o,i[r(o)]=n);0<n;){var a=n-1>>1;if(!(0<t(e[a],e[n])))break;var s=e[n];e[n]=e[a],e[a]=s,i[r(e[n])]=n,n=i[r(s)]=a}return n},min:function(){return e[0]},remove:function(t){return this.decreaseKey(t,Number.NEGATIVE_INFINITY),this.pop()},push:function(o){var a=++n-1;for(e[a]=o;0<a;){var s=a-1>>1;if(!(0<t(e[s],e[a])))break;var u=e[a];e[a]=e[s],e[s]=u,i[r(e[a])]=a,a=i[r(u)]=s}return a},empty:function(){return n<=0},toArray:function(){return e.slice(0,n)}}}function Dc(t){var e=t.sources,i=t.targets,r=t.weights,n=t.source,o=t.target,a=t.undirected,s=void 0!==a&&a,u=t.indexes,d=t.N;if(!(d=u?u.length:d)||!isFinite(d)||0===d)throw new Error("Invalid number of nodes "+d);var l=new Float32Array(d),h=new Int32Array(d),c={},f=Number.POSITIVE_INFINITY;if(!r){r=[];for(var g=0;g<d;g++)r[g]=1}if(!u)for(u=new Uint32Array(d),g=0;g<d;g++)u[g]=g+1;for(g=0;g<d;g++)l[g]=f,h[g]=-1,c[u[g]]=g;l[c[n]]=0;var p=!1;for(g=1;g<=d;g++){for(var _=0;_<r.length;_++){var v=e[_],m=i[_],y=c[v],b=c[m];if(void 0!==y&&void 0!==b){var x=r[_],E=l[y]+x;l[y]!==f&&E<l[b]&&(l[b]=E,h[b]=v,p=!0),s&&(E=l[b]+x,l[b]!==f&&E<l[y]&&(l[y]=E,h[y]=m,p=!0))}}if(!p)break}if(p)for(g=0;g<r.length;g++)if(v=e[g],m=i[g],y=c[v],b=c[m],void 0!==y&&void 0!==b&&(x=r[g],l[y]+x<l[b]))return null;var A=null,S=null;if(void 0!==o){var w=c[o];if(void 0!==w&&l[w]!==f){for(A=[],g=o;-1!==g;g=h[c[g]])A.push(g);A=A.reverse(),S=l[w]}}return{distances:l,path:A,pathLength:S}}function zc(t,e,i,r,n,o,a){var s=(r=r||t.map((function(t,e){return e+1}))).length,u=new Float32Array(s),d=new Int32Array(s),l=new Uint32Array(s),h=Number.POSITIVE_INFINITY,c={};if(0===s)return{distances:u,path:null,pathLength:null};if(!n){n={};for(var f=0;f<s;f++)n[r[f]]=f}for(f=0;f<s;f++)u[f]=h,d[f]=-1,l[f]=c[f]=f;var g=Pc((function(t,e){return u[t]-u[e]}),l,c);for(u[n[e]]=0,g.decreaseKey(c[n[e]]);0!==g.size;){var p=g.pop(),_=u[p],v=t[p];if(_===h)break;f=0;for(var m=v.nodes.length;f<m;f++){var y=v.nodes[f],b=o?1:a?a(r[p],y):v.weights?v.weights[f]:1,x=n[y];if(void 0!==x){var E=_+b;E<u[x]&&(u[x]=E,d[x]=p,g.decreaseKey(c[x]))}}}var A=null,S=null;if(void 0!==i){var w=n[i];if(u[w]!==h){for(A=[],f=w;-1!==f;f=d[f])A.push(r[f]);A.reverse(),S=u[i]}}return{distances:u,path:A,pathLength:S}}function Bc(t){var e=t.sources,i=t.targets,r=t.weights,n=t.indexes,o=t.adjacency,a=t.undirected,s=t.ignoreWeights,u=Number.POSITIVE_INFINITY,d=n?n.length:o.length;if(!n){n=new Uint32Array(d);for(var l=0;l<d;l++)n[l]=l+1}var h=new Array(d),c={};for(l=0;l<d;l++){h[l]=new Float32Array(d);for(var f=0;f<d;f++)h[l][f]=l===f?0:u;c[n[l]]=l}var g=d,p=r.length;for(e=e.slice(),i=i.slice(),r=r.slice(),l=0;l<d;l++)e[p+l]=g,i[p+l]=n[l],r[p+l]=0,s&&(r[l]=1);var _=Dc({sources:e,targets:i,weights:r,undirected:a,N:d+1,source:g});if(null===_)throw new Error("Graph has negative weight loops");var v=_.distances;for(l=0;l<r.length;l++){var m=c[e[l]],y=c[i[l]];void 0!==m&&void 0!==y&&(r[l]=r[l]+v[m]-v[y])}for(e=e.slice(0,p),i=i.slice(0,p),r=r.slice(0,p),l=0;l<d;l++){var b=zc(o,n[l],void 0,n,c,!!s).distances;for(f=0;f<d;f++)h[l][f]=l===f?0:b[f]}return h}var Uc,Vc=(function(t){function e(t){if(!(this instanceof e))return new e(t);this.points=t||[]}function i(t,e,i){return 0<(e[0]-t[0])*(i[1]-t[1])-(e[1]-t[1])*(i[0]-t[0])}function r(t,e){return i(t,e.dest,e.orig)}function n(t,e){return i(t,e.orig,e.dest)}function o(t,e){return r(t.dest,e)}function a(t,e,i,r){if(t[0]===r[0]&&t[1]===r[1]||e[0]===r[0]&&e[1]===r[1]||i[0]===r[0]&&i[1]===r[1])return!1;var n=t[0]*t[0]+t[1]*t[1],o=e[0]*e[0]+e[1]*e[1],a=i[0]*i[0]+i[1]*i[1],s=r[0]*r[0]+r[1]*r[1],u=a-s,d=i[1]-r[1],l=i[1]*s-a*r[1],h=i[0]-r[0],c=i[0]*s-a*r[0],f=i[0]*r[1]-i[1]*r[0];return 1<t[0]*(e[1]*u-o*d+l)-t[1]*(e[0]*u-o*h+c)+n*(e[0]*d-e[1]*h+f)-e[0]*l+e[1]*c-o*f}function s(t,e,i){this.onext=t,this.rot=e,this.orig=i,this.mark=!1}function u(t,e){var i=new s(null,null,t),r=new s(null,null,null),n=new s(null,null,e),o=new s(null,null,null);return i.onext=i,n.onext=n,(r.onext=o).onext=r,(((i.rot=r).rot=n).rot=o).rot=i}function d(t,e){var i=t.onext.rot,r=e.onext.rot,n=t.onext,o=r.onext,a=i.onext;t.onext=e.onext,e.onext=n,i.onext=o,r.onext=a}function l(t,e){var i=u(t.dest,e.orig);return d(i,t.lnext),d(i.sym,e),i}function h(t){d(t,t.oprev),d(t.sym,t.sym.oprev)}e.prototype={triangulate:function(){var t=this.points;t.sort((function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}));for(var e=t.length-1;1<=e;e--)t[e][0]===t[e-1][0]&&t[e][1]===t[e-1][1]&&t.splice(e,1);if(t.length<2)return{};for(var s=function t(e){var s,c,f,g;if(2===e.length)return{le:s=u(e[0],e[1]),re:s.sym};if(3===e.length)return s=u(e[0],e[1]),c=u(e[1],e[2]),d(s.sym,c),i(e[0],e[1],e[2])?(f=l(c,s),{le:s,re:c.sym}):i(e[0],e[2],e[1])?{le:(f=l(c,s)).sym,re:f}:{le:s,re:c.sym};for(var p=Math.ceil(e.length/2),_=t(e.slice(0,p)),v=t(e.slice(p)),m=_.le,y=_.re,b=v.le,x=v.re;;)if(n(b.orig,y))y=y.lnext;else{if(!r(y.orig,b))break;b=b.rprev}var E=l(b.sym,y);for(y.orig===m.orig&&(m=E.sym),b.orig===x.orig&&(x=E);;){var A=E.sym.onext;if(o(A,E))for(;a(E.dest,E.orig,A.dest,A.onext.dest);)g=A.onext,h(A),A=g;var S=E.oprev;if(o(S,E))for(;a(E.dest,E.orig,S.dest,S.oprev.dest);)g=S.oprev,h(S),S=g;if(!o(A,E)&&!o(S,E))break;E=!o(A,E)||o(S,E)&&a(A.dest,A.orig,S.orig,S.dest)?l(S,E.sym):l(E.sym,A.sym)}return{le:m,re:x}}(t).le,c=[],f=0,g=[s];n(s.onext.dest,s);)s=s.onext;for(var p=s;g.push(p.sym),p.mark=!0,(p=p.lnext)!==s;);do{var _=g[f++];if(!_.mark)for(p=_;c.push(p.orig),p.sym.mark||g.push(p.sym),p.mark=!0,(p=p.lnext)!=_;);}while(f<g.length);return c}},s.prototype={get sym(){return this.rot.rot},get dest(){return this.sym.orig},get rotSym(){return this.rot.sym},get oprev(){return this.rot.onext.rot},get dprev(){return this.rotSym.onext.rotSym},get lnext(){return this.rotSym.onext.rot},get lprev(){return this.onext.sym},get rprev(){return this.sym.onext}},e.prototype.ccw=i,e.prototype.rightOf=r,e.prototype.leftOf=n,e.prototype.inCircle=a,t.exports=e}(Uc={exports:{}}),Uc.exports);function jc(t){for(var e,i,r,n=t.length,o=[0,1],a=2,s=2;s<n;s++){for(;1<a&&(e=t[o[a-2]],i=t[o[a-1]],r=t[s],(i[0]-e[0])*(r[1]-e[1])-(i[1]-e[1])*(r[0]-e[0])<=0);)--a;o[a++]=s}return o.slice(0,a)}function Gc(t){var e=t.length;if(e<3)return null;for(var i=new Array(e),r=new Array(e),n=0;n<e;n++)i[n]=[+t[n][0],+t[n][1],n];for(i.sort((function(t,e){return t[0]-e[0]||t[1]-e[1]})),n=0;n<e;n++)r[n]=[i[n][0],-i[n][1]];var o=jc(i),a=jc(r),s=a[a.length-1],u=o[o.length-1],d=a[0]===o[0],l=s===u?1:0,h=[];for(n=o.length-1;0<=n;--n)h.push(t[i[o[n]][2]]);for(n=+d;n<a.length-l;n++)h.push(t[i[a[n]][2]]);return h}function Hc(t,e,i,r,n){if(void 0===e&&(e=1),void 0===i&&(i=0),!r||!n){var o=t.map((function(t){return[t.x,t.y]}));r=new Vc(o.slice()).triangulate(),n=Gc(o)}if(!n)return[];for(var a,s,u,d,l,h,c=i*i,f=[],g={},p=0;p<r.length;p+=3)Wc(n,qc(r[p],r[p+1],r[p+2]))&&c<(u=(s=qc(a=r[p],r[p+1],r[p+2]))[0],d=s[1],y=(l=u-a[0])*l+(h=d-a[1])*h)&&(f.push(p),g[p]=y);if(0===f.length)return[];f.sort((function(t,e){return g[t]-g[e]}));var _=f[0],v=g[_],m=[];for(p=0;p<f.length;p++){var y,b=f[p];v<(y=g[b])&&c<y&&(_=b,v=y,m.push(_),m.length>e&&m.shift())}return m.map((function(t){return function(t,e,i){for(var r=arguments,n=qc(t,e,i),o=0,a=0;a<3;a++){var s=r[a],u=s[0]-n[0],d=s[1]-n[1],l=Math.sqrt(u*u+d*d);o<l&&(o=l)}return[n[0],n[1],o]}(r[t],r[t+1],r[t+2])}))}function Wc(t,e){for(var i=t.length,r=t[i-1],n=e[0],o=e[1],a=r[0],s=r[1],u=!1,d=0;d<i;d++){var l=t[d],h=l[0],c=l[1];o<c!=o<s&&n<(a-h)*(o-c)/(s-c)+h&&(u=!u),a=h,s=c}return u}function qc(t,e,i){var r=[(t[0]+e[0])/2,(t[1]+e[1])/2],n=[(e[0]+i[0])/2,(e[1]+i[1])/2],o=-1/((e[1]-t[1])/(e[0]-t[0])),a=-1/((i[1]-e[1])/(i[0]-e[0])),s=r[1]-o*r[0],u=(s-(n[1]-a*n[0]))/(a-o);return[u,o*u+s]}function Xc(t){var e=t.X,i=t.Y,r=t.sizes,n=t.indexes,o=t.R,a=t.center,s=t.gap,u=void 0===s?0:s,d=t.epsilon,l=void 0===d?.001:d,h=t.maxLoops,c=void 0===h?5:h,f=t.inPlace,g=void 0===f||f,p=n.length,_=a[0],v=a[1],m=p;g||(e=e.slice(),i=i.slice());for(var y=vd,b=md,x=n.slice().sort((function(t,r){return b(e[t],i[t],e[r],i[r],_,v)})),E=x[p-1],A=e[E],S=i[E],w=!1,T=0;T<m-1;T++){var C=T%p,M=(T+1)%p;-1===T&&(C=p-1,M=0),C=x[C],M=x[M];var I=e[C],L=i[C],N=e[M],k=i[M],O=r[C]+r[M]+u,F=b(I,L,N,k,_,v);if(-1===F&&w&&(F=1),!(o<O)){if(1===F||O-Pa(I,L,N,k)>l){var R=y(_,v,o,I,L,O);if(R){var P=R[0];w=_<N&&P[0]<_,N=e[M]=P[0],k=i[M]=P[1]}}else w=!1;if(T%p==p-2){var D=x[p-1],z=x[0];if(i[D]>v&&i[z]>v&&e[D]-r[D]<e[z]+r[D]){var B=0;for(m=Math.min(p*c,m+p);i[x[D]]>v&&i[x[0]]>v&&e[x[D]]<e[x[0]]&&++B<p;)(X=x.pop())&&x.unshift(X)}}}}var U=A-_,V=S-v,j=e[E]-_,G=i[E]-v,H=U==j?0:Math.abs(Math.acos((U*j+V*G)/(Math.sqrt(U*U+V*V)*Math.sqrt(j*j+G*G))));if(0!==H){var W=Math.sin(-H),q=Math.cos(-H),X=void 0;for(T=0;T<p;T++){X=x[T],B=e[X]-_;var Y=i[X]-v;e[X]=B*q-Y*W+_,i[X]=B*W+Y*q+v}}return{X:e,Y:i}}function Yc(t,e,i,r,n,o){var a=Object.create(null),s=i[t],u=s,d=0,l=s;for(var h in e){for(var c=e[h],f=0,g=0,p=0,_=c.length;p<_;p++){var v=i[c[p]];g=Math.max(g,v),f+=2*v+r}var m=f/(2*Math.PI)+g,y=g+u,b=o?d+Math.max(o,y):d*n;d=Math.max(d,m,l,b),a[h]=d,u=g}return a[0]=0,a[Number.POSITIVE_INFINITY]=d,a}function Zc(t){return--t*t*t+1}function Kc(t,e,i){var r=t-i[0],n=e-i[1];return r*r+n*n}function Qc(t,e,i,r,n,o,a,s){void 0===n&&(n=0),void 0===o&&(o=Math.sin(n)),void 0===a&&(a=Math.cos(n)),void 0===s&&(s=[0,0,0,0]);var u,d,l,h,c,f,g,p,_=i/2,v=r/2,m=t+_,y=e+v;return 0===n?(s[0]=t,s[1]=e,s[2]=t+i,s[3]=e+r):(c=g=u=m+(l=-_)*a-(h=-v)*o,f=p=d=y+l*o+h*a,(u=m+(l=-_)*a-(h=v)*o)<c?c=u:g<u&&(g=u),(d=y+l*o+h*a)<f?f=d:p<d&&(p=d),(u=m+(l=_)*a-(h=v)*o)<c?c=u:g<u&&(g=u),(d=y+l*o+h*a)<f?f=d:p<d&&(p=d),(u=m+(l=_)*a-(h=-v)*o)<c?c=u:g<u&&(g=u),(d=y+l*o+h*a)<f?f=d:p<d&&(p=d),s[0]=c,s[1]=f,s[2]=g,s[3]=p),s}function Jc(t,e,i,r,n){void 0===n&&(n=0);var o=i/2,a=r/2,s=t+o,u=e+a;if(0===n)return[{x:t,y:e},{x:t+i,y:e},{x:t+i,y:e+r},{x:t,y:e+r}];var d,l,h=Math.sin(n),c=Math.cos(n);return[{x:s+(d=-o)*c-(l=-a)*h,y:u+d*h+l*c},{x:s+(d=-o)*c-(l=a)*h,y:u+d*h+l*c},{x:s+(d=o)*c-(l=a)*h,y:u+d*h+l*c},{x:s+(d=o)*c-(l=-a)*h,y:u+d*h+l*c}]}function $c(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=Fa.slice());var n=i*Math.sin(e),o=i*Math.cos(e);return r[0]=t[0]+n,r[1]=t[1]+o,r[2]=t[2]+n,r[3]=t[3]+o,r}function tf(t,e,i,r,n,o,a,s){return n<t&&t<a&&o<e&&e<s||n<i&&i<a&&o<r&&r<s}function ef(t,e,i,r,n,o,a,s){return o<=r&&e<=s&&n<=i&&t<=a}function rf(t,e,i,r,n,o){return{minX:t,minY:e,maxX:i,maxY:r,leaf:!0,level:o,parent:n,objects:[],final:!1,children:[]}}function nf(t){return[t.minX,t.minY,t.maxX,t.maxY]}function of(t,e,i,r,n,o,a,s){var u=(t+i)/2,d=(e+r)/2;return n<=u&&u<=a&&o<=d&&d<=s}function af(t,e,i,r,n,o,a,s){var u=(o+s)/2,d=(e+r)/2;return(t+i)/2<=(n+a)/2?d<=u?0:1:d<=u?3:2}function sf(t){return t}var uf=(Object.defineProperty(df.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(df.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),df.prototype.clear=function(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this},df.prototype.insert=function(t,e,i){if(void 0===i&&(i=this._root),e=e||this._getBBox(t),!this._objects[t]){if(this._objects[t]=!0,this._size++,!this._root){var r=Math.max(Math.abs(e[2]-e[0]),Math.abs(e[3]-e[1]));return this._root=rf(e[0],e[1],e[0]+r,e[1]+r,null,this._rootLevel),this._root.objects=[t],t}for(var n,o,a=[i],s=!1,u=this._nodeCapacity,d=this._idToCell,l=this._maxLevel;o=a.pop();){var h=(n=o).minX,c=n.minY,f=n.maxX,g=n.maxY;ef(e[0],e[1],e[2],e[3],h,c,f,g)&&(n.leaf?n.objects&&(n.objects.length<u||n.final)?(n.objects.push(t),d[t]?d[t].push(n):d[t]=[n],s=!0,(n.level>=l||Math.abs(f-h)<=Math.abs(e[2]-e[0])||Math.abs(g-c)<=Math.abs(e[3]-e[1]))&&(n.final=!0)):(this.splitNode(n),a.push(n)):a.push.apply(a,n.children))}if(s)return t;if(i=this._root,!of(e[0],e[1],e[2],e[3],i.minX,i.minY,i.maxX,i.maxY)){var p,_=this._rootLevel,v=(e[0]+e[2])/2,m=(e[1]+e[3])/2;for(p=this._root?this._root:{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0};!of(e[0],e[1],e[2],e[3],this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){var y=h=(p=this._root).minX,b=c=p.minY,x=f=p.maxX,E=g=p.maxY,A=Math.abs(f-h),S=Math.abs(g-c);if(0===S&&0===A)break;var w=Math.max(A,S);v<=h&&(y-=w),m<=c&&(b-=w),h<v&&(x+=w),c<m&&(E+=w);var T=rf(y,b,x,E,null,--_);this.splitNode(T),T.children[af(h,c,f,g,y,b,x,E)]=p,this._root=p.parent=T}for(a=[this._root],this._root.level=this._rootLevel;o=a.shift();)if(!(n=o).leaf)for(var C=0;C<4;C++){var M=n.children[C];M.level=n.level+1,a.push(M)}}return(n=(i=this._root).children[af(e[0],e[1],e[2],e[3],i.minX,i.minY,i.maxX,i.maxY)]).leaf&&n.objects&&(n.objects.push(t),d[t]?d[t].push(n):d[t]=[n]),t}},df.prototype.removeById=function(t){if(!this._objects[t])return t;this._size--;for(var e=this._idToCell[t],i=0;i<e.length;i++)for(var r=e[i].objects||[],n=0,o=r.length;n<o;n++)if(r[n]===t){r.splice(n,1);break}return delete this._objects[t],delete this._idToCell[t],t},df.prototype.remove=function(t){for(var e,i,r=this._getBBox(t),n=r[0],o=r[1],a=r[2],s=r[3],u=[this._root],d=[];e=u.pop();)if(ef(n,o,a,s,e.minX,e.minY,e.maxX,e.maxY))if(e.leaf){for(var l=e.objects||[],h=0,c=l.length;h<c;h++)if(l[h]===t){l.splice(h,1),1===c&&d.push(e);break}}else u.push.apply(u,e.children);if(delete this._idToCell[t],delete this._objects[t],this._size--,d.length)for(;i=d.pop();)for(var f=i.parent,g=!0;f&&g;){if(!f.leaf){for(h=0;h<4;h++)if(!(e=f.children[h]).leaf||e.objects&&0!==e.objects.length){g=!1;break}g&&(f.leaf=!0,f.children=[],f.objects=[])}f=f.parent}return t},df.prototype.splitNode=function(t){var e=t.minX,i=t.minY,r=t.maxX,n=t.maxY,o=(e+r)/2,a=(i+n)/2,s=t.level+1,u=this._idToCell,d=this._maxLevel,l=[rf(e,i,o,a,t,s),rf(e,a,o,n,t,s),rf(o,a,r,n,t,s),rf(o,i,r,a,t,s)];if(null!==t.objects)for(var h=t.objects,c=this._getBBox,f=0,g=h.length;f<g;f++){for(var p=h[f],_=c(p),v=u[p],m=0;m<4;m++){var y=l[m],b=y.minX,x=y.minY,E=y.maxX,A=y.maxY;ef(_[0],_[1],_[2],_[3],b,x,E,A)&&(y.objects&&y.objects.push(p),(y.level>=d||Math.abs(E-b)<=Math.abs(_[2]-_[0])||Math.abs(A-x)<=Math.abs(_[3]-_[1]))&&(y.final=!0),v?v.push(y):v=[y])}v.splice(v.indexOf(t),1)}t.children=l,t.objects=null,t.leaf=!1},df.prototype.point=function(t,e,i){for(var r,n,o,a=[],s=[this._root],u=this._getBBox;r=s.pop();)if(t>=r.minX&&t<=r.maxX&&e>=r.minY&&e<=r.maxY){if(r.leaf){i&&r.objects&&(a=r.objects);for(var d=r.objects||[],l=0,h=d.length;l<h;l++)t>=(n=u(o=d[l]))[0]&&t<=n[2]&&e>=n[1]&&e<=n[3]&&a.push(o);break}s.push.apply(s,r.children)}return a.length?a:null},df.prototype.neigbours=function(t,e){for(var i,r=[],n=[this._root];i=n.pop();)if(t>=i.minX&&t<=i.maxX&&e>=i.minY&&e<=i.maxY){if(i.leaf){r=i.objects;break}n.push.apply(n,i.children)}return r},df.prototype.query=function(t,e,i,r){for(var n,o,a,s=[],u=[this._root],d=this._getBBox,l={};n=u.pop();)if(ef(t,e,i,r,n.minX,n.minY,n.maxX,n.maxY))if(n.leaf)for(var h=n.objects||[],c=0,f=h.length;c<f;c++)l[a=h[c]]||(ef(t,e,i,r,(o=d(a))[0],o[1],o[2],o[3])&&s.push(a),l[a]=!0);else u.push.apply(u,n.children);return s},df.prototype.getOverlaps=function(){for(var t,e,i,r=[this._root],n=[],o=this._getBBox,a={};t=r.pop();)if(t.leaf){for(var s=t.objects||[],u=s.length,d=0;d<u;d++)for(var l=0;l<u;l++)if(e=s[d],i=s[l],d!==l&&!a[e+":"+i]&&!a[i+":"+e]){a[e+":"+i]=!0;var h=o(e),c=o(i);ef(h[0],h[1],h[2],h[3],c[0],c[1],c[2],c[3])&&n.push(e,i)}}else r.push.apply(r,t.children);return n},df.prototype.getAll=function(){return Object.keys(this._objects).map((function(t){return Number(t)}))},df.prototype.forEach=function(t,e){for(var i,r=[this._root];i=r.pop();)if(i.leaf&&i.objects)for(var n=0,o=i.objects.length;n<o;n++)t.call(e,i.objects[n]);else r.push.apply(r,i.children);return this},df.prototype.getLeafs=function(){for(var t,e=[this._root],i=[];t=e.pop();)t.leaf?i.push(t):e.push.apply(e,t.children);return i},df.prototype.traverse=function(t,e){for(var i,r=[this._root];i=r.pop();)t.call(e,i,i.objects)||i.leaf||r.push.apply(r,i.children);return this},df.prototype.update=function(t){return this.remove(t),this.insert(t,this._getBBox(t)),this},df.prototype.getNodeBounds=function(t){return nf(t)},df.flatAccessor=function(t,e){return function(i){var r=e*i;return t.slice(r,r+e)}},df.inside=of,df.intersects=tf,df.overlaps=ef,df.getNodeBBox=nf,df);function df(t,e,i,r){void 0===t&&(t=sf),void 0===e&&(e=10),void 0===r&&(r=0),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=e,this._root=null,this._getBBox=t,this._rootLevel=r,this._maxLevel=r+30,this._idToCell={},i&&(this._root=rf(i[0],i[1],i[2],i[3],null,r))}function lf(t,e,i,r,n){for(var o=new Array(t.length),a=0;a<e.length;a++){var s=r[e[a]],u=r[i[a]];o[s]=o[s]||[],o[s].push(u),n&&(o[u]=o[u]||[],o[u].push(s))}return o}function hf(t,e){return-1===t[e]?e:hf(t,t[e])}function cf(t,e,i,r,n,o,a,s){if(r[t]=n,i[t])return 1;if(!e[t]){e[t]=1,i[t]=1;var u=o[t];if(u)for(var d=0,l=u;d<l.length;d++){var h=l[d];if(cf(h,e,i,r,t,o,a,s))return a.push(s[h]),1}i[t]=0}}function ff(t,e,i){for(var r=t.length,n=new Uint8Array(r),o=new Uint8Array(r),a=new Int32Array(r),s={},u=0;u<r;u++)s[t[u]]=u;var d=lf(t,e,i,s,!1);for(u=0;u<r;u++){var l=[];if(cf(u,n,o,a,-1,d,l,t)&&1<l.length){for(var h=l[0],c=1;c<l.length;c++)if(l[c]===h){l.length=c;break}return l.push(h),l.reverse()}}return!1}function gf(t,e,i,r,n,o,a){e[t]=1,r[t]=i;var s=n[t];if(s)for(var u=0,d=s;u<d.length;u++){var l=d[u];if(e[l]){if(l!==i)return r[l]=t,o.push(a[l]),1}else if(gf(l,e,t,r,n,o,a))return o.push(a[l]),1}}var pf=(_f.prototype.getCycles=function(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(var t=0;t<this.nodes.length;t++)for(this.backtrack(t,t);0!==this.visitedLength;){var e=this.visitedStack.pop();void 0!==e&&this.visited[e]&&(this.visited[e]=0,this.visitedLength--)}return this.cycles},_f.prototype.backtrack=function(t,e){var i=!1;this.stack.push(e),this.visited[e]||(this.visited[e]=1,this.visitedLength++),this.visitedStack.push(e);for(var r=0,n=this.adjacency[e]||[];r<n.length;r++){var o=n[r];if(this.removed[e]=this.removed[e]||{},!this.removed[e][o])if(o<t)this.removed[e][o]=!0;else if(o===t){for(var a=[],s=0,u=!(i=!0);s<this.stack.length;s++){var d=this.stack[s];t===d&&(u=!0),u&&a.push(this.nodes[d])}this.cycles.push(a)}else if(!this.visited[o]){var l=this.backtrack(t,o);i=i||l}}if(i)for(var h=void 0;h=this.visitedStack.pop(),this.visited[h]&&(this.visited[h]=0,this.visitedLength--),h!==e;);return this.stack.pop(),i},_f);function _f(t,e,i){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=t,this.visited=new Uint8Array(this.nodes.length);for(var r=0;r<t.length;r++)this.idToIndex[t[r]]=r;this.adjacency=lf(t,e,i,this.idToIndex)}function vf(t,e){var i=t.index[e];if(void 0===i)return-1;for(;0<=i;)e=i,i=t.parent[i];return e}function mf(t,e,i,r,n){n&&e.sort((function(t,e){return n(t)-n(e)}));var o,a,s=[],u={index:{},parent:[],count:0};t.forEach((function(t){var e,i;void 0===(e=u).index[i=t]&&(e.count+=1,e.index[i]=e.parent.push(-e.count))}));for(var d=0;d<e.length&&!(u.count<=1);d++){var l=vf(u,i(e[d])),h=vf(u,r(e[d]));l!==h&&0<l&&0<h&&(a=l,(o=u).parent[h]=a,--o.count,s.push(e[d]))}return s}var yf,bf=Object.freeze({__proto__:null,minHeap:Pc,bellmanFord:Dc,dijkstra:zc,johnson:Bc,largestEmptyCircle:Hc,minDisk:Vh,removeRadialOverlap:Xc,convexhull:Gc,circlePack:function(t){var e=t.X,i=t.Y,r=t.R,n=t.center,o=t.maxSteps,a=void 0===o?1e3:o,s=t.padding,u=void 0===s?5:s,d=t.epsilon,l=void 0===d?1e-5:d,h=t.damping,c=void 0===h?2:h,f=t.pinned,g=t.indexes,p=t.onUpdate,_=t.pushSmallerOut,v=void 0===_||_,m=g?g.length:e.length,y=g;if(isFinite(f)||(f=-1),void 0===y){y=new Uint32Array(m);for(var b=0;b<m;b++)y[b]=b}else y=g;if(-1!==f)n=[e[f],i[f]];else if(!n){var x=0,E=0;for(b=0;b<m;b++)x+=e[y[b]],E+=i[y[b]];n=[x/m,E/m]}var A=function(t,e){for(var i=1/0,r=-1/0,n=0;n<t.length;n++){var o=t[n],a=e?e[o]:o;i=Math.min(a,i),r=Math.max(a,r)}return{min:i,max:r}}(y,r),S=A.min,w=A.max;function T(t,o){for(var a=0,s=0;s<m-1;s++)for(var d=s+1;d<m;d++)if(s!==d){var l=y[s],h=y[d],g=e[l],p=i[l],_=r[l],b=e[h],x=i[h],E=r[h],A=b-g,T=x-p,C=A*A+T*T;if(C<(F=_+E+u)*F-t){var M=(F-Math.sqrt(C))*o,I=1/C,L=(R=A*I*M)*R+(P=T*I*M)*P;h!==f&&(a+=L*(B=_/S),e[h]+=R*B,i[h]+=P*B),l!==f&&(a+=L*(B=E/S),e[l]-=R*B,i[l]-=P*B)}}var N=t*c*(1-o),k=n[0],O=n[1];for(s=0;s<m;s++)if((l=y[s])!==f){var F,R,P,D=e[l],z=i[l],B=(F=r[l])/w,U=v?N*B:N;a+=L=(R=(D-k)*U)*R+(P=(z-O)*U)*P,e[l]-=R,i[l]-=P}return a}y.sort((function(t,o){return r[o]*Kc(e[o],i[o],n)-r[t]*Kc(e[t],i[t],n)}));var C=0,M=0,I=Zc(1/m);for(b=0;b<a&&(C=T(I,Zc((b+1)/a)),p&&setTimeout((function(){return p(e,i)})),!(Math.abs(C-M)<l));b++)M=C;return{X:e,Y:i}},Quadtree:uf,kruskal:mf,weightedStress:kc,distanceStress:Oc,constrainedStress:Fc,stressMinimizationStep:Rc,stressMinimizationStepGeneral:function(t,e,i,r,n,o,a,s){a=a||0;var u,d=e,l=i;-1===(n=void 0===n?-1:n)&&(a=0);for(var h=0;h<r;h++){for(var c=s[h],f=0,g=0,p=0,_=e[c],v=i[c],m=0;m<r;m++){var y=s[m],b=0;if(y!==c){var x=0,E=t[c][y]*o,A=1/(E*E);c!==n&&y!==n||(x=A);var S=(1-a)*A+a*x;if(f+=S,0!=A){var w=e[y],T=i[y],C=_-w,M=v-T,I=C*C+M*M;1e-6<I&&(b=1/Math.sqrt(I)),g+=S*(w+E*(_-w)*b),p+=S*(T+E*(v-T)*b)}}}0!==(u=f)&&(d[c]=g/u,l[c]=p/u)}return{x:d,y:l}},detectCyclesUndirected:function(t,e,i,r){void 0===r&&(r=!1);for(var n,o,a,s,u=new Int32Array(t.length),d={},l=0;l<t.length;l++)u[l]=-1,d[t[l]]=l;for(l=0;l<e.length;l++){var h=d[e[l]],c=d[i[l]];if(r&&h===c)return!0;var f=hf(u,h),g=hf(u,c);if(f===g)return!0;o=g,a=hf(n=u,f),s=hf(n,o),n[a]=s}return!1},detectCyclesDirected:ff,detectCyclesUndirectedDFS:function(t,e,i){for(var r=t.length,n=new Uint8Array(r),o=new Int32Array(r),a={},s=0;s<r;s++)o[a[t[s]]=s]=-1;var u=lf(t,e,i,a,!0);for(s=0;s<e.length;s++){var d=a[e[s]],l=a[i[s]];u[d]=u[d]||[],u[d].push(l)}for(s=0;s<r;s++)if(!n[s]&&gf(s,n,-1,o,u,[],t))return!0;return!1},CyclesFinder:pf}),xf=(E(Ef,yf=xe),Ef.prototype.shortestPath=function(t){void 0===t&&(t={source:void 0,target:void 0});var e=t.source,i=t.target,r=t.directed,n=void 0!==r&&r,o=t.filter,a=void 0===o?"visible":o,s=t.edgeCostFunction,u=void 0===s?function(){return 1}:s,d=t.heuristicFunction,l=void 0===d?function(){return 0}:d,h=this._graph.getNode(e),c=this._graph.getNode(i);if(!h)throw new Error("the source is not a node");if(!c)throw new Error("the target is not a node");var f=h._index,g=c._index,p=null;if(f===g)p={nodes:h.toList(),edges:this._graph.edgeList()};else{var _=this._graph.getNodeMaxIndex()+1,v=new Int32Array(_),m=new Float32Array(_),y=new Float32Array(_),b=new Set,x=new Mo(y);for(m.fill(1/0),y.fill(1/0),v.fill(-1),x.add(f),m[f]=0,y[f]=l(h,c);!x.isEmpty();){var E=x.removeMin();if(E===g){p=this._constructPath(v,f,g);break}b.add(E);var A=this._graph.getAdjacentDirections(E);if(A)for(var S=0;S<A.length;++S){for(var w=A[S],T=this._graph.getEdgeIndexesInDirection(w),C=-1,M=0,I=-1,L=0;L<T.length;++L){var N=T[L],k=this._sourceList.get(N),O=this._targetList.get(N);if(k!==O&&!(n&&E!==k||"visible"===a&&this._excludedList.get(N)||"raw"===a&&this._virtualList.get(N))){var F=u(this._edgeList.get(N));(-1===C||F<M)&&(C=N,M=F,I=k===E?O:k)}}if(-1!==I||b.has(I)){var R=m[E]+M;if(!x.has(I)||R<m[I]){var P=this._nodeList.get(E);v[I]=C,m[I]=R,y[I]=R+l(P,c),x.add(I)}}}}}return Promise.resolve(p)},Ef.prototype._constructPath=function(t,e,i){for(var r=[i],n=[],o=i;o!==e;){var a=t[o],s=this._sourceList.get(a),u=this._targetList.get(a);o=o===s?u:s,r.push(o),n.push(a)}return r.reverse(),n.reverse(),{nodes:this._graph.nodeList(new Uint32Array(r)),edges:this._graph.edgeList(new Uint32Array(n))}},Ef.prototype.detectCycle=function(t,e){var i=e.getSource(),r=e.getTarget(),n=ff(t._indexes,i._indexes,r._indexes);return n?this._graph.nodeList(new Uint32Array(n)).dedupe():this._graph.nodeList()},Ef.prototype.getAllSimpleCycles=function(t,e){var i=this,r=e.getSource(),n=e.getTarget();return new pf(t._indexes,r._indexes,n._indexes).getCycles().map((function(t){return i._graph.nodeList(new Uint32Array(t))}))},Ef.prototype.minimumSpanningTree=function(t,e,i){var r=this._graph;t=r.getNodes(t),e=r.getEdges(e);var n=new Set;t.forEach((function(t){return n.add(t._index)}));var o=r.getConnectedComponents(t,{filter:function(t){return n.has(t)},internalIndexes:!0}),a={};o.forEach((function(t,e){return t.forEach((function(t){return a[t]=e}))}));var s=[];return e.forEach((function(t){var e=a[t.getSource()._index];void 0!==e&&(void 0===s[e]&&(s[e]=[]),s[e].push(t._index))})),o.map((function(t,e){var n=mf(t,s[e]||[],(function(t){return r.edge(t).getSource()._index}),(function(t){return r.edge(t).getTarget()._index}),i?function(t){return i(r.edge(t))}:void 0);return{nodes:r.nodeList(new Uint32Array(t)),edges:r.edgeList(new Uint32Array(n))}}))},Ef);function Ef(t){var e=t.graph,i=yf.call(this)||this;return i._graph=e,i._nodeList=e.getNodeAttribute("object"),i._edgeList=e.getEdgeAttribute("object"),i._sourceList=e.getEdgeAttribute("source"),i._targetList=e.getEdgeAttribute("target"),i._excludedList=e.getEdgeAttribute("excluded"),i._virtualList=e.getEdgeAttribute("virtual"),i}var Af,Sf=(E(wf,Af=xe),wf.prototype._addAttributeLayer=function(){return this._graphics.addAttributeLayer({name:"curvature",priority:2,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:function(t,e){var i,r=e.edgesAlwaysCurvy,n=e.directedEdges,o=t.getSource()===t.getTarget(),a=t.getParallelEdges(),s=a.indexOf(t);if(-1===s)return 0;if(o)i=s+1;else{var u=t.getSource(),d=a.size;if(1===d&&!r)return 0;if(n){for(var l=0,h=0;h<s;++h)a.get(h).getSource()===u&&(l+=1);i=l+1}else{var c=u!==a.get(0).getSource();i=d%2!=1||r?(1+(s/2|0))*(s%2==0?1:-1)*(c?-1:1):0===s?0:((s+1)/2|0)*(s%2==0?1:-1)*(c?-1:1)}}return i}}})},wf);function wf(t){var e=t.settings,i=t.graphics,r=Af.call(this)||this;return r._context={edgesAlwaysCurvy:!1,directedEdges:!1},r._settings=e,r._graphics=i,r._attributeLayer=r._addAttributeLayer(),e.register("edgesAlwaysCurvy",!1,(function(t){r._context.edgesAlwaysCurvy=t,r._attributeLayer.updateAll()})),e.register("directedEdges",!1,(function(t){r._context.directedEdges=t,r._attributeLayer.updateAll()})),r}function Tf(){return{}}function Cf(){}function Mf(){return!1}function If(){}function Lf(){}function Nf(){}var kf,Of=(E(Ff,kf=Fo),Ff.prototype.configure=function(t){this._onStart=t.onStart||Lf,this._onEnd=t.onEnd||Nf,this._update=t.update||Cf,this._onUpdate=t.onUpdate||If,this._createContext=t.context||Tf,this._isRunning=t.isRunning||Mf},Ff.prototype.setData=function(t){this._data=t},Ff.prototype.getData=function(){return this._data},Ff.prototype.onStart=function(){return this.fire("start",{target:this}),this._onStart.call(this),this},Ff.prototype.stop=function(){},Ff);function Ff(t,e,i){var r=kf.call(this)||this;return r._complete=!1,r._data=null,r._dependencies=e,r._dom=i,r.configure(t),r}var Rf,Pf=(E(Df,Rf=Of),Df.prototype.sync=function(t){var e=t.data.isRunning,i=t.data.result,r=this._onUpdate.call(this,i,this._dependencies,e);return this.fire("update",{target:this,isRunning:e}),e?this.send(r):this.stop(i)},Df.prototype.stop=function(t){return this._complete||(this._onEnd.call(this,t,this._dependencies),this._worker.terminate(),this.fire("stop",{target:this})),this._complete=!0,this},Df.prototype.send=function(t){return this._worker.postMessage(lo(t)),this},Df);function Df(t,e,i){var r=Rf.call(this,t,e,i)||this,n=[function(t){void 0===t&&(t={});for(var e=Object.keys(t),i=[],r=0,n=e.length;r<n;r++){var o=e[r],a=t[o];if("function"!=typeof a)throw new Error('Asynchronous task: dependency "'+o+'" is not found');var s=Uf(a);s?(i.push(Bf(a,o)),s!==o&&i.push("var "+o+" = "+s+";")):i.push("var "+o+" = "+Bf(a,o)+";")}return i.join("\n")}(t.imports),"","","var __CONTEXT = ("+r._createContext.toString()+")();","var __UPDATE_FUNC = "+r._update.toString()+";","var __IS_RUNNING_FUNC = "+r._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result    = __UPDATE_FUNC(evt.data, __CONTEXT);","  var isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");return r._worker=ho(n),r._worker.addEventListener("message",(function(t){r._dom.isDestroyed()||r.sync(t)})),r}var zf=/^function\s*\(/;function Bf(t,e){var i=t.toString();return zf.test(i)?"function "+(t.name||e)+" "+i.substring(i.indexOf("(")):i}function Uf(t){var e=t.toString();return t.name?t.name:zf.test(e)?null:e.substring("function ".length,e.indexOf("(")).trim()}var Vf,jf=(E(Gf,Vf=Of),Gf.prototype.sync=function(t){var e=this._update(t,this._context),i=this._isRunning(this._context,t),r=this._onUpdate.call(this,e,this._dependencies,i);this.fire("update",{target:this,isRunning:i}),i?this.send(r):this.stop(e)},Gf.prototype.send=function(t){var e=this;return this._complete||this._dom.setTimeout((function(){return e.sync(t)}),0),this},Gf.prototype.stop=function(t){return this._complete||(this._onEnd(t,this._dependencies),this._complete=!0),this},Gf);function Gf(t,e,i){var r=Vf.call(this,t,e,i)||this;return r._context=r._createContext(),r}var Hf,Wf=(E(qf,Hf=xe),qf.prototype.run=function(t,e,i,r){var n=i,o=function(t,e,i){var r=t(e,i);return void 0===r&&(r=e),r}(t.configure||function(t){return t},e,r);return new(n?Pf:jf)(t,r,this._dom).onStart().send(o)},qf);function qf(t){var e=t.dom,i=Hf.call(this)||this;return i._dom=e,i}function Xf(t,e,i){void 0===e&&(e={}),void 0===i&&(i=!0),i||(e.edges=void 0);var r=function(t,e,i,r){if(void 0===r&&(r=t.getNodes()),!e)return i?t.nodeList():r.filter((function(t){return null===t.getMetaNode()}));if(e instanceof gr)return e;if(Array.isArray(e)&&0<e.length)return t.getNodes(e);throw Error("[Layout]: 'nodes' must be a NodeList or an NodeId[]")}(t,e.nodes,e.edges),n=function(t,e,i){if(void 0===i&&(i=t.getEdges()),!e)return i;if(e instanceof Ki)return e;if(Array.isArray(e)&&0<e.length)return t.getEdges(e);throw Error("[Layout]: 'edges' must be a EdgeList or a valid EdgeId[]")}(t,e.edges,function(t){if(t.size){for(var e=new Set,i=0,r=t.getId();i<r.length;i++){var n=r[i];e.add(n)}return t.getAdjacentEdges().filter((function(t){return t.getExtremities().getId().every((function(t){return e.has(t)}))}))}}(r));return A(A({},e),{nodes:r.concat(n.getExtremities()).dedupe(),edges:n})}var Yf,Zf="complete",Kf=(E(Qf,Yf=xe),Qf.prototype.register=function(t,e){if(t in this._layouts)throw new Error("Layout "+t+" already exists");var i=A(A({},e),{name:t});this._layouts[t]=i},Qf.prototype.getAvailableLayouts=function(){return Object.keys(this._layouts)},Qf.prototype.start=function(t,e){var i=this;void 0===e&&(e={});var r=this._layouts[t],n=Xf(this._graph,e,-1===["radial","grid"].indexOf(t));return new Promise((function(e){if(!r)throw new Error("layout "+t+" does not exist");n.duration="number"==typeof n.duration?n.duration:500;var o=r.onSync;n.skipTextDrawing=void 0===n.skipTextDrawing||!!n.skipTextDrawing;var a=n.locate||!1;a&&"boolean"==typeof a&&(a={}),n.locate=a;var s=i._onTaskStart,u=i._onTaskUpdate,d=i._onTaskComplete,l={name:t,update:r.update,isRunning:r.isRunning,configure:r.configure,context:r.context,imports:r.imports,onStart:function(){s(r,n,this)},onUpdate:function(e,i,r){var a=e.lastUpdate||-1/0,s=Jt();r&&s-a<40||(e.lastUpdate=s,u(this,t,e,r,o,n))},onEnd:function(t){var i=this;this.once(Zf,(function(o){d(i,t,o,r,n,e,i.getData())}))}};i._graphics.forceAttributesComputation();var h=void 0===n.useWebWorker||!!n.useWebWorker;i._running.push(i._tasks.run(l,n,h,i._modules))}))},Qf.prototype._animateCamera=function(t,e,i){if(0===t.indexes.length)return Promise.resolve();var r=this._locate.layoutDataBoundingBox(t),n=this._locate.computeConfigForBounds(r,e);return this._camera.setView(n,{duration:i,easing:e.easing})},Qf.prototype.stop=function(){for(;0!==this._running.length;){var t=this._running.pop();t.stop(),t.fire(Zf,null)}return Promise.resolve()},Qf.prototype.isRunning=function(){return 0!==this._running.length},Qf.prototype._assignNodePositions=function(t,e,i){if(!t||i){var r=t?new Uint32Array(t.indexes):void 0,n=this._graph.nodeList(r);return Promise.resolve(n)}for(var o=t.indexes,a=t.x,s=t.y,u=this._graph.nodeList(new Uint32Array(o)),d=Jf(t),l=0;l<d.length;l++)d[l]={x:a[l],y:s[l]};return u.setAttributes(d,e)},Qf);function Qf(t){var e=Yf.call(this)||this;return e._running=[],e._onTaskUpdate=function(t,i,r,n,o,a){var s=a.duration,u=a.onSync,d=a.onUpdate,l=a.dryRun,h=a.locate;if(u&&e._dom.setTimeout((function(){return u(r,e._modules,n)}),s),o){var c=o(r,e._modules,n);e._events.fire(ye.LAYOUT_COMPUTED,{type:ye.LAYOUT_COMPUTED,name:i,positions:c}),d&&d(r,c,n);var f=e._assignNodePositions(c,s,l);n||(h&&e._animateCamera(c,h,a.duration),f.then((function(){return t.fire(Zf,c)})))}else n||t.fire(Zf,r)},e._onTaskComplete=function(t,i,r,n,o,a,s){for(var u=0;u<e._running.length;u++)if(e._running[u]===t){e._running.splice(u,1);break}n.onEnd&&i&&n.onEnd(i,e._modules),o.skipTextDrawing&&e._dom.setTimeout((function(){return e._graphics.showTexts()}),50);var d=e._graph.nodeList(new Uint32Array(s.indexes)),l=o.dryRun&&i?r:$f(d,e._graph),h=d.getId(),c={before:Jf(s),current:Jf(l)};e._events.fire(ye.LAYOUT_END,{type:ye.LAYOUT_END,name:n.name,positions:c,ids:h}),e._dom.setTimeout((function(){o.onEnd&&o.onEnd(i),a({name:n.name,positions:c,ids:h})}))},e._onTaskStart=function(t,i,r){i.skipTextDrawing&&e._graphics.hideTexts();var n=$f(e._graph.getNodes(i.nodes),e._graph),o=n.ids;r.setData(n),e._events.fire(ye.LAYOUT_START,{type:ye.LAYOUT_START,name:t.name,ids:o,task:r})},e._modules=t,e._dom=t.dom,e._events=t.events,e._graph=t.graph,e._graphics=t.graphics,e._tasks=t.tasks,e._locate=t.locate,e._camera=t.camera,e._layouts={},e._events.register([ye.LAYOUT_START,ye.LAYOUT_END,ye.LAYOUT_COMPUTED]),e._events.on(ye.CLEAR_GRAPH,(function(){return e.stop()})),e}function Jf(t){for(var e=t.x,i=t.y,r=t.indexes.length,n=new Array(r),o=0;o<r;o++)n[o]={x:e[o],y:i[o]};return n}function $f(t,e){var i=t._indexes,r=e.getNodeAttribute("x").getMultiple(i),n=e.getNodeAttribute("y").getMultiple(i);return{ids:t.getId(),indexes:i,x:r,y:n}}function tg(t){return"number"==typeof t&&isFinite(t)}var eg=(ig.prototype.onUpdate=function(t){this._onUpdateHandlers.push(t)},ig.prototype.getPropertyInfo=function(){return this._info},ig.prototype.getPath=function(){return this._path.slice()},ig.prototype.destroy=function(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)},ig.prototype.kill=function(){return this.destroy()},ig);function ig(t,e,i){var r=this,n=i.path,o=i.filter,a=i.unwindArrays;this._module=t,this._isNode=e,this._path=n||[],this._filter=o,this._unwindArrays=a,this._onUpdateHandlers=[],this._triggerUpdate=function(t){for(var e=0;e<r._onUpdateHandlers.length;++e)r._onUpdateHandlers[e](t)},this._info=t.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}var rg=(Object.defineProperty(ng.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),ng.prototype.onPropertyAdded=function(t){return this._onAddHandlers.push(t),this},ng.prototype.onPropertyRemoved=function(t){return this._onRemoveHandlers.push(t),this},ng.prototype.onPropertyUpdated=function(t){return this._onUpdateHandlers.push(t),this},ng.prototype.getPath=function(){return this._path.slice()},ng.prototype.getProperties=function(){return this._propertyList.slice()},ng.prototype.getPropertyInfo=function(t){var e=this._properties[t];return e?e.info:null},ng.prototype.destroy=function(){var t=this;W(this._properties,(function(e,i){var r=e.handler,n=t._path.concat([i]);t._module.unwatchPropertyInformation(t._isNode,n,r,t._filter,t._unwindArrays)})),this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[];var e=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(e,1)},ng.prototype.kill=function(){return this.destroy()},ng.prototype.updateSubPropertiesToWatch=function(t,e){if(t===this._isNode)for(var i=e.getData(this._path),r=0;r<i.length;r++){var n=i[r];if(G(n))for(var o=Object.keys(n),a=0;a<o.length;a++)this._addSubPropertyToWatch(o[a])}},ng.prototype._addSubPropertyToWatch=function(t){var e=this;if(!this._properties[t]){var i=this._path.concat([t]),r=function(){return e._triggerPropertyUpdate(t)},n=this._unwindArrays,o=this._isNode,a=this._filter,s=this._module.watchPropertyInformation(o,i,r,a,n);this._properties[t]={handler:r,info:s},this._triggerPropertyUpdate(t)}},ng.prototype._triggerPropertyUpdate=function(t){var e=this._properties[t].info,i=this._propertyList.indexOf(t),r=-1!==i,n="undefined"!==e.getType();!r&&n?(this._propertyList.push(t),this._triggerHandlers("_onAddHandlers",t,e),this._triggerHandlers("_onUpdateHandlers",t,e)):r&&!n?(this._propertyList.splice(i,1),this._triggerHandlers("_onUpdateHandlers",t,e),this._triggerHandlers("_onRemoveHandlers",t,e)):r&&n&&this._triggerHandlers("_onUpdateHandlers",t,e)},ng.prototype._triggerHandlers=function(t,e,i){for(var r=this[t],n=0,o=r.length;n<o;n++)r[n](e,i)},ng);function ng(t,e,i){var r=i.path,n=i.filter,o=i.unwindArrays;this._module=t,this._isNode=e,this._path=r,this._filter=n,this._unwindArrays=o,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}var og=(ag.prototype.setWatcher=function(t){this._watcher=t},ag.prototype.isNode=function(){return this._watcher.isNode},ag.prototype.getPath=function(){return this._watcher.property.slice()},ag.prototype.getBoundaries=function(){var t=this._watcher.boundaries;return t?{min:t.min,max:t.max}:null},ag.prototype.getValues=function(){return this._watcher.values.keys()},ag.prototype.getValueCount=function(t){return this._watcher.values.get(t)||0},ag.prototype.getCount=function(){return this._watcher.total},ag.prototype.getType=function(){return 0<this._watcher.any?"any":0<this._watcher.numbers?"number":"undefined"},ag);function ag(){}function sg(t){return"number"==typeof t&&isNaN(t)}var ug=(dg.prototype.set=function(t,e){var i=this._getIndex(t);return-1===i?(this._keys.push(t.slice()),this._values.push(e),!0):(this._values[i]=e,!1)},dg.prototype.get=function(t){var e=this._getIndex(t);return-1===e?void 0:this._values[e]},dg.prototype.has=function(t){return-1!==this._getIndex(t)},dg.prototype.delete=function(t){var e=this._getIndex(t);return-1!==e&&(this._keys.splice(e,1),this._values.splice(e,1),!0)},dg.prototype.keys=function(){return this._keys.map((function(t){return t.slice()}))},dg.prototype.values=function(){return this._values.slice()},dg.prototype._getIndex=function(t){for(var e=0;e<this._keys.length;e++){var i=this._keys[e];if(i.length===t.length){for(var r=!0,n=0;n<t.length;n++){var o=i[n],a=t[n];if(!(o===a||sg(o)&&sg(a))){r=!1;break}}if(r)return e}}return-1},Object.defineProperty(dg.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),dg);function dg(){this._keys=[],this._values=[]}var lg=(hg.prototype.clear=function(){return this._arrays=new ug,this._map.clear()},hg.prototype.delete=function(t){return O(t)?this._arrays.delete(t):this._map.delete(t)},hg.prototype.get=function(t){return O(t)?this._arrays.get(t):this._map.get(t)},hg.prototype.set=function(t,e){return O(t)?this._arrays.set(t,e):this._map.set(t,e),this},hg.prototype.keys=function(){return w(Zn(this._map),this._arrays.keys())},hg.prototype.values=function(){return w(Kn(this._map),this._arrays.values())},Object.defineProperty(hg.prototype,"size",{get:function(){return this._map.size+this._arrays.size},enumerable:!0,configurable:!0}),hg);function hg(){this._map=new Map,this._arrays=new ug}var cg,fg=(E(gg,cg=xe),gg.prototype.watchNodeObjectProperty=function(t){return this._watchObjectProperty(!0,xg(t))},gg.prototype.watchEdgeObjectProperty=function(t){return this._watchObjectProperty(!1,xg(t))},gg.prototype.watchNodeNonObjectProperty=function(t){return this._watchNonObjectProperty(!0,xg(t))},gg.prototype.watchEdgeNonObjectProperty=function(t){return this._watchNonObjectProperty(!1,xg(t))},gg.prototype.watchPropertyInformation=function(t,e,i,r,n){var o=this._findWatcher(t,e,r,n)||this._createWatcher(t,e,r,n);return i&&o.onChange.push(i),o.info},gg.prototype.unwatchPropertyInformation=function(t,e,i,r,n){var o=this._findWatcher(t,e,r,n);if(o){var a=o.onChange,s=a.indexOf(i);if(-1!==s&&(a.splice(s,1),0===a.length)){var u=this._propertyWatchers.indexOf(o);this._propertyWatchers.splice(u,1)}}},gg.prototype._watchObjectProperty=function(t,e){var i=new rg(this,t,e);return this._objectPropertyWatchers.push(i),i.updateSubPropertiesToWatch(t,this._graph[t?"getNodes":"getEdges"](e.filter)),i},gg.prototype._watchNonObjectProperty=function(t,e){return new eg(this,t,e)},gg.prototype._findWatcher=function(t,e,i,r){for(var n=0;n<this._propertyWatchers.length;++n){var o=this._propertyWatchers[n];if(o.isNode===t&&o.filter===i&&o.unwindArrays===r&&vg(o.property,e))return o}return null},gg.prototype._createWatcher=function(t,e,i,r){var n={isNode:t,property:e,numbers:0,any:0,total:0,values:new lg,boundaries:null,onChange:[],filter:i,unwindArrays:r,info:new og};return n.info.setWatcher(n),yg(n,this._graph[t?"getNodes":"getEdges"](i).getData(e)),this._propertyWatchers.push(n),n},gg);function gg(t){var e,i=t.graph,r=t.events,n=cg.call(this)||this;return n._onExcludedStateChange=function(t){for(var e=t.elements,i=!t.value,r=0,o=n._propertyWatchers.length;r<o;r++){var a=n._propertyWatchers[r];a.isNode===e.isNode&&"visible"===a.filter&&((i?yg:bg)(a,e.getData(a.property)),_g(a))}},n._onDataChange=function(t){for(var e=t.isNode,i=t.changes,r=0;r<n._propertyWatchers.length;++r){var o=(_=n._propertyWatchers[r]).property,a="all"===_.filter;if(_.isNode===e)for(var s=0;s<i.length;++s){var u=i[s],d=mg(u.property||[],o);if(d){var l=u.nodes||u.edges,h=[],c=[];if(l)for(var f=0;f<l.size;++f){var g=l.get(f);(a||g.isVisible())&&(h.push(Y(u.newValues[f],d)),c.push(Y(u.previousValues[f],d)))}h.length&&(yg(_,h),bg(_,c),_g(_))}}}r=0;for(var p=n._objectPropertyWatchers.length;r<p;r++){var _,v=(_=n._objectPropertyWatchers[r]).path,m=function(t){var e=i[t],r=e.property,n=e.nodes,o=e.edges,a=n||o;if(a){var s=a.isNode;(!r||r.length<=v.length+1&&v.every((function(t,e){return t===r[e]})))&&_.updateSubPropertiesToWatch(s,a)}};for(s=0;s<i.length;++s)m(s)}},n._onElementsAdded=function(t){for(var e=t.nodes||t.edges,i=0;i<n._propertyWatchers.length;++i){var r=n._propertyWatchers[i];if(r.isNode===e.isNode){var o=e.getData(r.property);o.length&&(yg(r,o),_g(r))}}for(i=0;i<n._objectPropertyWatchers.length;i++)n._objectPropertyWatchers[i].updateSubPropertiesToWatch(e.isNode,e)},n._onElementsRemoved=function(t){for(var e=t.nodes||t.edges,i=0;i<n._propertyWatchers.length;++i){var r=n._propertyWatchers[i],o="all"===r.filter;if(r.isNode===e.isNode&&o){var a=e.getData(r.property);a.length&&(bg(r,a),_g(r))}}},n._onGraphClear=function(){n._propertyWatchers.forEach((function(t){t.numbers=0,t.any=0,t.total=0,t.boundaries=null,t.values.clear()}))},n._graph=i,n._propertyWatchers=[],n._objectPropertyWatchers=[],r.on(((e={})[ye.EXCLUDED_STATE_CHANGE]=n._onExcludedStateChange,e[ye.UPDATE_NODE_DATA+" "+ye.UPDATE_EDGE_DATA]=n._onDataChange,e[ye.ADD_NODES+" "+ye.ADD_EDGES]=n._onElementsAdded,e[ye.REMOVE_NODES+" "+ye.REMOVE_EDGES]=n._onElementsRemoved,e[ye.CLEAR_GRAPH]=n._onGraphClear,e)),n}function pg(t){return null==t?[]:z(t)}function _g(t){for(var e=0;e<t.onChange.length;++e)t.onChange[e](t.info)}function vg(t,e){if(t.length===e.length){for(var i=0;i<t.length;++i)if(t[i]!==e[i])return;return 1}}function mg(t,e){if(t.length>e.length)return null;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return null;return e.slice(i)}function yg(t,e,i){for(var r=t.values,n=!i&&t.unwindArrays,o=0;o<e.length;++o){var a=e[o];if(i||void 0===a||(t.total+=1),n&&Array.isArray(a))yg(t,a,!0);else{var s=r.get(a);s?r.set(a,s+1):(r.set(a,1),tg(a)?(t.boundaries?a<t.boundaries.min?t.boundaries.min=a:a>t.boundaries.max&&(t.boundaries.max=a):t.boundaries={min:a,max:a},t.numbers+=1):void 0!==a&&(t.any+=1))}}}function bg(t,e,i){for(var r=t.values,n=!i&&t.unwindArrays,o=t.boundaries,a=!1,s=0;s<e.length;++s){var u=e[s];if(i||void 0===u||--t.total,n&&Array.isArray(u))a=a||bg(t,u,!0);else{var d=r.get(u);1<d?r.set(u,d-1):(r.delete(u),tg(u)?(--t.numbers,!o||o.min!==u&&o.max!==u||(a=!0)):void 0!==u&&--t.any)}}return!i&&a&&(t.boundaries=function(t){for(var e=null,i=null,r=0;r<t.length;++r){var n=t[r];tg(n)&&((null==e||n<e)&&(e=n),(null==i||i<n)&&(i=n))}return null==e||null==i?null:{min:e,max:i}}(r.keys())),a}function xg(t){return"object"!=typeof t||null===t||Array.isArray(t)?{path:pg(t),filter:"visible",unwindArrays:!1}:{path:pg(t.path),filter:"all"===(t.filter||"visible")?"all":"visible",unwindArrays:!!t.unwindArrays}}function Eg(t,e){var i=t.getPosition(),r=e.getPosition();return Pa(i.x,i.y,r.x,r.y)}var Ag,Sg={pathLengthFunction:Eg,heuristicLengthFunction:Eg},wg={pathLengthFunction:function(){return 1},heuristicLengthFunction:function(){return 0}},Tg=(E(Cg,Ag=xe),Cg.prototype.astar=function(t,e,i){return Mg(this._graph,t,e,this._cachedObjectList,A(A({},Sg),i))},Cg.prototype.dijkstra=function(t,e,i){return Mg(this._graph,t,e,this._cachedObjectList,A(A({},wg),i))},Cg.prototype.dijkstraBig=function(t,e,i){var r=this._graph.getNode(t),n=this._graph.getNode(e);if(!r||!n)return this._graph.nodeList();var o=this._graph.getNodes(),a=zc(this._graph.getAdjacencyList({directed:i.directed,weight:1,nodes:o}),r._index,n._index,o._indexes,void 0,!1);return a.path?this._graph.nodeList(new Uint32Array(a.path)):this._graph.nodeList()},Cg);function Cg(t){var e=t.graph,i=Ag.call(this)||this;return i._graph=e,i._cachedObjectList=e.getNodeAttribute("object"),i}function Mg(t,e,i,r,n){var o=void 0===n?{}:n,a=o.pathLengthFunction,s=o.heuristicLengthFunction,u=o.filter,d=o.directed,l=t.getNode(e),h=t.getNode(i);if(!l||!h)return t.nodeList();var c,f=l._index,g=h._index,p=a||function(){return 0},_=s||function(){return 0},v=d?_i:vi,m=r.get(f),y=r.get(g);if(f===g)return t.nodeList(new Uint32Array([f]));for(var b=t.getNodeMaxIndex()+1,x=new Qn,E=new Qn,A=new Int32Array(b),S=new Float32Array(b),w=new Float32Array(b),T=0;T<b;++T)A[T]=-1,S[T]=1/0,w[T]=1/0;for(E.add(f),S[f]=0,w[f]=_(m,y);0!==E.length;){var C=E.length,M=E.get(0),I=0,L=w[M];for(T=1;T<C;++T){var N=E.get(T),k=w[N];k<L&&(L=k,M=N,I=T)}if(M===g){c=Ig(A,f,g);break}var O=r.get(M);E.removeByPosition(I),x.add(M);var F=t.node(M).getAdjacentNodes({direction:v,filter:u})._indexes;for(T=0;T<F.length;++T){var R=F[T],P=r.get(R);if(!x.has(R)){var D=S[M]+p(O,P);!E.add(R)&&D>=S[R]||(A[R]=M,S[R]=D,w[R]=D+_(P,y))}}}return c&&t.nodeList(c)}function Ig(t,e,i){for(var r=[i],n=i;n!==e;)n=t[n],r.push(n);return r.reverse(),r}var Lg,Ng=(E(kg,Lg=xe),Object.defineProperty(kg.prototype,"x",{get:function(){return this._position.x||0},enumerable:!0,configurable:!0}),Object.defineProperty(kg.prototype,"y",{get:function(){return this._position.y||0},enumerable:!0,configurable:!0}),kg.prototype._later=function(){return this._dom.afterNextFrame()},kg.prototype.move=function(t){var e=this,i=t.x,r=t.y;return void 0!==i&&void 0!==r?this._dom.afterNextFrame().then((function(){var t=i-e.x,n=r-e.y;return e._events.fire(ye.VIRTUAL_MOVE,{x:i,y:r,dx:t,dy:n}),e._later()})):Promise.resolve()},kg.prototype.down=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,a=void 0===o?Ih.LEFT:o;return this.move({x:r,y:n}).then((function(){return e._events.fire(ye.VIRTUAL_DOWN,{x:e.x,y:e.y,button:a}),e._events.fire(ye.VIRTUAL_MOVE,{x:e.x,y:e.y,dx:0,dy:0,button:a}),e._later()}))},kg.prototype.up=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,a=void 0===o?Ih.LEFT:o;return this.move({x:r,y:n}).then((function(){return e._events.fire(ye.VIRTUAL_UP,{x:r,y:n,button:a}),e._later()}))},kg.prototype.click=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,a=void 0===o?Ih.LEFT:o;return this.move({x:r,y:n}).then((function(){return e._events.fire(ye.VIRTUAL_CLICK,{x:r,y:n,button:a}),e._later()}))},kg.prototype.rightClick=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,a=void 0===o?Ih.RIGHT:o;return this.move({x:r,y:n}).then((function(){return e._events.fire(ye.VIRTUAL_CLICK,{x:r,y:n,button:a}),e._later()}))},kg.prototype.doubleClick=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,a=void 0===o?Ih.LEFT:o;return this.move({x:r,y:n}).then((function(){return e._events.fire(ye.VIRTUAL_DOUBLE_CLICK,{x:r,y:n,button:a}),e._later()}))},kg.prototype.drag=function(t,e){var i=this;return this.down(t).then((function(){return i.move(e)})).then((function(){return i.up(e)}))},kg.prototype.wheel=function(t){var e=this,i=t.x,r=t.y,n=t.delta;return this.move({x:i,y:r}).then((function(){return e._events.fire(ye.VIRTUAL_WHEEL,{x:i,y:r,delta:n}),e._later()}))},kg);function kg(t){var e=t.position,i=t.dom,r=t.events,n=Lg.call(this)||this;return n._dom=i,n._events=r,n._position=e,n._events.register([ye.VIRTUAL_DOWN,ye.VIRTUAL_UP,ye.VIRTUAL_MOVE,ye.VIRTUAL_CLICK,ye.VIRTUAL_DOUBLE_CLICK,ye.VIRTUAL_WHEEL]),n}function Og(t,e,i,r,n,o){var a=Ct(),s=o.graphToScreenCoordinates(t),u=o.graphToScreenCoordinates(e);n.beginPath(),n.moveTo(s.x*a,s.y*a),n.lineTo(u.x*a,u.y*a),n.strokeStyle=r,n.lineWidth=i,n.stroke()}function Fg(t,e,i,r){for(var n,o,a=0,s=t.length-1;a<s;)n=(a+s)/2|0,o=Math.abs(e[t[n]]-i),Math.abs(e[t[1+n]]-i)<=o?a=1+n:s=n;return r?s:t[s]}function Rg(t,e,i,r,n,o,a){for(var s,u,d=0,l=t.length;d<l;d++)for(var h=0;h<l;h++)if(d!==h){var c=t[d],f=t[h];h<d&&(s=f,f=c,c=s);var g=e[c],p=e[f],_=o.get(c),v=o.get(f);if(g+_<r-n&&r+n<p-v&&Math.abs(Math.abs(g+_-(r-n))-Math.abs(p-v-(r+n)))<=a)return{a:c,b:i,c:f,current:i,target:u=g+_+Math.abs(p-v-(g+_))/2,points:[g+_,u-n,u+n,p-v]};if(g+_<r-n&&p+v<r-n&&Math.abs(Math.abs(g+_-(p-v))-Math.abs(Math.max(g+_,p+v)-(r-n)))<=a)return{a:c,b:f,c:i,current:i,target:u=p+_+Math.abs(Math.abs(g+_-(p-v)))+n,points:[g+_,p-v,p+v,u-n]};if(r+n<g-_&&r+n<p-v&&Math.abs(Math.abs(g+_-(p-v))-Math.abs(Math.min(g-_,p-v)-(r+n)))<=a)return{a:i,b:c,c:f,current:i,target:u=g-_-Math.abs(Math.abs(g+_-(p-v)))-n,points:[u+n,g-_,g+_,p-v]}}return null}var Pg,Dg,zg={tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}};(Dg=Pg=Pg||{})[Dg.NONE=0]="NONE",Dg[Dg.CENTER=1]="CENTER",Dg[Dg.LEFT=2]="LEFT",Dg[Dg.RIGHT=3]="RIGHT",Dg[Dg.TOP=4]="TOP",Dg[Dg.BOTTOM=5]="BOTTOM";var Bg,Ug=(E(Vg,Bg=xe),Vg.prototype.enable=function(t){var e=this;this._enabled||(this._options=tt(t,zg),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._events.on(ye.NODES_DRAG_START,this._onNodeDragStart),this._events.on(ye.NODES_DRAG_END,this._onNodeDragEnd),this._settings.update({"interactions.drag.onBeforeDrag":function(t,i,r,n){return e._onBeforeDrag(i,r,n)}}))},Vg.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._onNodeDragStart),this._events.removeListener(this._onNodeDragEnd),this._graphics.removeCanvas(this._canvas),this._settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)},Vg.prototype.enabled=function(){return this._enabled},Vg.prototype._onBeforeDrag=function(t,e,i){if(this._node){var r=i[0];this._scan(r),this._node.setAttributes(r)}},Vg.prototype._cacheViewportData=function(){var t=this._camera,e=t.screenToGraphCoordinates({x:0,y:0}),i=t.screenToGraphCoordinates({x:t.width,y:t.height});if(this._nodes=this._spatial.getNodesByBoundingBox(e.x,e.y,i.x,i.y),null!=this._node){var r=this._node._index,n=Array.from(this._nodes._indexes);n.splice(n.indexOf(r),1);var o=this._graph.getNodeAttribute("radius"),a=this._graph.getNodeAttribute("x"),s=this._graph.getNodeAttribute("y"),u=a.buffer(),d=s.buffer(),l=k(n.slice(),a),h=k(n.slice(),s),c={},f={};this._gridResolution=this._node.getAttribute("radius");for(var g=this._gridResolution,p=0,_=n.length;p<_;p++){var v=l[p],m=h[p],y=u[v]/g|0,b=d[m]/g|0;c[y]||(c[y]=[]),f[b]||(f[b]=[]),c[y].push(v),f[b].push(m)}this._nodesByX=l,this._nodesByY=h,this._xGrid=c,this._yGrid=f,this._xList=a,this._yList=s,this._X=u,this._Y=d,this._R=o}},Vg.prototype._scan=function(t){if(tn(this._canvas,this._ctx),null!=this._node){var e,i,r,n,o,a,s,u,d=this._node._index,l=t.x,h=t.y,c=this._r,f=this._options,g=this._xList,p=this._yList,_=this._R,v=this._X,m=this._Y,y=this._camera.zoom,b=Math.min(c,this._options.tolerance/y),x=2*c*f.sideSnapDistanceFactor,E=f.guidelineWidth,A=f.guidelineColor,S=d,w=d,T=null,C=!1,M=!1;if(S=Fg(this._nodesByX,v,l),w=Fg(this._nodesByY,m,h),Math.abs(v[S]-l)>f.centerSnapDistance&&(S=d),Math.abs(m[w]-h)>f.centerSnapDistance&&(w=d),this._xsnap=Pg.NONE,S!==d){e=this._vguideline.start,i=this._vguideline.end,r=v[u=S],n=m[u],T=_.get(u),s=Math.abs(l-r);var I=Math.abs(l-c-(r-T)),L=Math.abs(l+c-(r+T));s<Math.max(c,T)&&(n<h?(e.y=n-T,i.y=h+c):(e.y=n+T,i.y=h-c),(N=Math.min(I,s,L))===s?(e.x=i.x=r,i.y=h,e.y=n,this._xsnap=Pg.CENTER):Math.abs(h-n)<T+c+x&&(N===I?(e.x=i.x=r-T,this._xsnap=Pg.LEFT):(e.x=i.x=r+T,this._xsnap=Pg.RIGHT)),N<b&&(C=!0)),this._xsnap!==Pg.NONE&&Og(e,i,E,A,this._ctx,this._camera)}if(this._ysnap=Pg.NONE,w!==d){e=this._hguideline.start,i=this._hguideline.end,r=v[u=w],n=m[u],T=_.get(u),s=Math.abs(h-n);var N,O=Math.abs(h-c-(n-T)),F=Math.abs(h+c-(n+T));s<Math.max(c,T)&&(r<l?(e.x=r-T,i.x=l+c):(e.x=r+T,i.x=l-c),(N=Math.min(O,s,F))===s?(e.y=i.y=n,i.x=l,e.x=r,this._ysnap=Pg.CENTER):Math.abs(l-r)<T+c+x&&(N===O?(e.y=i.y=n-T,this._ysnap=Pg.TOP):(e.y=i.y=n+T,this._ysnap=Pg.BOTTOM)),N<b&&(M=!0)),this._ysnap!==Pg.NONE&&Og(e,i,E,A,this._ctx,this._camera)}if(null!=T&&f.preferredDistance.enabled){var R=f.preferredDistance.ratio,P=Math.min(f.preferredDistance.tolerance/y,c),D=Math.max(c,T);if(S===d||this._xsnap!==Pg.NONE&&C)w!==d&&(this._ysnap===Pg.NONE||!M)&&(r=v[u=w],n=m[u],T=_.get(u),(a=Math.abs(h-n)-(c+T)*(1+R))<=P&&-P<=a)&&(z=h<n?-1:1,e=this._hguideline.start,i=this._hguideline.end,e.x=r-D,i.x=r+D,e.y=i.y=n,Og(e,i,E,A,this._ctx,this._camera),e.x=l-D,i.x=l+D,e.y=i.y=n+z*(1+R)*(c+T),Og(e,i,E,A,this._ctx,this._camera),this._ysnap=Pg.CENTER,M=!0);else if(r=v[u=S],n=m[u],T=_.get(u),(o=Math.abs(l-r)-(c+T)*(1+R))<=P&&-P<=o){var z=l<r?-1:1;e=this._vguideline.start,i=this._vguideline.end,e.x=i.x=r+z*(1+R)*(c+T),e.y=n-D,i.y=n+D,e.x=i.x=r,Og(e,i,E,A,this._ctx,this._camera),e.y=h-D,i.y=h+D,e.x=i.x=r+z*(1+R)*(c+T),Og(e,i,E,A,this._ctx,this._camera),this._xsnap=Pg.CENTER,C=!0}}if(f.neighbours.enabled){var B=this._gridResolution,U=l/B|0,V=h/B|0,j=this._xGrid,G=this._yGrid,H=[],W=[].concat(G[V-1]||H,G[V]||H,G[1+V]||H),q=[].concat(j[U-1]||H,j[U]||H,j[1+U]||H),X=void 0;1<W.length&&(k(W,g),(X=Rg(W,v,d,l,c,_,b))&&(this._drawNeighbourGuidelines(X,t,!1),C=!1)),1<q.length&&!X&&(k(q,p),(X=Rg(q,m,d,h,c,_,b))&&(this._drawNeighbourGuidelines(X,t,!0),M=!1))}(C||M)&&this._snap(t,!C,!M)}},Vg.prototype._drawNeighbourGuidelines=function(t,e,i){var r,n,o=t.a,a=t.b,s=t.c,u=t.points,d=t.target,l={x:0,y:0},h={x:0,y:0},c=this._R,f=this._X,g=this._Y,p=c.getMultiple([o,a,s]),_=p[0],v=p[1],m=p[2],y=this._options.neighbours,b=y.offset,x=y.lineWidth,E=y.lineColor;n=i?(e.y=d,_=-_,v=-v,m=-m,r=h.x=l.x=Math.min(f[o]+_,f[a]+v,f[s]+m)-b,f):(e.x=d,r=h.y=l.y=Math.max(g[o]+_,g[a]+v,g[s]+m)+b,g);var A=i?"y":"x",S=i?"x":"y";l[A]=u[0],h[A]=u[1],Og(l,h,x,E,this._ctx,this._camera),l[A]=u[2],h[A]=u[3],Og(l,h,x,E,this._ctx,this._camera),l[A]=u[0],l[S]=r-b/2,h[A]=u[0],l[S]=n[o]+_,Og(l,h,x,E,this._ctx,this._camera),l[A]=u[1],l[S]=r-b/2,h[A]=u[1],l[S]=n[a]+v,Og(l,h,x,E,this._ctx,this._camera),l[A]=u[2],l[S]=r-b/2,h[A]=u[2],l[S]=n[a]+v,Og(l,h,x,E,this._ctx,this._camera),l[A]=u[3],l[S]=r-b/2,h[A]=u[3],l[S]=n[s]+m,Og(l,h,x,E,this._ctx,this._camera)},Vg.prototype._snap=function(t,e,i){var r,n=this._xsnap,o=this._ysnap;e||n===Pg.NONE||(r=this._vguideline.end,n===Pg.LEFT?t.x=r.x+this._r:n===Pg.RIGHT?t.x=r.x-this._r:t.x=r.x),i||o===Pg.NONE||(r=this._hguideline.end,o===Pg.TOP?t.y=r.y+this._r:o===Pg.BOTTOM?t.y=r.y-this._r:t.y=r.y)},Vg);function Vg(t){var e=t.graph,i=t.graphics,r=t.spatial,n=t.camera,o=t.events,a=t.settings,s=Bg.call(this)||this;return s._options=q(zg),s._enabled=!1,s._ysnap=Pg.NONE,s._xsnap=Pg.NONE,s._node=null,s._nodes=null,s._r=0,s._vguideline={start:{x:0,y:0},end:{x:0,y:0}},s._hguideline={start:{x:0,y:0},end:{x:0,y:0}},s._gridResolution=0,s._onNodeDragStart=function(t){var e=t.nodes;1===e.size&&(s._node=e.get(0),s._cacheViewportData(),s._r=s._node.getAttribute("radius"))},s._onNodeDragEnd=function(){s._node=null,tn(s._canvas,s._ctx)},s._graph=e,s._graphics=i,s._spatial=r,s._settings=a,s._events=o,s._camera=n,s._options=q(zg),s._enabled=!1,s._canvas=$r(),s._ctx=s._canvas.getContext("2d"),s}var jg=(Gg.prototype.getId=function(){return this._id},Gg.prototype.whenApplied=function(){return this._whenApplied},Gg.prototype.refresh=function(){return this._module.refreshRule(this._id)},Gg.prototype.getIndex=function(){return this._module.getRuleIndex(this._id)},Gg.prototype.setIndex=function(t){return this._module.setRuleIndex(this._id,t)},Gg.prototype.update=function(t){return this._module.updateRule(this._id,t)},Gg.prototype.getDefinition=function(){return this._module.getRuleDefinition(this._id)},Gg.prototype.destroy=function(){return this._module.destroyRule(this._id)},Gg.prototype.delete=function(){return this.destroy()},Gg);function Gg(t,e,i){var r=this;this._module=t,this._id=e,this._whenApplied=i.then((function(){return r}))}var Hg,Wg=(E(qg,Hg=xe),qg.prototype._get=function(t){for(var e=0;e<this._rules.length;++e){var i=this._rules[e];if(i.id===t)return i.index=e,i}throw new Error("calling a method on a destroyed style rule")},qg.prototype._updatePriorities=function(){for(var t=0;t<this._rules.length;++t){var e=3+.001*t;this._rules[t].attributeLayer.update({priority:e})}},qg.prototype.addRule=function(t){void 0===t&&(t={});var e=this._idCounter++,i=this._graphics.addAttributeLayer(A({name:"rule("+e+")"},Xg(t))),r=this._dom.afterNextFrame(),n=new jg(this,e,r),o={id:e,attributeLayer:i,wrapper:n};return this._rules.push(o),this._updatePriorities(),n},qg.prototype.getRuleIndex=function(t){var e=this._get(t);return null==e.index?null:e.index},qg.prototype.setRuleIndex=function(t,e){var i=this._get(t),r=qe(e,0,this._rules.length-1);return this._rules.splice(i.index,1),this._rules.splice(r,0,i),this._updatePriorities(),this._dom.afterNextFrame()},qg.prototype.updateRule=function(t,e){var i=this._get(t),r=Object.assign({fullOverwrite:e.fullOverwrite},Xg(e));return i.attributeLayer.update(r),this._dom.afterNextFrame()},qg.prototype.getRuleDefinition=function(t){return Xg(this._get(t).attributeLayer.getDefinition())},qg.prototype.destroyRule=function(t){var e=this._get(t);return e.attributeLayer.destroy(),this._rules.splice(e.index,1),this._dom.afterNextFrame()},qg.prototype.refreshRule=function(t){return this._get(t).attributeLayer.updateAll(),this._dom.afterNextFrame()},qg.prototype.refreshAllRules=function(){for(var t=0;t<this._rules.length;t++)this._rules[t].attributeLayer.updateAll();return this._dom.afterNextFrame()},qg.prototype.getRuleList=function(){return this._rules.map((function(t){return t.wrapper}))},qg);function qg(t){var e=t.graphics,i=t.dom,r=Hg.call(this)||this;return r._idCounter=1,r._rules=[],r._graphics=e,r._dom=i,r._rules=[],r}function Xg(t){return{nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeSelector:t.nodeSelector,edgeSelector:t.edgeSelector,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput}}var Yg,Zg={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(t){return t.nodes.setSelected(!0)},bothExtremities:!1},Kg=(E(Qg,Yg=xe),Qg.prototype.enable=function(t){return void 0===t&&(t={}),this._enabled||(this._enabled=!0,this._captor.setDetectionEnabled(!1),this._options=tt(t,Zg),this._graphics.addCanvas(this._canvas),Gt(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition())),this},Qg.prototype.disable=function(){return this._enabled&&(this._enabled=!1,this._captor.setDetectionEnabled(!0),this._graphics.removeCanvas(this._canvas)),this},Qg.prototype.enabled=function(){return this._enabled},Qg.prototype.savePoint=function(t,e,i){var r=Ct(),n=this._ctx,o=this._options,a=this._points;if(this._bbox.addPoint(t,e),n.clearRect(0,0,this._canvas.width,this._canvas.height),a.push({x:t,y:e}),i){var s=a[0];n.lineWidth=o.strokeWidth,n.lineJoin="bevel",n.strokeStyle=o.strokeColor,n.fillStyle=o.fillColor,n.beginPath(),n.moveTo(s.x*r,s.y*r);for(var u=1;u<a.length;++u){var d=a[u];n.lineTo(d.x*r,d.y*r)}n.stroke(),o.fillColor&&n.fill()}},Qg.prototype.filterByExtremities=function(t,e){var i=this._graph.getEdgeAttribute("source"),r=this._graph.getEdgeAttribute("target");return t.filter((function(t){var n=t._index,o=i.get(n),a=r.get(n);return e[o]&&e[a]}))},Qg);function Qg(t){var e=t.locate,i=t.graphics,r=t.captor,n=t.graph,o=t.spatial,a=t.interactions,s=Yg.call(this)||this;return s._enabled=!1,s._points=[],s._bbox=new ko,s._onStart=function(t){var e=t.x,i=t.y;s._bbox.reset(),s.savePoint(e,i,!1)},s._onStop=function(){var t=s._bbox,e=t.minX,i=t.minY,r=t.maxX,n=t.maxY,o=s._spatial.queryProjected(e,i,r,n),a=o.nodes,u=o.edges,d={},l=a.filter((function(t){var e=t.isVisible(),i=t.getAttribute("detectable"),r=e&&i&&s._locate.isNodeInPolygon(t,s._points);return d[t._index]=r})),h=u.filter((function(t){var e=t.isVisible(),i=t.getAttribute("detectable");return e&&i&&s._locate.isEdgeInPolygon(t,s._points)}));s._options.bothExtremities&&(h=s.filterByExtremities(h,d)),s._ctx.clearRect(0,0,s._canvas.width,s._canvas.height),s._points=[],s.disable(),s._options.callback({nodes:l,edges:h})},s._locate=e,s._graph=n,s._graphics=i,s._captor=r,s._interactions=a,s._spatial=o,s._options=q(Zg),s._canvas=$r(),s._ctx=s._canvas.getContext("2d"),s._interaction=s._interactions.onDrag({priority:"lasso",check:function(){return s._enabled},onStart:s._onStart,onProgress:function(t){var e=t.x,i=t.y;return s.savePoint(e,i,!0)},onStop:s._onStop}),s}var Jg,$g={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(t){var e=t.nodes,i=t.edges;e.size?e.setSelected(!0):i.setSelected(!0)},bothExtremities:!1},tp=(E(ep,Jg=Kg),ep.prototype.enable=function(t){return this._enabled||(this._enabled=!0,this._options=tt(t,$g),this._graphics.addCanvas(this._canvas),Gt(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition())),this},ep.prototype.disable=function(){return this._enabled&&(this._enabled=!1,this._graphics.removeCanvas(this._canvas)),this},ep.prototype.enabled=function(){return this._enabled},ep.prototype._formatRectangle=function(t){var e=this._start.x,i=this._start.y,r=t.x,n=t.y,o=Math.abs(e-r),a=Math.abs(i-n),s=e<r?e:r,u=i<n?i:n;return this._rectangle.reset().addPoint(s,u).addPoint(s+o,u+a)},ep.prototype._refreshRectangle=function(t){var e=this._formatRectangle(t),i=e.minX,r=e.minY,n=e.width,o=e.height,a=Ct();tn(this._canvas,this._ctx),this._ctx.strokeRect(i*a,r*a,n*a,o*a),this._options.fillColor&&this._ctx.fillRect(i*a,r*a,n*a,o*a)},ep);function ep(t){var e=Jg.call(this,t)||this;return e._options=q($g),e._canvas=$r(),e._ctx=e._canvas.getContext("2d"),e._enabled=!1,e._rectangle=new ko,e._interaction=e._interactions.onDrag({priority:"lasso",disableDetection:!0,check:function(){return e._enabled},onStart:function(t){var i=t.x,r=t.y;e._rectangle.reset(),e._start={x:i,y:r},e._ctx.fillStyle=e._options.fillColor,e._ctx.strokeStyle=e._options.strokeColor,e._ctx.lineWidth=e._options.strokeWidth},onProgress:function(t){var i=t.x,r=t.y;return e._refreshRectangle({x:i,y:r})},onStop:function(){var t=e._captor.getCursorPosition(),i=e._formatRectangle(t),r=e._spatial.queryProjected(i.minX,i.minY,i.maxX,i.maxY),n=r.nodes,o=r.edges,a={},s=n.filter((function(t){var r=t.isVisible(),n=t.getAttribute("detectable"),o=r&&n&&e._locate.isNodeInRectangle(t,i);return a[t._index]=o})),u=o.filter((function(t){var r=t.isVisible(),n=t.getAttribute("detectable");return r&&n&&e._locate.isEdgeInRectangle(t,i)}));e._options.bothExtremities&&(u=e.filterByExtremities(u,a)),tn(e._canvas,e._ctx),e.disable(),e._options.callback({nodes:s,edges:u})}}),e}var ip={left:-1,right:1,top:0,bottom:0,center:0},rp={left:0,right:0,top:-1,bottom:1,center:0},np={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},op={left:-.5,right:-.5,top:-1,bottom:0,center:-.5},ap={x1:0,y1:0,x2:0,y2:0},sp={x:0,y:0},up={x:0,y:0},dp=Math.PI/2;function lp(t,e,i,r){void 0===r&&(r="#ff0000"),e.strokeStyle=r,e.lineWidth=1,e.beginPath();for(var n=Ct(),o=0,a=t.length;o<a;o++){var s=i.graphToScreenCoordinates(t[o]);0===o?e.moveTo(s.x*n,s.y*n):e.lineTo(s.x*n,s.y*n)}e.closePath(),e.stroke()}var hp,cp=["x","y","radius","width","layer","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"].reduce((function(t,e){return t.add(e),t}),new Set),fp=(E(gp,hp=xe),gp.prototype.getTextsBoundingBox=function(){this._updateLabels();for(var t=this._rects,e=this._textBBoxes,i=new ko,r=this._graphics.getNodeAttributes(),n=this._graphics.getEdgeAttributes(),o=r.excluded,a=n.excluded,s=0;s<t.length;s++){var u=5*s,d=1===e[6*s+4],l=e[6*s+4];if(!(d?o.get(l):a.get(l))){var h=Qc(t[u],t[1+u],t[2+u],t[3+u],t[4+u]),c=h[0],f=h[1],g=h[2],p=h[3];i.addPoint(c,f).addPoint(g,p)}}return i},gp.prototype.setRate=function(t){var e=this;this._updateDebounced=this._sync.debounceIdle((function(t){return e._updateLabels(t)}),t)},gp.prototype.forceEnable=function(){this._forceEnabled=!0},gp.prototype.update=function(){this._update()},gp.prototype.forceUpdate=function(){this._updateLabels()},gp.prototype._enable=function(){this._enabled=!0,this._update()},gp.prototype._disable=function(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1},gp.prototype._onCameraMove=function(){this._update()},gp.prototype._updateLabels=function(t){if(void 0===t&&(t=this._camera.getZoom()),this._settings.get("texts.preventOverlap")){var e=this._graphics.getNodeAttributes(),i=this._graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];var r=this._textQuad.clear(),n=this._camera.getAngle(),o=this._camera.getProjectedScreenBounds(.25),a="bottomUp"===this._settings.get("texts.removalStrategy"),s={angle:n,zoom:t,screen:o,sin:Math.sin(n),cos:Math.cos(n)},u={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects},d=this._spatial.queryRaw(o[0],o[1],o[2],o[3]),l=d.nodes,h=d.edges;if(l.length+h.length!==0){var c=this._captor.getPointedElement(),f=null,g=null;null!==c&&(c.isNode?f=c._index:g=c._index),function(t,e,i,r,n,o,a,s){for(var u,d,l=a.remove.nodes,h=a.remove.edges,c=a.redraw.nodes,f=i.angle,g=i.zoom,p=i.sin,_=i.cos,v=r.x,m=r.y,y=r.radius,b=r.layer,x=r.innerStroke.width,E=r.outerStroke.width,A=r.scalingMethod,S=r.text.content,w=r.text.position,T=r.text.size,C=r.text.font,M=r.text.style,I=r.text.maxLineLength,L=r.text.scaling,N=r.text.scale,k=r.text.minVisibleSize,O=r.text.padding,F=r.text.margin,R=r.animationDuration,P=r.textHidden,D=r.excluded,z=[],B=0;B<t.length;B++){var U=t[B];(z[X=b.get(U)- -1]=z[X]||[]).push(U)}null!==s&&z[z.length-1].unshift(s);for(var V=[0,0,0,0],j=[0,0,0,0,0],G=a.bboxes,H=a.rects,W=a.intersects,q=z.length-1;0<=q;q--){var X;if(X=z[q])for(B=0;B<X.length;B++){u=X[B];var Y=R.get(u),Z=S.get(u);if(null!==Z&&""!==Z&&0===Y){var K=y.get(u),Q=k.get(u);if(1!==D.get(u))if(2*K*g<Q)0===P.get(u)&&l.push(u);else{"fixed"===A.get(u)&&(K/=g);var J=v.get(u),$=m.get(u);"number"==typeof Z&&(Z=Z.toString());for(var tt=!L.get(u),et=w.get(u),it=O.get(u),rt=N.get(u),nt=+(tt?T.get(u):rt*K),ot=M.get(u),at=C.get(u),st=Yo(Z,I.get(u)),ut=st.lines,dt=st.data,lt=it+x.get(u)+E.get(u)+F.get(u),ht=ip[et],ct=rp[et],ft=n(dt[0],at,ot,nt).width,gt=1;gt<ut;gt++)ft=Math.max(ft,n(dt[gt],at,ot,nt).width);var pt=ut*nt*1,_t=ft/2/g,vt=pt/2/g,mt=lt/g,yt=np[et]*ft,bt=op[et]*pt;tt&&(yt/=g,bt/=g),yt=yt+ht*mt+_t+ht*K,bt=bt+ct*mt+vt+ct*K,Qc(J-_t,$-vt,ft/g,pt/g,-f,p,-_,V),j[0]=J-_t,j[1]=$-vt,j[2]=ft/g,j[3]=pt/g,j[4]=f;var xt=_*yt-p*bt,Et=p*yt+_*bt;V[0]+=xt,V[1]+=Et,V[2]+=xt,V[3]+=Et,j[0]+=xt,j[1]+=Et;var At=e.query(V[0],V[1],V[2],V[3]);if(0!==At.length){for(var St=!1,wt=Jc(j[0],j[1],j[2],j[3],j[4]),Tt=0;Tt<At.length;Tt++){var Ct=At[Tt],Mt=5*Ct,It=Jc(H[Mt],H[1+Mt],H[2+Mt],H[3+Mt],H[4+Mt]);if(el(wt,It)){if(W.push(wt,It),St=!0,!o)break;e.remove(Ct),1===G[6*Ct+4]?l.push(G[6*Ct+5]):h.push(G[6*Ct+5])}}if(St&&!o){l.push(u);continue}}c.push(u),d=G.length/6,G.push(V[0],V[1],V[2],V[3],1,u),e.insert(d,V),H.push(j[0],j[1],j[2],j[3],j[4])}else l.push(u)}}}}(l,r,s,e,this._measureText,a,u,f),function(t,e,i,r,n,o,a,s,u){for(var d,l,h=s.remove.nodes,c=s.remove.edges,f=s.redraw.edges,g=i.angle,p=i.zoom,_=n.x,v=n.y,m=n.radius,y=Math.PI,b=r.source,x=r.target,E=r.scalingMethod,A=r.width,S=r.curvature,w=r.layer,T=r.text.content,C=r.text.scaling,M=r.text.size,I=r.text.font,L=r.text.style,N=r.text.scale,k=r.text.maxLineLength,O=r.text.margin,F=r.text.minVisibleSize,R=r.animationDuration,P=[],D=0;D<t.length;D++){var z=t[D];(P[W=w.get(z)- -1]=P[W]||[]).push(z)}null!==u&&P[P.length-1].unshift(u);for(var B=[0,0,0,0],U=[0,0,0,0,0],V=s.bboxes,j=s.rects,G=s.intersects,H=P.length-1;0<=H;H--){var W;if(W=P[H])for(D=0;D<W.length;D++){d=W[D];var q=R.get(d),X=T?T.get(d):"";if(null!==X&&""!==X&&!q){var Y=b.get(d),Z=x.get(d),K=A.get(d),Q=S.get(d);if(!(K*p<F.get(d))){"fixed"===E.get(d)&&(K/=p);var J=(_.get(Y)+_.get(Z))/2,$=(v.get(Y)+v.get(Z))/2;X=X?X.toString():"";var tt=!C.get(d),et=N.get(d),it=I.get(d),rt=+(tt?M.get(d):et*K),nt=L.get(d),ot=k.get(d),at=O.get(d),st=_.get(Y),ut=v.get(Y),dt=_.get(Z),lt=v.get(Z),ht=void 0,ct=Y===Z;if(ct)ht=y/4-g,Ta(st,ut,Q,m.get(Y),0,ap),Bs(.5,st,ut,dt,lt,ap.x1,ap.y1,ap.x2,ap.y2,up),J=up.x,$=up.y,at/=-p;else{if(st===dt&&ut===lt)continue;ht=Ss(st,ut,dt,lt)-g,0!==Q&&(ht=Ss(st,ut,dt,lt)-g,wa(st,ut,dt,lt,Q,sp),Ds(.5,st,ut,dt,lt,sp.x,sp.y,up),J=up.x,$=up.y)}var ft=at+4,gt=Yo(X,ot);if(gt){for(var pt=gt.lines,_t=gt.data,vt=+o(_t[0],it,nt,rt).width,mt=1;mt<pt;mt++)vt=Math.max(vt,+o(_t[mt],it,nt,rt).width);var yt=pt*rt,bt=vt/p/2,xt=yt/p/2,Et=Math.abs(ht)<dp?1:-1,At=ct?yt/p+K/2:Et*(ft/p+K/2+xt);U[0]=J-bt,U[1]=$-xt,U[2]=J+bt,U[3]=$+xt,U[4]=ht+g,$c(U,-(ht+g),-At,U),U[2]=U[2]-U[0],U[3]=U[3]-U[1],Qc(J-bt,$-xt,2*bt,2*xt,ht=y-ht-g,void 0,void 0,B),$c(B,ht,At,B);var St=e.query(B[0],B[1],B[2],B[3]);if(St.length){for(var wt=!1,Tt=Jc(U[0],U[1],U[2],U[3],U[4]),Ct=0;Ct<St.length;Ct++){var Mt=St[Ct],It=5*Mt,Lt=Jc(j[It],j[1+It],j[2+It],j[3+It],j[4+It]);if(el(Tt,Lt)){if(wt=!0,G.push(Tt,Lt),!a)break;e.remove(Mt),1===V[6*Mt+4]?h.push(V[6*Mt+5]):c.push(V[6*Mt+5])}}if(wt&&!a){c.push(d);continue}}f.push(d),l=V.length/6,V.push(B[0],B[1],B[2],B[3],0,d),e.insert(l,B),j.push(U[0],U[1],U[2],U[3],U[4])}}}}}}(h,r,s,i,e,this._measureText,a,u,g),this._clearOverlaps(u),this._settings.get("texts.debug")&&this.drawAll()}}},gp.prototype._clearOverlaps=function(t){var e=this._graph.nodeList,i=this._graph.edgeList,r=this._graphics,n=e(new Uint32Array(t.remove.nodes)),o=i(new Uint32Array(t.remove.edges)),a=e(new Uint32Array(t.redraw.nodes)),s=i(new Uint32Array(t.redraw.edges));r.setTextHidden(n,!0),r.setTextHidden(o,!0),r.setTextHidden(a,!1),r.setTextHidden(s,!1),this._events.fire("labelCollisionsRemoved",t)},gp.prototype._reset=function(){this._graphics.resetTextHidden()},gp.prototype.drawAll=function(){this._canvas&&this._ctx&&function(t,e,i,r,n,o){t.clearRect(0,0,e.width,e.height);for(var a=0,s=r.length;a<s;a+=6)u=r.slice(a,a+4),d=t,l=i,void 0===(h="#aaaaaa")&&(h="#22ff00"),lp([[u[0],u[1]],[u[2],u[1]],[u[2],u[3]],[u[0],u[3]]].map((function(t){return{x:t[0],y:t[1]}})),d,l,h);var u,d,l,h;for(a=0;a<n.length;a+=5)lp(Jc(n[a],n[a+1],n[a+2],n[a+3],n[a+4]),t,i,"green");o.forEach((function(e){return lp(e,t,i,"red")}))}(this._ctx,this._canvas,this._camera,this._textBBoxes,this._rects,this._intersects)},gp);function gp(t,e){var i,r=t.graph,n=t.graphics,o=t.camera,a=t.events,s=t.settings,u=t.sync,d=t.spatial,l=t.captor,h=hp.call(this)||this;return h._textBBoxes=[],h._rects=[],h._enabled=!1,h._intersects=[],h._onZoomStart=B((function(t){var e=t.startZoom,i=t.endZoom;h._enabled&&i<e&&h._updateLabels(i)}),80),h._onAttributesChanged=function(t){w(t.edgeAttributes,t.nodeAttributes).some((function(t){return cp.has(t)}))&&h._update()},h._onItemsAdded=function(t){var e=t.nodes||t.edges;(h._enabled||h._forceEnabled)&&h._settings.get("texts.preventOverlap")&&h._graphics.setTextHidden(e,!0)},h._onToggle=function(t){return t?h._update():h._reset(),h},h._update=function(){(h._enabled||h._forceEnabled)&&h._updateDebounced()},h._toggleDebug=function(t){t?(h._canvas=$r(),h._graphics.addCanvas(h._canvas),h._ctx=h._canvas.getContext("2d"),h._update()):h._canvas&&(h._graphics.removeCanvas(h._canvas),h._canvas=h._ctx=null)},h._measureText=function(t,e,i,r){return h._engine.measureText(t,e,i,r)},h._graph=r,h._graphics=n,h._camera=o,h._events=a,h._settings=s,h._sync=u,h._spatial=d,h._captor=l,h._engine=n.getGraphicsEngine(),h._textQuad=new uf((function(t){var e=6*t;return h._textBBoxes.slice(e,6+e)}),5),e.forceEnableTextOverlapRemoval&&h.forceEnable(),h._events.register(["labelCollisionsRemoved"]),h.setRate(200),s.register("texts.preventOverlap",!0,h._onToggle),s.register("texts.debug",!1,h._toggleDebug),s.register("texts.removalStrategy","topDown"),a.on(((i={})[[ye.ADD_NODES,ye.ADD_EDGES].join(" ")]=h._onItemsAdded,i[ye.LAYOUT_END]=function(){return h._updateLabels()},i[[ye.VIEW_CHANGED,ye.HOVER,ye.UNHOVER].join(" ")]=h._update,i[ye.UPDATE_ATTRIBUTES]=h._onAttributesChanged,i[ye.SET_CONTAINER]=function(t){if(t.element)return h._enable();h._disable()},i[ye.START_ZOOM]=h._onZoomStart,i)),h}function pp(){}function _p(){return!1}var vp,mp,yp=(bp.prototype._startInteraction=function(t,e){t.onStart&&t.onStart(e),t.onStop&&(this._current=t).disableDetection&&this._captor.setDetectionEnabled(!1)},bp.prototype._stopCurrentInteraction=function(t){this._current&&this._current.disableDetection&&this._captor.setDetectionEnabled(!0),this._current&&this._current.onStop&&this._current.onStop(t),this._current=void 0},bp.prototype._forceStartInteraction=function(t,e){this._current&&this._stopCurrentInteraction(e),this._startInteraction(t,e)},bp.prototype._createWrapper=function(t){var e=this;return{start:function(i){return e._forceStartInteraction(t,i)}}},bp.prototype._addInteraction=function(t,e){var i=this._interactionsByStartEvent[t];return i?i.push(e):(this._interactionsByStartEvent[t]=[e],this._events.on(t,this._onStartInteractionEvent)),this._createWrapper(e)},bp.prototype._createProgressiveInteraction=function(t,e,i,r){var n={priority:xp(r.priority),check:r.check||_p,onStart:r.onStart||pp,onProgress:r.onProgress||pp,onStop:r.onStop||pp,disableDetection:!!r.disableDetection,progressEventName:e,stopEventName:i};return this._boundProgressEvents[e]||(this._boundProgressEvents[e]=!0,this._events.on(e,this._onProgressInteractionEvent)),this._boundStopEvents[i]||(this._boundStopEvents[i]=!0,this._events.on(i,this._onStopInteractionEvent)),this._addInteraction(t,n)},bp.prototype._createNonProgressiveInteraction=function(t,e){return this._addInteraction(t,{priority:xp(e.priority),check:e.check||_p,onStart:e.handler||pp,onProgress:void 0,onStop:void 0,disableDetection:!1,progressEventName:void 0,stopEventName:void 0})},bp.prototype.onDrag=function(t){return this._createProgressiveInteraction(ye.DRAG_START,ye.DRAG_PROGRESS,ye.DRAG_END,t)},bp.prototype.onGesture=function(t){return this._createProgressiveInteraction(ye.GESTURE_START,ye.GESTURE_PROGRESS,ye.GESTURE_END,t)},bp.prototype.onClick=function(t){return this._createNonProgressiveInteraction(ye.CLICK,t)},bp.prototype.onDoubleClick=function(t){return this._createNonProgressiveInteraction(ye.DOUBLE_CLICK,t)},bp.prototype.onHover=function(t){return this._createNonProgressiveInteraction(ye.HOVER,t)},bp.prototype.onUnhover=function(t){return this._createNonProgressiveInteraction(ye.UNHOVER,t)},bp.prototype.onMouseWheel=function(t){return this._createNonProgressiveInteraction(ye.WHEEL,t)},bp.prototype.onMouseDown=function(t){return this._createNonProgressiveInteraction(ye.DOWN,t)},bp.prototype.onMouseUp=function(t){return this._createNonProgressiveInteraction(ye.UP,t)},bp.prototype.onMouseMove=function(t){return this._createNonProgressiveInteraction(ye.MOVE,t)},bp);function bp(t){var e=this,i=t.captor,r=t.events;this._onStartInteractionEvent=function(t,i){if(!e._current){for(var r,n=0,o=e._interactionsByStartEvent[i];n<o.length;n++){var a=o[n];a.check(t)&&(!r||a.priority>=r.priority)&&(r=a)}r&&e._startInteraction(r,t)}},this._onProgressInteractionEvent=function(t,i){e._current&&e._current.progressEventName===i&&e._current.onProgress&&e._current.onProgress(t)},this._onStopInteractionEvent=function(t,i){e._current&&e._current.stopEventName===i&&e._stopCurrentInteraction(null)},this._captor=i,this._events=r,this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}function xp(t){return"string"==typeof t?yi.indexOf(t):"number"!=typeof t||isNaN(t)?0:t}(mp=vp=vp||{}).MOUSE="mouse",mp.TOUCH="touch";var Ep,Ap=[ye.VIRTUAL_UP,ye.MOUSE_UP,ye.TOUCH_UP].join(" "),Sp=[ye.VIRTUAL_DOWN,ye.MOUSE_DOWN,ye.TOUCH_DOWN].join(" "),wp=[ye.VIRTUAL_MOVE,ye.MOUSE_MOVE,ye.TOUCH_MOVE].join(" "),Tp=[ye.VIRTUAL_CLICK,ye.MOUSE_CLICK,ye.TOUCH_TAP].join(" "),Cp=[ye.VIRTUAL_DOUBLE_CLICK,ye.MOUSE_DOUBLE_CLICK,ye.TOUCH_DOUBLE_TAP].join(" "),Mp=[ye.VIRTUAL_WHEEL,ye.MOUSE_WHEEL].join(" "),Ip=(E(Lp,Ep=xe),Lp.prototype.triggerUnhover=function(){this._hover=!1,this._hoveredElt=null},Lp.prototype.triggerDetection=function(){this._detectElement(this._position.x,this._position.y),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)},Lp.prototype.getElementAt=function(t,e){var i=t.x,r=t.y;return this._detectElementAt(i,r,e)},Lp.prototype.getPointedElement=function(){return this._hoveredElt},Lp.prototype.getDraggedElement=function(){return this._draggedElt},Lp.prototype.isAnyButtonPressed=function(){return this._buttons[Ih.LEFT].isPressed||this._buttons[Ih.RIGHT].isPressed||this._buttons[Ih.MIDDLE].isPressed},Lp.prototype.isAnyButtonDragging=function(){return this._buttons[Ih.LEFT].isDragging||this._buttons[Ih.RIGHT].isDragging||this._buttons[Ih.MIDDLE].isDragging},Lp.prototype.isButtonPressed=function(t){return this._buttons[t].isPressed},Lp.prototype.isLeftPressed=function(){return this.isButtonPressed(Ih.LEFT)},Lp.prototype.getCursorPosition=function(){return{x:this._position.x,y:this._position.y}},Lp.prototype.getCursorInformation=function(){return{x:this._position.x,y:this._position.y,target:this._hoveredElt}},Lp.prototype.setDetectionEnabled=function(t){this._disabledCounter=Math.max(0,this._disabledCounter+(t?-1:1))},Lp.prototype._resetCurrent=function(t,e){for(var i in this._buttons){var r=this._buttons[i];r.isDragging&&this._events.fire(ye.DRAG_END,{domEvent:null,x:t,y:e,button:i,target:this._draggedElt}),r.isPressed=!1,r.isDragging=!1}this._hover&&this._hoveredElt&&this._events.fire(ye.UNHOVER,{domEvent:null,x:t,y:e,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null},Lp.prototype._onMove=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.source,o=this._setPointerPosition(i,r),a=o.dx,s=o.dy;for(var u in this._events.fire(ye.MOVE,{domEvent:e,x:i,y:r,dx:a,dy:s,source:n}),this._buttons){var d=this._buttons[u];if(d.isPressed)if(d.isDragging){var l=this._getStoredDXY();a+=l.dx,s+=l.dy,this._events.fire(ye.DRAG_PROGRESS,{domEvent:e,x:i,y:r,dx:a,dy:s,button:u,source:n,target:this._draggedElt})}else d.isDragging=!0,this._hoveredElt&&this._hover&&(this._events.fire(ye.UNHOVER,{domEvent:e,x:i,y:r,source:n,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(a,s),this._events.fire(ye.DRAG_START,{domEvent:e,x:i,y:r,button:u,source:n,target:this._draggedElt})}e&&!this._graphics.getDomElement().contains(e.target)||this._detectElement(i,r),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._events.fire(ye.UNHOVER,{domEvent:e,x:i,y:r,source:n,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._events.fire(ye.HOVER,{domEvent:e,x:i,y:r,source:n,target:this._hoveredElt})))},Lp.prototype._onDocumentMove=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.source;for(var o in this._buttons)if(this._buttons[o].isDragging){var a=this._setPointerPosition(i,r),s=a.dx,u=a.dy;this._events.fire(ye.DRAG_PROGRESS,{domEvent:e,x:i,y:r,dx:s,dy:u,button:o,source:n,target:this._draggedElt})}},Lp.prototype._onDocumentUp=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.source,o=t.button;if(null!=o&&this._buttons[o].isDragging){this._events.fire(ye.DRAG_END,{domEvent:e,x:i,y:r,button:o,source:n,target:this._draggedElt});var a=this._buttons[o];a.isDragging=!1,a.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}},Lp.prototype._onDown=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.button,o=t.source;if(null!=n){this._detectElement(i,r),this._elt!==this._hoveredElt&&this._resetCurrent(i,r);var a=this._buttons[n];this._hoveredElt=this._elt,a.isPressed=!0,this._events.fire(ye.DOWN,{domEvent:e,x:i,y:r,button:n,source:o,target:this._hoveredElt})}},Lp.prototype._onDoubleClick=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.button,o=t.source;null!=n&&(Fp(e,"doubleclick")||this._events.fire(ye.DOUBLE_CLICK,{domEvent:e,x:i,y:r,button:n,source:o,target:this._hoveredElt}))},Lp.prototype._onUp=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.button,o=t.source;if(null!=n){var a=this._buttons[n];a.isPressed&&(a.isDragging&&(this._events.fire(ye.DRAG_END,{domEvent:e,x:i,y:r,button:n,source:o,target:this._draggedElt}),a.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),a.isPressed=!1,this._detectElement(i,r),this._events.fire(ye.UP,{domEvent:e,x:i,y:r,button:n,source:o,target:this._elt}),this.isAnyButtonPressed()||this._hover||o===vp.TOUCH||(this._hoveredElt=this._elt,this._hoveredElt&&(this._events.fire(ye.HOVER,{domEvent:e,x:i,y:r,source:o,target:this._hoveredElt}),this._hover=!0)))}},Lp.prototype._onClick=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.button,o=t.source;Fp(e,"click")||this._events.fire(ye.CLICK,{domEvent:e,x:i,y:r,button:n,source:o,target:this._hoveredElt})},Lp.prototype._onWheel=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.delta,o=t.source;this._position.x=i,this._position.y=r,this._events.fire(ye.WHEEL,{domEvent:e,x:i,y:r,delta:n,source:o,target:this._hoveredElt})},Lp.prototype._storeDXY=function(t,e){this._accDx=t,this._accDy=e},Lp.prototype._getStoredDXY=function(){var t=this._accDx,e=this._accDy;return this._accDx=0,this._accDy=0,{dx:t,dy:e}},Lp.prototype._setPointerPosition=function(t,e){var i=t-this._prevX,r=e-this._prevY;return this._position.x=t,this._position.y=e,this._prevX=t,this._prevY=e,this._accDx=0,this._accDy=0,{dx:i,dy:r}},Lp.prototype._detectElement=function(t,e,i){this._elt=this._detectElementAt(t,e,i)},Lp.prototype._detectElementAt=function(t,e,i){if(0!==this._disabledCounter)return null;var r=this._settings,n=r.get("detect.enableSpatialIndex"),o=r.get("detect.nodeErrorMargin"),a=r.get("detect.edgeErrorMargin"),s=r.get("detect.nodes"),u=r.get("detect.edges"),d=null,l=[],h=[];if(!i&&n&&(s||u)){var c=r.get("detect.spatialIndexMarginRatio"),f=Math.max(o*c,a*c),g=this._spatial.queryRawProjected(t-f,e-f,t+f,e+f);l=g.nodes,h=g.edges}return s&&(d=this._graphics.detectNode({x:t,y:e,indexes:l,margin:o,texts:!!r.get("detect.nodeTexts")})),!d&&u&&(d=this._graphics.detectEdge({x:t,y:e,indexes:h,margin:a,texts:!!r.get("detect.edgeTexts")})),d},Lp);function Lp(t){var e,i,r=t.dom,n=t.events,o=t.graphics,a=t.spatial,s=t.settings,u=t.position,d=Ep.call(this)||this;return d._elt=null,d._hoveredElt=null,d._draggedElt=null,d._hover=!1,d._disabledCounter=0,d._accDx=0,d._accDy=0,d._prevX=0,d._prevY=0,d._buttons=((e={})[Ih.LEFT]={isPressed:!1,isDragging:!1},e[Ih.MIDDLE]={isPressed:!1,isDragging:!1},e[Ih.RIGHT]={isPressed:!1,isDragging:!1},e),d._onGraphChanged=function(){d._resetCurrent(d._position.x,d._position.y),d._timeout||(d._timeout=d._dom.setTimeout((function(){d._onMove({x:d._position.x,y:d._position.y,source:null,domEvent:null}),d._timeout=null}),0))},d._dom=r,d._graphics=o,d._events=n,d._settings=s,d._spatial=a,d._position=u,n.register([ye.MOVE,ye.DOWN,ye.UP,ye.CLICK,ye.DOUBLE_CLICK,ye.HOVER,ye.UNHOVER,ye.WHEEL,ye.DRAG_START,ye.DRAG_PROGRESS,ye.DRAG_END,ye.GESTURE_START,ye.GESTURE_PROGRESS,ye.GESTURE_END]),s.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",7).register("detect.enableSpatialIndex",!0).register("detect.spatialIndexMarginRatio",3),n.on(((i={})[[ye.REMOVE_NODES,ye.REMOVE_EDGES,ye.CLEAR_GRAPH].join(" ")]=d._onGraphChanged,i[wp]=function(t,e){var i=t.domEvent,r=t.x,n=t.y;d._onMove({domEvent:i,x:r,y:n,source:Np(e)})},i[Sp]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,a=void 0===o?Ih.LEFT:o;d._onDown({domEvent:i,x:r,y:n,button:a,source:Np(e)})},i[Ap]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,a=void 0===o?Ih.LEFT:o;d._onUp({domEvent:i,x:r,y:n,button:a,source:Np(e)})},i[Tp]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,a=void 0===o?Ih.LEFT:o;d._onClick({domEvent:i,x:r,y:n,button:a,source:Np(e)})},i[Cp]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,a=void 0===o?Ih.LEFT:o;d._onDoubleClick({domEvent:i,x:r,y:n,button:a,source:Np(e)})},i[Mp]=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.delta;d._onWheel({domEvent:e,x:i,y:r,delta:n,source:vp.MOUSE})},i.touchStartGesture=function(t){return n.fire(ye.GESTURE_START,t)},i.touchProgressGesture=function(t){return n.fire(ye.GESTURE_PROGRESS,t)},i.touchEndGesture=function(t){return n.fire(ye.GESTURE_END,t)},i[ye.DOCUMENT_MOUSE_MOVE]=function(t,e){var i=t.domEvent,r=t.x,n=t.y;d._onDocumentMove({domEvent:i,x:r,y:n,source:Np(e)})},i[ye.DOCUMENT_MOUSE_UP]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,a=void 0===o?Ih.LEFT:o;d._onDocumentUp({domEvent:i,x:r,y:n,source:Np(e),button:a})},i)),d}function Np(t){return 0===t.indexOf(vp.TOUCH)?vp.TOUCH:vp.MOUSE}var kp=!1,Op={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function Fp(t,e){return t&&(t.type===Op[e].trigger&&(kp=!0),t.type===Op[e].duplicate&&kp&&(kp=!1,1))}var Rp,Pp=(E(Dp,Rp=xe),Dp);function Dp(t){t.graph;var e=t.graphics,i=t.camera,r=t.selection,n=t.events,o=t.captor,a=t.individualAttributes,s=t.interactions,u=t.classes,d=t.settings,l=Rp.call(this)||this;return l._dragged=null,l._start=[],l._end=[],l._shouldDrag=function(t){var e=t.target,i=t.button===Ih.LEFT,r=l._settings.get("interactions.drag.enabled"),n=null!==e&&e.isNode&&!0===e.getAttribute("draggable");return!!(i&&r&&n)},l._onDragStart=function(t){var e=t.x,i=t.y,r=t.target;r.isSelected()?l._dragged=l._selection.getSelectedNodes().filter((function(t){return t.getAttribute("draggable")})):l._dragged=r.toList(),l._dragged&&(l._start=l._dragged.getPosition(),l._end=q(l._start),l._onBeforeDrag=l._settings.get("interactions.drag.onBeforeDrag"),l._startDrag=l._camera.screenToGraphCoordinates({x:e,y:i}),l._dragged.addClass(hi),l._events.fire(ye.NODES_DRAG_START,{nodes:l._dragged}),l._graphics.addCursorStyle(l._settings.get("interactions.drag.cursor")))},l._onDrag=function(){if(l._dragged&&l._startDrag){for(var t=l._captor.getCursorInformation(),e=t.x,i=t.y,r=l._dragged._indexes,n=l._camera.screenToGraphCoordinates({x:e,y:i}),o=n.x-l._startDrag.x,a=n.y-l._startDrag.y,s=0;s<r.length;++s){var u=l._start[s],d=l._end[s];d.x=u.x+o,d.y=u.y+a}l._onBeforeDrag&&l._onBeforeDrag(l._dragged,e,i,l._end),l._settings.get("interactions.drag.applyResult")&&l._attributes.setMultipleAttributes(l._dragged,l._end,void 0,["x","y"]),l._events.fire(ye.NODES_DRAG_PROGRESS,{nodes:l._dragged,dx:o,dy:a})}},l._onDragEnd=function(){l._dragged&&(l._dragged.removeClass(hi),l._graphics.removeCursorStyle(l._settings.get("interactions.drag.cursor")),l._events.fire(ye.NODES_DRAG_END,{nodes:l._dragged,start:l._start,end:l._end}),l._dragged=null,l._start=[],l._end=[])},l._camera=i,l._graphics=e,l._selection=r,l._events=n,l._settings=d,l._captor=o,l._attributes=a,l._interactions=s,u.createClass({name:hi,isBuiltin:!0,nodeAttributes:{layer:3}}),n.register([ye.NODES_DRAG_START,ye.NODES_DRAG_PROGRESS,ye.NODES_DRAG_END]),d.register("interactions.drag.enabled",!0),d.register("interactions.drag.cursor","move"),d.register("interactions.drag.onBeforeDrag",void 0),d.register("interactions.drag.applyResult",!0),l._interactions.onDrag({priority:"drag",disableDetection:!0,check:l._shouldDrag,onStart:l._onDragStart,onProgress:l._onDrag,onStop:l._onDragEnd}),l}var zp,Bp={color:"#00C3FF",radius:7,cursorOnHover:"grab",cursorOnDrag:"grabbing"},Up=(E(Vp,zp=xe),Vp.prototype.onMounted=function(t){t.events.onEdgesSelected(this._refreshHandles),t.events.onEdgesUnselected(this._refreshHandles)},Vp.prototype.enable=function(t){this._enabled||(this._options=A(A({},Bp),t),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._refreshHandles())},Vp.prototype.disable=function(){this._enabled&&(this._interaction.stop&&this._interaction.stop(),this._graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._restoreSettings(),this._graphics.removeCanvas(this._canvas),this._rewirableClass.clearEdges(),this._enabled=!1)},Vp.prototype.enabled=function(){return this._enabled},Vp.prototype._restoreSettings=function(){this._prevSettings&&(this._settings.update(this._prevSettings),this._prevSettings=void 0)},Vp.prototype._disableCursorOnHover=function(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._graphics.removeCursorStyle(this._options.cursorOnHover))},Vp.prototype._enableCursorOnHover=function(){this._hoverHandle||(this._hoverHandle=!0,this._graphics.addCursorStyle(this._options.cursorOnHover))},Vp.prototype._displayMovedEdges=function(){var t=this;if(this._movedEdges){var e=this._x,i=this._y,r=this._ctx,n=Ct(),o={x:e,y:i},a=this._camera.getZoom();this._movedEdges.forEach((function(e,i){var s=t._edgeColors[i],u=e.getSource(),d=e.getTarget(),l=t._getPointedNode(),h=d===t._startNode?u:d,c=e.getAttribute("width")*a,f=h.getPositionOnScreen(),g=l?l.getPositionOnScreen():o;h.addClass(li),r.beginPath(),r.moveTo(f.x*n,f.y*n),r.lineTo(g.x*n,g.y*n),r.strokeStyle=s,r.lineWidth=c*n,r.stroke()}))}},Vp.prototype._getPointedNode=function(){var t=this._captor.getPointedElement();return t&&t.isNode?t:null},Vp);function Vp(t){var e,i=t.classes,r=t.graphics,n=t.camera,o=t.captor,a=t.selection,s=t.events,u=t.settings,d=t.interactions,l=zp.call(this)||this;return l._canvas=$r(),l._ctx=l._canvas.getContext("2d"),l._hoverHandle=!1,l._grabHandle=!1,l._x=0,l._y=0,l._enabled=!1,l._onDragStart=function(){if(l._movedEdges){l._nodesToHighlight=l._nodesToHighlight.filter((function(t){return t!==l._startNode})),l._movedEdges.setExcluded(!0);var t=l._options.cursorOnDrag;l._prevSettings=l._settings.update({edgeHover:!1,cursor:{default:t,node:t,edge:t}})}},l._onDragEnd=function(){if(l._movedEdges){l._restoreSettings();var t=l._getPointedNode();t&&l._movedEdges.forEach((function(e){e.getTarget()===l._startNode?e.setTarget(t):e.setSource(t)})),l._movedEdges.setExcluded(!1),l._movedEdges.setSelected(!0),l._movedEdges=null,l._refreshHandles()}},l._refreshHandles=function(){if(l._enabled&&!l._movedEdges){var t=l._selection.getSelectedEdges();l._nodesToHighlight=t.getExtremities().dedupe(),l._rewirableClass.clearEdges(),l._rewirableClass.add(t),l._refreshCanvas()}},l._shouldInteractionStart=function(t){var e=t.target;if(!(l._enabled&&e&&e.isNode&&l._hoverHandle))return!1;var i=e.getAdjacentEdges().filter((function(t){return t.isSelected()}));return!!i.size&&(l._movedEdges=i,l._edgeColors=l._movedEdges.getAttribute("color"),l._startNode=e,!0)},l._refreshCanvas=function(){if(l._enabled&&l._nodesToHighlight){var t=l._captor.getCursorPosition(),e=l._getPointedNode(),i=l._camera.zoom,r=l._canvas.getContext("2d"),n=Ct(),o=l._options.color,a=l._options.radius,s=2*a*n;r.clearRect(0,0,l._canvas.width,l._canvas.height),l._displayMovedEdges(),r.fillStyle=o,r.strokeStyle=o;var u=!1;if(l._nodesToHighlight.forEach((function(e){var o=e.getPositionOnScreen(),d=o.x,l=o.y,h=e.getAttribute("radius")*("fixed"===e.getAttribute("scalingMethod")?1:i);a<h&&(r.fillRect((d-a)*n,(l-a)*n,s,s),Pa(d,l,t.x,t.y)<a&&(u=!0))})),l._movedEdges){var d=e?e.getPositionOnScreen():t;r.fillRect((d.x-a)*n,(d.y-a)*n,s,s)}u?l._enableCursorOnHover():l._disableCursorOnHover()}},l._captor=o,l._camera=n,l._graphics=r,l._selection=a,l._events=s,l._settings=u,l._interactions=d,l._classes=i,l._rewirableClass=l._classes.createClass({name:ci,isBuiltin:!0,edgeAttributes:{layer:4}}),l._events.on(((e={})[ye.CAMERA_MOVE]=l._refreshCanvas,e[ye.MOVE]=l._refreshCanvas,e[ye.NODES_DRAG_PROGRESS]=l._refreshCanvas,e[ye.DOWN]=function(){l._hoverHandle&&(l._grabHandle=!0)},e[ye.UP]=function(){return l._grabHandle=!1},e)),l._interaction=l._interactions.onDrag({priority:"rewiring",check:l._shouldInteractionStart,onStart:l._onDragStart,onProgress:function(t){var e=t.x,i=t.y;l._x=e,l._y=i},onStop:l._onDragEnd}),l}var jp,Gp={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},Hp=(E(Wp,jp=xe),Wp.prototype.onMounted=function(t){t.events.onNodesSelected(this._onSelectionChange),t.events.onNodesUnselected(this._onSelectionChange)},Wp.prototype._enableCursor=function(){this._cursorEnabled||(this._graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)},Wp.prototype._disableCursor=function(){this._cursorEnabled&&(this._graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)},Wp.prototype._detectBoundingBoxes=function(t,e){var i=this;if(this._enabled&&!this._nodeBeingResized&&this._nodesToHighlight){var r=this._options.handleSize/2,n=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight((function(o,a,s){var u=a.x+s-r-n,d=a.x+s+r+n,l=a.y-s-r-n,h=a.y-s+r+n;u<=t&&t<=d&&l<=e&&e<=h&&(i._pointedNode=o)})),this._pointedNode?this._enableCursor():this._disableCursor()}},Wp.prototype._forEachNodeToHighlight=function(t){var e=this;this._nodesToHighlight&&this._nodesToHighlight.forEach((function(i){var r=i.getPositionOnScreen(),n=e._getTotalOnScreenRadius(i);t(i,r,n)}))},Wp.prototype._displayHandles=function(){var t=this;if(this._enabled&&this._nodesToHighlight){var e=this._canvas,i=this._ctx,r=e.width,n=e.height,o=Ct(),a=this._options,s=a.color,u=a.lineWidth,d=a.handleSize,l=0;if(i.clearRect(0,0,r,n),this._nodeBeingResized){var h=this._getTotalOnScreenRadius(this._nodeBeingResized),c=this._nodeBeingResized.getPositionOnScreen();l=Math.max(this._x-(c.x+h),-(this._y-(c.y-h)))/2}this._additionalRadiuses=[],this._forEachNodeToHighlight((function(e,r,n){var a=0;if(t._nodeBeingResized){a=l;var h=-n+e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width")+u/2+1;a=a<h?h:t._snap(e,a),t._additionalRadiuses.push(a);var c=e.getAttribute("shape"),f=t._engine.getShapePoints(c),g=r.x+a,p=r.y-a,_=n+a;t._displayNodePreview(i,o,g,p,_,f)}i.strokeStyle=s,i.fillStyle=s,i.lineWidth=u,i.strokeRect((r.x-n)*o,(r.y-n-2*a)*o,2*(a+n)*o,2*(a+n)*o),i.fillRect((r.x+n+2*a-d/2)*o,(r.y-n-2*a-d/2)*o,d*o,d*o)}))}},Wp.prototype._displayNodePreview=function(t,e,i,r,n,o){if(i*=e,r*=e,n*=e,t.beginPath(),1===o.length)t.arc(i,r,n,0,2*Math.PI);else for(var a=0;a<o.length;++a){var s=o[a],u=i+s.x*n,d=r+s.y*n;0===a?t.moveTo(u,d):t.lineTo(u,d)}t.fillStyle=this._options.previewColor,t.fill()},Wp.prototype._getTotalOnScreenRadius=function(t){return t.getAttribute("radius")*this._camera.zoom+t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width")+this._options.lineWidth/2},Wp.prototype._snap=function(t,e){var i=this,r=this._spatial.getNodesInScreenByDistance(t).filter((function(t){return!t.isSelected()})).slice(0,this._options.nbNodesToSnapTo),n=this._ctx,o=this._getTotalOnScreenRadius(t),a=o+e,s=this._options.snappingRatio,u=a/o,d=Math.round(Qe(u,s)),l=o*Math.pow(s,d),h=null;if(r.forEach((function(t){var e=i._getTotalOnScreenRadius(t);Math.abs(e-a)<=Math.abs(l-a)&&(l=e,h=t)})),h){n.save(),n.strokeStyle=this._options.sizeIndicatorColor,n.lineWidth=this._options.sizeIndicatorThickness;var c=h.getAttribute("radius");this._displaySizeIndicator(t,l),r.filter((function(t){return t.getAttribute("radius")===c})).forEach((function(t){return i._displaySizeIndicator(t)})),n.restore()}return l-o},Wp.prototype._displaySizeIndicator=function(t,e){var i=this._ctx,r=Ct(),n=t.getPositionOnScreen(),o=this._getTotalOnScreenRadius(t),a=e||o,s=e?e-o:0,u=s-this._options.sizeIndicatorOffset-(e?t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width"):0),d=n.x-a+u|0,l=n.y-a-s|0,h=n.y+a-s|0,c=this._options.sizeIndicatorWidth;i.beginPath(),i.moveTo((d-c)*r,l*r),i.lineTo((d+c)*r,l*r),i.moveTo(d*r,l*r),i.lineTo(d*r,h*r),i.moveTo((d-c)*r,h*r),i.lineTo((d+c)*r,h*r),i.stroke()},Wp.prototype.enable=function(t){var e;this._enabled||(this._options=A(A({},Gp),t),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._events.on(((e={})[[ye.CAMERA_MOVE,ye.NODES_DRAG_PROGRESS].join(" ")]=this._displayHandlesHandler,e[[ye.MOVE,ye.DOWN].join(" ")]=this._moveHandler,e)),this._enabled=!0)},Wp.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._displayHandlesHandler),this._events.removeListener(this._moveHandler),this._graphics.removeCanvas(this._canvas),this._disableCursor(),this._reset())},Wp.prototype._reset=function(){this._enabled=!1,this._nodesToHighlight=null,this._options=A({},Gp),this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]},Wp.prototype.enabled=function(){return this._enabled},Wp);function Wp(t){var e=t.dom,i=t.interactions,r=t.camera,n=t.events,o=t.graphics,a=t.spatial,s=t.selection,u=jp.call(this)||this;return u._enabled=!1,u._cursorEnabled=!1,u._x=0,u._y=0,u._additionalRadiuses=[],u._onSelectionChange=function(){u._enabled&&(u._nodesToHighlight=u._selection.getSelectedNodes(),u._displayHandles())},u._displayHandlesHandler=function(){return u._displayHandles()},u._moveHandler=function(t){var e=t.x,i=t.y;u._dom.setTimeout((function(){return u._detectBoundingBoxes(e,i)}))},u._dom=e,u._interactions=i,u._events=n,u._camera=r,u._dom=e,u._spatial=a,u._graphics=o,u._selection=s,u._engine=u._graphics.getGraphicsEngine(),u._canvas=$r(),u._ctx=u._canvas.getContext("2d"),u._interactions.onDrag({priority:"resizing",disableDetection:!0,check:function(){return!(!u._enabled||!u._pointedNode)},onStart:function(t){var e=t.x,i=t.y;u._x=e,u._y=i,u._nodeBeingResized=u._pointedNode},onProgress:function(t){var e=t.x,i=t.y;u._x=e,u._y=i,u._displayHandles()},onStop:function(){u._nodesToHighlight&&u._nodesToHighlight.forEach((function(t,e){var i=u._additionalRadiuses[e]/u._camera.zoom;t.setAttributes({radius:t.getAttribute("radius")+i,x:t.getPosition().x+i,y:t.getPosition().y-i})})),u._pointedNode=null,u._nodeBeingResized=null,u._displayHandles()}}),u}var qp,Xp,Yp,Zp={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:function(){return!0},onNodeCreated:function(){},onEdgeCreated:function(){},onComplete:function(){}},Kp=(E(Qp,qp=xe),Qp.prototype._onStart=function(t){t&&(this._cursorEnabled=!0,this._startNode=t,this._startPos=t.getPosition(),this._graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._graphics.allocateGraphicsEngineBlockId())},Qp.prototype._onMove=function(t,e){null!==this._startNode&&(this._endPos=this._camera.screenToGraphCoordinates({x:t,y:e}),this._drawLine())},Qp.prototype._onStop=function(){if(null!==this._startNode){var t=this._options,e=t.condition,i=t.onNodeCreated,r=t.onEdgeCreated,n=t.onComplete,o=t.createNodes,a=this._captor.getPointedElement(),s=null,u=null;this._graphics.releaseGraphicsEngineBlockId(this._blockId),!a&&o&&(u=a=this._graph.addNode({attributes:{x:this._endPos.x,y:this._endPos.y}}),i&&i(u)),a&&(u||!e||e(this._startNode,a))&&(s=this._graph.addEdge({source:this._startNode.getId(),target:a.getId()}),r&&r(s)),n&&(this._events.fire(ye.CONNECT_NODES,{source:this._startNode,target:a,edge:s}),n(this._startNode,a,s||void 0)),this.disable()}},Qp.prototype._drawLine=function(){this._block.reset(1,!1,this._depth);var t=this._block.nextAndReset().end;t.pieceId=2,t.shape="line",t.x1=this._startPos.x,t.y1=this._startPos.y,t.x2=this._endPos.x,t.y2=this._endPos.y,t.fillColor=this._options.strokeColor,t.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(t.dashLength=3,t.gapLength=1),this._engine.storeBlock(this._blockId,this._block),this._dom.refresh()},Qp.prototype.enable=function(t){return void 0===t&&(t={}),this._enabled||(this._options=A(A({},Zp),t),this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorInformation())),this},Qp.prototype.disable=function(){return this._enabled&&(this._enabled=!1,this._settings.update(this._prevSettings),this._cursorEnabled&&this._graphics.removeCursorStyle(this._options.cursorStyle)),this},Qp.prototype.enabled=function(){return this._enabled},Qp);function Qp(t){var e=t.dom,i=t.camera,r=t.captor,n=t.graph,o=t.graphics,a=t.interactions,s=t.events,u=t.settings,d=qp.call(this)||this;return d._enabled=!1,d._cursorEnabled=!1,d._dom=e,d._camera=i,d._captor=r,d._graph=n,d._graphics=o,d._interactions=a,d._events=s,d._settings=u,d._engine=d._graphics.getGraphicsEngine(),d._block=d._engine.createBlock(),d._depth=td(0).edgeBody,d._events.register([ye.CONNECT_NODES]),d._interaction=d._interactions.onDrag({priority:"connectNodes",check:function(t){var e=t.target,i=t.button,r=void 0===i?"left":i;return d._enabled&&"left"===r&&e&&e.isNode},onStart:function(t){var e=t.target;return d._onStart(e)},onProgress:function(t){var e=t.x,i=t.y;return d._onMove(e,i)},onStop:function(){return d._onStop()}}),d._events.on(ye.CLEAR_GRAPH,(function(){return d.disable()})),d}var Jp,$p=["top","bottom","left","right","cssDefined"],t_={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},e_={position:"top",autoAdjust:!0,delay:100},i_={hover:{node:function(t){var e=t.target;return e&&e.isNode},edge:function(t){var e=t.target;return e&&!e.isNode}},click:((Xp={})[Ih.LEFT]={node:function(t){var e=t.target;return t.button===Ih.LEFT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===Ih.LEFT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===Ih.LEFT&&!e}},Xp[Ih.RIGHT]={node:function(t){var e=t.target;return t.button===Ih.RIGHT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===Ih.RIGHT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===Ih.RIGHT&&!e}},Xp),doubleClick:((Yp={})[Ih.LEFT]={node:function(t){var e=t.target;return t.button===Ih.LEFT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===Ih.LEFT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===Ih.LEFT&&!e}},Yp[Ih.RIGHT]={node:function(t){var e=t.target;return t.button===Ih.RIGHT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===Ih.RIGHT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===Ih.RIGHT&&!e}},Yp)},r_=(E(n_,Jp=xe),n_.prototype.hide=function(){this._hideTooltip(!0)},n_.prototype.isShown=function(){return!!this._tooltip},n_.prototype.refresh=function(){this._refreshTooltip()},n_.prototype.show=function(t,e){var i=void 0===e?{}:e,r=i.position,n=void 0===r?"top":r,o=i.autoAdjust,a=void 0===o||o,s=i.className,u=i.x,d=void 0===u?0:u,l=i.y,h=void 0===l?0:l;this._showTooltip(t,{position:n,autoAdjust:a,className:s},{x:d,y:h})},n_.prototype.setHandler=function(t,e,i){var r=A(A({},e_),i);r.position&&-1===$p.indexOf(r.position)&&(r.position="top"),this._handlers[t]={handler:e,condition:Y(i_,t),settings:r}},n_.prototype._hideTooltip=function(t){if(this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null),t&&(this._currentHandlerName=null),this._tooltip){var e=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._events.fire(ye.TOOLTIP_HIDE,{tooltip:e})}},n_.prototype._createInteraction=function(t,e){var i=this;return void 0===e&&(e=!1),{priority:"tooltip",check:function(r){var n=o_(t,r),o=i._handlers[n];return!(e&&i._connectNodes.enabled()||(!o||!o.condition(r))&&(e||!i._currentHandlerName||i._isHover||null===i._tooltip))},handler:function(r){var n=r.target,o=r.x,a=r.y;i._hideTooltip(!1),i._isHover=e,i._elt=n,i._x=o,i._y=a,i._currentHandlerName=o_(t,r),i._refreshTooltip()}}},n_.prototype._refreshTooltip=function(){var t=this;if(this._currentHandlerName){var e=this._handlers[this._currentHandlerName];if(e){var i=e.settings,r=e.handler,n=this._elt;if(n){var o=n.isNode?"node":"edge";if(-1===this._currentHandlerName.indexOf(o))return}var a=r(n);Promise.resolve(a).then((function(e){t._schedule((function(){return t._showTooltip(e,i)}),i.delay)}))}}else this._hideTooltip(!1)},n_.prototype._schedule=function(t,e){var i=this;this._timeout&&this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout((function(){i._timeout=null,t()}),e)},n_.prototype._showTooltip=function(t,e,i){this._hideTooltip(!1);var r=e.position,n=e.className,o=e.autoAdjust,a=this._x,s=this._y,u=this._elt,d=this._dom.getDimensions(),l=0,h=0;if(i&&(a=i.x,s=i.y,u=null),"string"==typeof t)this._tooltip=gt?document.createElement("div"):Tt(),this._tooltip.innerHTML=t;else{if(!jt(t))throw new Error("invalid tooltip "+t+", expected HTML string or HTML element");this._tooltip=t}var c=this._tooltip;if(n&&this._tooltip.classList.add(n),"cssDefined"!==r&&(c.style.position="absolute"),this._dom.appendElement(c),u&&u.isNode){var f=u,g=f.getPositionOnScreen(),p=f.getAttribute("radius");p="fixed"===f.getAttribute("scalingMethod")?p+f.getAttribute("innerStroke.width")+f.getAttribute("outerStroke.width"):p*this._camera.getZoom()+f.getAttribute("innerStroke.width")+f.getAttribute("outerStroke.width"),a=g.x,s=g.y,h=l=p}var _=c.offsetWidth/2,v=c.offsetHeight/2;if(l+=_,h+=v,r&&"cssDefined"!==r){var m=t_[r],y=m.x,b=m.y;if(o){var x=a+l*m.x,E=s+h*m.y;(x-_<0||x+_>=d.width)&&("left"===r||"right"===r?y*=-1:y=x-_<0?(_-x+1)/l:(d.width-(x+_)-1)/l),(E-v<0||E+v>=d.height)&&("top"===r||"bottom"===r?b*=-1:b=E-v<0?(v-E+1)/h:(d.height-(E+v)-1)/h)}c.style.left=a+l*y-_+"px",c.style.top=s+h*b-v+"px"}this._events.fire(ye.TOOLTIP_SHOW,{tooltip:c})},n_);function n_(t){var e,i=t.dom,r=t.connectNodes,n=t.interactions,o=t.camera,a=t.events,s=Jp.call(this)||this;return s._x=0,s._y=0,s._dom=i,s._connectNodes=r,s._interactions=n,s._camera=o,s._events=a,s._handlers={},s._currentHandlerName=null,s._tooltip=null,s._isHover=!1,s._events.register(["showTooltip","hideTooltip"]),s._events.on(((e={})[ye.UP+" "+ye.DRAG_START]=function(){s._isHover||s._hideTooltip(!1)},e[ye.UNHOVER]=function(){s._isHover&&s._hideTooltip(!1)},e[ye.CLEAR_GRAPH]=function(){return s._hideTooltip(!1)},e)),s._interactions.onHover(s._createInteraction("hover",!0)),s._interactions.onClick(s._createInteraction("click")),s._interactions.onDoubleClick(s._createInteraction("doubleClick")),s}function o_(t,e){var i=e.button,r=e.target;return t+(i?"."+i:"")+"."+(null!==r?r.isNode?"node":"edge":"background")}var a_,s_={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},u_=Object.keys(s_).reduce((function(t,e){var i=s_[e];return t[i]||(t[i]=[]),t[i].push(e),t}),{}),d_=(E(l_,a_=xe),l_.prototype.setIdleTimeout=function(t){if(!isFinite(t)||t<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=t},l_.prototype.resetKeys=function(){for(var t=0;t<this._pressed.length;t++)this._pressed[t]&&(this._pressed[t]=!1,this._events.fire("keyUp",{key:s_[t],code:t}))},l_.prototype.onKeyPress=function(t,e){var i=this,r=[];if("number"==typeof t)r=[t];else if("string"==typeof t)r=t.split(" ");else{if(!Array.isArray(t))throw new TypeError(t+" is not a number, string or array");r=t}if(0===r.length)throw new Error("the array should contain at least one element");var n=r.map((function(t){if("number"==typeof t)return[t];if("string"!=typeof t)throw new TypeError(t+" is not a valid key identifier");var e=u_[t];if(!e)throw new Error(t+" is not a valid key identifier");return e})),o=n.pop(),a={keys:n,handler:e};o&&o.forEach((function(t){i._binds[t]||(i._binds[t]=[]),i._binds[t].push(a)}))},l_.prototype.isPressed=function(t){var e=this;if("number"==typeof t)return this._pressed[t];if("string"==typeof t){var i=u_[t];if(i)return i.some((function(t){return e._pressed[t]}))}return!1},l_);function l_(t){var e=t.dom,i=t.events,r=a_.call(this)||this;return r._onBlur=function(){return r.resetKeys()},r._onKeyUp=function(t){var e=t.keyCode||t.which;r._pressed[e]=!1,r._events.fire("keyUp",{domEvent:t,key:s_[e],code:e})},r._onKeyDown=function(t){var e=t.keyCode||t.which,i=r._binds[e];if(!r._pressed[e]){if(r._pressed[e]=!0,i)for(var n=0,o=i;n<o.length;n++){var a=o[n];a.keys.every((function(t){return t.some((function(t){return r._pressed[t]}))}))&&a.handler({domEvent:t})}r._events.fire("keyDown",{domEvent:t,key:s_[e],code:e})}},r._events=i,r._events.register(["keyUp","keyDown"]),r._binds=[],r._pressed=[],e.addWindowEventListener("keydown",r._onKeyDown),e.addWindowEventListener("keyup",r._onKeyUp),e.addWindowEventListener("visibilitychange",r._onBlur),e.addWindowEventListener("blur",r._onBlur,!1),r._idleTimeout=4e3,r._prevEventTimeStamp=Jt(),r._events.onAnyEvent((function(){var t=Jt();t-r._prevEventTimeStamp>r._idleTimeout&&r.resetKeys(),r._prevEventTimeStamp=t})),r}var h_=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],c_=Math.PI,f_=2*Math.PI,g_=Math.cos(c_/2-f_/5),p_=Math.cos(c_/2-f_/5*2),__=Math.cos(c_/2-f_/5*3),v_=Math.cos(c_/2-f_/5*4),m_=Math.sin(-c_/2+f_/5),y_=Math.sin(-c_/2+f_/5*2),b_=Math.sin(-c_/2+f_/5*3),x_=Math.sin(-c_/2+f_/5*4),E_=[8,3],A_=[3,3],S_={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:function(t){return t[t.length-1]}},w_=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function T_(t){var e=["K","M","B","T","P","E","Z","Y"];if(9999<t){for(var i=0;i<e.length&&999<t;)t/=1e3,i++;return(C_(t,3)+e[i-1]).toString()}return C_(t,4).toString()}function C_(t,e){void 0===e&&(e=3);var i=4===e?10:1;return t<10?Math.round(100*t*i)/(100*i):t<100?Math.round(10*t*i)/(10*i):t<1e3?Math.round(t*i)/i:Math.round(t)}function M_(t){return t.innerMargin+1.6*(t.titleFontSize+t.fontSize)}function I_(t,e,i){var r,n,o=e.getContext("2d"),a=i.x,s=i.y,u=i.height,d=i.isNode,l=i.styleProperty,h=i.title,c=i.mapping,f=i.iconFont,g=i.iconFontStyle;n=u,function(t,e,i,r,n,o,a,s,u){t.setLineDash([]),t.beginPath(),t.moveTo(e+o,i),t.lineTo(e+r-o,i),t.quadraticCurveTo(e+r,i,e+r,i+o),t.lineTo(e+r,i+n-o),t.quadraticCurveTo(e+r,i+n,e+r-o,i+n),t.lineTo(e+o,i+n),t.quadraticCurveTo(e,i+n,e,i+n-o),t.lineTo(e,i+o),t.quadraticCurveTo(e,i,e+o,i),t.closePath(),t.fillStyle=a,t.fill(),t.strokeStyle=s,t.lineWidth=u,t.stroke()}(o,a,s,(r=t).widgetWidth,n,r.borderRadius,r.backgroundColor,r.borderColor,r.borderWidth),function(t,e,i,r,n){L_(t,e.fontFamily,e.titleFontSize,e.titleFontColor,e.titleTextAlign);var o="center"===e.titleTextAlign,a=e.widgetWidth-2*e.innerMargin,s=t.measureText(i).width,u=r+(o?e.widgetWidth/2:e.innerMargin),d=n+e.titleFontSize/2+e.innerMargin;if(a<s){var l=a/s,h=(i.length*l|0)-2;i=i.substr(0,h)+""}t.fillText(i,u,d)}(o,t,h,a,s);var p,_=1.6*t.fontSize,v=t.fontSize/2*1.6*.9,m=3*t.fontSize,y=t.fontSize,b=(p=d?1:3,t.fontSize*p),x=s+M_(t),E=a+t.innerMargin+b/2,A=a+2*t.innerMargin+b,S=H(c),w=function t(e){return Array.isArray(e)?e.reduce((function(e,i){return e&&t(i)}),!0):"undefined"===e||!isNaN(Number(e))}(S),T=t.fontColor,C=t.shapeColor,M=Object.keys(c);if(w&&(M.sort((function(t,e){return Ke(c[e])-Ke(c[t])})),"radius"===l||"width"===l)){var I=function t(e){return Array.isArray(e)?e.reduce((function(e,i){return Math.min(e,t(i))}),1/0):isNaN(e)?1/0:+e}(S),L=function t(e){return Array.isArray(e)?e.reduce((function(e,i){return Math.max(e,t(i))}),-1/0):isNaN(e)?-1/0:+e}(S),N=Math.round((I+L)/2);return(d?k_:O_)(t,o,a,x,I,N,L,C)}M.forEach((function(e){var i,r,n,a,s,u,h,p,b,S,M=c[e];"color"===l&&(d?N_(o,E,x,v,e):(r=E,n=x,a=m,s=y,u=e,(i=o).fillStyle=u,i.fillRect(r-a/2,n-s/2,a,s))),"shape"===l&&(d?function(t,e,i,r,n,o){switch(t.fillStyle=o,n){case"square":return t.fillRect(e-r,i-r,2*r,2*r);case"circle":return N_(t,e,i,r,o);case"cross":return function(t,e,i,r){t.fillRect(e-r,i-.31*r,2*r,2*r*.31),t.fillRect(e-.31*r,i-r,2*r*.31,2*r)}(t,e,i,r);case"diamond":return function(t,e,i,r){t.beginPath(),t.moveTo(e-r,i),t.lineTo(e,i-r),t.lineTo(e+r,i),t.lineTo(e,i+r),t.fill()}(t,e,i,r);case"equilateral":return function(t,e,i,r){t.beginPath(),t.moveTo(e,i-r),t.lineTo(e+g_*r,i+m_*r),t.lineTo(e+p_*r,i+y_*r),t.lineTo(e+__*r,i+b_*r),t.lineTo(e+v_*r,i+x_*r),t.fill()}(t,e,i,r);case"star":!function(t,e,i,r){t.beginPath(),t.moveTo(e,i-r),t.lineTo(e+p_*r,i+y_*r),t.lineTo(e+v_*r,i+x_*r),t.lineTo(e+g_*r,i+m_*r),t.lineTo(e+__*r,i+b_*r),t.fill()}(t,e,i,r)}}(o,E,x,v,e,C):function(t,e,i,r,n,o,a){t.fillStyle=a,"line"===o&&t.fillRect(e-r/2,i-n/4,r,n/2),"arrow"===o?function(t,e,i,r,n){t.fillRect(e-r/2,i-n/4,r*(1-1/3),n/2),t.beginPath(),t.moveTo(e+r*(1-1/3-.5),i-n/2),t.lineTo(e+r*(1-1/3-.5),i+n/2),t.lineTo(e+r/2,i),t.fill()}(t,e,i,r,n):"dashed"===o||"dotted"===o?function(t,e,i,r,n,o,a){t.beginPath(),t.moveTo(e-r/2,i),t.lineTo(e+r/2,i),t.strokeStyle=o,t.lineWidth=n/2,t.setLineDash("dashed"===a?E_:A_),t.stroke()}(t,e,i,r,n,a,o):"tapered"===o&&function(t,e,i,r,n){t.beginPath(),t.moveTo(e-r/2,i-n/2),t.lineTo(e-r/2,i+n/2),t.lineTo(e+r/2,i),t.fill()}(t,e,i,r,n)}(o,E,x,m,y,e,C)),"icon.content"===l&&(p=E,b=x,S=e,L_(h=o,f,2*v,T,"center",g),h.fillText(S,p,b)),"image"!==l&&"image.url"!==l||function(t,e,i,r,n){if("undefined"!=typeof Image){t._imgStore||(t._imgStore={});var o=t._imgStore[n];if(o)return t.drawImage(o,e-r,i-r,2*r,2*r);(o=new Image).src=n,o.onload=function(){t.drawImage(o,e-r,i-r,2*r,2*r)},t._imgStore[n]=o}}(o,E,x,v,e),function(t,e,i,r,n,o){var a=n.join();if(o)if(1===n.length)a=T_(n[0]);else{var s=Ke(n),u=Ze(n);a=T_(s)+" - "+T_(u)}L_(t,e.fontFamily,e.fontSize,e.fontColor),t.fillText(a,i,r)}(o,t,A,x,M,w),x+=_}))}function L_(t,e,i,r,n,o){void 0===n&&(n="left"),void 0===o&&(o="normal"),t.textAlign=n,t.textBaseline="middle",t.fillStyle=r,t.font=o+" "+i+'px "'+e+'"'}function N_(t,e,i,r,n){t.beginPath(),t.arc(e,i,r,0,2*c_),t.fillStyle=n,t.fill()}function k_(t,e,i,r,n,o,a,s){for(var u,d,l,h,c,f,g=.7*t.fontSize,p=3*g,_=(g+p)/2,v=i+t.innerMargin+p,m=v+p+t.innerMargin,y=r+2*p-.5*t.innerMargin,b=t.circleStrokeWidth,x=0,E=[g,_,p];x<E.length;x++){var A=E[x];d=v,l=y-A,h=A,c=s,f=b,(u=e).beginPath(),u.arc(d,l,h,0,f_),u.strokeStyle=c,u.lineWidth=f,u.stroke()}L_(e,t.fontFamily,t.fontSize,t.fontColor,"left"),e.fillText(T_(n),m,y+g-2*g),e.fillText(T_(o),m,y+g-2*_),e.fillText(T_(a),m,y+g-2*p)}function O_(t,e,i,r,n,o,a,s){var u=(t.widgetWidth-2*t.innerMargin)/3,d=t.fontSize,l=r-t.innerMargin/2,h=l+2*d,c=i+t.innerMargin;e.fillStyle=s,e.fillRect(c,l-d/2,1+u,d),e.fillRect(c+u,l-d/3,1+u,d/1.5),e.fillRect(c+2*u,l-d/6,u,d/3),L_(e,t.fontFamily,t.fontSize,t.fontColor,"center"),e.fillText(T_(a),c+.5*u,h),e.fillText(T_(o),c+1.5*u,h),e.fillText(T_(n),c+2.5*u,h)}function F_(t,e,i){for(var r=null,n=0;n<e.length;++n){var o;(o=e[n]).isNode!==t.isNode&&1!==e.length||!(null===r||o.height<e[r].height)||(r=n)}null!=r&&((o=e[r]).content.push(t),o.height+=t.height+i.outerMargin)}function R_(t){for(var e=0,i=1;i<t.length;++i)t[i].height>t[e].height&&(e=i);return e}function P_(t,e){return t.isNode!==e.isNode?t.isNode?-1:1:t.title<=e.title?-1:1}function D_(t,e){return t.height-e.height}function z_(t,e){return t.isNode!==e.isNode?t.isNode?-1:1:e.height-t.height}function B_(t,e){return t.isNode!==e.isNode?t.isNode?-1:1:t.content[0].title<=e.content[0].title?-1:1}var U_,V_=(E(j_,U_=xe),j_.prototype.enable=function(t){void 0===t&&(t={});var e=this._settings;return this._settings=A(A({},S_),t),this._mustRefresh=!this._enabled||!this._sameOptions(e,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._graphics.addCanvas(this._canvas),this.refresh())},j_.prototype._afterNextUpdate=function(){var t=this;return new Promise((function(e){return t._promises.push(e)}))},j_.prototype._formatSettings=function(t,e){var i=A(A({},S_),t);return w_.forEach((function(t){return i[t]*=e})),i},j_.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._graphics.removeCanvas(this._canvas))},j_.prototype.enabled=function(){return this._enabled},j_.prototype.refresh=function(){return this._mustRefresh=!0,this._dom.refresh(),this._afterNextUpdate()},j_.prototype.destroy=function(){this._enabled=!1,this._mustRefresh=!1,this._settings=A({},S_),this._promises=[]},j_.prototype.getOptions=function(){return this._enabled?A({},this._settings):A({},S_)},j_.prototype.getCurrentOptions=function(){return this._settings},j_.prototype._sameOptions=function(t,e){return t===e||Object.keys(t).reduce((function(i,r){return i&&t[r]===e[r]}),!0)},j_.prototype._drawOnCanvas=function(t,e,i){var r=this._formatSettings(t,i);!function(t,e,i){var r={width:e.width,height:e.height};r.width&&r.height&&i&&("top"===t.position||"bottom"===t.position?function(t,e,i,r){i=i.slice();for(var n=e.widgetWidth+e.outerMargin,o=Math.floor((t.width-e.outerMargin)/n),a=t.height-e.outerMargin,s=new Array(Math.min(o,i.length)),u=i.length,d=0,l=0,h=0,c=0,f=0;f<u;++f)(S=i[f]).isNode?(d+=1,l+=S.height):(h+=1,c+=S.height);var g=l+c,p=l/g,_=c/g,v=Math.round(p*o),m=Math.round(_*o);if(d<v?v=d:h<m&&(v=o-h),0===o)return!1;for(f=0;f<s.length;f++)s[f]={content:[],height:0,isNode:f<v};for(f=0;f<u;++f){var y=R_(i);F_(i[y],s,e),i.splice(y,1)}s.every((function(t){return 1===t.content.length}))?s.sort(B_):s.sort(z_);var b=e.outerMargin;for(f=0;f<s.length;++f){var x=s[f];if(x.height>a)return!1;x.content.sort(D_);for(var E=0,A=0;A<x.content.length;++A){var S;(S=x.content[A]).x=b,S.y=r?t.height-E-S.height-e.outerMargin:E+e.outerMargin,E+=S.height+e.outerMargin}b+=n}return!0}(r,t,i,"bottom"===t.position):function(t,e,i,r){var n=e.widgetWidth+e.outerMargin,o=Math.floor((t.width-e.outerMargin)/n),a=t.height,s=e.outerMargin,u=r?e.outerMargin:t.width-n,d=1;i=i.slice().sort(P_);for(var l=0;l<i.length;++l){var h=i[l];if(s+h.height>a){if(s===e.outerMargin)return!1;s=e.outerMargin,d+=1,r?u+=n:u-=n}h.x=u,h.y=s,s+=h.height}return d<=o}(r,t,i,"left"===t.position))&&i.forEach((function(i){return I_(t,e,i)}))}(r,e,this._computeWidgetList(r))},j_.prototype.exportOnCanvas=function(t,e){return this._drawOnCanvas(e,t,1)},j_.prototype._computeWidgetList=function(t){var e=this,i=[];return h_.forEach((function(r){var n=r.name,o=r.isNode,a=e._computeWidget(t,n,o);a&&i.push(a)})),i},j_.prototype._computeWidget=function(t,e,i){var r=this._computePropertyMapping(t,e,i);if(r){if("icon.content"!==e)return r;var n=this._getRulesForAttribute(i,"icon.font"),o=this._getRulesForAttribute(i,"icon.style"),a=null,s=null;if(n.length||(a="Arial",s="normal"),"string"==typeof n[0]&&(a=n[0],s=o[0]),a&&s)return r.iconFont=a,r.iconFontStyle=s,r}return null},j_.prototype._computePropertyMapping=function(t,e,i){var r,n,o,a,s,u,d,l=this._getRulesForAttribute(i,e)[0],h=l&&l.mapping,c=h&&h.getValues(i);if(h&&c){var f=h.getField(),g={};return W(c,(function(t,e){void 0!==t&&"undefined"!==e&&(g[t]=g[t]||[],g[t].push(e))})),0===Object.keys(g).length?null:{isNode:i,title:t.titleFunction(f),styleProperty:e,dataProperty:f,mapping:g,height:(r=g,n=e,o=i,s=(a=t).outerMargin+M_(a),u=1.6*a.fontSize,d=s-.8*a.innerMargin,"radius"===n||"width"===n?d+u*(o?3:2):d+Object.keys(r).length*u)}}return null},j_.prototype._getRulesForAttribute=function(t,e){return this._styleRules.getRuleList().map((function(i){var r=i.getDefinition();return Y(t?r.nodeAttributes:r.edgeAttributes,e)})).filter((function(t){return t})).sort((function(t,e){return t.mapping&&e.mapping?0:t.mapping?-1:1}))},j_);function j_(t){var e,i=t.graphics,r=t.dom,n=t.events,o=t.styleRules,a=U_.call(this)||this;return a._enabled=!1,a._mustRefresh=!1,a._promises=[],a._graphics=i,a._dom=r,a._events=n,a._styleRules=o,a._canvas=$r(),a._ctx=a._canvas.getContext("2d"),a._events.on(((e={})[ye.NEW_FRAME]=function(){if(a._enabled&&a._mustRefresh){a._ctx.clearRect(0,0,a._canvas.width,a._canvas.height),a._drawOnCanvas(a._settings,a._canvas,Ct());var t=a._promises;a._promises=[],t.forEach((function(t){return t()})),a._mustRefresh=!1}},e[ye.RESIZE+" "+ye.RELOAD_FONTS]=function(){a._mustRefresh=!0},e)),a}var G_,H_={layer:3,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},W_={layer:3,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},q_=(E(X_,G_=xe),X_.prototype.setRate=function(t){this._delay=t},X_.prototype.updateNodeAttributes=function(t,e){this._hoverClass.update({nodeAttributes:t,fullOverwrite:e}),this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},X_.prototype.updateEdgeAttributes=function(t,e){this._hoverClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},X_.prototype.getHoverClassDefinition=function(){return this._hoverClass.getDefinition()},X_.prototype.onMounted=function(t){function e(){i._hoverExtremityHighlightedClass.clearNodes(),i._hoverClass.getEdges().getExtremities().addClass(ui)}var i=this;this._classes.onEdgeClassAdded(si,e),this._classes.onEdgeClassRemoved(si,e)},X_.prototype._registerSettings=function(){var t=this;this._settings.register("cursor.node","pointer",(function(e,i){t._hovered&&t._hovered.isNode&&(t._graphics.removeCursorStyle(i),t._graphics.addCursorStyle(e))})),this._settings.register("cursor.edge","pointer",(function(e,i){t._hovered&&!t._hovered.isNode&&(t._graphics.removeCursorStyle(i),t._graphics.addCursorStyle(e))})),this._settings.register("nodeHover",!0,(function(e){!e&&t._hovered&&t._hovered.isNode&&t._unhover(t._hovered)})),this._settings.register("edgeHover",!0,(function(e){e||!t._hovered||t._hovered.isNode||t._unhover(t._hovered)}))},X_.prototype._updateExtremityHighlightLayer=function(){var t=this._hoverClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})},X_.prototype._removeTimeout=function(){this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null)},X_.prototype._hover=function(t){var e=this,i=t.isNode?"nodeHover":"edgeHover";this._settings.get(i)&&!this._graphics.isAnimating()&&(this._removeTimeout(),this._timeout=this._dom.setTimeout((function(){e._graphics.isAnimating()||(e._setElementHighlight(!0,t),e._hovered=t),e._timeout=null}),this._delay))},X_.prototype._unhover=function(t){this._removeTimeout(),this._hovered===t&&(this._setElementHighlight(!1,t),this._hovered=null)},X_.prototype._setElementHighlight=function(t,e){var i=this._settings.get(e.isNode?"cursor.node":"cursor.edge");t?(this._graphics.addCursorStyle(i),e.addClass(si)):(this._graphics.removeCursorStyle(i),e.removeClass(si)),e.isNode&&t&&this._graph.getAttribute(e.isNode,"textHidden").set(e._index,!1)},X_);function X_(t){var e,i=t.dom,r=t.classes,n=t.captor,o=t.graph,a=t.graphics,s=t.settings,u=t.events,d=G_.call(this)||this;return d._delay=100,d._manualTriggerDetection=!1,d._hovered=null,d._onAnimate=function(t){t.duration&&(d._manualTriggerDetection=!0,d._resetHover())},d._onBeforeNewFrame=function(){if(d._manualTriggerDetection&&!d._graphics.isAnimating()){d._manualTriggerDetection=!1,d._captor.triggerDetection();var t=d._captor.getPointedElement();t&&d._hover(t)}},d._onClear=function(){d._hovered=null,d._timeout&&d._dom.clearTimeout(d._timeout)},d._resetHover=function(){d._hovered&&(d._unhover(d._hovered),d._captor.triggerUnhover()),d._timeout&&(d._dom.clearTimeout(d._timeout),d._timeout=null)},d._dom=i,d._graph=o,d._graphics=a,d._settings=s,d._captor=n,d._events=u,d._classes=r,d._registerSettings(),d._hoverExtremityHighlightedClass=d._classes.createClass({name:ui,isBuiltin:!0,nodeAttributes:H_}),d._hoverClass=d._classes.createClass({name:si,isBuiltin:!0,nodeAttributes:H_,edgeAttributes:W_}),d._events.on(((e={})[ye.HOVER]=function(t){var e=t.target;return e&&d._hover(e)},e[ye.UNHOVER]=function(t){var e=t.target;return e&&d._unhover(e)},e[ye.ANIMATE]=d._onAnimate,e[ye.BEFORE_NEW_FRAME]=d._onBeforeNewFrame,e[ye.MOUSE_LEAVE]=d._resetHover,e[ye.CLEAR_GRAPH]=d._onClear,e)),d}var Y_=function(){this.x=0,this.y=0},Z_=(K_.prototype.getValue=function(t,e){var i=t.isNode,r=i?this._nodeMapping:this._edgeMapping;r.valid||(r.values=this._computeMapping(i),r.valid=!0);var n=t.getData(this._field);return Array.isArray(n)?"color"===e?n.map((function(t){return r.values[t]})):r.values[n[0]]:r.values[n]},K_.prototype.markAsInvalid=function(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1},K_.prototype.getValues=function(t){return t?this._nodeMapping.values:this._edgeMapping.values},K_.prototype.getField=function(){return this._field},K_);function K_(t,e){this._nodeMapping={valid:!1,values:{}},this._edgeMapping={valid:!1,values:{}},this._computeMapping=e,this._field=t}function Q_(t,e,i){var r=(e?t.getNodes():t.getEdges()).getData(i),n={};return r.forEach((function(t){if(!Array.isArray(t))return n[t]=1;t.forEach((function(t){return n[t]=1}))})),"undefined"in n&&delete n[void 0],Object.keys(n).sort()}function J_(t,e,i,r){for(var n=i.values,o=void 0===n?{}:n,a=i.fallback,s=Q_(t,r,e),u={},d=0,l=0;l<s.length;++l){var h=s[l];h in o?u[h]=o[h]:(u[h]=a[d],d=(d+1)%a.length)}return u}function $_(t,e,i,r){for(var n=i.fallback,o=i.stops,a=void 0===o?{}:o,s=i.values,u=i.reverse,d=Q_(t,r,e),l=1/0,h=-1/0,c=0;c<d.length;c++)tg(_=+d[c])&&(l=Math.min(l,_),h=Math.max(h,_),d[c]=_);var f={};if(!isFinite(l)){for(c=0;c<d.length;c++)f[d[c]]=n;return f}var g=function(t,e){var i=e.nbSlices,r=e.minValue,n=e.maxValue;if(Array.isArray(t))return t.slice();for(var o=t.min,a=void 0===o?r:o,s=t.max,u=((void 0===s?n:s)-a)/i,d=[],l=1;l<i;++l)d.push(a+u*l);return d}(a,{nbSlices:Array.isArray(s)?s.length:s.nbSlices,minValue:l,maxValue:h}),p=function(t,e){if(Array.isArray(t))return t;for(var i=t.min,r=t.max,n=e.length+1,o=(r-i)/e.length,a=[],s=0;s<n;s++)a.push(i+s*o);return a}(s,g);for(u&&p.reverse(),c=0;c<d.length;++c){var _=d[c];if(isFinite(_)){for(var v=0;v<g.length&&g[v]<=_;)v+=1;f[_]=p[v]}else f[_]=n}return f}var tv,ev=(E(iv,tv=xe),iv.prototype.createMapping=function(t){var e=void 0===t?{field:""}:t,i=e.field,r=e.values,n=void 0===r?{}:r,o=e.fallback,a=void 0===o?void 0:o;if(i=z(i),Array.isArray(a)?0===a.length&&(a=[void 0]):a=[a],!G(n))throw new Error('"mapping" should be an object');return this._createMappingFunction(J_,i,{values:n,fallback:a})},iv.prototype.createSlices=function(t){var e=void 0===t?{field:"",values:[]}:t,i=e.field,r=e.fallback,n=void 0===r?void 0:r,o=e.stops,a=void 0===o?{}:o,s=e.values,u=e.reverse,d=void 0!==u&&u;if(i=z(i),Array.isArray(s)||s.nbSlices||(s.nbSlices=7),Array.isArray(a)&&Array.isArray(s)&&a.length!==s.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction($_,i,{fallback:n,stops:a,values:s,reverse:d})},iv.prototype._createMappingFunction=function(t,e,i){var r=this,n=new Z_(e,(function(n){return t(r._graph,e,i,n)}));function o(t,e,i){return n.getValue(t,i)}return this._mappingList.push(n),o.mapping=n,o},iv.prototype.createTemplate=function(t){if("string"!=typeof t)throw new TypeError('"template" should be a string');for(var e=[],i=0,r=!1;!r;){var n=-1,o=t.indexOf("{{",i);-1!==o&&(n=t.indexOf("}}",o+2)),-1!==n?(e.push(t.substring(i,o)),e.push(t.substring(o+2,n)),i=n+2):(e.push(t.slice(i)),r=!0)}return function(t){for(var i=e[0],r=1;r<e.length;r+=2)i+=t.getData(e[r]),i+=e[r+1];return i}},iv);function iv(t){var e,i=t.graph,r=t.events,n=t.styleRules,o=t.legend,a=tv.call(this)||this;return a._mappingList=[],a._graph=i,a._styleRules=n,a._events=r,a._legend=o,a._events.on(((e={})[[ye.ADD_NODES,ye.ADD_EDGES,ye.UPDATE_NODE_DATA,ye.UPDATE_EDGE_DATA,ye.REMOVE_NODES,ye.BEFORE_REMOVE_EDGES,ye.EXCLUDED_STATE_CHANGE,ye.CLEAR_GRAPH].join(" ")]=function(){if(a._mappingList.length){for(var t=0;t<a._mappingList.length;++t)a._mappingList[t].markAsInvalid();a._styleRules.refreshAllRules(),a._legend.refresh()}},e)),a}var rv,nv,ov=(av.prototype.run=function(t){var e=t.ogma,i=t.duration,r=this._getNodesToFilter(e),n=this._getEdgesToFilter(e,r);return Promise.all([r.addClass(pi,i),n.addClass(pi,i)]).then((function(){return r.setExcluded(!0),n.setExcluded(!0),{nodes:r,edges:n,virtualNodes:null,virtualEdges:null}}))},av.prototype.undo=function(t){var e=t.duration,i=t.context,r=i.nodes,n=i.edges;return r.setExcluded(!1),n.setExcluded(!1),r.addClass(pi),n.addClass(pi),Promise.all([r.removeClass(pi,e),n.removeClass(pi,e)])},av.prototype.cleanup=function(t){return Promise.resolve()},av);function av(t){var e=t.getNodesToFilter,i=t.getEdgesToFilter;this._getNodesToFilter=e,this._getEdgesToFilter=i}(nv=rv=rv||{}).NodeFilter="node-filter",nv.EdgeFilter="edge-filter",nv.NodeCollapsing="node-collapsing",nv.VirtualProperties="virtual-properties",nv.NeighborGeneration="neighbor-generation",nv.NeighborMerging="neighbor-merging",nv.NodeGrouping="node-grouping",nv.EdgeGrouping="edge-grouping";var sv,uv=(E(dv,sv=ov),dv.prototype.getName=function(){return rv.NodeFilter},dv);function dv(t){return sv.call(this,{getNodesToFilter:function(e){return e.getNodes().filter((function(e){return!t||!t(e)}))},getEdgesToFilter:function(t,e){return e.getAdjacentEdges()}})||this}var lv,hv=(E(cv,lv=ov),cv.prototype.getName=function(){return rv.EdgeFilter},cv);function cv(t){return lv.call(this,{getNodesToFilter:function(t){return t.createNodeList()},getEdgesToFilter:function(e){return e.getEdges().filter((function(e){return!t||!t(e)}))}})||this}function fv(t){return"object"!=typeof t?{criteria:t,enabled:!0,duration:0}:t}var gv,pv=(E(_v,gv=xe),_v.prototype.addNodeFilter=function(t){var e=fv(t),i=e.criteria,r=S(e,["criteria"]);return this._transformations.add(new uv(i),r)},_v.prototype.addEdgeFilter=function(t){var e=fv(t),i=e.criteria,r=S(e,["criteria"]);return this._transformations.add(new hv(i),r)},_v);function _v(t){var e=t.transformations,i=gv.call(this)||this;return i._transformations=e,i}var vv=(mv.prototype.destroy=function(){var t=this;Object.keys(this).forEach((function(e){var i=t[e];i instanceof xe&&i.destroy(t._ogma)}))},mv);function mv(t,e){var i=this;this._ogma=t,"webgl"===Pl&&ps.cacheInitData(ps.createInitData()),this.settings=new Kl,this.events=new jl,this.dom=new we(this,e.dimensions),this.animations=new mc(this),this.camera=new Il(this),this.graph=new br(this,t),this.data=new Ie(this),this.graphics=new Dl(this,t),this.individualAttributes=new Xl(this),this.algorithms=new xf(this),this.position=new Y_,this.touch=new Bh(this),this.mouse=new Ph(this),this.virtualMouse=new Ng(this),this.spatial=new Th(this),this.captor=new Ip(this),this.interactions=new yp(this),this.classes=new eh(this),this.cameraInteractions=new Sl(this,!!e.debug),this.hover=new q_(this),this.keyboard=new d_(this),this.selection=new rc(this),this.styleRules=new Wg(this),this.legend=new V_(this),this.sync=new ac(this),this.rules=new ev(this),this.transformations=new Qh(this,t),this.filters=new pv(this),this.locate=new Nh(this),this.drag=new Pp(this),this.grouping=new Hh(this),this.pulses=new fc(this),this.curvatureManager=new Sf(this),this.tasks=new Wf(this),this.layouts=new Kf(this),this.watcher=new fg(this),this.pathfinding=new Tg(this),this.rectangleSelect=new tp(this),this.labels=new fp(this,e),this.brand=new Tc(this),this.lasso=new Kg(this),this.rewiring=new Up(this),this.resizing=new Hp(this),this.snapping=new Ug(this),this.connectNodes=new Kp(this),this.tooltip=new r_(this),this.geo=new Lc(this),t.onReady((function(){Object.keys(i).forEach((function(t){var r=i[t];r instanceof xe&&r.onMounted(i._ogma,e)}))}))}var yv=(bv.initNamespace=function(t){var e;t.algorithms=(e=t,{shortestPath:function(t){return e.modules.algorithms.shortestPath(t)},hasCycle:function(t){var i=void 0===t?{}:t,r=i.nodes,n=i.edges;return null!==e.algorithms.detectCycle({nodes:r,edges:n})},getAllSimpleCycles:function(t){var i=void 0===t?{}:t,r=i.nodes,n=i.edges;return r=r||e.getNodes(),n=n||r.getAdjacentEdges({bothExtremities:!0}),e.modules.algorithms.getAllSimpleCycles(r,n)},detectCycle:function(t){var i=void 0===t?{}:t,r=i.nodes,n=i.edges;r=r||e.getNodes(),n=n||r.getAdjacentEdges({bothExtremities:!0});var o=e.modules.algorithms.detectCycle(r,n);return o.size?o:null},minimumSpanningTree:function(t){var i=void 0===t?{}:t,r=i.nodes,n=i.edges,o=i.edgeCostFunction;return e.modules.algorithms.minimumSpanningTree(r,n,o)}})},bv);function bv(){}var xv=(Ev.prototype.createClass=function(t,e){return this.modules.classes.createClass(Object.assign({},e,{name:t}))},Ev.prototype.updateClass=function(t,e){return this.modules.classes.getClassByName(t,!0).update(e||{})},Ev.prototype.getNodesByClassName=function(t,e){return this.modules.classes.getClassByName(t,!0).getNodes(e)},Ev.prototype.getEdgesByClassName=function(t,e){return this.modules.classes.getClassByName(t,!0).getEdges(e)},Ev);function Ev(){}var Av=(Sv.prototype.getHoveredElement=function(){return this.modules.captor.getPointedElement()},Sv.prototype.getPointerInformation=function(){return this.modules.captor.getCursorInformation()},Sv);function Sv(){}var wv=(Tv.initNamespace=function(t){var e;t.debug=(e=t,{wait:function(t){return new Promise((function(e){return setTimeout(e,t)}))},initRandomGraph:function(t){return e.generate.random(t).then(e.setGraph).then((function(){return e.view.locateGraph()})).then((function(){return e.view.afterNextFrame()}))},initGrid:function(t){var i=Math.ceil(Math.sqrt(t));return e.generate.grid({rows:i,columns:i}).then((function(t){return e.setGraph(t)})).then((function(){return e.view.locateGraph()}))},initLine:function(t){return e.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:t?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),e.view.locateGraph()},initSingleNode:function(){return e.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),e.view.locateGraph()},initContinuousRenderLoop:function(t){var i=void 0===t?{}:t,r=i.triggerKey,n=void 0===r?"r":r,o=i.start,a=void 0===o||o,s=function(){a&&e.modules.dom.beforeNextFrame().then(s)};document.addEventListener("keydown",(function(t){t.key===n&&(a=!a,s())})),s()},appendToBody:function(){var t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.bottom="0",t.style.right="0",document.body.appendChild(t),e.setContainer(t)},loadFile:function(t){return(t.endsWith(".gexf")?e.parse.gexfFromUrl(t):e.parse.jsonFromUrl(t)).then((function(t){return e.setGraph(t)})).then((function(){return e.view.locateGraph()})).then((function(){return e.view.afterNextFrame()}))},enableLasso:function(t){e.events.onDragStart((function(){e.keyboard.isKeyPressed("ctrl")&&e.tools.lasso.enable(t)}))},randomizeGraph:function(t){var i=void 0===t?{}:t,r=i.minX,n=void 0===r?0:r,o=i.minY,a=void 0===o?0:o,s=i.maxX,u=void 0===s?500:s,d=i.maxY,l=void 0===d?500:d;return e.getNodes().setAttributes(e.getNodes().map((function(){return{x:n+Math.random()*(u-n),y:a+Math.random()*(l-a)}})))}})},Tv);function Tv(){}var Cv=(Mv.prototype.setContainer=function(t){this.modules.dom.setContainer(t)},Mv.prototype.getContainer=function(){return this.modules.dom.getContainer()},Mv);function Mv(){}var Iv=(Lv.initNamespace=function(t){var e;t.events=(e=t,{removeListener:function(t){e.modules.events.removeListener(t)},onNodesAdded:function(t){return e.modules.events.on(ye.ADD_NODES,t),e},onBeforeNodesRemoved:function(t){return e.modules.events.on(ye.BEFORE_REMOVE_NODES,t),e},onNodesRemoved:function(t){return e.modules.events.on(ye.REMOVE_NODES,t),e},onEdgesAdded:function(t){return e.modules.events.on(ye.ADD_EDGES,t),e},onBeforeEdgesRemoved:function(t){return e.modules.events.on(ye.BEFORE_REMOVE_EDGES,t),e},onEdgesRemoved:function(t){return e.modules.events.on(ye.REMOVE_EDGES,t),e},onNodesClassAdded:function(t,i){return e.modules.classes.onNodeClassAdded(t,i),e},onNodesClassRemoved:function(t,i){return e.modules.classes.onNodeClassRemoved(t,i),e},onEdgesClassAdded:function(t,i){return e.modules.classes.onEdgeClassAdded(t,i),e},onEdgesClassRemoved:function(t,i){return e.modules.classes.onEdgeClassRemoved(t,i),e},onNodeDragStart:function(t){return e.modules.events.on(ye.NODES_DRAG_START,t),e},onNodeDragProgress:function(t){return e.modules.events.on(ye.NODES_DRAG_PROGRESS,t),e},onNodeDragEnd:function(t){return e.modules.events.on(ye.NODES_DRAG_END,t),e},onDrop:function(t){return e.modules.events.on(ye.DROP,t),e},onKeyPress:function(t,i){return e.modules.keyboard.onKeyPress(t,i),e},onNodesSelected:function(t){return e.events.onNodesClassAdded(di,t)},onNodesUnselected:function(t){return e.events.onNodesClassRemoved(di,t)},onEdgesSelected:function(t){return e.events.onEdgesClassAdded(di,t)},onEdgesUnselected:function(t){return e.events.onEdgesClassRemoved(di,t)},onNodeDataChange:function(t){return e.modules.events.on(ye.UPDATE_NODE_DATA,t),e},onEdgeDataChange:function(t){return e.modules.events.on(ye.UPDATE_EDGE_DATA,t),e},onMouseMove:function(t){return e.modules.events.on(ye.MOVE,t),e},onMouseButtonDown:function(t){return e.modules.events.on(ye.DOWN,t),e},onMouseButtonUp:function(t){return e.modules.events.on(ye.UP,t),e},onClick:function(t){return e.modules.events.on(ye.CLICK,t),e},onDoubleClick:function(t){return e.modules.events.on(ye.DOUBLE_CLICK,t),e},onMouseWheel:function(t){return e.modules.events.on(ye.WHEEL,t),e},onHover:function(t){return e.modules.events.on(ye.HOVER,t),e},onUnhover:function(t){return e.modules.events.on(ye.UNHOVER,t),e},onDragStart:function(t){return e.modules.events.on(ye.DRAG_START,t),e},onDragProgress:function(t){return e.modules.events.on(ye.DRAG_PROGRESS,t),e},onDragEnd:function(t){return e.modules.events.on(ye.DRAG_END,t),e},onGestureStart:function(t){return e.modules.events.on(ye.GESTURE_START,t),e},onGestureProgress:function(t){return e.modules.events.on(ye.GESTURE_PROGRESS,t),e},onGestureEnd:function(t){return e.modules.events.on(ye.GESTURE_END,t),e},onRendererStateChange:function(t){return e.modules.events.on(ye.RENDERER_STATE_CHANGE,t),e},onZoomProgress:function(t){return e.modules.events.on(ye.CAMERA_ZOOM,t),e},onViewChanged:function(t){return e.modules.events.on(ye.VIEW_CHANGED,t),e},onNodesConnected:function(t){return e.modules.events.on(ye.CONNECT_NODES,t),e},onGeoModeEnabled:function(t){return e.modules.events.on(ye.GEO_ENABLED,t),e},onGeoModeDisabled:function(t){return e.modules.events.on(ye.GEO_DISABLED,t),e},onGeoModeLoaded:function(t){return e.modules.events.on(ye.GEO_LOADED,t),e},onLayoutStart:function(t){return e.modules.events.on(ye.LAYOUT_START,t),e},onLayoutComplete:function(t){return e.modules.events.on(ye.LAYOUT_END,t),e},onLayoutComputed:function(t){return e.modules.events.on(ye.LAYOUT_COMPUTED,t),e},onTooltipShown:function(t){return e.modules.events.on(ye.TOOLTIP_SHOW,t),e},onTooltipHidden:function(t){return e.modules.events.on(ye.TOOLTIP_HIDE,t),e}})},Lv);function Lv(){}function Nv(t){return t instanceof cr?t.getId():t}function kv(t){return t instanceof Yi?t.getId():t}function Ov(t){return t instanceof gr?t.getId():t instanceof cr?[t.getId()]:O(t)?t.map(Nv):[Nv(t)]}function Fv(t){return t instanceof Ki?t.getId():t instanceof Yi?[t.getId()]:O(t)?t.map(kv):[kv(t)]}function Rv(t,e,i){if(null!=t){if(Array.isArray(t))return t[0];if(e&&i){if("source"===t)return Rv(i.color.get(e.getSource()._index));if("target"===t)return Rv(i.color.get(e.getTarget()._index))}return t}}function Pv(t){return null==t?null:"string"==typeof t||"number"==typeof t?""+t:t&&Pv(t.content)}var Dv=["color","radius","shape","text.content","x","y"],zv=["color","width","shape.type","text.content"],Bv="visible";function Uv(t,e,i,r){var n,o,a,s,u=(o=r,(n=e)?Ov(n):"object"==typeof o?Ov(o.nodes):o||Bv),d=(s=r,(a=i)?Fv(a):"object"==typeof s?Fv(s.edges):s||Bv);return{nodes:t.getNodes(u),edges:t.getEdges(d)}}function Vv(t,e){var i=e.nodeAttributes,r=e.edgeAttributes,n=e.nodes,o=e.edges,a=e.filter,s=e.nodeData,u=e.edgeData,d=Uv(t,n,o,a);return{nodes:d.nodes.toJSON({attributes:i,data:s}),edges:d.edges.toJSON({attributes:r,data:u})}}function jv(t,e,i){var r,n,o,a,s,u=i.styles,d=i.nodes,l=i.edges,h=i.filter,c=i.nodeData,f=i.edgeData,g="all"!==u?{nodes:["x","y"],edges:[]}:{nodes:Dv,edges:zv},p=Vv(t,{nodeAttributes:g.nodes,edgeAttributes:g.edges,nodes:d,edges:l,filter:h,nodeData:c,edgeData:f});if("original"===u){for(var _=(r=e,o=(n=Uv(t,d,l,h)).nodes,a=n.edges,s=r.getOriginalAttributes(),{nodes:o.reduce((function(t,e){return t[e.getId()]={x:s.nodes.x.get(e._index),y:s.nodes.y.get(e._index),color:Rv(s.nodes.color.get(e._index)),radius:s.nodes.radius.get(e._index),shape:s.nodes.shape.get(e._index),text:{content:s.nodes.text.content.get(e._index)}},t}),{}),edges:a.reduce((function(t,e){return t[e.getId()]={color:Rv(s.edges.color.get(e._index)),width:s.edges.width.get(e._index),shape:{type:s.edges.shape.type.get(e._index)},text:{content:s.edges.text&&s.edges.text.content&&s.edges.text.content.get(e._index)}},t}),{})}),v=0,m=p.nodes;v<m.length;v++){var y=m[v];null!=y.id&&(y.attributes=_[y.id])}for(var b=0,x=p.edges;b<x.length;b++){var E=x[b];null!=E.id&&(E.attributes=_[E.id])}}return"all"===u&&p.edges.forEach((function(e){var i=e.source,r=e.target,n=e.attributes;if(n){var o=t.getNode(i);"source"===n.color&&o&&(n.color=o.getAttribute("color"));var a=t.getNode(r);"target"===n.color&&a&&(n.color=a.getAttribute("color"))}})),function(t){return{nodes:t.nodes.map((function(t){var e=t.id,i=t.attributes,r=void 0===i?{}:i,n=t.data,o=r.color,a=r.radius,s=r.shape,u=r.text;return{id:e,x:r.x,y:r.y,color:Rv(o),size:a,shape:s,text:Pv(u),data:n}})),edges:t.edges.map((function(t){var e=t.id,i=t.source,r=t.target,n=t.attributes,o=void 0===n?{}:n,a=t.data,s=o.color,u=o.width,d=o.text,l=o.shape;return{id:e,source:i,target:r,color:Rv(s),size:u,shape:function(t){if(null!=t)return"string"==typeof t?t:t.type}(l),text:Pv(d),data:a}}))}}(p)}function Gv(t,e){return null==t||Array.isArray(t)&&!t.length?e:t}function Hv(t){return"string"==typeof t}function Wv(t,e,i,r,n){var o="edges"===e,a={};return t.forEach((function(t,s){var u=n.get(s),d=F(Gv(i(u),e));if(!d.every(Hv))throw Error("The tab "+e+" function returned an invalid value.");var l=F(r(t.data,d));d.forEach((function(e,i){var r=Gv(l[i],{}),n=eo(A(A({internal___id:t.id},o?{internal___source:t.source,internal___target:t.target}:{}),r)).reduce((function(t,e){var i=e.path,r=e.value;return t[i.join(".")]=r,t}),{});a[e]=a[e]||[],a[e].push(n)}))})),a}function qv(t){if(!t.length)return[];for(var e=function(t){for(var e=A({},t[0]),i=0,r=t;i<r.length;i++)for(var n=r[i],o=0,a=Object.keys(n);o<a.length;o++){var s=a[o];s in e||(e[s]=void 0)}return Object.keys(e)}(t),i=[e],r=function(t){i.push(e.map((function(e){return t[e]})))},n=0,o=t;n<o.length;n++)r(o[n]);return i[0]=i[0].map((function(t){return t.replace("internal___","")})),i}function Xv(t){return{csv:function(e){var i=tt("string"==typeof e?{what:e}:e,Yv),r=i.what,n=i.dataProperties,o=i.nodes,a=i.edges,s=i.separator,u=i.textSeparator,d=i.download,l=i.nodeData,h=i.edgeData,c=i.filename,f=i.filter,g=jv(t.modules.graph,t.modules.individualAttributes,{styles:"none",nodes:o,edges:a,filter:f,nodeData:l,edgeData:h});try{var p=function(t,e){var i=e.what,r=e.separator,n=e.textSeparator,o=e.dataProperties,a=new RegExp(""+n,"g");if(n&&'"'!==n&&"'"!==n)throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+n);if("nodes"!==i&&"edges"!==i)throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');var s="nodes"===i;return function(t,e,i){for(var r=new io,n=e?1:3,o=[],a=function(a){var s=t[a],u=new Array(n),d=s.data;if(i){var l={};i.forEach((function(t){var e=z(t),i=function(t,e){for(var i=0;i<e.length;++i){if(null==t)return;t=t[e[i]]}return t}(d,e);!function(t,e,i){for(var r=0;r<e.length-1;++r){var n=e[r],o=t[n];void 0===o&&(o={},t[n]=o),t=o}t[e[e.length-1]]=i}(l,e,i)})),d=l}var h=eo(d);u[0]=s.id,e||(u[1]=s.source,u[2]=s.target);for(var c=0;c<h.length;++c){var f=h[c],g=f.path,p=f.value;g.length&&(r.has(g)?u[r.get(g)]=p:(r.set(g,n),u[n]=p,n++))}o.push(u)},s=0;s<t.length;++s)a(s);var u=[];return u.push("id"),e||(u.push("source"),u.push("target")),r.keys().forEach((function(t){return u.push(t[t.length-1])})),o.unshift(u),o.forEach((function(t){return t.length=n})),o}(s?t.nodes:t.edges,s,o).map((function(t){return t.map((function(t){return function(t){return t=function(t){return t instanceof Date?t.toISOString():""+t}(t),n+t.replace(a,"\\$&")+n}(t)}))})).map((function(t){return t.join(r)})).join("\n")}(g,{what:r,separator:s,textSeparator:u,dataProperties:n});return d&&Nt(p,c,"text"),Promise.resolve(p)}catch(e){return Promise.reject(e)}}}}var Yv={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:function(t){return t},edgeData:function(t){return t},styles:"none"},Zv={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:function(t){return t},edgeData:function(t){return t},filter:"visible"};function Kv(t){return Math.round(255*t)}function Qv(t,e){if("integer"===e&&"number"==typeof t){if(t%1!=0)return"float"}else if("number"!=typeof t)return"boolean"==typeof t?"boolean":"string";return e}function Jv(t){return"object"==typeof t&&null!==t&&t.constructor===Object}function $v(t,e){return void 0===e&&(e={}),W(t,(function(t,i){Jv(t)?$v(t,e):e[i]=t})),e}function tm(t){return{graphml:function(e){void 0===e&&(e={});var i=tt(e,em),r=i.styles,n=i.nodes,o=i.edges,a=i.download,s=i.filename,u=i.graphId,d=i.directedEdges,l=i.filter,h=i.nodeData,c=i.edgeData,f=function(t,e){var i=new Ir,r=Co();function n(t){return i.toHexa(t)}function o(t,e,i,n,o){i=i||{};var a=r.createElement(e);for(var s in i)if(i.hasOwnProperty(s)){var u=i[s];void 0!==u&&a.setAttribute(s,u)}return void 0===n&&!o||("[object Object]"===Object.prototype.toString.call(n)&&(n=JSON.stringify(n)),a.appendChild(r.createTextNode(n))),t.appendChild(a),a}var a=["id","source","target"],s=["size","x","y","shape","text","color"],u={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};e.noStyles&&(delete u.color,delete u.r,delete u.g,delete u.b,delete u.a,delete u.shape,s.pop());var d=[],l=[];function h(t,e){var r={id:t.id};s.forEach((function(n){var o=t[n];"y"===n&&o&&(o=-parseFloat(o)),void 0!==o&&(r[("edge"===e?"edge_":"")+n]=o,"color"===n&&function(t,e){var r,n=(r=e,i.parseColor(r));n&&(t.r=n[0],t.g=n[1],t.b=n[2])}(r,o))})),W(t.data||{},(function(t,i){-1===s.indexOf(i)&&-1===a.indexOf(i)&&(u[i]?u[i].for!==e&&(u[i].for="all"):u[i]={for:e,type:"string"},r[i]=t)})),"edge"===e?(r.source=t.source,r.target=t.target,l.push(r)):d.push(r)}t.nodes.forEach((function(t){return h(t,"node")})),t.edges.forEach((function(t){return h(t,"edge")}));var c=o(r,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});W(u,(function(t,e){"node"!==t.for&&"all"!==t.for||o(c,"key",{"attr.name":e,"attr.type":t.type,for:"node",id:e}),"edge"!==t.for&&"all"!==t.for||o(c,"key",{"attr.name":e,"attr.type":t.type,for:"edge",id:"edge_"+e})})),o(c,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),o(c,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var f=o(c,"graph",{edgedefault:e.directedEdges||void 0===e.directedEdges?"directed":"undirected",id:e.graphId?e.graphId:"G","parse.nodes":t.nodes.length,"parse.edges":t.edges.length,"parse.order":"nodesfirst"});return d.forEach((function(t){var i=o(f,"node",{id:t.id});!function(t,i){var r=o(t,"data",{key:"nodegraphics"}),a=o(r,"y:ShapeNode");o(a,"y:Geometry",{x:i.x,y:i.y,width:i.size,height:i.size}),e.noStyles||o(a,"y:Fill",{color:n(i.color),transparent:!1}),o(a,"y:NodeLabel",null,i.text||""),o(a,"y:Shape",{type:i.shape})}(i,t),W(t,(function(t,e){-1===a.indexOf(e)&&o(i,"data",{key:e},t,!0)}))})),l.forEach((function(t){var i,r,s,u=o(f,"edge",{id:t.id,source:t.source,target:t.target});i=t,r=o(u,"data",{key:"edgegraphics"}),s=o(r,"y:PolyLineEdge"),o(s,"y:LineStyle",{type:i.edge_type,color:e.noStyles?void 0:n(i.edge_color),width:i.edge_size}),o(s,"y:EdgeLabel",null,i.edge_label),W(t,(function(t,e){-1===a.indexOf(e)&&o(u,"data",{key:e},t,!0)}))})),'<?xml version="1.0" encoding="UTF-8"?>\n'+To(r)}(jv(t.modules.graph,t.modules.individualAttributes,{styles:r,nodes:n,edges:o,filter:l,nodeData:h,edgeData:c}),{graphId:u,directedEdges:d,noStyles:"none"===r});return a&&Nt(f,s,"text"),Promise.resolve(f)}}}var em={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:function(t){return t},edgeData:function(t){return t},filter:"visible"},im={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:function(t){return t},edgeData:function(t){return t},filter:"visible",pretty:!1,download:!0,filename:"graph.json"};function rm(t,e){void 0===e&&(e={});var i=t.view.get(),r="number"==typeof e.margin?e.margin:0,n={pixelRatio:1,angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1};if(e.width&&e.height?(n.width=e.width,n.height=e.height):(n.width=i.width,n.height=i.height),e.clip)n.zoom=i.zoom,n.x=i.x,n.y=i.y;else{var o=t.getNodes(e.filter),a=o.getBoundingBox().computeForZoom(i.zoom).extend(ko.fromValues(o.getAttribute("x"),o.getAttribute("y"),o.map((function(t){return t.getAttribute("radius")+t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width")}))));if(e.texts){var s=t.modules.labels.getTextsBoundingBox();s.isValid()&&a.extend(s)}if(null==e.width||!isFinite(e.width)||null==e.height||!isFinite(e.height)){var u=t.view.graphToScreenCoordinates(a.bottomLeft()),d=t.view.graphToScreenCoordinates(a.topRight()),l=d.x-u.x,h=d.y-u.y,c=Math.min(n.width/l,n.height/h);n.width=l*c,n.height=h*c}n.x=a.cx,n.y=a.cy,n.width=Math.max(n.width,2*r+1),n.height=Math.max(n.height,2*r+1),n.zoom=Math.min((n.width-2*r)/a.width,(n.height-2*r)/a.height)}return t.modules.geo.isEnabled()?n.backgroundColor=null:void 0!==e.background&&(n.backgroundColor=e.background),n}function nm(t,e,i,r,n){void 0===n&&(n=!1);var o=A(A({},i),{renderBackground:!1,hideImages:n,angle:i.angle||0,currentTime:Jt(),isBufferDisplayable:function(t){return e.texts||!Yu(t)}}),a={};if(!1===e.badges){var s={text:null,image:null};a.badges={topLeft:s,topRight:s,bottomRight:s,bottomLeft:s}}var u=t.styles.getClass(fi);return u&&u.update({nodeAttributes:a}),t.modules.graphics.export(r,o,e.filter||Bv,e)}function om(t){return{download:!0,filter:"visible",filename:"graph."+t,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,images:!0,textWatermark:{content:"",fontFamily:"Arial",fontSize:48,fontStyle:void 0,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:void 0,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0}}var am={png:om("png"),jpg:om("jpg"),tiff:om("tiff"),gif:om("gif")};function sm(t){var e=t.canvas,i=t.parameters;return i.textWatermark.content&&mm(e,i.textWatermark,gm,pm),i.imageWatermark.url?Bt(i.imageWatermark.url).then((function(r){return r&&(i.imageWatermark.content=r,mm(e,i.imageWatermark,vm,_m)),t})):t}function um(t){var e=t.ogma,i=t.canvas,r=t.parameters,n=e.modules.legend,o=null;return void 0===r.legend&&(o=!!n.enabled()&&n.getCurrentOptions()),!0===r.legend&&(o={}),o&&n.exportOnCanvas(i,o),t}function dm(t){var e=t.ogma,i=t.view;return e.modules.geo.isEnabled()?e.modules.geo.exportBackground(i).then((function(e){var r=cm(t.view),n=r.getContext("2d");return n.drawImage(e,(i.width-e.width)/2,(i.height-e.height)/2),n.drawImage(t.canvas,0,0),t.canvas=r,t})):t}function lm(t){var e=t.ogma,i=t.parameters,r=t.canvas,n=t.view,o=r.getContext("2d");return nm(e,i,n,"canvas",!i.images).then((function(r){try{return r.getContext("2d").getImageData(0,0,1,1),o.drawImage(r,0,0),t}catch(r){return Si(r),nm(e,i,n,"canvas",!0).then((function(e){return o.drawImage(e,0,0),t}))}}))}function hm(t){var e=t.canvas,i=t.parameters,r=t.type,n=e.toDataURL("image/"+r);return i.download&&Nt(n,i.filename,"dataURL"),n}function cm(t){var e=t.width,i=t.height,r=$r();return r.width=e,r.height=i,r}function fm(t,e,i){var r=tt(e,am[i]);null===r.background&&(r.background=t.modules.graphics.getTransparentBackgroundColor());var n=rm(t,r),o={ogma:t,parameters:r,canvas:cm(n),view:n,type:i};return Promise.resolve(o).then(dm).then(lm).then(sm).then(um).then(hm)}function gm(t,e,i,r){t.textAlign="center",t.textBaseline="middle",t.fillText(e,i,r)}function pm(t,e,i){return{width:t.measureText(e).width,height:i}}function _m(t,e,i,r,n){return{width:void 0===r?e.width:r,height:void 0===n?e.height:n}}function vm(t,e,i,r,n,o){t.drawImage(e,i-n/2,r-o/2,n,o)}function mm(t,e,i,r){if(e){if("object"!=typeof e)e={content:e};else if(!e.content)return;var n=e.fontFamily,o=e.fontSize,a=e.fontStyle,s=e.fontColor,u=e.repeat,d=e.angle,l=e.alpha,h=e.space,c=e.content,f=t.getContext("2d"),g=t.width,p=t.height,_=void 0===e.x?g/2:e.x,v=void 0===e.y?p/2:e.y,m=e.height,y=e.width;d=d/180*Math.PI,en(f,n,o,a),f.fillStyle=s,f.globalAlpha=l;var b=r(f,c,o,y,m);if(u){var x=b.width+h,E=b.height+h,A=Math.sqrt(g*g+p*p);f.save(),f.translate(0,0),f.rotate(d);for(var S=0;S<A;S+=x)for(var w=0;w<A;w+=E)i(f,c,S,w,b.width,b.height),0!==w&&i(f,c,S,-w,b.width,b.height);f.restore()}else f.save(),f.translate(_,v),f.rotate(d),i(f,c,0,0,b.width,b.height),f.restore()}}var ym={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,images:!0,badges:!0,embedFonts:!1,clip:!1,margin:10,prefix:"ogma"},bm={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0};function xm(t,e){for(var i,r={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!==e.length;++o)for(var a=e[o],s=0;s!==a.length;++s){var u=a[s];n.s.r>o&&(n.s.r=o),n.s.c>s&&(n.s.c=s),n.e.r<o&&(n.e.r=o),n.e.c<s&&(n.e.c=s);var d={v:void 0===(i=u)?"":i instanceof Date?i.toISOString():""+i};r[t.utils.encode_cell({c:s,r:o})]=d}return n.s.c<1e7&&(r["!ref"]=t.utils.encode_range(n)),r}var Em=function(){this.SheetNames=[],this.Sheets={}};function Am(t){return t.styles.createClass({name:fi,isBuiltin:!0}),A(A(A(A(A(A(A({},Xv(t)),function(t){return{gexf:function(e){void 0===e&&(e={});var i=tt(e,Zv),r=i.styles,n=i.nodes,o=i.edges,a=i.download,s=i.filename,u=i.creator,d=i.description,l=i.filter,h=i.nodeData,c=i.edgeData,f=function(t,e){var i,r=new Ir,n=wo(),o={},a={},s=0,u=0,d=n.createElement("gexf");d.setAttribute("xmlns","http://www.gexf.net/1.2draft"),d.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),d.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),d.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),d.setAttribute("version","1.2");var l=n.createElement("meta");if(l.setAttribute("lastmodifieddate",$t()),e.creator){var h=n.createElement("creator");i=n.createTextNode(""+e.creator),h.appendChild(i),l.appendChild(h)}if(e.description){var c=n.createElement("description");i=n.createTextNode(""+e.description),c.appendChild(i),l.appendChild(c)}var f=n.createElement("graph");f.setAttribute("mode","static");var g=n.createElement("nodes");t.nodes.forEach((function(t){var e=n.createElement("node");if(e.setAttribute("id",String(t.id)),t.text&&e.setAttribute("label",qt(t.text)),Jv(t.data)){var i=$v(t.data),a=n.createElement("attvalues");Object.keys(i).forEach((function(t){t in o||(o[t]={id:s,type:"integer"},s++);var e=i[t];o[t].type=Qv(e,o[t].type);var r=n.createElement("attvalue");r.setAttribute("for",o[t].id),r.setAttribute("value",qt(e)),a.appendChild(r)})),e.appendChild(a)}if(t.color){var u=r.parseColor(t.color);if(u){var d=n.createElement("viz:color");d.setAttribute("r",Kv(u[0])),d.setAttribute("g",Kv(u[1])),d.setAttribute("b",Kv(u[2])),d.setAttribute("a",u[3]),e.appendChild(d)}}var l=n.createElement("viz:position");if(l.setAttribute("x",t.x),l.setAttribute("y",-t.y),e.appendChild(l),t.size){var h=n.createElement("viz:size");h.setAttribute("value",t.size),e.appendChild(h)}g.appendChild(e)}));var p=n.createElement("attributes");p.setAttribute("class","node"),Object.keys(o).forEach((function(t){var e=n.createElement("attribute");e.setAttribute("id",o[t].id),e.setAttribute("title",t),e.setAttribute("type",o[t].type),p.appendChild(e)}));var _=n.createElement("edges");t.edges.forEach((function(t){var e=n.createElement("edge");if(e.setAttribute("id",t.id.toString()),e.setAttribute("source",t.source),e.setAttribute("target",t.target),t.size&&e.setAttribute("weight",t.size),t.text&&e.setAttribute("label",qt(t.text)),Jv(t.data)){var i=$v(t.data),o=n.createElement("attvalues");Object.keys(i).forEach((function(t){t in a||(a[t]={id:u,type:"integer"},u++);var e=i[t];a[t].type=Qv(e,a[t].type);var r=n.createElement("attvalue");r.setAttribute("for",a[t].id),r.setAttribute("value",qt(e)),o.appendChild(r)})),e.appendChild(o)}if(t.color){var s=r.parseColor(t.color);if(s){var d=n.createElement("viz:color");d.setAttribute("r",Kv(s[0])),d.setAttribute("g",Kv(s[1])),d.setAttribute("b",Kv(s[2])),d.setAttribute("a",s[3]),e.appendChild(d)}}if(t.size){var l=n.createElement("viz:size");l.setAttribute("value",t.size),e.appendChild(l)}_.appendChild(e)}));var v=n.createElement("attributes");return v.setAttribute("class","edge"),Object.keys(a).forEach((function(t){var e=n.createElement("attribute");e.setAttribute("id",a[t].id),e.setAttribute("title",t),e.setAttribute("type",a[t].type),v.appendChild(e)})),f.appendChild(p),f.appendChild(v),f.appendChild(g),f.appendChild(_),d.appendChild(l),d.appendChild(f),n.appendChild(d),'<?xml version="1.0" encoding="UTF-8"?>'+n.serialize()}(jv(t.modules.graph,t.modules.individualAttributes,{styles:r,nodes:n,edges:o,filter:l,nodeData:h,edgeData:c}),{creator:u,description:d});return a&&Nt(f,s,"text"),Promise.resolve(f)}}}(t)),tm(t)),(i=t,{json:function(t){void 0===t&&(t={});var e=tt(t,im),r=e.nodeAttributes,n=e.edgeAttributes,o=e.nodeData,a=e.edgeData,s=e.filter,u=e.pretty,d=e.download,l=e.filename,h=Vv(i.modules.graph,{nodeAttributes:r,edgeAttributes:n,filter:s,nodeData:o,edgeData:a}),c=u?JSON.stringify(h,null," "):JSON.stringify(h);return d&&Nt(c,l,"text"),Promise.resolve(c)}})),(e=t,{png:function(t){return void 0===t&&(t={}),fm(e,t,"png")},jpg:function(t){return void 0===t&&(t={}),fm(e,t,"jpg")},tiff:function(t){return void 0===t&&(t={}),fm(e,t,"tiff")},gif:function(t){return void 0===t&&(t={}),fm(e,t,"gif")}})),function(t){return{svg:function(e){return void 0===e&&(e={}),function(t,e){var i=tt(e,ym),r=i.background,n=i.filename,o=i.download,a=t.modules.graphics;null===r&&(i.background=a.getTransparentBackgroundColor());var s=rm(t,i);return nm(t,i,s,"svg",!i.images).then((function(t){return t.removeAttribute("pointer-events"),t.setAttribute("version","1.1"),t.setAttributeNS(Rt,"xmlns",Ft),t.setAttributeNS(Rt,"xmlns:xlink",Pt),t})).then((function(e){return function(t,e,i){for(var r=e.childNodes[2],n=r.childNodes,o={},a=i.prefix,s=0;s<n.length;s++){var u=(E=n[s]).getAttribute(Ga);null!=u&&(o[u]=o[u]||[],o[u].push(E))}var d=Object.keys(o),l=t.modules.graph,h=l.getNodeAttribute("id"),c=l.getEdgeAttribute("id"),f=Dt("g",{class:a+"-edges"}),g=Dt("g",{class:a+"-nodes"});for(s=0;s<d.length;s++){var p=d[s],_="n"===p.charAt(0),v=parseInt(p.substring(1)),m=o[p],y=qt((_?h:c).get(v).toString()),b=Dt("g");b.setAttribute("data-"+(_?"node":"edge")+"-id",y),b.setAttribute("class",a+"-"+(_?"node":"edge"));for(var x=0;x<m.length;x++){var E=m[x];b.appendChild(E),E.removeAttribute(Ga)}(_?g:f).appendChild(b)}return r.appendChild(f),r.appendChild(g),e}(t,e,i)})).then((function(t){return r=i,n=function(t){for(var e=[].concat(Array.prototype.slice.call(t.getElementsByTagName("text")||[]),Array.prototype.slice.call(t.getElementsByTagName("tspan")||[])),i=[],r={},n=0;n<e.length;n++){var o=e[n].getAttribute("font-family");if("string"==typeof o)for(var a=o.split(","),s=0;s<a.length;s++){var u=a[s].replace(/['"]/g,"");""===u||r[u]||(r[u]=!0,i.push(u))}}return{list:i,map:r}}(e=t).map,Hn().then((function(t){return t.filter((function(t){return n[t.name]}))})).then((function(t){return Wn(t,!!r.embedFonts)})).then((function(t){if(0!==t.length){for(var i=Dt("style"),r=0;r<t.length;r++)i.appendChild(zt(t[r]));e.childNodes[0].appendChild(i)}return e}));var e,r,n})).then((function(t){var e='<?xml version="1.0" encoding="utf-8"?>'+To(t);return o&&Nt(e,n,"text/xml"),e}))}(t,e)}}}(t)),function(t){return{xlsx:function(e){"string"==typeof e&&(e={what:e});var i=tt(e,bm),r=i.what,n=i.nodes,o=i.edges,a=i.tab,s=void 0===a?{nodes:function(){return"nodes"},edges:function(){return"edges"}}:a,u=i.download,d=i.filename,l=i.dataProperties,h=i.filter,c=i.nodeData,f=i.edgeData;s.nodes||(s.nodes=function(){return"nodes"}),s.edges||(s.edges=function(){return"edges"});var g=jv(t.modules.graph,t.modules.individualAttributes,{styles:"none",nodes:n,edges:o,filter:h,nodeData:function(t){return t},edgeData:function(t){return t}}),p=function(t,e,i){var r=e.what,n=e.tabFunctions,o=e.tabContentFunctions,a=N("XLSX")||N("xlsx",{throwOnError:!0});if(!a)throw Error('The xlsx exports requires the "xlsx" peer dependency to be associated');var s=new Em;if(r){if("nodes"!==r&&"edges"!==r)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+r);"nodes"===r&&(t.edges=[]),"edges"===r&&(t.nodes=[])}for(var u={},d=0,l=["nodes","edges"];d<l.length;d++)for(var h=l[d],c=Wv(t[h],h,n[h],o[h],i[h]),f=0,g=Object.keys(c);f<g.length;f++){var p=g[f];u[p]=w(u[p]||[],c[p])}for(var _=0,v=Object.keys(u);_<v.length;_++)p=v[_],s.SheetNames.push(p),s.Sheets[p]=xm(a,qv(u[p]));return Lt([function(t){for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),r=0;r!==t.length;++r)i[r]=255&t.charCodeAt(r);return e}(a.write(s,{bookType:"xlsx",bookSST:!1,type:"binary"}))])}(g,{what:r,tabFunctions:s,tabContentFunctions:{nodes:c||function(t){return rt(Z(t||{}),l)},edges:f||function(t){return rt(Z(t||{}),l)}}},{nodes:t.modules.graph.getNodes(g.nodes.map((function(t){return t.id}))),edges:t.modules.graph.getEdges(g.edges.map((function(t){return t.id})))});return u&&Nt(p,d,"blob"),Promise.resolve(p)}}}(t));var e,i}var Sm=(wm.initNamespace=function(t){t.export=Am(t)},wm);function wm(){}var Tm=function(t){var e,i=void 0===t?{}:t,r=i.children,n=void 0===r?2:r,o=i.height,a=void 0===o?3:o;if(!("number"==typeof(e=n)&&isFinite(e)&&0<e&&e))throw new TypeError('Invalid argument: "children" is not a positive number, was '+n);if(!tu(a))throw new TypeError('Invalid argument: "height" is not a positive number, was '+a);return{children:n,height:a}},Cm=function(t){var e=t.children,i=t.height;i+=1;for(var r=Math.pow(e,i),n=[],o=[],a=1,s=0,u=0,d=0;d<i;++d){for(var l=r/(a+1)/1.5,h=0;h<a;++h){var c=s++;if(n.push({id:c,attributes:{x:(h+1)*l*10,y:20*d}}),d!==i-1)for(var f=0;f<e;++f)o.push({id:u,source:c,target:c*e+f+1}),u+=1}a*=e}return{nodes:n,edges:o}},Mm=function(t){var e=void 0===t?{}:t,i=e.nodes,r=void 0===i?40:i,n=e.m0,o=void 0===n?5:n,a=e.m,s=void 0===a?1:a,u=e.scale,d=void 0===u?100:u;if(!$s(r)||r<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+r);if(!$s(o)||r<=o)throw new TypeError("Invalid argument: options.m0 is not a number < "+r+", was "+o);if(!$s(o)||o<=s)throw new TypeError("Invalid argument: options.m is not a number <= "+o+", was "+s);if(!$s(d)||d<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:r,m0:o,m:s,scale:d}},Im=function(t){for(var e=t.scale,i=t.nodes,r=t.m0,n=t.m,o={nodes:[],edges:[]},a={},s=[],u=e/10,d=0,l=0;l<r;l++)o.nodes.push({id:l,attributes:{x:Math.random()*u,y:Math.random()*u}}),s[l]=0;for(l=0;l<r;l++)for(var h=l+1;h<r;h++)a[(v={id:d++,source:l,target:h}).source+"-"+v.target]=v,o.edges.push(v),s[l]++,s[h]++;for(l=r;l<i;l++){o.nodes.push({id:l,attributes:{x:Math.random()*e,y:Math.random()*e}});var c=s[l]=0;for(h=0;h<l;h++)c+=s[h];for(var f=0,g=0;g<n;g++){var p=Math.random(),_=0;for(h=0;h<l;h++)if(!a[l+"-"+h]&&!a[h+"-"+l]&&p<=(_=1===l?1:_+s[h]/c+f/(l-g))){var v;f+=s[h]/c,a[(v={id:d++,source:l,target:h}).source+"-"+v.target]=v,o.edges.push(v),s[l]++,s[h]++;break}}}return o},Lm=function(t){var e=void 0===t?{}:t,i=e.nodes,r=void 0===i?20:i,n=e.edges,o=e.p,a=e.scale,s=void 0===a?100:a;if(!$s(r)||r<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+r);if(void 0!==n&&void 0!==o)throw new TypeError("Invalid argument: choose between options.edges and options.p");return void 0===n&&void 0===o&&(o=.1),void 0===o&&(o=-1),void 0===n&&(n=-1),{nodes:r,p:o,edges:n,scale:s}},Nm=function(t){var e={nodes:[],edges:[]},i=t.nodes,r=t.p,n=t.scale;if(0<=r)for(var o=0,a=0;a<i;a++){e.nodes.push({id:a,attributes:{x:Math.random()*n,y:Math.random()*n}});for(var s=0;s<a;s++)Math.random()<r&&e.edges.push({id:o++,source:a,target:s})}else{var u=[],d=t.edges;for(a=0;a<i;a++)for(e.nodes.push({id:a,attributes:{x:100*Math.random(),y:100*Math.random()}}),s=a+1;s<i;s++)u.push({source:a,target:s});for(o=u.length-1,a=0;a<d;a++){var l=u.splice(Math.floor(Math.random()*o),1)[0];l.id=a,e.edges.push(l),o--}}return e};function km(t){return 10*Math.pow(2.7,t)}function Om(t){return 5+km(t)/10}var Fm=function(t){var e=t.depth,i=void 0===e?3:e,r=t.breadth,n=void 0===r?3:r,o=t.nbNodes;return void 0!==o?(n=5,i=Math.ceil(Math.log(o)/Math.log(5))):o=-1,{depth:i,breadth:n,nbNodes:o}},Rm=function(t){var e=t.depth,i=t.breadth,r=t.nbNodes,n={id:0,attributes:{x:0,y:0,radius:Om(e+1)}},o={nodes:[n],edges:[]};return function t(e,i,r,n,o){if(0===r)return o;for(var a=km(r),s=Om(r),u=.2*s,d=-Math.PI,l=2*Math.PI/i,h=n.attributes.x||0,c=n.attributes.y||0,f=0;f<i;++f){var g={id:o,attributes:{x:h+a*Math.cos(d),y:c+a*Math.sin(d),radius:s}},p={id:o,source:n.id,target:o,attributes:{width:u}};e.nodes.push(g),e.edges.push(p),o=t(e,i,r-1,g,o+1),d+=l}return o}(o,i,e,n,1),void 0!==r&&0<=r&&(o.nodes=o.nodes.slice(0,r),o.edges=o.edges.slice(0,Math.max(r-1,0))),o},Pm=function(t){var e=void 0===t?{}:t,i=e.rows,r=void 0===i?4:i,n=e.columns,o=void 0===n?4:n,a=e.columnDistance,s=void 0===a?20:a,u=e.rowDistance,d=void 0===u?20:u,l=e.xmin,h=void 0===l?0:l,c=e.ymin;return{rows:r,columns:o,columnDistance:s,rowDistance:d,xmin:h,ymin:void 0===c?0:c}},Dm=function(t){for(var e=t.rows,i=t.columns,r=t.columnDistance,n=t.rowDistance,o=t.xmin,a=t.ymin,s={nodes:[],edges:[]},u=0,d=0;d<e;++d)for(var l=0;l<i;++l){var h=d*i+l;s.nodes.push({id:h,attributes:{x:o+l*r,y:a+d*n}}),l!==i-1&&(s.edges.push({id:u,source:h,target:d*i+l+1}),u++),d!==e-1&&(s.edges.push({id:u,source:h,target:(d+1)*i+l}),u++)}return s},zm=function(t){var e=void 0===t?{}:t,i=e.nodes,r=void 0===i?10:i,n=e.edges,o=void 0===n?10:n,a=e.texts,s=void 0!==a&&a,u=e.scale;return{nodes:r,edges:o,texts:s,scale:void 0===u?100:u}},Bm=function(t){for(var e=t.nodes,i=t.edges,r=t.texts,n=t.scale,o=[],a=[],s=0;s<e;s++)o.push({id:s,attributes:{x:Math.random()*n,y:Math.random()*n,text:r?"Node "+s:void 0}});for(s=0;s<i;s++)a.push({id:s,source:Math.random()*e|0,target:Math.random()*e|0,attributes:{text:r?"Edge "+s:void 0}});return{nodes:o,edges:a}},Um=function(t){var e=void 0===t?{}:t,i=e.nodes,r=void 0===i?50:i,n=e.width,o=void 0===n?100:n,a=e.height,s=void 0===a?100:a,u=e.x,d=void 0===u?0:u,l=e.y,h=void 0===l?0:l;if(!isFinite(r)||r<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:r,width:o,height:s,x:d,y:h}},Vm=function(t){var e=t.nodes,i=t.x,r=t.y,n=t.width,o=t.height,a=i-n/2,s=r-o/2;return{nodes:new Array(e).fill(0).map((function(t,e){return{id:e,attributes:{x:a+Math.random()*n,y:s+Math.random()*o}}})),edges:new Array(e-1).fill(0).map((function(t,e){return{id:e,source:Math.floor(Math.sqrt(e)),target:e+1}}))}},jm=function(t){var e=void 0===t?{}:t,i=e.length,r=void 0===i?5:i,n=e.scale;return{length:r,scale:void 0===n?100:n}},Gm=function(t){var e=t.length,i=t.scale,r={nodes:[],edges:[]};if(e<=0)return r;r.nodes.push({id:0,attributes:{x:Math.random()*i,y:Math.random()*i}});for(var n=1;n<e;++n)r.nodes.push({id:n,attributes:{x:Math.random()*i,y:Math.random()*i}}),r.edges.push({id:n-1,source:n-1,target:n});return r},Hm=(Wm.initNamespace=function(t){t.generate={balancedTree:function(t){return Promise.resolve(Cm(Tm(t)))},barabasiAlbert:function(t){return Promise.resolve(Im(Mm(t)))},erdosRenyi:function(t){return Promise.resolve(Nm(Lm(t)))},flower:function(t){return Promise.resolve(Rm(Fm(t)))},grid:function(t){return Promise.resolve(Dm(Pm(t)))},path:function(t){return Promise.resolve(Gm(jm(t)))},random:function(t){return Promise.resolve(Bm(zm(t)))},randomTree:function(t){return Promise.resolve(Vm(Um(t)))}}},Wm);function Wm(){}var qm=(Xm.initNamespace=function(t){var e;t.geo=(e=t,{enable:function(t){return e.modules.geo.enable(t)},disable:function(t){return e.modules.geo.disable(t)},setOptions:function(t){return e.modules.geo.setOptions(t)},getOptions:function(){return e.modules.geo.getOptions()},getMap:function(){return e.modules.geo.getMap()},enabled:function(){return e.modules.geo.isEnabled()},getCenter:function(){return e.modules.geo.getCenter()},getView:function(){return e.modules.geo.getView()},getZoom:function(){return e.modules.geo.getZoom()},setZoom:function(t){return e.modules.geo.setZoom(t)},setView:function(t,i,r){return e.modules.geo.setView(t,i,r)},setCenter:function(t,i){return e.modules.geo.setCenter(t,i)},toggle:function(t){return e.modules.geo.toggle(t)},resetCoordinates:function(){return e.modules.geo.resetCoordinates()},updateCoordinates:function(){return e.modules.geo.updateCoordinates()},getUnprojectedCoordinates:function(t){return e.modules.geo.getUnprojectedCoordinates(e.getNodes(t))}})},Xm);function Xm(){}function Ym(t,e,i,r){var n;void 0===r&&(r={}),Array.isArray(i)||i instanceof(e?gr:Ki)||(i=[i]);var o=r.virtual,a=void 0!==o&&o,s={elementsToRemove:t.getElements(e,i),virtual:a};t.fireEvent(ye.REQUEST_ELEMENTS_TO_DELETE,s);var u=(a?{elementsToRemove:i}:s).elementsToRemove;if(!u.size)return Promise.resolve();u=u.dedupe(),e&&Ym(t,!1,u.getAdjacentEdges({filter:"all"}),r);var d=u._indexes,l=t.storage.fetch(e),h=t.getCacheLists(e),c=l.getFlexArray("removed");if(We(l.getFlexArray("virtual").getMultiple(d))!==(a?d.length:0))throw new Error("Attempting to remove virtual elements; you should not do that");var f=((n={virtual:a})[e?"nodes":"edges"]=u,n);if(t.fireEvent(e?ye.BEFORE_REMOVE_NODES:ye.BEFORE_REMOVE_EDGES,f),h.visible.invalidList(),h.all.invalidList(),a||h.raw.invalidList(),t.setExcluded(u,!0),c.setMultiple(d,1),!e)for(var g=0;g<d.length;++g)t.topology.removeFromAdjacencyList(d[g]);return l.removeElements(d),t.setIndexFreeStep(1),t.fireEvent(e?ye.REMOVE_NODES:ye.REMOVE_EDGES,f),Promise.resolve()}var Zm=(Km.prototype.addNodes=function(t,e){return vr(this.modules.graph,!0,t,e)},Km.prototype.addEdges=function(t,e){return vr(this.modules.graph,!1,t,e)},Km.prototype.addNode=function(t,e){return _r(this.modules.graph,!0,t,e)},Km.prototype.addEdge=function(t,e){return _r(this.modules.graph,!1,t,e)},Km.prototype.removeNodes=function(t,e){return Ym(this.modules.graph,!0,t,e)},Km.prototype.removeEdges=function(t,e){return Ym(this.modules.graph,!1,t,e)},Km.prototype.removeNode=function(t,e){return Ym(this.modules.graph,!0,[t],e)},Km.prototype.removeEdge=function(t,e){return Ym(this.modules.graph,!1,[t],e)},Km.prototype.getNodes=function(t){return this.modules.graph.getNodes(t)},Km.prototype.getEdges=function(t){return this.modules.graph.getEdges(t)},Km.prototype.getNode=function(t){return this.modules.graph.getNode(t)},Km.prototype.getEdge=function(t){return this.modules.graph.getEdge(t)},Km.prototype.clearGraph=function(){this.modules.graph.clear()},Km.prototype.setGraph=function(t,e){return this.modules.graph.clear(),this.addGraph(t,e)},Km.prototype.addGraph=function(t,e){return i=this.modules.graph,n=e,s=void 0===(a=(r=t).nodes)?[]:a,u=r.edges,d=void 0===u?[]:u,void 0===n&&(n={}),n.batchSize?vr(i,!0,s,n).then((function(t){return o=t,vr(i,!1,d,n)})).then((function(t){return{nodes:o,edges:t}})):Promise.resolve({nodes:mr(i,!0,s,n),edges:mr(i,!1,d,n)});var i,r,n,o,a,s,u,d},Km.prototype.createNodeList=function(){return this.getNodes([])},Km.prototype.createEdgeList=function(){return this.getEdges([])},Km.prototype.getConnectedComponents=function(t){return void 0===t&&(t={}),this.modules.graph.getConnectedComponents(this.getNodes(t.filter),t)},Km.prototype.getConnectedComponentByNode=function(t,e){var i=this.modules.graph.getNode(t);if(void 0===i)throw new Error("getComponentByNode: cannot find node "+t);return this.modules.graph.getConnectedComponentByNode(i,e)[0]},Km);function Km(){}var Qm=(Jm.prototype.reloadFonts=function(){this.modules.graphics.reloadFonts()},Jm);function Jm(){}function $m(t){return t.charCodeAt(0)}var ty=$m(" "),ey=$m("<"),iy=$m(">"),ry=$m('"'),ny=$m("\n"),oy=$m("\r"),ay=$m("/"),sy=$m("\\"),uy=$m("a"),dy=$m("z"),ly=$m("A"),hy=$m("Z"),cy=$m("0"),fy=$m("9"),gy=$m(":");function py(t,e,i,r){var n=r.length;if(i-e===n){for(var o=0;o<n;++o)if(t[e+o]!==r[o])return;return 1}}function _y(t,e,i,r){for(var n=t.length,o=0;o<n;++o)if(py(e,i,r,t[o]))return o;return t.push(e.slice(i,r)),n}function vy(t,e,i){var r=yy(e,i),n=e[r];if(n===iy||n===ay)return r;for(var o,a,s,u=r,d=(o=e,a=u,s=r=by(e,r),_y(t.attributes,o,a,s));e[r]!==ry;)++r;for(u=++r;(n=e[r])!==ry;)n===sy&&++r,++r;return t.tokens.push(-3,d,u,r),r+1}function my(t){return t===ty||t===ny||t===oy}function yy(t,e){for(;my(t[e]);)++e;return e}function by(t,e){for(;i=t[e],uy<=i&&i<=dy||ly<=i&&i<=hy||i===gy||cy<=i&&i<=fy;)++e;var i;return e}function xy(t,e){var i=["return {","  id: undefined,","  attributes: {","    text: undefined,","    color: undefined,","    "+(t?"radius":"width")+": undefined",t?"  ,x: undefined":"",t?"  ,y: undefined":"","  },"];t||i.push("  source: undefined,","  target: undefined,");var r=Object.keys(e);r.length&&i.push("  data: {");for(var n=0;n<r.length;++n){var o=e[r[n]],a=o.title;i.push('  "'+a+'": '+(void 0!==o.default?JSON.stringify(o.default):void 0)+(n===r.length-1?"":","))}return r.length&&i.push("}"),i.push("};"),new Function(i.join("\n"))}function Ey(t){return-1===t.indexOf("\\")?t:t=t.replace(/\\"/g,'"')}function Ay(t){if(-1===t.indexOf("<gexf"))throw new Error("not a GEXF file");var e=function(t){for(var e=new Int32Array(t.length),i=0,r=t.length;i<r;++i)e[i]=t.charCodeAt(i);return e}(t),i=function(t,e){for(var i,r,n={tags:[],attributes:[],tokens:[]},o=n.tokens,a=yy(t,e);a<t.length;){var s=t[a];if(s===ey){if(t[a=yy(t,++a)]===ay)for(o.push(-2);t[++a]!==iy;);else{a=by(t,i=a);var u=_y(n.tags,t,i,a);for(o.push(-1,u),s=t[a];s!==iy&&s!==ay;)s=t[a=vy(n,t,a)];if(s===ay)for(o.push(-2);t[++a]!==iy;);}a+=1}else{for(i=a;t[++a]!==ey;);for(r=a-1;my(t[r]);)--r;o.push(-4,i,r+1)}a=yy(t,a)}return n}(e,t.indexOf("<gexf ")),r={},n={};i.tags.forEach((function(t,e){var i=String.fromCharCode.apply(null,t);r[i]=e})),i.attributes.forEach((function(t,e){var i=String.fromCharCode.apply(null,t);n[i]=e}));for(var o=r.attributes,a=r.attribute,s=r.node,u=r.edge,d=r.default,l=r["viz:position"],h=r["viz:size"],c=r["viz:color"],f=r.attvalue,g=n.class,p=n.id,_=n.type,v=n.title,m=n.label,y=n.source,b=n.target,x=n.x,E=n.y,A=n.r,S=n.g,w=n.b,T=n.a,C=n.value,M=n.for,I=n.weight,L={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5},N=0,k=i.tokens,O=k.length,F=new Array(16),R=0,P=0,D=0,z=!0,B={},U={},V="",j="",G="",H=void 0,W={attributes:{}},q=0,X=0,Y=0,Z=1,K="",Q=void 0,J=!1,$=!0,tt=null,et=null,it=[],rt=[],nt=0,ot={};N<O;){var at=k[N];if(-1===at)P=R,R=k[N+1],F[D]=R,D+=1,R===s?(W=(tt=tt||xy(!0,B))(),$=!0,ot=B):R===u&&(W=(et=et||xy(!1,U))(),$=!1,ot=U),N+=2;else if(-2===at){if(V&&R===a){ot=z?B:U;var st=L[j];(lt=H)&&(1===st?lt=+lt:2===st?lt=0|+lt:3===st?lt="true"===lt:5===st&&(lt=lt.split(" ").filter((function(t){return t})))),ot[V]={title:G||V,default:lt,type:st},j=G=V="",H=void 0}else if(R===s&&4===D)J&&W.attributes&&(W.attributes.color="rgba("+q+", "+X+", "+Y+", "+Z+")",Y=X=q=0,J=!(Z=1)),W.id||(W.id=++nt),it.push(W);else if(R===u&&4===D)W.id||(W.id=++nt),rt.push(W);else if(R===f&&6===D&&K){var ut=($?B:U)[K];ut&&(void 0===Q?Q=ut.default:(st=ut.type)&&(1===st?Q=+Q:2===st?Q=0|+Q:3===st?Q="true"===Q:5===st?Q=Q.split(" ").filter((function(t){return t})).map((function(t){return Ey(t)})):"string"==typeof e&&(Q=Ey(Q))),W.data[ot[K].title]=Q),K="",Q=null}R=P,P=F[--D-2],N+=1}else if(-3===at){var dt=k[N+1],lt=t.substring(k[N+2],k[N+3]);if(R===o)dt===g&&(z="edge"!==lt&&"edges"!==lt);else if(R===a)dt===p?V=lt:dt===_?j=lt:dt===v&&(G=lt);else if(R!==s&&R!==u||4!==D)if(R===l&&5===D){if(dt===x)W.attributes.x=parseFloat(lt);else if(dt===E){var ht=parseFloat(lt);W.attributes.y=0===ht?ht:-ht}}else R===c&&5===D?(J=!0,dt===A?q=parseInt(lt):dt===S?X=parseInt(lt):dt===w?Y=parseInt(lt):dt===T&&(Z=parseFloat(lt))):R===h&&5===D?dt===C&&($?W.attributes.radius=+lt:W.attributes.width=+lt):R===f&&6===D&&(dt===M||dt===p?K=lt:dt===C&&(Q=lt));else dt===p?W.id=lt:dt===m?W.attributes.text=lt:dt===y?W.source=lt:dt===b?W.target=lt:dt===I&&(W.attributes.width=+lt);N+=4}else{if(-4!==at)throw new Error("at index "+N+": token "+at);lt=t.substring(k[N+1],k[N+2]),R===d&&(H=lt),N+=3}}return{nodes:it,edges:rt}}function Sy(t,e){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(t[n])return wy(t[n])}}function wy(t){return"string"==typeof t||isFinite(t)?String(t):String(t.id||t._id)}function Ty(t,e,i){i=i||e,e in t&&(t.attributes[i]=t[e])}function Cy(t,e){void 0===e&&(e=function(t){return t});for(var i=e(JSON.parse(t)),r=i.nodes||[],n=i.edges||[],o=0;o<r.length;o++){var a=r[o];a.attributes||(a.attributes={}),"string"==typeof a.size&&(a.size=+a.size),"string"==typeof a.x&&(a.x=+a.x),"string"==typeof a.y&&(a.y=+a.y),Ty(a,"x"),Ty(a,"y"),Ty(a,"size","radius"),Ty(a,"color"),Ty(a,"text")}for(o=0;o<n.length;o++){var s=n[o];s.attributes||(s.attributes={}),"string"==typeof s.size&&(s.size=+s.size),Ty(s,"size","width"),Ty(s,"color"),Ty(s,"text")}return{nodes:r,edges:n}}function My(t,e){for(var i=0,r=0;r<20;++r){var n=i+t[r]+e[r];i=+(10<=n),t[r]=n%10}}function Iy(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}var Ly=new(Iy.prototype.int64ToString=function(t){var e=t.low,i=t.high;if(0===e&&0===i)return"0";!function(t,e,i){for(var r=0;r<32;++r)i[r]=+!!(t&1<<r);for(r=0;r<32;++r)i[r+32]=+!!(e&1<<r)}(e,i,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0);var r=(this._decimalPowerOfTwo[0]=1)===this._binaryNumber[63];r&&function(t){for(var e=0;e<64;++e)t[e]^=1;for(e=0;e<64&&!(t[e]^=1);++e);}(this._binaryNumber);for(var n=0;n<64;++n)this._binaryNumber[n]&&My(this._decimalNumber,this._decimalPowerOfTwo),My(this._decimalPowerOfTwo,this._decimalPowerOfTwo);var o=[],a=this._decimalNumber.length-1;for(r&&o.push("-");!this._decimalNumber[a];)--a;for(n=a;0<=n;--n)o.push(String(this._decimalNumber[n]));return o.join("")},Iy);function Ny(t){return Ly.int64ToString(t)}function ky(t){return"object"==typeof t&&"high"in t&&"low"in t}function Oy(t){return{gexf:function(t){return Promise.resolve(Ay(t))},gexfFromUrl:function(t){return Vt(t).then((function(t){return Ay(t)}))},janus:function(t){return Promise.resolve(function(t){var e=[],i=[];return function t(e,i,r){if(e&&"object"==typeof e){if(Array.isArray(e))return e.forEach((function(e){return t(e,i,r)}));if("vertex"===(s=e).type||"vertex"===s._type||s.inE||s.outE||s._inE||s._outE){var n={};e.properties&&Object.keys(e.properties).forEach((function(t){n[t]=e.properties[t][0].value}));var o=wy(e);for(var a in i.push({id:o,data:{id:e.id+"",categories:[e.label],properties:n}}),e)"properties"!==a&&t(e[a],i,r)}else{var s,u;if("edge"===(u=e).type||"edge"===u._type||u.inV||u.outV||u._outV||u._inV)for(var a in o=wy(e),r.push({id:o,source:Sy(e,["inV","_inV"]),target:Sy(e,["outV","_outV"]),data:{id:o,type:e.label,properties:e.properties||{}}}),e)"properties"!==a&&t(e[a],i,r);else Object.keys(e).forEach((function(n){return t(e[n],i,r)}))}}}("string"==typeof t?JSON.parse(t):t,e,i),{nodes:e,edges:i}}(t))},json:function(t,e){return Promise.resolve(Cy(t,e))},jsonFromUrl:function(t,e){return Vt(t).then((function(t){return Cy(t,e)}))},neo4j:function(t){return Promise.resolve((i="string"==typeof(e=t)?JSON.parse(e):e,r={nodes:[],edges:[]},n=new Set,o=new Set,i.records.forEach((function(t){t._fields.forEach((function(t){!function t(e,i,r,n){var o,a,s;i&&(Array.isArray(i)?i.forEach((function(i){return t(e,i,r,n)})):function(t){return"segments"in t}(i)?(o=e,a=r,s=n,i.segments.forEach((function(e){t(o,e.start,a,s),t(o,e.end,a,s),t(o,e.relationship,a,s)}))):(function(t){if("object"!=typeof t||null===t)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");for(var e,i=0,r=Object.keys(t.properties);i<r.length;i++){var n=r[i],o=t.properties[n];ky(o)&&(t.properties[n]=Ny(o))}if(void 0!==t.identity&&(ky(t.identity)&&(t.identity=Ny(t.identity)),"start"in(e=t)&&"end"in e)){var a=t.start.identity||t.start,s=t.end.identity||t.end;ky(a)&&(t.start=Ny(a)),ky(s)&&(t.end=Ny(s))}}(i),function(t){return"start"in t&&"end"in t&&"type"in t}(i)?n.has(i.identity)||(n.add(i.identity),e.edges.push({id:i.identity,source:i.start,target:i.end,data:{neo4jType:i.type,neo4jProperties:i.properties}})):r.has(i.identity)||(r.add(i.identity),e.nodes.push({id:i.identity,attributes:{x:100*Math.random(),y:100*Math.random()},data:{neo4jLabels:i.labels,neo4jProperties:i.properties}}))))}(r,t,n,o)}))})),r));var e,i,r,n,o}}}var Fy=(Ry.initNamespace=function(t){t.parse=Oy()},Ry.prototype.fetch=function(t){return Vt(t)},Ry);function Ry(){}var Py=(Dy.initNamespace=function(t){var e;t.keyboard=(e=t,{isKeyPressed:function(t){return e.modules.keyboard.isPressed(t)},resetKeys:function(){e.modules.keyboard.resetKeys()}})},Dy);function Dy(){}function zy(t,e){return t-e}var By={configure:function(t,e){var i=e.graph,r=e.data;if(void 0===t.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');var n,o,a=A(A({},t),{centralNode:(n=i,(o=t.centralNode)instanceof cr?o:n.getNode(o))}),s=a.centralNode,u=a.nodes,d=i.getNode(s);if(void 0===d)throw new Error('concentric layout: "centralNode" parameter is not valid');var l=d._index,h=d.getPosition(),c=h.x,f=h.y,g=u.getAttribute("layoutable"),p=i.getNodes(u)._indexes,_=Array.from(p.filter((function(t,e){return g[e]})));-1===_.indexOf(l)&&_.push(l);var v=i.getNodeAttribute("radius").getMultiple(p),m=function(t,e,i,r){if(e)return"random"===e?"random":"radius"===e?r.slice():"degree"===e?i.getDegree():t.getProperty(i,e)}(r,a.sortBy,u,v),y=_.reduce((function(t,e,i){return t[e]=i,t}),{}),b=_.map((function(t,e){return e})),x=new Set;t.edges.getExtremities()._indexes.forEach((function(t){x.add(t)}));var E=_.map((function(t){return i.topology.getAdjacentElements(!0,new Uint32Array([t])).filter((function(t){return x.has(t)})).map((function(t){return y[t]}))}));return{sourceNodeIndex:_.indexOf(l),centerX:"number"==typeof a.centerX?a.centerX:c,centerY:"number"==typeof a.centerY?a.centerY:f,list:_,indexes:b,size:_.length,totalSize:_.length,attributes:{adjacentNodes:E,size:v},sortAttr:m,clockwise:void 0===a.clockwise||a.clockwise,circleHopRatio:a.circleHopRatio||5,allowOverlap:!!a.allowOverlap}},context:function(){return{dijkstra:function(t,e,i,r,n){var o=Math.pow(2,31)-1,a=new Int32Array(r),s=new Int32Array(r),u=new Int8Array(r);a.fill(o),s.fill(-1);for(var d=0;d<r;++d){var l=e[d];void 0!==l&&(a[l]=o,s[l]=-1)}for(var h=a[n]=0,c=function(){var r=o;h=-1;for(var n=0;n<i;++n){var d=e[n],l=a[d];!u[d]&&l<r&&(r=l,u[h=d]=1)}if(-1<h){var c=t[h],f=r+1;c.forEach((function(t){var e=a[t];f<e&&(a[t]=f,s[t]=h)}))}};-1!==h;)c();return a},determinePropertyType:function(t,e,i){return e.some((function(e){return"number"!==t[e]}))?"string":"number"}}},update:function(t,e){for(var i=t.attributes,r=t.indexes,n=t.size,o=t.sourceNodeIndex,a=t.centerX,s=t.centerY,u=t.sortAttr,d=i.adjacentNodes,l=i.size,h=new Array(t.totalSize),c=new Array(t.totalSize),f=e.dijkstra(d,r,t.size,t.totalSize,o),g=0,p={},_=0;_<n;_++){var v=l[r[_]];g<v&&(g=v)}var m=g*t.circleHopRatio,y=0,b=0,x=Math.PI/9;for(_=0;_<n;_++){var E=r[_],A=f[E],S=p[A];S||(S=[],p[A]=S),S.push(E)}var w,T,C=(T=r,"random"===(w=u)?function(){return Math.random()-.5}:w?"number"===e.determinePropertyType(w,T,T.length)?function(t,e){return w[t]-w[e]}:function(t,e){return w[t]<w[e]?-1:1}:void 0),M="random"===u||u;return Object.keys(p).sort((function(t,e){return parseInt(t)-parseInt(e)})).forEach((function(e,i){var r,n=p[e],o=n.length,u=0,d=b,f=2*Math.PI/o;0===i||t.allowOverlap||2*Math.PI*y<(r=2*(u+=n.reduce((function(t,e){return t+l[e]}),0))*Math.SQRT2)&&(y+=r/(2*Math.PI)-y),M&&(n.sort(C),t.clockwise||n.reverse());for(var g=0;g<o;g++){var _=n[g];h[_]=Math.cos(d)*y+a,c[_]=Math.sin(d)*y+s;var v=l[_];d+=f*(t.allowOverlap?1:v/u*o)}y+=m,b+=x})),{x:h,y:c,indexes:t.list}},isRunning:function(){return!1},onSync:function(t){return{indexes:t.indexes,x:t.x,y:t.y}}},Uy={imports:{minHeap:Pc,bellmanFord:Dc,dijkstra:zc,johnson:Bc,distance:Pa,circleCircleIntersection:vd,circleSortCompare:md,weightedStress:kc,distanceStress:Oc,constrainedStress:Fc,stressMinimizationStep:Rc,removeRadialOverlap:Xc,quadraticInOut:bu,calculateRadii:Yc},configure:function(t,e){var i=e.graph,r=t.nodes,n=r.size;function o(t,e){return null!=t&&isFinite(t)?t:e}if(void 0===t.centralNode)throw new Error('radial layout: missing parameter "centralNode"');var a=i.getNode(t.centralNode);if(void 0===a)throw new Error('radial layout: parameter "centralNode" is not valid');t.radiusRatio=o(t.radiusRatio,Math.SQRT2),t.radiusDelta=o(t.radiusDelta,0),t.nodeGap=o(t.nodeGap,10),t.repulsion=n*o(t.repulsion,1);var s=a.getPosition(),u=o(t.centerX,s.x),d=o(t.centerY,s.y),l=a._index;r.includes(a)||(r=r.concat(a.toList()));var h=r._indexes,c=r.getAttribute("layoutable");(h=h.filter((function(t,e){return c[e]||t===l}))).sort(zy);var f=h.length,g=function(t,e,i){for(var r=t.slice().sort(zy),n=[],o=0,a=e.length;o<a;o++){for(var s=[],u=e[o],d=!1,l=0,h=u.length;l<h;l++){var c=u[l];-1!==D(r,c)&&(c===i&&(d=!0),s.push(c))}0!==s.length&&n[d?"unshift":"push"](s.sort(zy))}return n}(h,i.getConnectedComponents(r,{internalIndexes:!0}),l),p=i.degrees(h),_=new Float32Array(i.getNodeAttribute("x").getMultiple(h)),v=new Float32Array(i.getNodeAttribute("y").getMultiple(h)),m=i.getNodeAttribute("radius").getMultiple(h),y=i.getEdges()._indexes,b=i.getEdgeAttribute("source").getMultiple(y),x=i.getEdgeAttribute("target").getMultiple(y),E=i.getAdjacencyList({internalIndexes:!0,weight:1,indexes:h});return{centerIndex:l,centerIndexPos:0,cx:u,cy:d,D:null,indexes:h,components:g,normIndexes:null,radii:null,rings:null,x:_,y:v,degree:p,size:f,attributes:{size:m,adjacency:E,weights:x.map((function(){return 1})),sources:b,targets:x},sortAttr:null,allowOverlap:!!t.allowOverlap,nodeGap:t.nodeGap,radiusRatio:t.radiusRatio,radiusDelta:t.radiusDelta,repulsion:t.repulsion,randomize:!("randomize"in t)||!!t.randomize,renderSteps:!!t.renderSteps,epsilon:o(t.epsilon,.001),maxSteps:o(t.maxIterations,100),iterationsPerRender:o(t.iterationsPerRender,20),step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:function(){return{data:null,gridPlacement:function(t,e,i){void 0===i&&(i=8);for(var r=t.length,n=new Float32Array(r),o=new Float32Array(r),a=0,s=0,u=t.length;s<u;s++){var d=e[t[s]];a<d&&(a=d)}var l=a*i,h=Math.ceil(Math.sqrt(r)),c=Math.ceil(r/h),f=-Math.floor((c-1)*l/2),g=-Math.floor((h-1)*l/2);for(s=0;s<h;s++)for(var p=0;p<c;p++)n[s*c+p]=f+p*l,o[s*c+p]=g+s*l;return{x:n,y:o}},connectComponents:function(t,e,i,r,n,o){var a;function s(t,e){var i=new Uint32Array(t.length+1);return i.set(t),i[t.length]=e,i}for(var u=function(u){var d=t[u],l=0,h=0;d.forEach((function(t,e){var i=n.get(t);null!=i&&l<i&&(h=e,l=i)})),a=d[h];var c=e[o.get(a)];c.weights=c.weights||[],c.nodes=s(c.nodes,i),c.weights.push(r);var f=e[o.get(i)];f.weights=f.weights||[],f.nodes=s(f.nodes,a),f.weights.push(r)},d=1;d<t.length;d++)u(d)},correctSubgraphsDistances:function(t,e,i,r,n){for(var o=Array.prototype.reduce.call(t[i],(function(t,e,n){return n!==i&&e<r&&t<e&&(t=e),t}),0),a=r-o-1,s=1;s<e.length;s++)for(var u=e[s],d=0,l=u.length;d<l;d++){var h=n.get(u[d]);null!=h&&(t[i][h]-=a,t[h][i]-=a)}},initialize:function(t,e){(t.data=e).step=0;var i=new Map,r=new Map;e.normIndexes=e.indexes.reduce((function(n,o,a){return n[a]=a,i.set(o,a),r.set(o,e.degree[a]),t.data&&o===e.centerIndex&&(t.data.centerIndexPos=a),n}),new Uint32Array(e.indexes.length));var n=e.centerIndexPos,o=e.components[0].length;t.connectComponents(e.components,e.attributes.adjacency,e.centerIndex,o,r,i);var a=Bc({sources:e.attributes.sources,targets:e.attributes.targets,weights:e.attributes.weights,indexes:e.indexes,adjacency:e.attributes.adjacency,undirected:!0});t.correctSubgraphsDistances(a,e.components,n,o,i);for(var s=(e.D=a)[n],u=Object.create(null),d=0,l=e.normIndexes.length;d<l;d++)if(d!==n){var h=s[d];u[h]=u[h]||[],u[h].push(e.normIndexes[d])}e.rings=u,e.radii=Yc(n,e.rings,e.attributes.size,e.nodeGap,e.radiusRatio,e.radiusDelta)},removeOverlaps:function(t,e){if(t.data){var i=t.data.centerIndexPos,r=e.attributes.size,n=e.rings,o=e.x[i],a=e.y[i];for(var s in n){var u=n[s],d=Pa(o,a,e.x[u[0]],e.y[u[0]]);Xc({X:e.x,Y:e.y,sizes:r,indexes:u,center:[o,a],R:d,gap:e.nodeGap,inPlace:!0})}}}}},update:function(t,e){var i,r=(t=t||e.data).indexes,n=t.centerIndex;function o(e){return t.radii&&t.radii[e]||1}t.x=t.x||new Float32Array(t.size),t.y=t.y||new Float32Array(t.size),-1===t.step?e.initialize(e,t):t.step++;var a=t.repulsion;if(0===t.step)t.randomize&&(i=e.gridPlacement(t.indexes,t.attributes.size),t.x=i.x,t.y=i.y);else if(!t.converged)for(var s=t.maxSteps,u=t.iterationsPerRender,d=t.step,l=Math.min(d+u,s+1),h=t.D,c=t.x,f=t.y,g=t.size,p=t.centerIndexPos,_=t.normIndexes;d<=l||!t.converged;){var v=bu(Math.min(d,s)/s);t.step=d++,i=Rc(h,c,f,g,p,a,v,_,o),t.x=i.x,t.y=i.y,t.prevStress=t.stress,t.stress=Fc(h,c,f,g,p,a,v,_),t.converged=t.converged||Math.abs(t.stress-t.prevStress)<=t.epsilon}if(t.converged)if(t.overlapRemoved||t.allowOverlap){t.done=!0;var m=t.rings||{};t.rings=Object.keys(m).reduce((function(t,e){return t[e]=m[e].map((function(t){return r[t]})),t}),{})}else e.removeOverlaps(e,t,n),t.overlapRemoved=!0;return t},isRunning:function(t){var e=t.data;return!(!e||e.converged&&(e.allowOverlap||e.done))},onSync:function(t){if(t.renderSteps||t.done)return Vy(t)},onEnd:function(t,e){return Vy(t)}};function Vy(t){for(var e=t.x,i=t.y,r=t.indexes.length,n=e[t.centerIndexPos]-t.cx,o=i[t.centerIndexPos]-t.cy,a=0;a<r;a++)e[a]-=n,i[a]-=o;return{indexes:t.indexes,x:e,y:i}}
/**
  * @preserve
  * @linkurious/force-layout@0.4.0
  * Ogma general-purpose force-directed layout
  */function jy(){return function(){var t=function(t){var e,i=(e=4022871197,function(t){t=t.toString();for(var i=0;i<t.length;i++){var r=.02519603282416938*(e+=t.charCodeAt(i));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});this.c=1,this.s0=i(" "),this.s1=i(" "),this.s2=i(" "),this.s0-=i(String(t)),this.s0<0&&(this.s0+=1),this.s1-=i(String(t)),this.s1<0&&(this.s1+=1),this.s2-=i(t),this.s2<0&&(this.s2+=1),i=null};function e(e){return new t(e.toString()).next()}t.prototype.next=function(){var t=this;return function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)}},t.prototype.nextDouble=function(){var t=this.next();return function(){return t()+11102230246251565e-32*(2097152*t()|0)}},t.prototype.nextInt32=function(){var t=this.next();return function(){return 4294967296*t()|0}};var i=e(42);function r(t){i=e(t)}function n(){return 1e-6*(i()-.5)}var o=function(t){return t.x},a=function(t){return t.y},s=function(t){return t.r};function u(t,e,i,r){void 0===e&&(e=o),void 0===i&&(i=a),void 0===r&&(r=s);for(var n,u=function(t){for(var e=t.length-1;0<=e;e--){var i=Math.floor(Math.random()*(e+1));i=Math.max(Math.min(i,e),0);var r=t[e];t[e]=t[i],t[i]=r}return t}(t.slice()),l=u.length,c=[],g=0;g<l;){var p=u[g];n&&h(n,e(p),i(p),r(p))?g++:(n=f(c=d(c,p,e,i,r),e,i,r),g=0)}return n}function d(t,e,i,r,n){var o=i(e),a=r(e),s=n(e),u={x:o,y:a,r:s};if(c(u,t,i,r,n))return[e];for(var d=0;d<t.length;++d){var h=t[d],f=i(h),_=r(h),v=n(h);if(!l(u,f,_,v)&&c(g(f,_,v,o,a,s),t,i,r,n))return[t[d],e]}for(var m=0;m<t.length-1;m++)for(var y=m+1;y<t.length;y++){var b=t[m],x=t[y],E=i(b),A=r(b),S=n(b),w=i(x),T=r(x),C=n(x);if(!l(g(E,A,S,w,T,C),o,a,s)&&!l(g(E,A,S,o,a,s),w,T,C)&&!l(g(w,T,C,o,a,s),E,A,S)&&c(p(E,A,S,w,T,C,o,a,s),t,i,r,n))return[t[m],t[y],e]}throw new Error}function l(t,e,i,r){var n=t.r-r,o=e-t.x,a=i-t.y;return 0<=n&&o*o+a*a<n*n}function h(t,e,i,r){var n=t.r-r+1e-6,o=e-t.x,a=i-t.y;return 0<n&&o*o+a*a<n*n}function c(t,e,i,r,n){for(var o=0;o<e.length;++o){var a=e[o];if(!h(t,i(a),r(a),n(a)))return}return 1}function f(t,e,i,r){return 1===t.length?{x:e(t[0]),y:i(t[0]),r:r(t[0])}:2===t.length?g(e(t[0]),i(t[0]),r(t[0]),e(t[1]),i(t[1]),r(t[1])):p(e(t[0]),i(t[0]),r(t[0]),e(t[1]),i(t[1]),r(t[1]),e(t[2]),i(t[2]),r(t[2]))}function g(t,e,i,r,n,o){var a=r-t,s=n-e,u=o-i,d=Math.sqrt(a*a+s*s);return{x:(t+r+a/d*u)/2,y:(e+n+s/d*u)/2,r:(d+i+o)/2}}function p(t,e,i,r,n,o,a,s,u){var d=t-r,l=t-a,h=e-n,c=e-s,f=o-i,g=u-i,p=t*t+e*e-i*i,_=p-r*r-n*n+o*o,v=p-a*a-s*s+u*u,m=l*h-d*c,y=(h*v-c*_)/(2*m)-t,b=(c*f-h*g)/m,x=(l*_-d*v)/(2*m)-e,E=(d*g-l*f)/m,A=b*b+E*E-1,S=2*(i+y*b+x*E),w=y*y+x*x-i*i,T=-(A?(S+Math.sqrt(S*S-4*A*w))/(2*A):w/S);return{x:t+y+b*T,y:e+x+E*T,r:T}}for(var _=[0,1],v=[0,2],m=4;m<65535;m<<=2)for(var y=0,b=_.length;y<b;y++)_.push(_[y]|m),v.push((_[y]|m)<<1);function x(t,e){return(v[255&e]|_[255&t])+65536*(v[e>>8&255]|_[t>>8&255])+4294967296*(v[e>>16&255]|_[t>>16&255])}function E(t,e){var i=t^e,r=65535^i,n=65535^(t|e),o=t&(65535^e),a=i|r>>1,s=i>>1^i,u=n>>1^r&o>>1^n,d=i&n>>1^o>>1^o;s=(i=a)&(r=s)>>2^r&(i^r)>>2,u^=i&(n=u)>>2^r&(o=d)>>2,d^=r&n>>2^(i^r)&o>>2,s=(i=a=i&i>>2^r&r>>2)&(r=s)>>4^r&(i^r)>>4,u^=i&(n=u)>>4^r&(o=d)>>4,d^=r&n>>4^(i^r)&o>>4,u^=(i=a=i&i>>4^r&r>>4)&(n=u)>>8^(r=s)&(o=d)>>8;var l=t^e,h=(r=(d^=r&n>>8^(i^r)&o>>8)^d>>1)|65535^(l|(i=u^u>>1));return((h=1431655765&((h=858993459&((h=252645135&((h=16711935&(h|h<<8))|h<<4))|h<<2))|h<<1))<<1|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&(l|l<<8))|l<<4))|l<<2))|l<<1)))>>>0}var A=new Uint32Array(1024);function S(t,e,i,r){this.left=null,this.right=null,this.data=null,this.code=t,this.data=e,this.left=i,this.right=r}var w,T,C=Math.clz32||function(t){for(var e=1<<31,i=0;i<31;i+=1){if(e&t)return i;e>>>=1}return 32};function M(t,e,i,r){var n=e[t[i]],o=e[t[r]];if(n===o)return i;for(var a,s,u=C(n^o),d=i,l=r-i;(a=d+(l=l+1>>1))<r&&(s=e[t[a]],u<C(n^s)&&(d=a)),1<l;);return d}(T=w=w||{})[T.HILBERT=1]="HILBERT",T[T.MORTON=0]="MORTON";var I,L,N,k,O,F,R,P,D,z=function(t,e){void 0===e&&(e={});var i=e.getX,r=e.getY,n=e.bucketSize;void 0===n&&(n=0);var o=e.sfc;void 0===o&&(o=w.HILBERT),this.bucketSize=0,this._root=null;var a=t.length,s=new Uint32Array(a),u=1/0,d=1/0,l=-1/0,h=-1/0;this._x=i,this._y=r;var c=o===w.HILBERT?E:x;this._project=c;for(var f=new Uint32Array(a),g=0;g<a;g++){var p=t[g],_=i(p),v=r(p);_<u&&(u=_),v<d&&(d=v),l<_&&(l=_),h<v&&(h=v),f[g]=g}this._minX=u,this._minY=d,this._maxX=l,this._maxY=h;var m=65535/Math.max(l-u,1),y=65535/Math.max(h-d,1);this._hw=m,this._hh=y;for(var b=0;b<a;b++){var T=t[b];s[b]=c(m*(i(T)-u),y*(r(T)-d))}!function(t,e){for(var i=new Uint32Array(e.length),r=0;r<1024;r++)A[r]=0;for(var n=0;n<e.length;n++){var o=e[n];A[255&o]++,A[256+(o>>8&255)]++,A[512+(o>>16&255)]++,A[768+(o>>24&255)]++}for(var a=0;a<4;a++)for(var s=0,u=0,d=256*a,l=0;l<256;l++)s=A[l+d],A[l+d]=u,u+=s;for(var h=0;h<e.length;h++){var c=e[h];i[A[255&c]++]=h}for(var f=0;f<e.length;f++){var g=i[f],p=e[g];t[A[256+(p>>8&255)]++]=g}for(var _=0;_<e.length;_++){var v=t[_],m=e[v];i[A[512+(m>>16&255)]++]=v}for(var y=0;y<e.length;y++){var b=i[y],x=e[b];t[A[768+(x>>24&255)]++]=b}}(f,s),this._root=0===n?function(t,e,i,r,n){for(var o=new S(null,null,null,null),a=[o],s=[0,n];0!==a.length;){var u=s.pop(),d=s.pop(),l=a.pop();if(u-d==0)l.code=i[d],l.data=t[e[d]];else{var h=M(e,i,d,u);d<=(l.code=h)&&(l.left=new S(null,null,null,null),a.push(l.left),s.push(d,h)),h<u&&(l.right=new S(null,null,null,null),a.push(l.right),s.push(h+1,u))}}return o}(t,f,s,0,a-1):function(t,e,i,r,n,o){for(var a=new S(null,null,null,null),s=[a],u=[0,n];0!==s.length;){var d=u.pop(),l=u.pop(),h=s.pop();if(d-l<o){for(var c=new Array(d-l+1),f=l,g=0;f<=d;f++,g++)c[g]=t[e[f]];h.code=i[l],h.data=c}else{var p=M(e,i,l,d);l<=(h.code=p)&&(h.left=new S(null,null,null,null),s.push(h.left),u.push(l,p)),p<d&&(h.right=new S(null,null,null,null),s.push(h.right),u.push(p+1,d))}}return a}(t,f,s,0,a-1,n),this.bucketSize=n},B={root:{configurable:!0}};B.root.get=function(){return this._root},z.prototype.inOrder=function(t,e){for(var i=this._root,r=[],n=!1;!n;)if(i)r.push(i),i=i.left;else if(0!==r.length){if(i=r.pop(),t.call(e,i))break;i=i.right}else n=!0;return this},z.prototype.preOrder=function(t,e){for(var i=[this._root];0!==i.length;){var r=i.pop();t.call(e,r)||(r.right&&i.push(r.right),r.left&&i.push(r.left))}return this},z.prototype.postOrder=function(t,e){var i,r=[],n=this._root;do{for(;n;)n.right&&r.push(n.right),r.push(n),n=n.left;n=r.pop(),i=r.length-1,n=n.right&&r[i]===n.right?(r[i]=n).right:(t.call(e,n),null)}while(0!==r.length);return this},z.prototype.map=function(t,e){var i=[];return this.inOrder((function(r){i.push(t.call(e,r))})),i},z.prototype.height=function(){return function t(e){return e?1+Math.max(t(e.left),t(e.right)):0}(this._root)},z.prototype.toString=function(t){void 0===t&&(t=function(t){return t.code.toString()});var e=[];return function t(e,i,r,n,o){if(e){n(i+(r?"^-- ":"|-- ")+o(e)+"\n");var a=i+(r?"    ":"|   ");e.left&&t(e.left,a,!1,n,o),e.right&&t(e.right,a,!0,n,o)}}(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},z.prototype.size=function(){var t=0;return this.preOrder((function(){t++})),t},z.prototype.destroy=function(){return this._root=null,this},Object.defineProperties(z.prototype,B);var U,V,j,G,H,W,q,X,Y,Z=0;function K(t,e,i,r){var n=r.X,o=r.Y,a=r.R,s=r.bucketSize;Z=t,null===i&&(i=new z(e,{getX:N,getY:k,bucketSize:s})).postOrder(I);for(var u=e.length,d=0;d<u;d++)F=e[d],R=n[F],P=o[F],D=a[F],i.preOrder(L);return i}function Q(t,e,i,r){for(var o=i.sources,a=i.targets,s=i.X,u=i.Y,d=i.R,l=i.fx,h=i.fy,c=i.degrees,f=i.weights,g=r.edgeStrength,p=r.edgeLength,_=0;_<e.length;_++){var v=e[_],m=o[v],y=a[v],b=c[m]+1,x=c[y]+1,E=g*f[v],A=s[y]+l[y]-s[m]-l[m]||n(),S=u[y]+h[y]-u[m]-h[m]||n(),w=A*A+S*S,T=Math.sqrt(w),C=p+d[m]+d[y];if(!(T<=C)){var M=C-T,I=1/Math.min(b,x),L=Math.min(1,t*E*(M*M/w)*I);A*=L,S*=L;var N=x/(x+b);l[m]+=A*N,h[m]+=S*N,l[y]-=A*(1-N),h[y]-=S*(1-N)}}}function J(t,e,i,r,n){var o=r.X,a=r.Y,s=r.R,u=r.fx,d=r.fy,l=r.bucketSize;if(0===n.elasticity)return i;i||(i=new z(e,{getX:U,getY:V,bucketSize:l})).postOrder(G);for(var h=0;h<e.length;h++)W=e[h],q=o[W]+u[W],X=a[W]+d[W],Y=s[W],i.preOrder(H);return i}function $(t,e,i,r){for(var o=i.pinned,a=i.X,s=i.Y,u=i.fx,d=i.fy,l=r.gravity,h=r.cx,c=r.cy,f=0,g=0,p=e.length,_=0;_<p;_++)f+=a[_],g+=s[_];f=f/p-h,g=g/p-c;for(var v=0;v<p;v++){var m=e[v];o[m]||(a[m]-=f,s[m]-=g)}for(var y=0;y<p;y++){var b=e[y],x=h-a[b]||n(),E=c-s[b]||n(),A=l*t;u[b]+=x*A,d[b]+=E*A}}K.initialize=function(t,e,i){var r=t.length,o=e.X,a=e.Y,s=e.R,d=e.degrees,l=e.pinned,h=e.masses,c=e.nodeIds,f=i.scaling,g=i.defaultRadius,p=i.bucketSize;e.bucketSize=void 0===p?Math.floor(Math.log(r)):p;for(var _,v,m,y,b,x,E=1/0,A=1/0,S=-1/0,w=-1/0,T=Math.PI*(3-Math.sqrt(5)),C=0;C<t.length;C++){var M=t[C],z=M.x,B=M.y,U=M.r,V=M.mass;if(isNaN(z)||isNaN(B)){var j=5*Math.sqrt(C),G=C*T;z=j*Math.cos(G),B=j*Math.sin(G)}o[C]=z,a[C]=B,s[C]=U||g,l[C]=M.pinned?1:0,h[C]=void 0===V?(1+d[C])*f:V,c[C]=C,z<E&&(E=z),B<A&&(A=B),S<z&&(S=z),w<B&&(w=B)}if(1<t.length&&(S-E==0||w-A==0))for(var H=(E+S)/2,W=(A+w)/2,q=0;q<r;q++)if(!l[q]){var X=5*Math.sqrt(q),Y=q*T,K=H+X*Math.cos(Y),Q=W+X*Math.sin(Y);(o[q]=K)<E&&(E=K),(a[q]=Q)<A&&(A=Q),S<K&&(S=K),w<Q&&(w=Q)}N=function(t){return o[t]},k=function(t){return a[t]},O=function(t){return s[t]},v=(_=e).X,m=_.Y,y=_.R,b=_.masses,x=_.bucketSize,I=function(t){var e,i=0,r=0,n=0,o=0,a=t.data;if(null!==a)if(0!==x){var s=a,d=u(s,N,k,O);i=d.x,r=d.y,n=d.r;for(var l=0;l<s.length;l++)o+=b[s[l]]}else i=v[a],r=m[a],n=y[a],o=b[a];else if(t.left&&t.right){var h=t.left.cx,c=t.left.cy,f=t.right.cx,g=t.right.cy,p=t.left.r,_=t.right.r,E=f-h,A=g-c,S=_-p,w=Math.sqrt(E*E+A*A);i=(h+f+E/w*S)/2,r=(c+g+A/w*S)/2,n=(w+p+_)/2,o=t.left.mass+t.right.mass}else i=(e=t.left||t.right).cx,r=e.cy,n=e.r,o=e.mass;t.cx=i,t.cy=r,t.r=n,t.mass=o},L=function(t,e){var i=t.fx,r=t.fy,o=t.X,a=t.Y,s=t.R,u=t.masses,d=t.bucketSize,l=e.charge,h=e.theta;return e.friction,function(t){var e=0,c=0,f=0,g=R-t.cx||n(),p=P-t.cy||n(),_=g*g+p*p,v=D+t.r,m=t.data;if(null!==m){if(m===F)return!1;if(0!==d)for(var y=m,b=0;b<y.length;b++){var x=y[b];x!==F&&(_=(g=R-o[x]||n())*g+(p=P-a[x]||n())*p,v=D+s[x],_<1&&(_=Math.sqrt(+_)),e=l*u[x],c=Z*e/_,i[F]+=g*c,r[F]+=p*c)}else _<1&&(_=Math.sqrt(+_)),e=l*t.mass,c=Z*e/_,i[F]+=g*c,r[F]+=p*c}else if((f=v/h)*f<_)return _<1&&(_=Math.sqrt(+_)),e=l*t.mass,c=Z*e/_,i[F]+=g*c,r[F]+=p*c,!0}}(e,i)},Q.initialize=function(t,e){for(var i=e.edgeIds,r=e.sources,n=e.targets,o=e.degrees,a=e.weights,s=0;s<t.length;s++){var u=t[s],d=u.source,l=u.target,h=u.weight;void 0===h&&(h=1),r[s]=d,n[s]=l,a[s]=h,o[d]++,o[l]++,a[i[s]=s]=void 0===h?1:h}},J.initialize=function(t,e,i){var r,o,a,s,d,l,h,c,f,g,p,_,v,m,y,b=e.X,x=e.Y,E=e.R;U=function(t){return b[t]},V=function(t){return x[t]},j=function(t){return E[t]},o=(r=e).X,a=r.Y,s=r.R,d=r.bucketSize,G=function(t){var e,i,r,n,l=t.data;if(null!==l)if(0!==d){var h=u(l,U,V,j);e=h.x,i=h.y,r=h.r}else e=o[l],i=a[l],r=s[l];else if(t.left&&t.right){var c=t.left.cx,f=t.left.cy,g=t.right.cx,p=t.right.cy,_=t.left.r,v=t.right.r,m=g-c,y=p-f,b=v-_,x=Math.sqrt(m*m+y*y);e=(c+g+m/x*b)/2,i=(f+p+y/x*b)/2,r=(x+_+v)/2}else(n=t.left||t.right)&&(e=n.cx,i=n.cy,r=n.r);t.cx=e,t.cy=i,t.r=r},h=i,c=(l=e).X,f=l.Y,g=l.R,p=l.fx,_=l.fy,v=l.bucketSize,m=h.elasticity,y=h.margin,H=function(t){var e=t.data;if(null===e){var i=t.cx-q,r=t.cy-X,o=t.r+Y;return o*o<i*i+r*r}if(0!==v)for(var a=e,s=0;s<a.length;s++){var u=a[s];if(W<u){var d=g[u],l=q-c[u]-p[u],h=X-f[u]-_[u],b=Y+d+y,x=l*l+h*h;if(x<b*b){0===l&&(x+=(l=n())*l),0===h&&(x+=(h=n())*h);var E=Math.sqrt(x),A=(b-E)*m/E,S=d/b;p[W]+=l*A*S,_[W]+=h*A*S,p[u]-=l*A*(1-S),_[u]-=h*A*(1-S)}}}else{var w=t.data;if(W<w){var T=g[w],C=q-c[w],M=X-f[w],I=Y+T+y,L=C*C+M*M;if(L<I*I){0===C&&(L+=(C=n())*C),0===M&&(L+=(M=n())*M);var N=Math.sqrt(L),k=(I-N)*m/N,O=T/I;p[W]+=C*k*O,_[W]+=M*k*O,p[w]-=C*k*(1-O),_[w]-=M*k*(1-O)}}}}},$.initialize=function(t,e,i){var r=e.X,n=e.Y,o=i.cx,a=i.cy,s=t.length;if(void 0===o||void 0===a){o=a=0;for(var u=0;u<s;u++)o+=r[u],a+=n[u];o/=s,a/=s}i.cx=o,i.cy=a};var tt=function(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0};function et(t,e){return(t+e)*(t+e+1)/2+e}function it(t,e,i,r){var n=i.X,o=i.Y,a=i.R,s=i.components,d=i.pinned,l=i.degrees,h=i.sources,c=i.targets,f=i.edgeIds,g=r.update,p=r.onUpdate,_=r.placement,v=r.placementOffset,m=r.alignSiblings,y=r.siblingsMinAngle,b=r.siblingsOffset;if(m&&(function(t,e,i){var r=t.edgeIds,n=t.sources,o=t.targets,a=t.pinned,s=t.degrees,u=t.X,d=t.Y,l=t.R;void 0===e&&(e=0),void 0===i&&(i=.5);for(var h={},c={},f=0,g=r;f<g.length;f+=1){var p=g[f],_=n[p],v=o[p];_!==v&&(h[_]=h[_]||{},h[v]=h[v]||{},h[_][v]=!0,h[v][_]=!0)}Object.keys(h).forEach((function(t){var e,i,r=Number(t),n=Object.keys(h[Number(r)]);if(2===n.length){var o=n[0],s=n[1],u=(e=Number(o))<(i=Number(s))?e*i+Math.pow(i-e-1,2)/4:e*i+Math.pow(e-i-1,2)/4;u in c||(c[u]=[Number(s),Number(o)]),a[r]||c[u].push(r)}})),Object.keys(c).forEach((function(t){var r=c[Number(t)],n=r[0],o=r[1],a=r.slice(2);if(1!==a.length){var h=u[n],f=d[n],g=u[o],p=d[o],_=s[n],v=.25+.5*_/(_+s[o]),m=h+(g-h)*v,y=f+(p-f)*v,b=-(p-f),x=g-h,E=Math.sqrt(Math.pow(h-g,2)+Math.pow(f-p,2));b=-2*b/E,x=-2*x/E;var A=Math.acos(b/Math.sqrt(b*b+x*x));0<e&&(A<e||A>Math.PI-e&&A<=Math.PI?(b=2*Math.cos(Math.PI-e),x=2*Math.sin(Math.PI-e)):(A>2*Math.PI-e||A>=Math.PI&&A<Math.PI+e)&&(b=2*Math.cos(e),x=2*Math.sin(e)));var S=0,w=1;a.sort((function(t,e){return l[e]-l[t]}));var T=0,C=0,M=Math.max(l[a[0]],l[a[1]])/2;a.length%2==1&&(S=1,m-=b*M,y-=x*M);for(var I=1+i,L=0;L<a.length;L++){var N=(S+L)%2,k=a[L],O=2<=L?l[k]:M,F=(N?T:C)+O;u[k]=m+b*w*F,d[k]=y+x*w*F,N?T+=O*I:C+=O*I,w=-w}}}))}({X:n,Y:o,R:a,degrees:l,pinned:d,sources:h,targets:c,edgeIds:f},y,b),g(t,n,o)),_){var x=function(t,e,i,r){for(var n=0,o=[],a=0,s=r;a<s.length;a+=1){for(var u=s[a],d=new tt,l=0,h=u;l<h.length;l+=1){var c=h[l];d.add(c,t[c],e[c],i[c])}o.push(d.measure()),u.length>o[n].ids.length&&(n=o.length-1)}return{boxes:o,biggest:n}}(n,o,a,s),E=x.boxes,A=x.biggest;if("spiral"===_)!function(t,e,i,r,n){void 0===e&&(e=20);for(var o=0,a=t;o<a.length;o+=1){var s=a[o],d=u(s.ids,(function(t){return i[t]}),(function(t){return r[t]}),(function(t){return n[t]})),l=d.x,h=d.y,c=d.r;s.cx=l,s.cy=h,s.radius=c+e}for(var f=t.slice().sort((function(t,e){return t.radius-e.radius})),g=f.map((function(t){return{x:t.cx,y:t.cy,r:t.radius}})),p=f.pop(),_=3*Math.PI/2,v=p.radius,m=2*Math.PI,y=p.cx,b=p.cy,x=[p],E=function(){var t=f[f.length-1],e=v+t.radius,i=y+Math.cos(_)*e,r=b+Math.sin(_)*e;x.some((function(e){var n=e.cx-i,o=e.cy-r;return Math.sqrt(n*n+o*o)<e.radius+t.radius}))?v+=1:(t.x=i-t.w/2,t.y=r-t.h/2,t.cx=i,t.cy=r,g[f.length-1].x=i,g[f.length-1].y=r,x.push(f.pop()),_+=(2*t.radius+1)/e*1%m)};0!==f.length;)E()}(E,v,n,o,a);else{if("box"!==_)return;!function(t,e){void 0===e&&(e=1),function(t){for(var e=0,i=0,r=0,n=t;r<n.length;r+=1){var o=n[r];e+=o.w*o.h,i=Math.max(i,o.w)}t.sort((function(t,e){return e.h-t.h}));for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}],s=0,u=0,d=0,l=t;d<l.length;d+=1)for(var h=l[d],c=a.length-1;0<=c;c--){var f=a[c];if(!(h.w>f.w||h.h>f.h)){if(h.x=f.x,h.y=f.y,u=Math.max(u,h.y+h.h),s=Math.max(s,h.x+h.w),h.w===f.w&&h.h===f.h){var g=a.pop();c<a.length&&(a[c]=g)}else h.h===f.h?(f.x+=h.w,f.w-=h.w):(h.w===f.w||a.push({x:f.x+h.w,y:f.y,w:f.w-h.w,h:h.h}),f.y+=h.h,f.h-=h.h);break}}}(t.map((function(t){return t.w+=t.maxr+e,t.h+=t.maxr+e,t})).sort((function(t,e){return t.w*t.h-e.w*e.h})))}(E,v)}for(var S=E[A].xmin-E[A].x,w=E[A].ymin-E[A].y,T=0,C=E;T<C.length;T+=1)for(var M=C[T],I=M.xmin,L=M.ymin,N=I-M.x-S,k=L-M.y-w,O=0,F=M.ids;O<F.length;O+=1){var R=F[O];n[R]-=N,o[R]-=k}g(t,n,o),p()}}function rt(t,e,r,n,o,a){var s,u=r.X,d=r.Y,l=r.R,h=r.degrees,c=r.nodeIds,f=r.edgeIds,g=r.layers,p=r.layer,_=r.cluster,v=r.masses,m=r.weights,y=r.sources,b=r.targets,x=n.cx,E=n.cy,A=n.nextTick,S=n.cancelTick,w=n.update,T=n.onUpdate,C=n.batch,M=(n.maxIterations,n.steps),I=n.minMovement,L=g.slice(),N=0;function k(){S(s),w(t,u,d),T(),a(N)}for(var O={},F=0;F<e.length;F++)O[Number(e[F].id)||F]=F;for(var R=new Map,P=0;P<f.length;P++){var D=f[P];R.set(et(y[D],b[D]),D)}for(var z=0;z<g.length;z++){for(var B=g[z],U=z,V=0;V<B.length;V++){var j=B[V],G=_[j];-1!==G&&(v[G]+=v[j])}for(var H=0;H<e.length;H++){var W=e[H],q=Number(W.id)||H,X=W.source,Y=W.target,Z=m[O[q]];if(p[X]===U&&p[Y]===U){var K=_[X],Q=_[Y];if(K!==Q){var J=R.get(et(K,Q));void 0!==J&&(m[J]+=Z)}}}}c.length=0,f.length=0;var $,tt,it=1,rt=1-Math.pow(.1,1/M/2),nt=(it-.1)/M,ot=.5;return s=setTimeout((function r(){var n=o(it+=(0-it)*rt,c,f),a=it<=ot||n<I;if(0===N||a){var g=L.pop();if(g){$&&(tt=$.reduce((function(t,e){return Math.max(t,x-u[e],E-d[e])}),0)),c.push.apply(c,g);for(var p=0;p<g.length;p++){var m=g[p],y=_[m];if(-1!==y){var b=1<h[m]?2:1,S=l[y]+l[m];v[y]-=v[m],u[m]=u[y]+b*S*(2*i()-1),d[m]=d[y]+b*S*(2*i()-1)}else $&&(u[m]=x+2*tt*(1-2*i()),d[m]=E+2*tt*(1-2*i()))}$=g;for(var M=c.reduce((function(t,e){return t[e]=!0,t}),{}),F=f.length=0;F<e.length;F++){var R=e[F],P=R.source,D=R.target,z=R.id;M[P]&&M[D]&&f.push(O[Number(z)])}a=!1,it=0===L.length?.2:.1+2*nt,ot=.1}}N%C==0&&(w(t,u,d),T()),++N>=1/0||a?k():s=A(r)})),{done:!1,stop:function(){return k(),this},get iterations(){return N}}}function nt(t,e,i){var r=i.X,n=i.Y,o=i.fx,a=i.fy,s=i.pinned,u=i.layer,d=(i.masses,i.layers),l=i.surfaces,h=i.movements;h.fill(0);for(var c=0,f=t.length,g=1/0,p=1/0,_=-1/0,v=-1/0,m=0;m<f;m++){var y=t[m],b=o[y]*=e,x=a[y]*=e;if(s[y])o[y]=a[y]=0;else{var E=u[y],A=b,S=x,w=r[y],T=n[y];if(1e4<A||1e4<S){var C=Math.sqrt(A*A+S*S);S/=C,A/=C}r[y]+=A,n[y]+=S;var M=Math.sqrt(A*A+S*S);w<g&&(g=w),T<p&&(p=T),g<w&&(_=w),p<T&&(v=T),h[E-1]+=M,c+=E*M}}for(var I=_-g,L=v-p,N=0;N<d.length;N++){for(var k=d[N].length,O=1/0,F=1/0,R=-1/0,P=-1/0,D=0;D<k;D++){var z=r[D],B=n[D];z<O&&(O=z),B<F&&(F=B),R<z&&(R=z),P<B&&(P=B)}var U=R-O,V=P-F,j=Math.max(1,Math.sqrt(Math.pow(U,2)+Math.pow(V,2)));l[N]=j;var G=h[N]/k;h[N]=G/(I*L)}return c}tt.prototype.add=function(t,e,i,r){this.ids.push(t),e-r<this.xmin&&(this.xmin=e-r),i-r<this.ymin&&(this.ymin=i-r),e+r>this.xmax&&(this.xmax=e+r),i+r>this.ymax&&(this.ymax=i+r),r>this.maxr&&(this.maxr=r),this.mx+=r*e,this.my+=r*i,this.m+=r},tt.prototype.measure=function(t){return void 0===t&&(t=0),this.w=this.xmax-this.xmin+2*t,this.h=this.ymax-this.ymin+2*t,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this};var ot=0,at="undefined"==typeof window,st="undefined"!=typeof performance&&performance.now?performance:Date,ut=at?function(t){var e=st.now(),i=Math.max(0,16-(e-ot)),r=setTimeout((function(){return t(e+i)}),i);return ot=e+i,r}:window.requestAnimationFrame,dt=at?function(t){return clearTimeout(t)}:window.cancelAnimationFrame;function lt(t,e,i){for(var r=0;r<t.length;r++){var n=t[r];n.x=e[r],n.y=i[r]}}function ht(){}function ct(t){for(var e in void 0===t&&(t={}),this.onUpdate=ht,this.update=lt,this.nextTick=ut,this.cancelTick=dt,this.onEnd=ht,this.charge=10,this.maxIterations=300,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=1,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=300,this.scaling=1,this.defaultRadius=1,this.autoStop=ft,"autoStop"in t?t.autoStop&&("boolean"==typeof t.autoStop?t.autoStop=ft:t.autoStop=Object.assign({},t.autoStop,ft)):t.steps,t)void 0!==t[e]&&(this[e]=t[e])}var ft={movementRatio:.1,surfaceRatio:.0025};function gt(t){for(var e=0,i=this.length;e<i;e++)this[e]=t;return this}var pt=Int32Array.prototype.fill||gt,_t=Uint8Array.prototype.fill||gt;function vt(t){this.bucketSize=0;var e=t.nodes.length,i=t.edges.length;r(e+i),this.X=new Array(e),this.Y=new Array(e),this.R=new Array(e),this.fx=new Float32Array(e),this.fy=new Float32Array(e),this.vx=new Float32Array(e),this.vy=new Float32Array(e),this.pinned=new Uint8Array(e),this.masses=new Float32Array(e),this.weights=new Float32Array(i),this.lengths=new Float32Array(i),this.sources=new Uint16Array(i),this.targets=new Uint16Array(i),this.degrees=new Uint32Array(e),this.layer=new Uint32Array(e),this.parent=new Int32Array(e),this.cluster=new Int32Array(e),this.component=new Uint16Array(e),this.components=[],this.layers=[],this.nodeIds=new Array(e),this.edgeIds=new Array(i),function(t,e,i){!function(t,e,i){for(var r=i.sources,n=i.targets,o=i.degrees,a=i.nodeIds,s=i.edgeIds,u={},d=0;d<t.length;d++)u[d]=a[d]=d;for(var l=0;l<e.length;l++){var h=e[l],c=h.source,f=h.target,g=u[c],p=u[f];s[l]=l,r[l]=g,n[l]=p,o[g]++,o[p]++}}(t,e,i),function(t){for(var e=t.nodeIds,i=t.edgeIds,r=t.sources,n=t.targets,o=t.degrees,a=t.layer,s=t.layers,u=t.component,d=t.components,l=t.cluster,h=t.parent,c=0,f=1,g=new Uint32Array(e.length),p=0;p<e.length;p++)g[p]=o[p];for(var _=new Array(e.length),v=0;v<i.length;v++){var m=i[v],y=r[m],b=n[m];_[y]=_[y]||[],_[b]=_[b]||[],_[y].push(b),_[b].push(y)}var x=new Uint8Array(e.length),E=new Uint8Array(e.length);pt.call(h,-1);for(var A=0,S=0;S<e.length;S++)if(0===x[S]){for(var w=[S];0!==w.length;){var T=w.pop();0===x[T]&&(w.push.apply(w,_[T]),x[T]=1,u[T]=A)}A++}for(var C=new Array(e.length),M=0;M<e.length;M++)a[M]=0,C[M]=M;for(;0!==C.length;){for(var I=[],L=[],N=0;N<C.length;N++)g[C[N]]<=c&&(I.push(N),L.push(C[N]));for(var k=0;k<L.length;k++){var O=L[k];E[O]=c,a[O]=f;var F=_[O];if(F)for(var R=0;R<F.length;R++)g[F[R]]--}for(var P=0;P<L.length;P++){var D=L[P],z=_[D];if(z)for(var B=0;B<z.length;B++){var U=z[B],V=a[U];if(void 0===V||f<V){h[D]=U;break}}}I.reverse();for(var j=0;j<I.length;j++)C.splice(I[j],1);if(f+=1,0<C.length){for(var G=1/0,H=0;H<C.length;H++){var W=g[C[H]];W<G&&(G=W)}c+1<=G&&(c=G,f=1)}}_t.call(x,0);for(var q=0;q<e.length;q++){var X=e[q],Y=a[X];if(-1===h[X]||a[h[X]]===Y){var Z=[X];for(_t.call(x,0);0!==Z.length;){var K=Z.pop();if(!x[K]){if(a[K]>Y){h[X]=K;break}var Q=_[K];x[K]=1,Q&&Z.push.apply(Z,Q)}}}}for(var J=0;J<e.length;J++){var $=e[J],tt=u[$];d[tt]=d[tt]||[],d[tt].push($);var et=a[$]-1;s[et]=s[et]||[],s[et].push($),l[$]=h[$]}}(i)}(t.nodes,t.edges,this),this.movements=new Array(this.layers.length).fill(0),this.surfaces=new Array(this.layers.length).fill(0),this.movementsPrev=new Array(this.layers.length).fill(0),this.surfacesPrev=new Array(this.layers.length).fill(0)}function mt(t){this.promise=new Promise(t)}mt.prototype.then=function(t){return this.promise.then(t)},mt.prototype.stop=function(){return this.simulation.stop(),this},mt.prototype.iterations=function(){return this.simulation.iterations()};var yt={euler:function(t,e,i){for(var r=i.X,n=i.Y,o=i.fx,a=i.fy,s=i.vx,u=i.vy,d=i.masses,l=i.pinned,h=0,c=0,f=t.length,g=0;g<f;g++){var p=t[g],_=d[p],v=o[p]/_,m=a[p]/_;s[p]+=1/8*v,u[p]+=1/8*m;var y=.2*s[p]*(1/8)+.5*v*(1/8)*(1/8),b=.2*u[p]*(1/8)+.5*m*(1/8)*(1/8);o[p]=a[p]=0,l[p]||(r[p]+=y,n[p]+=b,h+=Math.abs(y)*_,c+=Math.abs(b)*_)}return(h*h+c*c)/f},verlet:nt,leapfrog:function(t,e,i){for(var r=i.X,n=i.Y,o=i.fx,a=i.fy,s=i.vx,u=i.vy,d=i.pinned,l=i.masses,h=t.length,c=0,f=0;f<h;f++){var g=t[f],p=l[g],_=o[g]/p,v=a[g]/p,m=s[g]+_,y=u[g]+v,b=+m,x=+y;1e4<b&&(b=.1),1e4<x&&(x=.1),s[g]=e*(m+s[g])/2,u[g]=e*(y+u[g])/2,o[g]=a[g]=0,d[g]||(r[g]+=b,n[g]+=x),c+=.5*(b*b+x*x)}return c}};function bt(t,e){var i,n,o=this;function a(t){return void 0===t&&(t={nodes:[],edges:[]}),i=t.nodes,n=t.edges,r(et(i.length,n.length)),new vt(t)}function s(t){return void 0===t&&(t={}),new ct(t)}void 0===e&&(e={});var u=a(t),d=s(e);function l(t,e,i){return f&&(f.destroy(),f=null),e.length<=1?0:(f=K(t,e,f,u),Q(t,i,u,d),0!==d.elasticity&&J(0,e,f,u,d),$(t,e,u,d),c(e,d.inertia,u))}Q.initialize(n,u),K.initialize(i,u,d),J.initialize(i,u,d),$.initialize(i,u,d);var h,c=yt[d.integrator]||nt,f=null;return{setOptions:function(t){return void 0===t&&(t={}),d=s(t),o},setGraph:function(e){var i=e.nodes,r=e.edges;return u=a(t),Q.initialize(r,u),K.initialize(i,u,d),J.initialize(i,u,d),$.initialize(i,u,d),o},start:function(){return h=(d.multilevel?rt:function(t,e,i,r,n,o){function a(){M=!0,m(s),A(),o(w)}var s,u=i.X,d=i.Y,l=i.nodeIds,h=i.edgeIds,c=i.layers,f=i.movements,g=i.movementsPrev,p=i.surfaces,_=i.surfacesPrev,v=r.nextTick,m=r.cancelTick,y=r.batch,b=r.steps,x=r.minMovement,E=r.update,A=r.onUpdate,S=r.autoStop,w=0,T=1,C=1-Math.pow(.05,1/b),M=!1,I=!1,L=function(){var e=n(T+=(.001-T)*C,l,h),i=c.length,r=!1,o=!1;if(S){r=o=!0;for(var m=S.movementRatio,N=S.surfaceRatio,k=0;k<i;k++)r&&Math.abs(1-p[k]/_[k])>N&&(r=!1),o&&Math.abs(1-f[k]/g[k])>m&&(o=!1)}r&&o&&!I&&(C=1-Math.pow(.001,1/Math.max(10,w)),I=!0);var O=M||T<.05||0!==e&&e<=x;if(w%y==0&&(E(t,u,d),A()),++w>=b||O)return a();for(var F=0;F<i;F++)g[F]=f[F],_[F]=p[F];s=v(L)};return s=setTimeout(L),{done:!1,stop:function(){return a(),this},get iterations(){return w}}})(i,n,u,d,l,(function(t){h.done||it(i,0,u,d),d.onEnd(t),h.done=!0})),this},iterations:function(){return h.iterations},data:function(){return u},stop:function(){return h&&h.stop(),this},step:function(t){return void 0===t&&(t=1),l(t,u.nodeIds,u.edgeIds),d.update(i,u.X,u.Y),this}}}return bt.run=function(t,e){var i,r=new mt((function(r){e.onEnd=r,i=bt(t,e).start()}));return r.simulation=i,r.stop=function(){return i.stop(),r},r.iterations=function(){return i.iterations()},r},bt}().apply(this,arguments)}var Gy={imports:{force:jy},configure:function(t,e){var i=e.graph,r=t.nodes._indexes,n=i.getNodeAttribute("x").getMultiple(r),o=i.getNodeAttribute("y").getMultiple(r),a=i.getNodeAttribute("radius").getMultiple(r),s=i.getNodeAttribute("layoutable").getMultiple(r),u=t.edges,d=[],l=[],h={};void 0===t.edgeStrength&&(t.edgeStrength=.75),null==t.gravity&&(t.gravity=.05),null==t.siblingsOffset&&(t.siblingsOffset=0),null==t.theta&&(t.theta=.62),t.autoStop=!!t.autoStop,t.alignSiblings=!!t.alignSiblings;for(var c=t.radiusRatio||1.25,f=0;f<t.nodes._indexes.length;f++){var g=t.nodes._indexes[f];h[g]=f,d.push({id:f,x:n[f],y:o[f],r:a[f]*c,pinned:!s[f]})}u.forEach((function(t){var e=h[t.getSource()._index],i=h[t.getTarget()._index];e!==i&&void 0!==e&&void 0!==i&&l.push({source:e,target:i})}));var p=$(A({},t));return delete p.nodes,delete p.edges,{graph:{nodes:d,edges:l},options:p,indexes:t.nodes._indexes,done:!1,x:n,y:o}},update:function(t,e){if(!e.simulation){e.graph=t.graph,e.options=t.options,e.indexes=t.indexes,t.options.nextTick=function(t){return t()},t.options.update=function(t,i,r){e.x=i,e.y=r},t.options.onEnd=function(){return e.done=!0};var i=jy(t.graph,t.options).start(),r=i.data(),n=r.X,o=r.Y;e.simulation=i,e.x=n,e.y=o}return{graph:e.graph,indexes:e.indexes,x:e.x,y:e.y}},context:function(){return{done:!1,graph:null,x:null,y:null,indexes:null}},isRunning:function(t){return!t.done},onSync:function(t){return{indexes:t.indexes,x:t.x,y:t.y}}};function Hy(t,e,i){var r=e.duration,n=void 0===r?0:r,o=e.margin,a=void 0===o?5:o,s=e.referenceNodes,u=e.nodes,d=s;!d||d instanceof gr||(d=t.getNodes(d));var l=d||u.inverse(),h=l.getPosition().map((function(t){return[t.x,t.y]})),c=i,f=u.getBoundingBox(),g=l.getBoundingBox();g.pad(g.maxScaledSize);var p,_,v,m,y,b,x,E=Vh(c.map((function(t){return t.x})),c.map((function(t){return t.y})),u.getAttribute("radius")),A=E[0],S=E[1],w=E[2]+g.maxScaledSize+a,T=0,C=0;if(function(t,e,i,r){for(var n=0;n<t.length;n++){var o=t[n],a=o[0],s=o[1],u=Math.abs(a-e),d=Math.abs(s-i);if(u+d<=r)return 1;if(!(r<u||r<d)&&u*u+d*d<=r*r)return 1}}(h,A,S,w))if(l.size<=3){if(xd(A,S,E[2],g.minX,g.minY,g.maxX,g.maxY)){var M=function(t,e,i){for(var r,n=Ts(i.cx,i.cy,t,e,i.minX,i.minY,i.maxX,i.maxY),o=1/0,a={x:i.maxX,y:e},s=0,u=n;s<u.length;s++){var d=u[s];(r=Pa(t,e,d.x,d.y))<o&&(o=r,a=d)}return a}(A,S,g);p=Pa(g.cx,g.cy,M.x,M.y);var I=(y=g.cx,b=g.cy,{x:y+(x=(p+w)/p)*(M.x-y),y:b+x*(M.y-b)});T=I.x-A,C=I.y-S}}else{var L=new Vc(h.slice()).triangulate(),N=3<h.length?Gc(h):(v=(_=g).bottomLeft(),m=_.topRight(),[[v.x,v.y],[v.x,m.y],[m.x,m.y],[m.x,v.y]]),k=Hc(l.getPosition(),10,w,L,N);if(M=function(t,e,i){for(var r,n,o=1/0,a=0,s=e.length;a<s;a++){var u=e[a],d=e[(a+1)%s],l=Ls(t[0],t[1],u[0],u[1],d[0],d[1]);l<o&&(o=l,r=u,n=d)}return function(t,e,i,r,n,o,a){var s=Ns(t,e,i,r,n,o),u=-(r-o),d=i-n,l=Math.sqrt(u*u+d*d);return u/=l,d/=l,[s.x-a*u,s.y-a*d]}(t[0],t[1],r[0],r[1],n[0],n[1],i)}([A,S],N,w),0<k.length){for(var O=Math.pow(A-M[0],2)+Math.pow(S-M[1],2),F=0,R=k;F<R.length;F++){var P=R[F];T=A-P[0],C=S-P[1],(p=T*T+C*C)<O&&(O=p,M=P.slice(0,2))}T=M[0]-A,C=M[1]-S}else T=M[0]-f.cx,C=M[1]-f.cy}var D={layoutName:"incremental",ids:u.getId(),positions:{before:c,current:c}};if(T||C){var z=c.map((function(t){return t.x+=T,t.y+=C,t}));if(e.locate){"boolean"==typeof e.locate&&(e.locate={});var B=t.modules.locate.layoutDataBoundingBox({x:h.map((function(t){return t[0]})).concat(z.map((function(t){return t.x}))),y:h.map((function(t){return t[1]})).concat(z.map((function(t){return t.y}))),indexes:t.getNodes()._indexes}),U=t.modules.locate.computeConfigForBounds(B,e.locate);t.modules.camera.setView(U,{duration:n,easing:e.locate.easing,ignoreZoomLimits:!0})}return D.positions.current=z,u.setAttributes(z,n).then((function(){return D}))}return u.setAttributes(c,n).then((function(){return D}))}function Wy(t,e,i){var r=q(e);return r.duration=0,r.dryRun=!0,r.locate=!1,delete r.incremental,i(r).then((function(i){return Hy(t,e,i.positions.current)}))}function qy(t,e,i){var r=e.nodes,n=e.duration,o=e.centralNode,a=r,s=a.reduce((function(t,e){return t[e._index]=!0,t}),{}),u=t.getNodes();if(e.focusOnGroupShape)return i({nodes:a,duration:0}).then((function(){var e=a.concat(o),r=e.getAttribute("layoutable");return e.setAttributes({layoutable:!1}),i({nodes:t.getNodes(),duration:n}).then((function(){return e.setAttributes(r)}))}));var d=q(e);return delete d.centralNode,d.incremental=!1,d.nodes=u,d.nodeMass=function(t,e){return(e+1)*(s[t._index]?1:2)},i(d)}function Xy(t,e,i){var r=Xf(e.modules.graph,t);if("boolean"!=typeof r.incremental&&"margin"in r.incremental&&!isFinite(r.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");var n=q(r);return"boolean"!=typeof r.incremental&&(n.margin=r.incremental.margin,n.referenceNodes=r.incremental.referenceNodes),(n.centralNode&&!n.centralNode.getAttribute("layoutable")?qy:Wy)(e,n,i)}var Yy={configure:function(t,e){var i,r=e.graph,n=e.camera,o=(e.graphics,t.nodes._indexes),a=t.edges._indexes,s={},u={},d=o.length,l=a.length,h=r.getObjectList(!0),c=r.getObjectList(!1);(t.nodes||t.edges)&&(delete(t=q(t)).nodes,delete t.edges);var f=r.getNodeAttribute("innerStroke.width").getMultiple(o),g=r.getNodeAttribute("outerStroke.width").getMultiple(o),p=r.degrees(o),_=r.getNodeAttribute("x").getMultiple(o),v=r.getNodeAttribute("y").getMultiple(o),m=r.getNodeAttribute("radius").getMultiple(o),y=r.nodeList(o).getAttribute("layoutable"),b="function"==typeof t.nodeMass?t.nodeMass:function(t,e,i){return e+1};delete t.nodeMass;var x="function"==typeof t.edgeWeight?t.edgeWeight:function(t){return 1};delete t.edgeWeight,isFinite(t.scalingRatio)||delete t.scalingRatio;var E=o.reduce((function(t,e,i){return y[i]||(t[e]=!0),t}),{}),A=0,S=0,w=0,T=n.getZoom();for(i=0;i<o.length;++i){var C=o[i],M=_[i],I=v[i],L=m[i]+(f[i]+g[i])/T;s[C]={id:C,x:M,y:I,degree:p[i],size:L,pinned:!!E[C],mass:b(h.get(C),p[i],i)},w=Math.max(L,w)}if(1<d)for(i=0;i<d;i++){var N=s[o[i]];A+=N.x,S+=N.y}var k={x:A/=d,y:S/=d},O=r.edgeList(a),F=O.getSource()._indexes,R=O.getTarget()._indexes;for(i=0;i<l;i++){var P=a[i],D=F[i],z=R[i];s[D]&&s[z]&&(u[P]={source:D,target:z},u[P].weight=x(c.get(P)))}return{nodes:s,edges:u,maxSize:w,config:$(t),barycentre:k}},context:function(){return{}},update:function(t,e){var i,r,n,o;e.W?i=e.W:(i={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},e.W=i,n=(r=t).config,o=function(t,e){var r,n,o,a,s=t.nodes,u=t.edges,d=t.maxSize,l=Object.keys(t.nodes),h=Object.keys(t.edges),c=l.length*i.ppn,f=h.length*i.ppe,g={},p=Math.pow(10,Math.log(Math.max(d,1))-6),_=p/2,v=Math.random,m=e.randomizeFactor||1;a="locally"===e.randomize?function(t){return t+v()*m}:"globally"===e.randomize?function(t){return v()*m}:function(t){return t+v()*p-_};var y=new Float32Array(c),b=new Float32Array(f);for(r=n=0,o=l.length;r<o;r++){var x=l[r],E=s[x],A=E.x,S=E.y;E.pinned||(A=a(A),S=a(S)),g[x]=n,y[n]=A,y[n+1]=S,y[n+2]=0,y[n+3]=0,y[n+4]=0,y[n+5]=0,y[n+6]=E.mass,y[n+7]=1,y[n+8]=E.size,y[n+9]=E.pinned||0,n+=i.ppn}for(r=n=0,o=h.length;r<o;r++){var w=u[x=h[r]];b[n]=g[w.source],b[n+1]=g[w.target],b[n+2]=w.weight||0,n+=i.ppe}return{nodes:y,edges:b}}(r,n),e.NodeMatrix=o.nodes,e.EdgeMatrix=o.edges,i.nodesLength=e.NodeMatrix.length,i.edgesLength=e.EdgeMatrix.length,i.settings=function(t,e){for(var i in t)e[i]=t[i];return e}(t.config,i.settings),e.nodes=t.nodes,e.edges=t.edges,e.barycentre=t.barycentre);var a,s=e.NodeMatrix,u=e.EdgeMatrix;function d(){var t,e,r,n,o,d,l,h,c,f,g,p,_,v,m,y,b;for(r=0;r<i.nodesLength;r+=i.ppn)s[r+4]=s[r+2],s[r+5]=s[r+3],s[r+2]=0,s[r+3]=0;if(i.settings.outboundAttractionDistribution){for(r=c=0;r<i.nodesLength;r+=i.ppn)c+=s[r+6];c/=i.nodesLength}if(i.settings.barnesHutOptimize){var x,E,A,S,w=1/0,T=-1/0,C=1/0,M=-1/0;for(a=[],r=0;r<i.nodesLength;r+=i.ppn)w=Math.min(w,s[r+0]),T=Math.max(T,s[r+0]),C=Math.min(C,s[r+1]),M=Math.max(M,s[r+1]);var I=T-w,L=M-C;for(L<I?M=(C-=(I-L)/2)+I:T=(w-=(L-I)/2)+L,a[0]=-1,a[1]=(w+T)/2,a[2]=(C+M)/2,a[3]=Math.max(T-w,M-C),a[4]=-1,a[5]=-1,a[6]=0,a[7]=0,t=1,r=a[8]=0;r<i.nodesLength;r+=i.ppn)for(e=0,A=i.MAX_SUBDIVISION_RETRIES;;){if(!(0<=a[e+5])){if(a[e+0]<0){a[e+0]=r;break}if(a[e+5]=t*i.ppr,l=a[e+3]/2,h=a[e+5],a[h+0]=-1,a[h+1]=a[e+1]-l,a[h+2]=a[e+2]-l,a[h+3]=l,a[h+4]=h+i.ppr,a[h+5]=-1,a[h+6]=0,a[h+7]=0,a[h+8]=0,h+=i.ppr,a[h+0]=-1,a[h+1]=a[e+1]-l,a[h+2]=a[e+2]+l,a[h+3]=l,a[h+4]=h+i.ppr,a[h+5]=-1,a[h+6]=0,a[h+7]=0,a[h+8]=0,h+=i.ppr,a[h+0]=-1,a[h+1]=a[e+1]+l,a[h+2]=a[e+2]-l,a[h+3]=l,a[h+4]=h+i.ppr,a[h+5]=-1,a[h+6]=0,a[h+7]=0,a[h+8]=0,h+=i.ppr,a[h+0]=-1,a[h+1]=a[e+1]+l,a[h+2]=a[e+2]+l,a[h+3]=l,a[h+4]=a[e+4],a[h+5]=-1,a[h+6]=0,a[h+7]=0,a[h+8]=0,t+=4,x=s[a[S=e+0]+0]<a[e+1]?s[a[S]+1]<a[e+2]?a[e+5]:a[e+5]+i.ppr:s[a[S]+1]<a[e+2]?a[e+5]+2*i.ppr:a[e+5]+3*i.ppr,a[e+6]=s[a[S]+6],a[e+7]=s[a[S]+0],a[e+8]=s[a[S]+1],a[x+0]=a[e+0],a[e+0]=-1,x===(E=s[r+0]<a[e+1]?s[r+1]<a[e+2]?a[e+5]:a[e+5]+i.ppr:s[r+1]<a[e+2]?a[e+5]+2*i.ppr:a[e+5]+3*i.ppr)){if(A--){e=x;continue}A=i.MAX_SUBDIVISION_RETRIES;break}a[E+0]=r;break}x=s[r+0]<a[e+1]?s[r+1]<a[e+2]?a[e+5]:a[e+5]+i.ppr:s[r+1]<a[e+2]?a[e+5]+2*i.ppr:a[e+5]+3*i.ppr,a[e+7]=(a[e+7]*a[e+6]+s[r+0]*s[r+6])/(a[e+6]+s[r+6]),a[e+8]=(a[e+8]*a[e+6]+s[r+1]*s[r+6])/(a[e+6]+s[r+6]),a[e+6]+=s[r+6],e=x}}if(i.settings.barnesHutOptimize)for(f=i.settings.scalingRatio,r=0;r<i.nodesLength;r+=i.ppn)for(e=0;;)if(0<=a[e+5]){if(y=Math.sqrt((s[r+0]-a[e+7])*(s[r+0]-a[e+7])+(s[r+1]-a[e+8])*(s[r+1]-a[e+8])),2*a[e+3]/y<i.settings.barnesHutTheta){if(g=s[r+0]-a[e+7],p=s[r+1]-a[e+8],i.settings.adjustSizes?0<y?(b=f*s[r+6]*a[e+6]/y/y,s[r+2]+=g*b,s[r+3]+=p*b):y<0&&(b=-f*s[r+6]*a[e+6]/y,s[r+2]+=g*b,s[r+3]+=p*b):0<y&&(b=f*s[r+6]*a[e+6]/y/y,s[r+2]+=g*b,s[r+3]+=p*b),a[e+4]<0)break;e=a[e+4];continue}e=a[e+5]}else{if(0<=a[e+0]&&a[e+0]!==r&&(g=s[r+0]-s[a[e+0]+0],p=s[r+1]-s[a[e+0]+1],y=Math.sqrt(g*g+p*p),i.settings.adjustSizes?0<y?(b=f*s[r+6]*s[a[e+0]+6]/y/y,s[r+2]+=g*b,s[r+3]+=p*b):y<0&&(b=-f*s[r+6]*s[a[e+0]+6]/y,s[r+2]+=g*b,s[r+3]+=p*b):0<y&&(b=f*s[r+6]*s[a[e+0]+6]/y/y,s[r+2]+=g*b,s[r+3]+=p*b)),a[e+4]<0)break;e=a[e+4]}else for(f=i.settings.scalingRatio,n=0;n<i.nodesLength;n+=i.ppn)for(o=0;o<n;o+=i.ppn)g=s[n+0]-s[o+0],p=s[n+1]-s[o+1],i.settings.adjustSizes?0<(y=Math.sqrt(g*g+p*p)-s[n+8]-s[o+8])?(b=f*s[n+6]*s[o+6]/y/y,s[n+2]+=g*b,s[n+3]+=p*b,s[o+2]+=g*b,s[o+3]+=p*b):y<0&&(b=100*f*s[n+6]*s[o+6],s[n+2]+=g*b,s[n+3]+=p*b,s[o+2]-=g*b,s[o+3]-=p*b):0<(y=Math.sqrt(g*g+p*p))&&(b=f*s[n+6]*s[o+6]/y/y,s[n+2]+=g*b,s[n+3]+=p*b,s[o+2]-=g*b,s[o+3]-=p*b);for(h=i.settings.gravity/i.settings.scalingRatio,f=i.settings.scalingRatio,r=0;r<i.nodesLength;r+=i.ppn)g=s[r+(b=0)],p=s[r+1],y=Math.sqrt(g*g+p*p),i.settings.strongGravityMode?0<y&&(b=f*s[r+6]*h):0<y&&(b=f*s[r+6]*h/y),s[r+2]-=g*b,s[r+3]-=p*b;for(f=+(i.settings.outboundAttractionDistribution?c:1),d=0;d<i.edgesLength;d+=i.ppe)n=u[d+0],o=u[d+1],l=u[d+2],m=Math.pow(l,i.settings.edgeWeightInfluence),g=s[n+0]-s[o+0],p=s[n+1]-s[o+1],i.settings.adjustSizes?(y=Math.sqrt(g*g+p*p)-s[n+8]-s[o+8],i.settings.linLogMode?i.settings.outboundAttractionDistribution?0<y&&(b=-f*m*Math.log(1+y)/y/s[n+6]):0<y&&(b=-f*m*Math.log(1+y)/y):i.settings.outboundAttractionDistribution?0<y&&(b=-f*m/s[n+6]):0<y&&(b=-f*m)):(y=Math.sqrt(g*g+p*p),i.settings.linLogMode?i.settings.outboundAttractionDistribution?0<y&&(b=-f*m*Math.log(1+y)/y/s[n+6]):0<y&&(b=-f*m*Math.log(1+y)/y):b=i.settings.outboundAttractionDistribution?(y=1,-f*m/s[n+6]):(y=1,-f*m)),0<y&&(s[n+2]+=g*b,s[n+3]+=p*b,s[o+2]-=g*b,s[o+3]-=p*b);var N,k,O,F,R=0;if(i.settings.adjustSizes)for(r=0;r<i.nodesLength;r+=i.ppn)s[r+9]||((N=Math.sqrt(s[r+2]*s[r+2]+s[r+3]*s[r+3]))>i.maxForce&&(s[r+2]=s[r+2]*i.maxForce/N,s[r+3]=s[r+3]*i.maxForce/N),k=s[r+6]*Math.sqrt((s[r+4]-s[r+2])*(s[r+4]-s[r+2])+(s[r+5]-s[r+3])*(s[r+5]-s[r+3])),O=Math.sqrt((s[r+4]+s[r+2])*(s[r+4]+s[r+2])+(s[r+5]+s[r+3])*(s[r+5]+s[r+3]))/2,F=.1*Math.log(1+O)/(1+Math.sqrt(k)),_=s[r+0],v=s[r+1],s[r+0]=s[r+0]+s[r+2]*(F/i.settings.slowDown),s[r+1]=s[r+1]+s[r+3]*(F/i.settings.slowDown),g=s[r+0],p=s[r+1],R+=y=Math.sqrt((g-_)*(g-_)+(p-v)*(p-v)));else for(r=0;r<i.nodesLength;r+=i.ppn)s[r+9]||(k=s[r+6]*Math.sqrt((s[r+4]-s[r+2])*(s[r+4]-s[r+2])+(s[r+5]-s[r+3])*(s[r+5]-s[r+3])),O=Math.sqrt((s[r+4]+s[r+2])*(s[r+4]+s[r+2])+(s[r+5]+s[r+3])*(s[r+5]+s[r+3]))/2,F=s[r+7]*Math.log(1+O)/(1+Math.sqrt(k)),s[r+7]=Math.min(1,Math.sqrt(F*(s[r+2]*s[r+2]+s[r+3]*s[r+3])/(1+Math.sqrt(k)))),_=s[r+0],v=s[r+1],s[r+0]=s[r+0]+s[r+2]*(F/i.settings.slowDown),s[r+1]=s[r+1]+s[r+3]*(F/i.settings.slowDown),g=s[r+0],p=s[r+1],R+=y=Math.sqrt((g-_)*(g-_)+(p-v)*(p-v)));if(i.iterations++,i.settings.autoStop&&(i.converged=i.iterations>i.settings.maxIterations||R/i.nodesLength<i.settings.avgDistanceThreshold,i.converged&&i.settings.alignNodeSiblings)){var P,D,z={},B={};for(d=0;d<i.edgesLength;d+=i.ppe)(n=u[d+0])!==(o=u[d+1])&&(z[n]=z[n]||{},z[o]=z[o]||{},z[n][o]=!0,z[o][n]=!0);Object.keys(z).forEach((function(t){var e=~~t;2==(D=Object.keys(z[e])).length&&((P=D[0]+";"+D[1])in B||(P=D[1]+";"+D[0],B[P]||(B[P]=[~~D[1],~~D[0]])),B[P].push(e))}));var U,V,j,G,H,W,q,X,Y,Z,K,Q,J,$,tt=i.settings.nodeSiblingsAngleMin;Object.keys(B).forEach((function(t){if(V=B[t].shift(),j=B[t].shift(),1!=(U=B[t].filter((function(t){return!s[t+9]}))).length){var e,r,n,o,a,u,d,l,h,c,f,g;if(W=s[V+0],q=s[V+1],X=s[j+0],Y=s[j+1],G=Object.keys(z[V]).length,H=Object.keys(z[j]).length,K={x:(e=W)+(X-e)*(n=.5*(G/(G+H)-0)/1+.25),y:(r=q)+(Y-r)*n},Q={xi:-((d=Y)-(a=q)),yi:(u=X)-(o=W),xiPrime:d-a,yiPrime:-(u-o)},l=X-W,h=Y-q,Z=Math.sqrt(l*l+h*h),g=J={x:((c=Q).xiPrime-c.xi)/(f=Z),y:(c.yiPrime-c.yi)/f},$=Math.acos(g.x/Math.sqrt(g.x*g.x+g.y*g.y)),2*tt>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");0<tt&&($<tt||$>Math.PI-tt&&$<=Math.PI?J={x:2*Math.cos(Math.PI-tt),y:2*Math.sin(Math.PI-tt)}:($>2*Math.PI-tt||$>=Math.PI&&$<Math.PI+tt)&&(J={x:2*Math.cos(tt),y:2*Math.sin(tt)}));var p=0,_=1,v=1;U.length%2==1&&(v=0,p=1);for(var m=0;m<U.length;m++)s[U[m]+0]=K.x+_*J.x*v*(p||2<=m?i.settings.nodeSiblingsScale:2*i.settings.nodeSiblingsScale/3),s[U[m]+1]=K.y+_*J.y*v*(p||2<=m?i.settings.nodeSiblingsScale:2*i.settings.nodeSiblingsScale/3),_=-_,v+=(m+p)%2}}))}}return function(){if(i.settings.autoStop)for(;!i.converged;)d();else for(var t=0===i.iterations?i.settings.startingIterations:i.iterations+i.settings.iterationsPerRender;i.iterations!==t;)d();return{nodes:function(t){for(var e=Object.keys(t),r={},n=0;n<s.length;n+=i.ppn){var o=e[n/i.ppn];r[o]={id:o,x:s[n+0],y:s[n+1],pinned:s[n+9]}}return r}(e.nodes),barycentre:e.barycentre}}()},isRunning:function(t){return!t.W.settings.autoStop},onSync:function(t,e){var i,r,n,o,a,s,u,d,l=t.nodes,h=t.barycentre,c=e.graph,f=Object.keys(l),g=f.length,p=0,_=0,v=new Array(g),m=new Array(g),y=new Array(g),b=new Array(g),x=c.getAttributes(!0,["x","y"]),E=x[0],A=x[1];for(i=0;i<g;i++)n=l[r=f[i]],d=parseInt(r),v[i]=d,b[i]=n.pinned,a=n.pinned?(o=E.get(d),A.get(d)):(o=n.x,n.y),p+=m[i]=o,_+=y[i]=a;for(s=p/g-h.x,u=_/g-h.y,i=0;i<g;i++)b[i]||(m[i]-=s,y[i]-=u);return{indexes:v,x:m,y:y}}},Zy=function(t){return t.reduce((function(t,e){return t[e]=!0,t}),{})};function Ky(t,e){for(var i=[t],r=Zy(i),n=[t];i.length;)for(var o=0,a=e[i.shift()];o<a.length;o+=1){var s=a[o];r[s]||(r[s]=!0,n.push(s),i.push(s))}return n}function Qy(t){return t.reduce((function(t,e){return t[e.source]=t[e.source]||[],t[e.target]=t[e.target]||[],t[e.source].push(""+e.target),t[e.target].push(""+e.source),t}),{})}function Jy(t,e){var i=Math.max(Math.min(e||10,100),1)/1e3;return function(e,r){var n=Math.abs(e.layer-r.layer),o=[r,e].reduce((function(t,e){return t+(ob(e)?1:i)}),0);return n?2*n*t:o*t}}function $y(t){return t.reduce((function(t,e){return t+function(t,e){for(var i=[],r=arguments.length-2;0<r--;)i[r]=arguments[r+2];for(var n=e,o=0,a=i;o<a.length;o+=1){var s=a[o];if(!n[s])return t;n=n[s]}return n}(ob(e)?.5:0,e,"data","radius")}),0)/t.length}function tb(t,e,i){var r=i||Qy(e||[]);return t.filter((function(t){return!(t.id in r)}))}function eb(t,e){var i=Zy(e);return t.filter((function(t){return!(t in i)}))}function ib(t,e){t.forEach((function(t,i){t.forEach((function(t,r,n){e(t,r,n,i)}))}))}function rb(t){return Object.keys(t).map((function(e){return t[e]}))}function nb(t,e){return Object.keys(t).reduce((function(i,r){return i[r]=e(t[r],r,t),i}),{})}function ob(t){return!!t.data}function ab(t,e){return{id:t,data:e,children:[]}}function sb(t,e){e.forEach((function(t){return t._median=[]})),t.forEach((function(t,e){t.children.filter((function(e){return e.layer>t.layer})).forEach((function(t){t._median.push(e)}))})),e.forEach((function(t,e){t.children.forEach((function(){return t._median.push(e)}))})),e.forEach((function(t){return t._median=function(t){if(t.sort((function(t,e){return t-e})),0===t.length)return 0;var e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2}(t._median)||0})),e.sort((function(t,e){return t._median-e._median})),e.forEach((function(t){return delete t._median}))}var ub="left",db="right",lb=Number.POSITIVE_INFINITY;function hb(t){for(var e=0,i=["up","down"];e<i.length;e+=1)t(i[e])}function cb(t){for(var e=0,i=[ub,db];e<i.length;e+=1)t(i[e])}function fb(){return function(t,e){var i,r,n,o,a,s,u=(i={},ib(t,(function(t){i[t.id]||(i[t.id]={successors:[],ancestors:[]});for(var e=0,r=t.children;e<r.length;e+=1){var n=r[e];i[n.id]||(i[n.id]={successors:[],ancestors:[]}),n.layer>t.layer&&(i[t.id].successors.push(n),i[n.id].ancestors.push(t)),n.layer<t.layer&&(i[t.id].ancestors.push(n),i[n.id].successors.push(t))}})),{getSuccessors:function(t){return i[t.id].successors},getAncestors:function(t){return i[t.id].ancestors}}),d=u.getSuccessors,l=u.getAncestors,h=(r={},ib(t,(function(t,e){r[t.id]=e})),r),c=(o=d,a=function(t){var e=t.id;return h[e]},s=(n=t).length,n.reduce((function(t,e,i){var r=t.prevLayer,n=t.conflicts;if(!i||s-2<i)return{prevLayer:r,conflicts:n};var u=0,d=e.length,l=e[d-1];return e.forEach((function(t,i){var r=function(t){if(ob(t))return o(t).find(ob)}(t),s=r?a(r):d-1;if(r||t===l)for(var h=function(){var t=e[u];o(t).forEach((function(e){var i=a(e);(i<0||s<i)&&(n[t.id]=n[t.id]||{},n[t.id][e.id]=!0)})),u++};u<=i;)h()})),{prevLayer:e,conflicts:n}}),{prevLayer:n[0],conflicts:{}}).conflicts),f={};hb((function(i){var r="up"===i?t:[].concat(t).reverse();cb((function(t){t===db&&(r=r.map((function(t){return[].concat(t).reverse()})));var n,o,a,s,u,h,g=e,p=(o=c,a="up"===i?l:d,s={},u={},h={},ib(n=r,(function(t,e){s[t.id]=t.id,u[t.id]=t.id,h[t.id]=e})),n.forEach((function(t){var e=-1;t.forEach((function(t){var i,r,n=a(t).sort((function(t,e){return h[t.id]-h[e.id]}));if(n.length)for(var d=(n.length-1)/2,l=0,c=[Math.floor(d),Math.ceil(d)];l<c.length;l+=1){var f=n[c[l]];u[t.id]===t.id&&(r=f,!(o[(i=t).id]&&o[i.id][r.id]||o[r.id]&&o[r.id][i.id])&&e<h[f.id]&&(u[f.id]=t.id,s[t.id]=s[f.id],u[t.id]=s[t.id],e=h[f.id]))}}))})),{roots:s,aligns:u}),_=function(t,e,i,r){var n={},o={},a={},s={},u={},d={},l={};return ib(t,(function(t,e,i){n[t.id]=t,o[t.id]=lb,a[t.id]=e,u[t.id]=i[e-1]||t,d[t.id]=t,l[t.id]=0})),t.forEach((function(t){t.filter((function(t){return e[t.id]===t.id})).forEach((function(t){return function t(a,h){if(void 0===h&&(h=0),null==s[a.id]){s[a.id]=0;for(var c=a,f=!1;!f;){if(null!=u[c.id]){var g=d[e[u[c.id].id]];if(l[g.id]>350||3500<h)return;t(g,h+1),l[g.id]++,n[a.id]===a&&(n[a.id]=n[g.id]),n[a.id]!==n[g.id]?o[n[g.id].id]=Math.min(o[n[g.id].id],s[a.id]-s[g.id]-r(a,u[a.id])):s[a.id]=Math.max(s[a.id],s[g.id]+r(a,u[a.id]))}f=(c=d[i[c.id]])===a}}}(t)}))})),ib(t,(function(t){s[t.id]=s[e[t.id]];var i=o[n[e[t.id]].id];t.id===e[t.id]&&isFinite(i)&&(s[t.id]+=i)})),s}(r,p.roots,p.aligns,g);t===db&&(_=nb(_,(function(t){return-t}))),f[i+t]=_}))}));var g,p,_,v,m,y,b,x=(g=f,p=Object.keys(g).reduce((function(t,e){var i=t.alignment,r=t.value,n=rb(g[e]),o=Math.max.apply(Math,n)-Math.min.apply(Math,n);return r<=o?{alignment:i,value:r}:{alignment:e,value:o}}),{alignment:null,value:lb}).alignment,g[p]);_=f,m=rb(v=x),y=Math.min.apply(Math,m),b=Math.max.apply(Math,m),hb((function(t){cb((function(e){var i=t+e,r=_[i];if(r!==v){var n=rb(r),o=e===ub?y-Math.min.apply(Math,n):b-Math.max.apply(Math,n);o&&(_[i]=nb(r,(function(t){return t+o})))}}))}));var E,A=nb((E=f).upleft,(function(t,e){var i=[];return hb((function(t){cb((function(r){var n=t+r;i.push(E[n][e])}))})),i.sort((function(t,e){return t-e})),(i[1]+i[2])/2}));return ib(t,(function(t){t.x=A[t.id]})),t}}function gb(){return function(t,e){var i=-lb;return t.forEach((function(t){var r=t.filter(ob);if(1===r.length)r[0].x=.5;else{r.reduce((function(t,i){return i.x=void 0===t?0:t.x+e(t,i),i}),void 0);var n=r[r.length-1].x;i=Math.max(i,n),r.forEach((function(t){return t.x/=n}))}})),i=Math.max(i,1),ib(t,(function(t){return t.x*=i})),t}}function pb(t,e,i,r){this.feasible=i,this.evaluation=e,this.bounded=r,this._tableau=t}var _b=pb;function vb(t,e,i,r,n){_b.call(this,t,e,i,r),this.iter=n}pb.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,i=e.varIndexByRow,r=e.variablesPerIndex,n=e.matrix,o=e.rhsColumn,a=e.height-1,s=Math.round(1/e.precision),u=1;u<=a;u+=1){var d=r[i[u]];if(void 0!==d&&!0!==d.isSlack){var l=n[u][o];t[d.id]=Math.round(l*s)/s}}return t};var mb=vb;function yb(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}vb.prototype=Object.create(_b.prototype),vb.constructor=vb;var bb=yb;function xb(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var i=0;i<e;i+=1)this.reducedCosts[i]=0}yb.prototype.solve=function(){return 0<this.model.getNumberOfIntegerVariables()?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},xb.prototype.copy=function(){var t=new xb(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t},yb.prototype.setOptionalObjective=function(t,e,i){var r=this.objectivesByPriority[t];void 0===r&&(r=new xb(t,Math.max(this.width,e+1)),this.objectivesByPriority[t]=r,this.optionalObjectives.push(r),this.optionalObjectives.sort((function(t,e){return t.priority-e.priority}))),r.reducedCosts[e]=i},yb.prototype.initialize=function(t,e,i,r){this.variables=i,this.unrestrictedVars=r,this.width=t,this.height=e;for(var n=new Array(t),o=0;o<t;o++)n[o]=0;this.matrix=new Array(e);for(var a=0;a<e;a++)this.matrix[a]=n.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},yb.prototype._resetMatrix=function(){var t,e,i=this.model.variables,r=this.model.constraints,n=i.length,o=r.length,a=this.matrix[0],s=!0===this.model.isMinimization?-1:1;for(t=0;t<n;t+=1){var u=i[t],d=u.priority,l=s*u.cost;0===d?a[t+1]=l:this.setOptionalObjective(d,t+1,l),e=i[t].index,this.rowByVarIndex[e]=-1,this.colByVarIndex[e]=t+1,this.varIndexByCol[t+1]=e}for(var h=1,c=0;c<o;c+=1){var f,g,p=r[c],_=p.index;this.rowByVarIndex[_]=h,this.colByVarIndex[_]=-1,this.varIndexByRow[h]=_;var v=p.terms,m=v.length,y=this.matrix[h++];if(p.isUpperBound){for(f=0;f<m;f+=1)g=v[f],y[this.colByVarIndex[g.variable.index]]=g.coefficient;y[0]=p.rhs}else{for(f=0;f<m;f+=1)g=v[f],y[this.colByVarIndex[g.variable.index]]=-g.coefficient;y[0]=-p.rhs}}},yb.prototype.setModel=function(t){var e=(this.model=t).nVariables+1,i=t.nConstraints+1;return this.initialize(e,i,t.variables,t.unrestrictedVariables),this._resetMatrix(),this},yb.prototype.getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},yb.prototype.density=function(){for(var t=0,e=this.matrix,i=0;i<this.height;i++)for(var r=e[i],n=0;n<this.width;n++)0!==r[n]&&(t+=1);return t/(this.height*this.width)},yb.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=this.matrix[this.costRowIndex][this.rhsColumn];this.evaluation=Math.round(e*t)/t},yb.prototype.getSolution=function(){var t=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return 0<this.model.getNumberOfIntegerVariables()?new mb(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new _b(this,t,this.feasible,this.bounded)},bb.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},bb.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],i=this.matrix,r=this.rhsColumn,n=this.width-1,o=this.height-1,a=0;;){for(var s=0,u=-this.precision,d=1;d<=o;d++)if(!0!==this.unrestrictedVars[this.varIndexByRow[d]]){var l=i[d][r];l<u&&(u=l,s=d)}if(0===s)return this.feasible=!0,a;for(var h=0,c=-1/0,f=i[0],g=i[s],p=1;p<=n;p++){var _=g[p];if(!(-this.precision<_&&_<this.precision)&&(!0===this.unrestrictedVars[this.varIndexByCol[p]]||_<-this.precision)){var v=-f[p]/_;c<v&&(c=v,h=p)}}if(0===h)return this.feasible=!1,a;if(t){e.push([this.varIndexByRow[s],this.varIndexByCol[h]]);var m=this.checkForCycles(e);if(0<m.length)throw console.log("Cycle in phase 1"),console.log("Start :",m[0]),console.log("Length :",m[1]),new Error}this.pivot(s,h),a+=1}},bb.prototype.phase2=function(){for(var t,e,i=this.model.checkForCycles,r=[],n=this.matrix,o=this.rhsColumn,a=this.width-1,s=this.height-1,u=this.precision,d=this.optionalObjectives.length,l=null,h=0;;){var c=n[this.costRowIndex];0<d&&(l=[]);for(var f=0,g=u,p=!1,_=1;_<=a;_++)t=c[_],e=!0===this.unrestrictedVars[this.varIndexByCol[_]],0<d&&-u<t&&t<u?l.push(_):e&&t<0?g<-t&&(g=-t,f=_,p=!0):g<t&&(g=t,f=_,p=!1);if(0<d)for(var v=0;0===f&&0<l.length&&v<d;){var m=[],y=this.optionalObjectives[v].reducedCosts;g=u;for(var b=0;b<l.length;b++)t=y[_=l[b]],e=!0===this.unrestrictedVars[this.varIndexByCol[_]],-u<t&&t<u?m.push(_):e&&t<0?g<-t&&(g=-t,f=_,p=!0):g<t&&(g=t,f=_,p=!1);l=m,v+=1}if(0===f)return this.setEvaluation(),h;for(var x=0,E=1/0,A=(this.varIndexByRow,1);A<=s;A++){var S=n[A],w=S[o],T=S[f];if(!(-u<T&&T<u)){if(0<T&&w<u&&-u<w){E=0,x=A;break}var C=p?-w/T:w/T;u<C&&C<E&&(E=C,x=A)}}if(E===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[f],h;if(i){r.push([this.varIndexByRow[x],this.varIndexByCol[f]]);var M=this.checkForCycles(r);if(0<M.length)throw console.log("Cycle in phase 2"),console.log("Start :",M[0]),console.log("Length :",M[1]),new Error}this.pivot(x,f,!0),h+=1}};var Eb=[];function Ab(t,e,i,r){this.id=t,this.cost=e,this.index=i,this.value=0,this.priority=r}function Sb(t,e,i,r){Ab.call(this,t,e,i,r)}function wb(t,e){Ab.call(this,t,0,e,0)}function Tb(t,e){this.variable=t,this.coefficient=e}function Cb(t,e,i){return 0===i||"required"===i?null:(e=e||1,i=i||1,!1===t.isMinimization&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,i))}function Mb(t,e,i,r){this.slack=new wb("s"+i,i),this.index=i,this.model=r,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function Ib(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}bb.prototype.pivot=function(t,e){var i=this.matrix,r=i[t][e],n=this.height-1,o=this.width-1,a=this.varIndexByRow[t],s=this.varIndexByCol[e];this.varIndexByRow[t]=s,this.varIndexByCol[e]=a,this.rowByVarIndex[s]=t,this.rowByVarIndex[a]=-1,this.colByVarIndex[s]=-1,this.colByVarIndex[a]=e;for(var u,d,l,h=i[t],c=0,f=0;f<=o;f++)0!==h[f]&&(h[f]/=r,Eb[c]=f,c+=1);h[e]=1/r,this.precision;for(var g=0;g<=n;g++){var p=i[g];if(g!==t&&0!==(u=p[e])){for(d=0;d<c;d++)0!==(l=h[f=Eb[d]])&&(p[f]=p[f]-u*l);p[e]=-u/r}}var _=this.optionalObjectives.length;if(0<_)for(var v=0;v<_;v+=1){var m=this.optionalObjectives[v].reducedCosts;if(0!==(u=m[e])){for(d=0;d<c;d++)0!==(l=h[f=Eb[d]])&&(m[f]=m[f]-u*l);m[e]=-u/r}}},bb.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var i=e+1;i<t.length;i++){var r=t[e],n=t[i];if(r[0]===n[0]&&r[1]===n[1]){if(i-e>t.length-i)break;for(var o=!0,a=1;a<i-e;a++){var s=t[e+a],u=t[i+a];if(s[0]!==u[0]||s[1]!==u[1]){o=!1;break}}if(o)return[e,i-e]}}return[]},wb.prototype.isSlack=Sb.prototype.isInteger=!0,Mb.prototype.addTerm=function(t,e){var i=e.index,r=this.termsByVarIndex[i];if(void 0===r)r=new Tb(e,t),this.termsByVarIndex[i]=r,this.terms.push(r),!0===this.isUpperBound&&(t=-t),this.model.updateConstraintCoefficient(this,e,t);else{var n=r.coefficient+t;this.setVariableCoefficient(n,e)}return this},Mb.prototype.removeTerm=function(t){return this},Mb.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;!0===this.isUpperBound&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this},Mb.prototype.setVariableCoefficient=function(t,e){var i=e.index;if(-1!==i){var r=this.termsByVarIndex[i];if(void 0===r)this.addTerm(t,e);else if(t!==r.coefficient){var n=t-r.coefficient;!0===this.isUpperBound&&(n=-n),r.coefficient=t,this.model.updateConstraintCoefficient(this,e,n)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},Mb.prototype.relax=function(t,e){this.relaxation=Cb(this.model,t,e),this._relax(this.relaxation)},Mb.prototype._relax=function(t){null!==t&&(this.isUpperBound?this.setVariableCoefficient(-1,t):this.setVariableCoefficient(1,t))},Ib.prototype.isEquality=!0,Ib.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this},Ib.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this},Ib.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t},Ib.prototype.relax=function(t,e){this.relaxation=Cb(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var Lb={Constraint:Mb,Variable:Ab,IntegerVariable:Sb,SlackVariable:wb,Equality:Ib,Term:Tb},Nb=Lb.SlackVariable;function kb(t,e){this.index=t,this.value=e}bb.prototype.addCutConstraints=function(t){for(var e,i=t.length,r=this.height,n=r+i,o=r;o<n;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=n,this.nVars=this.width+this.height-2;for(var a=this.width-1,s=0;s<i;s+=1){var u=t[s],d=r+s,l="min"===u.type?-1:1,h=u.varIndex,c=this.rowByVarIndex[h],f=this.matrix[d];if(-1===c){for(f[this.rhsColumn]=l*u.value,e=1;e<=a;e+=1)f[e]=0;f[this.colByVarIndex[h]]=l}else{var g=this.matrix[c],p=g[this.rhsColumn];for(f[this.rhsColumn]=l*(u.value-p),e=1;e<=a;e+=1)f[e]=-l*g[e]}var _=this.getNewElementIndex();this.varIndexByRow[d]=_,this.rowByVarIndex[_]=d,this.colByVarIndex[_]=-1,this.variablesPerIndex[_]=new Nb("s"+_,_),this.nVars+=1}},bb.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],r=i-Math.floor(i);if(r<this.precision||1-this.precision<r)return!1;var n=this.height;e[n]=e[n-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[n]=o,this.rowByVarIndex[o]=n,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new Nb("s"+o,o),e[n][this.rhsColumn]=Math.floor(i);for(var a=1;a<this.varIndexByCol.length;a+=1)if(this.variablesPerIndex[this.varIndexByCol[a]].isInteger){var s=e[t][a],u=Math.floor(s)+Math.max(0,s-Math.floor(s)-r)/(1-r);e[n][a]=u}else e[n][a]=Math.min(0,e[t][a]/(1-r));for(var d=0;d<this.width;d+=1)e[n][d]-=e[t][d];return!0},bb.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],r=i-Math.floor(i);if(r<this.precision||1-this.precision<r)return!1;var n=this.height;e[n]=e[n-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[n]=o,this.rowByVarIndex[o]=n,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new Nb("s"+o,o),e[n][this.rhsColumn]=-r;for(var a=1;a<this.varIndexByCol.length;a+=1){var s=this.variablesPerIndex[this.varIndexByCol[a]],u=e[t][a],d=u-Math.floor(u);s.isInteger?e[n][a]=d<=r?-d:-(1-d)*r/d:e[n][a]=0<=u?-u:u*r/(1-r)}return!0},bb.prototype.applyMIRCuts=function(){for(var t=this.height,e=0;e<t;e+=1)this._addUpperBoundMIRCut(e);for(e=0;e<t;e+=1)this._addLowerBoundMIRCut(e)},bb.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(-1===e){for(var i=this.colByVarIndex[t],r=1;r<this.height;r+=1){var n=this.matrix[r][i];if(n<-this.precision||this.precision<n){e=r;break}}this.pivot(e,i)}return e},bb.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(-1===e){for(var i=this.rowByVarIndex[t],r=this.matrix[i],n=1;n<this.height;n+=1){var o=r[n];if(o<-this.precision||this.precision<o){e=n;break}}this.pivot(i,e)}return e},bb.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),i=0;i<t;i+=1){var r=this.variables[i],n=r.index,o=this.rowByVarIndex[n];if(-1===o)r.value=0;else{var a=this.matrix[o][this.rhsColumn];r.value=Math.round(a*e)/e}}},bb.prototype.updateRightHandSide=function(t,e){var i=this.height-1,r=this.rowByVarIndex[t.index];if(-1===r){for(var n=this.colByVarIndex[t.index],o=0;o<=i;o+=1){var a=this.matrix[o];a[this.rhsColumn]-=e*a[n]}var s=this.optionalObjectives.length;if(0<s)for(var u=0;u<s;u+=1){var d=this.optionalObjectives[u].reducedCosts;d[this.rhsColumn]-=e*d[n]}}else this.matrix[r][this.rhsColumn]-=e},bb.prototype.updateConstraintCoefficient=function(t,e,i){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var r=this._putInBase(t.index),n=this.colByVarIndex[e.index];if(-1===n)for(var o=this.rowByVarIndex[e.index],a=0;a<this.width;a+=1)this.matrix[r][a]+=i*this.matrix[o][a];else this.matrix[r][n]-=i},bb.prototype.updateCost=function(t,e){var i=t.index,r=this.width-1,n=this.colByVarIndex[i];if(-1===n){var o,a=this.matrix[this.rowByVarIndex[i]];if(0===t.priority){var s=this.matrix[0];for(o=0;o<=r;o+=1)s[o]+=e*a[o]}else{var u=this.objectivesByPriority[t.priority].reducedCosts;for(o=0;o<=r;o+=1)u[o]+=e*a[o]}}else this.matrix[0][n]-=e},bb.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,i=this.height,r=this.matrix[i];void 0===r&&(r=this.matrix[0].slice(),this.matrix[i]=r);for(var n=this.width-1,o=0;o<=n;o+=1)r[o]=0;r[this.rhsColumn]=e*t.rhs;for(var a=t.terms,s=a.length,u=0;u<s;u+=1){var d=a[u],l=d.coefficient,h=d.variable.index,c=this.rowByVarIndex[h];if(-1===c)r[this.colByVarIndex[h]]+=e*l;else{var f=this.matrix[c];for(f[this.rhsColumn],o=0;o<=n;o+=1)r[o]-=e*l*f[o]}}var g=t.index;this.varIndexByRow[i]=g,this.rowByVarIndex[g]=i,this.colByVarIndex[g]=-1,this.height+=1},bb.prototype.removeConstraint=function(t){var e=t.index,i=this.height-1,r=this._putInBase(e),n=this.matrix[i];this.matrix[i]=this.matrix[r],this.matrix[r]=n,this.varIndexByRow[r]=this.varIndexByRow[i],this.varIndexByRow[i]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,--this.height},bb.prototype.addVariable=function(t){var e=this.height-1,i=this.width,r=!0===this.model.isMinimization?-t.cost:t.cost,n=t.priority,o=this.optionalObjectives.length;if(0<o)for(var a=0;a<o;a+=1)this.optionalObjectives[a].reducedCosts[i]=0;0===n?this.matrix[0][i]=r:(this.setOptionalObjective(n,i,r),this.matrix[0][i]=0);for(var s=1;s<=e;s+=1)this.matrix[s][i]=0;var u=t.index;this.varIndexByCol[i]=u,this.rowByVarIndex[u]=-1,this.colByVarIndex[u]=i,this.width+=1},bb.prototype.removeVariable=function(t){var e=t.index,i=this._takeOutOfBase(e),r=this.width-1;if(i!==r){for(var n=this.height-1,o=0;o<=n;o+=1){var a=this.matrix[o];a[i]=a[r]}var s=this.optionalObjectives.length;if(0<s)for(var u=0;u<s;u+=1){var d=this.optionalObjectives[u].reducedCosts;d[i]=d[r]}var l=this.varIndexByCol[r];this.varIndexByCol[i]=l,this.colByVarIndex[l]=i}this.varIndexByCol[r]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,--this.width},bb.prototype.log=function(t,e){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var i,r,n,o,a,s,u,d,l,h,c="",f=[" "];for(r=1;r<this.width;r+=1)a=this.varIndexByCol[r],u=" ",d="\t",5<(s=void 0===(o=this.variablesPerIndex[a])?"c"+a:o.id).length?u+=" ":d+="\t",f[r]=u,c+=d+s;console.log(c);var g=this.matrix[this.costRowIndex],p="\t";for(i=1;i<this.width;i+=1)p+="\t",p+=f[i],p+=g[i].toFixed(5);for(p+="\t"+f[0]+g[0].toFixed(5),console.log(p+"\tZ"),n=1;n<this.height;n+=1){for(l=this.matrix[n],h="\t",r=1;r<this.width;r+=1)h+="\t"+f[r]+l[r].toFixed(5);h+="\t"+f[0]+l[0].toFixed(5),a=this.varIndexByRow[n],s=void 0===(o=this.variablesPerIndex[a])?"c"+a:o.id,console.log(h+"\t"+s)}console.log("");var _=this.optionalObjectives.length;if(0<_){console.log("    Optional objectives:");for(var v=0;v<_;v+=1){var m=this.optionalObjectives[v].reducedCosts,y="";for(i=1;i<this.width;i+=1)y+=m[i]<0?"":" ",y+=f[i],y+=m[i].toFixed(5);y+=(m[0]<0?"":" ")+f[0]+m[0].toFixed(5),console.log(y+" z"+v)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},bb.prototype.copy=function(){var t=new bb(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],i=0;i<this.optionalObjectives.length;i++)e[i]=this.optionalObjectives[i].copy();t.optionalObjectives=e;for(var r=this.matrix,n=new Array(this.height),o=0;o<this.height;o++)n[o]=r[o].slice();return t.matrix=n,t},bb.prototype.save=function(){this.savedState=this.copy()},bb.prototype.restore=function(){if(null!==this.savedState){var t,e,i=this.savedState,r=i.matrix;for(this.nVars=i.nVars,this.model=i.model,this.variables=i.variables,this.variablesPerIndex=i.variablesPerIndex,this.unrestrictedVars=i.unrestrictedVars,this.lastElementIndex=i.lastElementIndex,this.width=i.width,this.height=i.height,t=0;t<this.height;t+=1){var n=r[t],o=this.matrix[t];for(e=0;e<this.width;e+=1)o[e]=n[e]}var a=i.varIndexByRow;for(e=0;e<this.height;e+=1)this.varIndexByRow[e]=a[e];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var s=i.varIndexByCol;for(t=0;t<this.width;t+=1)this.varIndexByCol[t]=s[t];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var u=i.rowByVarIndex,d=i.colByVarIndex,l=0;l<this.nVars;l+=1)this.rowByVarIndex[l]=u[l],this.colByVarIndex[l]=d[l];if(0<i.optionalObjectives.length&&0<this.optionalObjectives.length){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var h=0;h<i.optionalObjectives.length;h++){var c=i.optionalObjectives[h].copy();this.optionalObjectives[h]=c,this.optionalObjectivePerPriority[c.priority]=c}}}},bb.prototype.getMostFractionalVar=function(){for(var t=0,e=null,i=null,r=this.model.integerVariables,n=r.length,o=0;o<n;o++){var a=r[o].index,s=this.rowByVarIndex[a];if(-1!==s){var u=this.matrix[s][this.rhsColumn],d=Math.abs(u-Math.round(u));t<d&&(t=d,e=a,i=u)}}return new kb(e,i)},bb.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,i=null,r=this.model.integerVariables,n=r.length,o=0;o<n;o++){var a=r[o],s=a.index,u=this.rowByVarIndex[s];if(-1!==u){var d=this.matrix[u][this.rhsColumn];if(Math.abs(d-Math.round(d))>this.precision){var l=a.cost;l<t&&(t=l,e=s,i=d)}}}return new kb(e,i)},bb.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var i=this.matrix[e][this.rhsColumn];(i-=Math.floor(i))<this.precision&&-i<this.precision&&(t+=1)}return t},bb.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,i=0;i<e;i++){var r=this.rowByVarIndex[t[i].index];if(-1!==r){var n=this.matrix[r][this.rhsColumn];if(Math.abs(n-Math.round(n))>this.precision)return!1}}return!0},bb.prototype.computeFractionalVolume=function(t){for(var e=-1,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var r=this.matrix[i][this.rhsColumn];if(r=Math.abs(r),Math.min(r-Math.floor(r),Math.floor(r+1))<this.precision){if(!t)return 0}else-1===e?e=r:e*=r}return-1===e?0:e};var Ob=bb;function Fb(t,e,i){this.type=t,this.varIndex=e,this.value=i}function Rb(t,e){this.relaxedEvaluation=t,this.cuts=e}function Pb(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}bb.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var i=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),.9*i<=this.computeFractionalVolume(!0)&&(e=!1)}},bb.prototype.branchAndCut=function(){for(var t=[],e=0,i=1/0,r=null,n=[],o=0;o<this.optionalObjectives.length;o+=1)n.push(1/0);var a=new Rb(-1/0,[]);for(t.push(a);0<t.length;)if(!((a=t.pop()).relaxedEvaluation>i)){var s=a.cuts;if(this.applyCuts(s),e++,!1!==this.feasible){var u=this.evaluation;if(!(i<u)){if(u===i){for(var d=!0,l=0;l<this.optionalObjectives.length&&!(this.optionalObjectives[l].reducedCosts[0]>n[l]);l+=1)if(this.optionalObjectives[l].reducedCosts[0]<n[l]){d=!1;break}if(d)continue}if(!0===this.isIntegral()){if(1===e)return void(this.branchAndCutIterations=e);r=a,i=u;for(var h=0;h<this.optionalObjectives.length;h+=1)n[h]=this.optionalObjectives[h].reducedCosts[0]}else{1===e&&this.save();for(var c=this.getMostFractionalVar(),f=c.index,g=[],p=[],_=s.length,v=0;v<_;v+=1){var m=s[v];m.varIndex===f?"min"===m.type?p.push(m):g.push(m):(g.push(m),p.push(m))}var y=Math.ceil(c.value),b=Math.floor(c.value),x=new Fb("min",f,y);g.push(x);var E=new Fb("max",f,b);p.push(E),t.push(new Rb(u,g)),t.push(new Rb(u,p)),t.sort(Pb)}}}}null!==r&&this.applyCuts(r.cuts),this.branchAndCutIterations=e};var Db={},zb=Lb.Constraint,Bb=Lb.Equality,Ub=Lb.Variable,Vb=Lb.IntegerVariable;function jb(t,e){this.tableau=new bb(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!0,this.checkForCycles=!1}var Gb=jb;jb.prototype.minimize=function(){return this.isMinimization=!0,this},jb.prototype.maximize=function(){return this.isMinimization=!1,this},jb.prototype._getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},jb.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(t)},jb.prototype.smallerThan=function(t){var e=new zb(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},jb.prototype.greaterThan=function(t){var e=new zb(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},jb.prototype.equal=function(t){var e=new zb(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var i=new zb(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),new Bb(e,i)},jb.prototype.addVariable=function(t,e,i,r,n){if("string"==typeof n)switch(n){case"required":n=0;break;case"strong":n=1;break;case"medium":n=2;break;case"weak":n=3;break;default:n=0}var o,a=this.tableau.getNewElementIndex();return null==e&&(e="v"+a),null==t&&(t=0),null==n&&(n=0),i?(o=new Vb(e,t,a,n),this.integerVariables.push(o)):o=new Ub(e,t,a,n),this.variables.push(o),this.tableau.variablesPerIndex[a]=o,r&&(this.unrestrictedVariables[a]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},jb.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e?(this.constraints.splice(e,1),--this.nConstraints,!0===this.tableauInitialized&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},jb.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this},jb.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(-1!==e)return this.variables.splice(e,1),!0===this.tableauInitialized&&this.tableau.removeVariable(t),this;console.warn("[Model.removeVariable] Variable not present in model")},jb.prototype.updateRightHandSide=function(t,e){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(t,e),this},jb.prototype.updateConstraintCoefficient=function(t,e,i){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(t,e,i),this},jb.prototype.setCost=function(t,e){var i=t-e.cost;return!1===this.isMinimization&&(i=-i),e.cost=t,this.tableau.updateCost(e,i),this},jb.prototype.loadJson=function(t){this.isMinimization="max"!==t.opType;for(var e=t.variables,i=t.constraints,r={},n={},o=Object.keys(i),a=o.length,s=0;s<a;s+=1){var u,d,l=o[s],h=i[l],c=h.equal,f=h.weight,g=h.priority,p=void 0!==f||void 0!==g;if(void 0===c){var _=h.min;void 0!==_&&(u=this.greaterThan(_),r[l]=u,p&&u.relax(f,g));var v=h.max;void 0!==v&&(d=this.smallerThan(v),n[l]=d,p&&d.relax(f,g))}else{u=this.greaterThan(c),r[l]=u,d=this.smallerThan(c),n[l]=d;var m=new Bb(u,d);p&&m.relax(f,g)}}for(var y=Object.keys(e),b=y.length,x=t.ints||{},E=t.binaries||{},A=t.unrestricted||{},S=t.optimize,w=0;w<b;w+=1){var T=y[w],C=e[T],M=C[S]||0,I=!!E[T],L=!!x[T]||I,N=!!A[T],k=this.addVariable(M,T,L,N);I&&this.smallerThan(1).addTerm(1,k);var O=Object.keys(C);for(s=0;s<O.length;s+=1){var F=O[s];if(F!==S){var R=C[F],P=r[F];void 0!==P&&P.addTerm(R,k);var D=n[F];void 0!==D&&D.addTerm(R,k)}}}return this},jb.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},jb.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},jb.prototype.isFeasible=function(){return this.tableau.feasible},jb.prototype.save=function(){return this.tableau.save()},jb.prototype.restore=function(){return this.tableau.restore()},jb.prototype.activateMIRCuts=function(t){this.useMIRCuts=t},jb.prototype.debug=function(t){this.checkForCycles=t},jb.prototype.log=function(t){return this.tableau.log(t)};var Hb={CleanObjectiveAttributes:function(t){var e,i,r;if("string"==typeof t.optimize){if(t.constraints[t.optimize]){for(i in e=Math.random(),t.variables)t.variables[i][t.optimize]&&(t.variables[i][e]=t.variables[i][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}return t}for(r in t.optimize)if(t.constraints[r])if("equal"===t.constraints[r])delete t.optimize[r];else{for(i in e=Math.random(),t.variables)t.variables[i][r]&&(t.variables[i][e]=t.variables[i][r]);t.constraints[e]=t.constraints[r],delete t.constraints[r]}return t}};function Wb(t){return(t.length?function(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},r={">=":"min","<=":"max","=":"equal"},n="",o=null,a="",s="",u="",d=0;"string"==typeof t&&(t=t.split("\n"));for(var l=0;l<t.length;l++)if(u="__"+l,n=t[l],o=null,e.is_objective.test(n))i.opType=n.match(/(max|min)/gi)[0],(o=n.match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")})).slice(1)).forEach((function(t){a=null===(a=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:a[0],a=parseFloat(a),s=t.match(e.get_word)[0].replace(/\;$/,""),i.variables[s]=i.variables[s]||{},i.variables[s]._obj=a}));else if(e.is_int.test(n))o=n.match(e.parse_int).slice(1),i.ints=i.ints||{},o.forEach((function(t){t=t.replace(";",""),i.ints[t]=1}));else if(e.is_constraint.test(n)){var h=n.indexOf(":");(o=(-1===h?n:n.slice(h+1)).match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")}))).forEach((function(t){a=null===(a=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:a[0],a=parseFloat(a),s=t.match(e.get_word)[0],i.variables[s]=i.variables[s]||{},i.variables[s][u]=a})),d=parseFloat(n.match(e.parse_rhs)[0]),n=r[n.match(e.parse_dir)[0]],i.constraints[u]=i.constraints[u]||{},i.constraints[u][n]=d}else e.is_unrestricted.test(n)&&(o=n.match(e.parse_int).slice(1),i.unrestricted=i.unrestricted||{},o.forEach((function(t){t=t.replace(";",""),i.unrestricted[t]=1})));return i}:function(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",i={max:"<=",min:">=",equal:"="},r=new RegExp("[^A-Za-z0-9]+","gi");for(var n in e+=t.opType+":",t.variables)t.variables[n][n]=t.variables[n][n]?t.variables[n][n]:1,t.variables[n][t.optimize]&&(e+=" "+t.variables[n][t.optimize]+" "+n.replace(r,"_"));for(n in e+=";\n",t.constraints)for(var o in t.constraints[n]){for(var a in t.variables)t.variables[a][n]&&(e+=" "+t.variables[a][n]+" "+a.replace(r,"_"));e+=" "+i[o]+" "+t.constraints[n][o],e+=";\n"}if(t.ints)for(n in e+="\n\n",t.ints)e+="int "+n.replace(r,"_")+";\n";if(t.unrestricted)for(n in e+="\n\n",t.unrestricted)e+="unrestricted "+n.replace(r,"_")+";\n";return e})(t)}function qb(){this.Model=Gb,this.branchAndCut=Db,this.Constraint=Xb,this.Variable=Yb,this.Numeral=Zb,this.Term=Kb,this.Tableau=Ob,this.lastSolvedModel=null,this.Solve=function(t,e,i,r){if(r)for(var n in Hb)t=Hb[n](t);if(!t)throw new Error("Solver requires a model to operate on");t instanceof Gb==0&&(t=new Gb(e).loadJson(t));var o=t.solve();if(this.lastSolvedModel=t,o.solutionSet=o.generateSolutionSet(),i)return o;var a={};return a.feasible=o.feasible,a.result=o.evaluation,a.bounded=o.bounded,Object.keys(o.solutionSet).map((function(t){a[t]=o.solutionSet[t]})),a},this.ReformatLP=Wb,this.MultiObjective=function(t){return function(t,e){var i,r,n,o,a,s=e.optimize,u=JSON.parse(JSON.stringify(e.optimize)),d=Object.keys(e.optimize),l=0,h={},c="",f={},g=[];for(delete e.optimize,r=0;r<d.length;r++)u[d[r]]=0;for(r=0;r<d.length;r++){for(a in e.optimize=d[r],e.opType=s[d[r]],i=t.Solve(e,void 0,void 0,!0),d)if(!e.variables[d[a]])for(o in i[d[a]]=i[d[a]]?i[d[a]]:0,e.variables)e.variables[o][d[a]]&&i[o]&&(i[d[a]]+=i[o]*e.variables[o][d[a]]);for(c="base",n=0;n<d.length;n++)i[d[n]]?c+="-"+(1e3*i[d[n]]|0)/1e3:c+="-0";if(!h[c]){for(h[c]=1,l++,n=0;n<d.length;n++)i[d[n]]&&(u[d[n]]+=i[d[n]]);delete i.feasible,delete i.result,g.push(i)}}for(r=0;r<d.length;r++)e.constraints[d[r]]={equal:u[d[r]]/l};for(r in e.optimize="cheater-"+Math.random(),e.opType="max",e.variables)e.variables[r].cheater=1;for(r in g)for(o in g[r])f[o]=f[o]||{min:1e99,max:-1e99};for(r in f)for(o in g)g[o][r]?(g[o][r]>f[r].max&&(f[r].max=g[o][r]),g[o][r]<f[r].min&&(f[r].min=g[o][r])):(g[o][r]=0,f[r].min=0);return{midpoint:i=t.Solve(e,void 0,void 0,!0),vertices:g,ranges:f}}(this,t)}}var Xb=Lb.Constraint,Yb=Lb.Variable,Zb=Lb.Numeral,Kb=Lb.Term;"object"==typeof window&&(window.solver=new qb);var Qb=new qb;function Jb(t){var e={},i={},r={};t.nodes.forEach((function(t){i[t.id]=1,e[t.id]={opt:t.children.length},t.children.forEach((function(i){var n=t.id+"->"+i.id;r[n]={min:1},e[t.id][n]=-1}))})),t.nodes.forEach((function(t){t.children.forEach((function(i){var r=t.id+"->"+i.id;e[i.id].opt--,e[i.id][r]=1}))}));var n=Qb.Solve({optimize:"opt",opType:"max",constraints:r,variables:e,ints:i});return t.nodes.forEach((function(t){t.layer=n[t.id]||0})),t}function $b(t){return t.nodes.forEach((function(t){t.layer=null!=t.data.layer?t.data.layer:t.layer})),t}function tx(t){var e=Object.assign({},{normalization:!0},t),i=Jb;return function(t){if(t.nodes.some((function(t){return"layer"in t.data&&t.data.layer<0})))throw new Error("Some nodes have negative layering information");if(!e.normalization&&t.nodes.every((function(t){return"layer"in t.data&&-1<t.data.layer}))){var r=[];t.nodes.forEach((function(t){return r[t.data.layer]=1}));for(var n=r.findIndex((function(t){return null!=t})),o=0,a=r.slice(n);o<a.length;o+=1)if(null==a[o])throw new Error("The overall layering contains gaps (two non-consecutive layers)")}t.nodes.some((function(t){return"layer"in t.data&&0===t.data.layer}))||$b(i(t));var s,u,d=function(t){if(t.nodes.every((function(t){return t.layer}))){var e=1/0;t.nodes.forEach((function(t){e=Math.min(e,t.layer)})),t.nodes.forEach((function(t){t.layer-=e}))}return t}(function(t){if(t.nodes.some((function(t){return t.data.sink}))){var e=-1/0;t.nodes.forEach((function(t){e=Math.max(e,t.layer)})),t.nodes.forEach((function(t){t.data.sink&&(t.layer=e+1)}))}return t}(function(t){var e={};t.nodes.forEach((function(t){e[t.id]=(e[t.id]||[]).concat(t.children),t.children.forEach((function(i){e[i.id]=(e[i.id]||[]).concat([t])}))}));var i=[];t.nodes.forEach((function(t){0===t.layer&&i.push(t)}));var r={},n={};for(t.nodes.forEach((function(t){null!=t.layer&&(n[t.id]=t.layer)}));i.length;)for(var o=i.shift().id,a=0,s=e[o];a<s.length;a+=1){var u=s[a];if(!r[u.id]){if(null==n[u.id]){var d=n[o]+1;n[u.id]=d,u.layer=d}r[u.id]=!0,i.push(u)}}return t}($b(t))));return function(t,e){if(e.normalization){var i=[];t.nodes.forEach((function(t){return i[t.layer]=0}));var r=Array.from(i).reduce((function(t,e,i){if(0===i)return t.push(0),t;var r=t[i-1];return null!=e?t.push(r):t.push(r-1),t}),[]);t.nodes.forEach((function(t){t.layer+=r[t.layer]}))}}(d,e),(u=(s=d).nodes.reduce((function(t,e){if(e.data.fixed){if(null==t)return e;if(t.layer>e.layer)return e}return t}),null))&&s.nodes.forEach((function(t){t.ref=u.id})),s}}var ex=function(){this.root=null};function ix(t){var e={x:0,y:0};for(var i in t)e.x+=t[i].x||0,e.y+=t[i].y||0;return e.x/=Object.keys(t).length,e.y/=Object.keys(t).length,e}ex.prototype.fit=function(t){var e=t.length?t[0].w:0,i=t.length?t[0].h:0;this.root={x:0,y:0,w:e,h:i};for(var r=0,n=t;r<n.length;r+=1){var o=n[r],a=this.findNode(this.root,o.w,o.h);o.fit=a?this.splitNode(a,o.w,o.h):this.growNode(o.w,o.h)}},ex.prototype.findNode=function(t,e,i){return t.used?this.findNode(t.right,e,i)||this.findNode(t.down,e,i):e<=t.w&&i<=t.h?t:void 0},ex.prototype.splitNode=function(t,e,i){return t.used=!0,t.down={x:t.x,y:t.y+i,w:t.w,h:t.h-i},t.right={x:t.x+e,y:t.y,w:t.w-e,h:i},t},ex.prototype.growNode=function(t,e){var i=t<=this.root.w,r=e<=this.root.h;return r&&this.root.h>=this.root.w+t?this.growRight(t,e):i&&this.root.w>=this.root.h+e?this.growDown(t,e):r?this.growRight(t,e):i?this.growDown(t,e):void 0},ex.prototype.getNewRoot=function(t,e,i,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.root),void 0===r&&(r=this.root),{used:!0,x:0,y:0,w:this.root.w+t,h:this.root.h+e,right:i,down:r}},ex.prototype.growRight=function(t,e){return this.root=this.getNewRoot(t,0,{x:this.root.w,y:0,w:t,h:this.root.h}),this.grow(t,e)},ex.prototype.growDown=function(t,e){return this.root=this.getNewRoot(0,e,void 0,{x:0,y:this.root.h,w:this.root.w,h:e}),this.grow(t,e)},ex.prototype.grow=function(t,e){var i=this.findNode(this.root,t,e);if(i)return this.splitNode(i,t,e)};var rx={down:function(){},up:function(t){t.y=-t.y},left:function(t){var e=t.x;t.x=-t.y,t.y=e},right:function(t){var e=t.x;t.x=t.y,t.y=-e}};function nx(t,e){return null!=t&&0<t?t:e}function ox(t){if(!t||!t.length)throw Error("Cannot stratify empty data");for(var e=0,i=t;e<i.length;e+=1){var r=i[e];if(null==r)throw Error('Node data is "null"');if(null==r.id)throw Error('Node id contains a "null" value')}for(var n=t.map((function(t){return ab(t.id,t)})),o=n.reduce((function(t,e){if(t[e.id])throw Error("The connected component contains id duplicates: "+e.id);return t[e.id]=e,t}),{}),a=ab(),s=0,u=n;s<u.length;s+=1){for(var d=u[s],l=0,h=d.data.parentIds;l<h.length;l+=1){var c=h[l],f=o[c];if(!f)throw Error("The node "+d.id+" has a missing parent id "+c);f.children.push(d)}d.data.parentIds.length||a.children.push(d)}return{nodes:function(t){for(var e={},i=[].concat(t.children),r=[];i.length;){var n=i.pop();e[n.id]||(r.push(n),e[n.id]=1,i.push.apply(i,n.children))}return r}(a)}}function ax(t,e){var i=e.decross,r=e.separation,n=e.coord;(0,e.layering)(t);var o,a,s=t.nodes.reduce((function(t,e){return t[e.layer]=t[e.layer]||[],t[e.layer].push(e),e.children=e.children.map((function(i){if(i.layer===e.layer+1)return i;for(var r=i,n=i.layer-1;n>e.layer;n--){var o=ab(e.id+"->"+i.id+"@"+n);o.children=[r],t[n]=t[n]||[],t[n].push(o),r=o}return r})),t}),[]);return a=1===(o=s).length?sx:ux,o.forEach((function(t,e){for(var i=0,r=t;i<r.length;i+=1)r[i].y=a(e,o.length)})),function(t,e){var i=e.coord,r=e.decross,n=e.separation;if(t.every((function(t){return 1===t.length})))return t.forEach((function(t){return t[0].x=.5}));r(t),i(t,n)}(s,{decross:i,coord:n,separation:r}),t.nodes.forEach((function(t){t.data&&(t.children=t.children.filter((function(t){return t.data})))})),t}function sx(){return.5}function ux(t,e){return 1*t/(e-1)}function dx(t){return{id:""+t.id,layer:t.layer,sink:t.sink,radius:t.r,fixed:!1===t.layoutable,parentIds:[],ref:null}}function lx(t,e){if(!t||!t.nodes)return t;var i,r,n=e||{},o=function(t,e){void 0===e&&(e={});for(var i=(t.edges||[]).filter((function(t){return t.source!==t.target})),r={},n=0,o=t.nodes;n<o.length;n+=1){var a=o[n];r[a.id]=a}var s=function(t,e,i){var r=e.reduce((function(t,e){return t[e.source]=t[e.source]||[],t[e.source].push(e),t}),{}),n=t.reduce((function t(e,n){var o=e.visited,a=e.stack,s=e.result;if(o[n.id])return e;o[n.id]=a[n.id]=1;for(var u=0,d=r[n.id]||[];u<d.length;u+=1){var l=d[u];a[l.target]?s.push(l):t(e,i[l.target])}return delete a[n.id],e}),{visited:{},stack:{},result:[]}).result.reduce((function(t,e){var i=e.source,r=e.target;return t[i]=t[i]||{},t[i][r]=1,t}),{});return e.map((function(t){var e=t.source,i=t.target;return n[e]&&n[e][i]?{source:i,target:e}:t}))}(t.nodes,i,r),u=function(t,e,i){void 0===i&&(i={});for(var r=Qy(e),n=Object.keys(r),o=[];n.length;){var a=Ky(n[0],r);o.push(a),n=eb(n,a)}return i.skipSingletons?o:o.concat(tb(t,e,r).map((function(t){return[t.id+""]})))}(t.nodes,s,{skipSingletons:"singleton"===e.packing}),d=s.reduce((function(t,e){return t[e.source]||(t[e.source]=dx(r[e.source])),t[e.target]||(t[e.target]=dx(r[e.target])),t[e.target].parentIds.push(""+e.source),t}),{});return{shapes:u.map((function(t){return t.map((function(t){return d[t]||dx(r[t]||{id:t})}))})),nLookup:r}}(t,n),a=o.shapes,s=o.nLookup,u=function(t,e){void 0===e&&(e={});for(var i=[],r=0,n=t;r<n.length;r+=1){var o=ox(n[r]);i.push(o),ax(o,{decross:function(t){return t.slice(0,t.length-1).forEach((function(e,i){return sb(e,t[i+1])})),t},separation:Jy($y(o.nodes),e.gapDistance),coord:(e.evenDistribution?gb:fb)(),layering:tx(e)})}return i}(a,n);if("singleton"===n.packing){var d=tb(t.nodes,t.edges),l=function(t,e){void 0===e&&(e={});var i=t.slice().sort((function(t,e){return e.r-t.r})),r=Math.sqrt(i.length),n=Math.floor(r),o=Math.ceil(r);n*o<i.length&&(n<o?n++:o++);var a=1.2*i.reduce((function(t,e){var i=e.r;return Math.max(t,2*i)}),0),s=Math.max(e.nodesGridSeparation||50,1),u=a*o+s*(o-1),d=a*n+s*Math.max(n-1,0);return i.forEach((function(t,e){var i=e%o,r=Math.floor(e/o);t.x=u*i/o,t.y=d*r/n})),{w:u,h:d}}(d,n);u.push((i=d,r=l,Object.assign({},{nodes:i.map((function(t){return Object.assign({},t,{data:t})})),isFake:!0},r)))}return function(t,e,i){void 0===i&&(i={});for(var r=-1/0,n=-1/0,o=nx(i.nodesSeparation,0),a=nx(i.componentsSeparation,25),s=nx(i.layerSeparation,50),u=[],d=ix(e),l=t.reduce((function(t,i){return i.nodes.filter((function(t){return t.data&&t.data.fixed})).reduce((function(t,i){var r=e[i.id],n=r.x,o=r.y;return t[i.id]={x:n||0,y:o||0},t}),t)}),{}),h=function(){var t=f[c],i={},d=t.nodes,l=1==d.length,h=2*$y(d)|5,g=d.reduce((function(t,e){var i=e.x;return Math.min(t,i)}),1/0);r=d.reduce((function(t,e){var i=e.x;return Math.max(t,i)}),-1/0)-g;for(var p=0,_=d;p<_.length;p+=1){var v=_[p],m=v.x,y=v.y,b=v.id;e[b]&&(l?e[b].x=e[b].y=0:(e[b].x=m-g,e[b].y=y,i[y]=i[y]||[],i[y].push(e[b])))}var x=Math.max(h,s),E=Object.keys(i),A=E.reduce((function(t,e){return Math.max(t,i[e].length-1)}),1)*(3+Math.max(1,o));n=(E.length||1)*x,r=Math.max(r,1),t.isFake||E.sort((function(t,e){return t-e})).forEach((function(t,e){i[t].forEach((function(t){t.y=e*x,t.x=t.x/r*A}))})),u.push({w:Math.ceil(A)+a,h:Math.ceil(n),dag:t}),n=r=-1/0},c=0,f=t;c<f.length;c+=1)h();if(u.sort((function(t,e){return Math.max(e.w,e.h)-Math.max(t.w,t.h)})),"hierarchy"!==i.packing)(new ex).fit(u);else for(var g=0,p=0,_=u;p<_.length;p+=1){var v=_[p];v.fit={x:g,y:0},g+=v.w}for(var m,y,b=u.reduce((function(t,e){var i=e.h;return Math.max(t,i)}),1),x=0,E=u;x<E.length;x+=1)for(var A=E[x],S=A.fit,w=A.dag,T=S||{x:0,y:0},C=T.y/b*50+T.y,M=T.x,I=0,L=w.nodes;I<L.length;I+=1){var N=L[I].id;e[N]&&(e[N].x+=M,e[N].y+=C,m=e[N],(y=i.direction)&&y in rx&&rx[y](m))}var k=ix(e),O=k.x-d.x,F=k.y-d.y;for(var R in e)e[R].x-=O,e[R].y-=F;for(var P=0,D=u;P<D.length;P+=1){var z=D[P].dag,B=z.nodes[0]&&z.nodes[0].ref,U=0,V=0;if(B&&(U=e[B].x-l[B].x,V=e[B].y-l[B].y),U||V)for(var j=0,G=z.nodes;j<G.length;j+=1){var H=G[j].id;e[H]&&(e[H].x-=U,e[H].y-=V)}}for(var W=0,q=Object.keys(l);W<q.length;W+=1){var X=q[W];e[X].x=l[X].x,e[X].y=l[X].y}}(u,s,n),t}var hx={direction:"TB",nodeDistance:50,levelDistance:50,componentDistance:50,gapWidth:1,arrangeComponents:"fit",gridDistance:50,layer:"layer"},cx={imports:{sequential:lx},configure:function(t,e){var i=e.graph,r=e.data;function n(t,e,i){return void 0===i&&(i=t.getNodes()),e?e instanceof gr?e:t.getNodes(e):i}var o=A(A(A({},hx),t),{nodeList:t.nodes});o.direction=t.direction||o.rankdir||hx.direction,o.layerSeparation=o.levelDistance,o.nodesSeparation=o.nodeDistance,o.componentsSeparation=o.componentDistance,o.gapDistance=o.gapWidth,o.packing=o.arrangeComponents;var a=A({},o),s=o.edges,u=o.nodeList;if(-1===["TB","BT","LR","RL"].indexOf(o.direction))throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(-1===["fit","grid","singleLine"].indexOf(o.packing))throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');o.nodesGridSeparation=t.gridDistance||hx.gridDistance;var d=u.getId(),l=u.getAttribute("layoutable").reduce((function(t,e,i){return t[d[i]]=e,t}),{}),h=u.getAttributes(["x","y"]).reduce((function(t,e,i){return t[d[i]]=e,t}),{}),c=u.getAttribute("radius");if("string"!=typeof a.layer)throw new Error("'layer' should be the valid data field name");for(var f=n(i,o.roots,i.nodeList()),g=r.getProperty(o.nodeList,a.layer),p=0,_=f.map((function(t){var e=-1;return o.nodeList.forEach((function(i,r){i===t&&(e=r)})),e}));p<_.length;p++)g[_[p]]=0;var v=n(i,o.sinks,i.nodeList()).toArray().reduce((function(t,e){return t[e.getId()]=!0,t}),{}),m=d.map((function(t){return v[t]}));return{nodes:d,edges:s.map((function(t){return{id:t.getId(),source:t.getSource().getId(),target:t.getTarget().getId()}})),options:$(o),layoutable:l,radiuses:c,layers:g,sinks:m,coords:h}},context:function(){},update:function(t){var e=t.nodes,i=t.edges,r=t.options,n=t.layoutable,o=t.radiuses,a=t.layers,s=t.sinks,u=t.coords,d=i.filter((function(t){var e=t.source,i=t.target;return e in n&&i in n}));return{positions:lx({nodes:e.map((function(t,e){return{id:t,r:o[e],layer:a[e],sink:s[e],layoutable:n[t],x:u[t].x,y:u[t].y}})),edges:d},{packing:{fit:"rect",singleLine:"hierarchy",grid:"singleton"}[r.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[r.direction],layerSeparation:r.layerSeparation,nodesSeparation:r.nodesSeparation,componentsSeparation:r.componentsSeparation,gapDistance:r.gapWidth,nodesGridSeparation:r.nodesGridSeparation,evenDistribution:r.evenDistribution}).nodes}},isRunning:function(){return!1},onSync:function(t,e){var i=t.positions,r=e.graph;return{indexes:i.map((function(t){var e=t.id;return(r.getNode(e)||{_index:-1})._index})),x:i.map((function(t){return t.x})),y:i.map((function(t){return t.y}))}}},fx={configure:function(t,e){var i=e.graph,r=e.camera;function n(t){return void 0===t||"number"==typeof t&&isFinite(t)&&0<t}var o,a,s,u,d,l=t.sortBy,h=t,c=h.nodes,f=Array.from(c._indexes),g=f.length,p=function(t,e,i){if(!n(t))throw new TypeError('"rows" should be a positive integer');if(!n(e))throw new TypeError('"cols" should be a positive integer');if(t)return{rows:t,cols:Math.ceil(i/t)};if(e)return{cols:e,rows:Math.ceil(i/e)};var r=Math.ceil(Math.sqrt(i));return{cols:r,rows:Math.ceil(i/r)}}(h.rows,h.cols,g),_=p.rows,v=p.cols,m=(o=l,a=i,s=c,u=f,d=t.sortFallbackValue,"string"!=typeof o?u.map((function(t,e){return e})):"radius"===o?a.getAttribute(!0,"radius").getMultiple(u):"random"===o?u.map((function(){return Math.random()})):s.getData(o).map((function(t){return t||d}))),y=c.getAttribute("layoutable"),b=f.reduce((function(t,e,i){return y[i]&&t.push({id:e,attr:m[i]}),t}),[]),x=c.getBoundingBox(),E=.65*Math.max(x.maxScaledSize,x.maxFixedSize/r.getZoom()),A=x.minX+E,S=x.maxX-E,w=x.minY+E,T=x.maxY-E;return x.width<E*v*2&&(A=x.cx-E*v+E,S=x.cx+E*v-E),x.height<E*_*2&&(w=x.cy-E*_+E,T=x.cy+E*_-E),{sort:!!l,nodes:b,reverse:!!h.reverse,cols:v,rows:_,minX:A,maxX:S,minY:w,maxY:T}},update:function(t){var e=t.sort,i=t.nodes,r=t.maxX,n=t.minX,o=t.maxY,a=t.minY,s=t.reverse,u=t.rows,d=t.cols;e&&i.sort((function(t,e){var i=t.attr,r=e.attr;return i<r?-1:r<i?1:0})),s&&i.reverse();var l=(r-n)/(d-1),h=(o-a)/(u-1),c=n,f=a;isFinite(l)||(l=0),isFinite(h)||(h=0);var g=0,p=0;return i.forEach((function(t){t.x=c+g*l,t.y=f+p*h,(g+=1)===d&&(p+=1,g=0)})),i},onSync:function(t){return{indexes:t.map((function(t){return t.id})),x:t.map((function(t){return t.x})),y:t.map((function(t){return t.y}))}}},gx=(px.initNamespace=function(t){t.layouts=function(t){return A(A(A(A(A(A(A(A(A({},((u=t).modules.layouts.register("concentric",By),{concentric:function(t){return u.modules.layouts.start("concentric",t)}})),((s=t).modules.layouts.register("radial",Uy),{radial:function(t){if(void 0===t.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');if(t.maxIterations=t.maxIterations&&isFinite(t.maxIterations)?Math.floor(t.maxIterations):100,t.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(t.iterationsPerRender=t.iterationsPerRender&&isFinite(t.iterationsPerRender)?Math.floor(t.iterationsPerRender):20,t.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(t.epsilon=t.epsilon&&isFinite(t.epsilon)?t.epsilon:.001,t.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return s.modules.layouts.start("radial",t)}})),((a=t).modules.layouts.register("force",Gy),{force:function(t){if(void 0===t&&(t={}),t.incremental)return Xy(t,a,a.layouts.force);if(void 0!==t.edgeStrength&&(!isFinite(t.edgeStrength)||t.edgeStrength<0))throw new Error("force layout: edgeStrength must be a positive number");if(void 0!==t.steps&&(!isFinite(t.steps)||t.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(void 0!==t.edgeLength&&(!isFinite(t.edgeLength)||t.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(void 0!==t.gravity&&(!isFinite(t.gravity)||t.gravity<0||1<=t.gravity))throw new Error("force layout: 'gravity' must be between 0 and 1");if(void 0!==t.charge&&!isFinite(t.charge))throw new Error("force layout: 'charge' must be a number");if(void 0!==t.radiusRatio&&(!isFinite(t.radiusRatio)||t.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(void 0!==t.theta&&(!isFinite(t.theta)||t.theta<0||1<t.theta))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(void 0===t.cx&&void 0===t.cy||"number"==typeof t.cx&&"number"==typeof t.cy))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(void 0!==t.siblingsOffset&&!isFinite(t.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return a.modules.layouts.start("force",t)}})),((o=t).modules.layouts.register("forceLink",Yy),{forceLink:function(t){return void 0===t&&(t={}),t.incremental?Xy(t,o,o.layouts.forceLink):o.modules.layouts.start("forceLink",t)}})),((n=t).modules.layouts.register("hierarchical",cx),{hierarchical:function(t){return void 0===t&&(t={}),t.useWebWorker=!1,n.modules.layouts.start("hierarchical",t)}})),((r=t).modules.layouts.register("sequential",cx),{sequential:function(t){void 0===t&&(t={}),t.useWebWorker=!1;var e=A(A({},t),{evenDistribution:!0});return r.modules.layouts.start("sequential",e)}})),((i=t).modules.layouts.register("grid",fx),{grid:function(t){return void 0===t&&(t={}),i.modules.layouts.start("grid",t)}})),(e=t,{incremental:function(t){Si("Incremental ForceLink layout is now deprecated.\n    Please use the incremental option in force and forceLink layouts.");var i=t.centralNode;if("margin"in t&&(null==t.margin||!isFinite(t.margin)))throw new Error("Incremental ForceLink layout: margin has to be a positive number");return i&&!i.getAttribute("layoutable")?qy(e,t,e.layouts.forceLink):Wy(e,Xf(e.modules.graph,t),e.layouts.forceLink)}})),{stop:function(){return t.modules.layouts.stop()}});var e,i,r,n,o,a,s,u}(t)},px);function px(){}var _x=(vx.initNamespace=function(t){var e;t.mouse=(e=t,{move:function(t){return e.modules.virtualMouse.move(t)},down:function(t){return e.modules.virtualMouse.down(t)},up:function(t){return e.modules.virtualMouse.up(t)},click:function(t){return e.modules.virtualMouse.click(t)},rightClick:function(t){return e.modules.virtualMouse.rightClick(t)},doubleClick:function(t){return e.modules.virtualMouse.doubleClick(t)},drag:function(t,i){return e.modules.virtualMouse.drag(t,i)},wheel:function(t){return e.modules.virtualMouse.wheel(t)}})},vx);function vx(){}var mx=(yx.initNamespace=function(t){var e;t.pathfinding=(e=t,{astar:function(t,i,r){return void 0===r&&(r={}),e.modules.pathfinding.astar(t,i,r)},dijkstra:function(t,i,r){return void 0===r&&(r={}),e.modules.pathfinding.dijkstra(t,i,r)},dijkstraBig:function(t,i,r){return void 0===r&&(r={}),e.modules.pathfinding.dijkstraBig(t,i,r)}})},yx);function yx(){}var bx=(xx.initNamespace=function(t){var e;t.rules=(e=t,{map:function(t){return e.modules.rules.createMapping(t)},slices:function(t){return e.modules.rules.createSlices(t)},template:function(t){return e.modules.rules.createTemplate(t)}})},xx);function xx(){}var Ex=(Ax.prototype.clearSelection=function(){return this.modules.selection.clear()},Ax.prototype.getSelectedNodes=function(){return this.modules.selection.getSelectedNodes()},Ax.prototype.getNonSelectedNodes=function(){return this.modules.selection.getNonSelectedNodes()},Ax.prototype.getSelectedEdges=function(){return this.modules.selection.getSelectedEdges()},Ax.prototype.getNonSelectedEdges=function(){return this.modules.selection.getNonSelectedEdges()},Ax);function Ax(){}var Sx=(wx.prototype.setOptions=function(t){return this.modules.settings.update(t)},wx.prototype.getOptions=function(){return this.modules.settings.get()},wx);function wx(){}var Tx=(Cx.initNamespace=function(t){var e;t.styles=(e=t,{setNodesVisibility:function(t){return e.modules.graphics.setNodesVisibility(t)},setEdgesVisibility:function(t){return e.modules.graphics.setEdgesVisibility(t)},setNodeTextsVisibility:function(t){return e.modules.graphics.setNodeTextsVisibility(t)},setEdgeTextsVisibility:function(t){return e.modules.graphics.setEdgeTextsVisibility(t)},addRule:function(t){return e.modules.styleRules.addRule(t)},getRuleList:function(){return e.modules.styleRules.getRuleList()},addNodeRule:function(t,i){var r,n;return n=1===arguments.length?void(r=t):(r=i,t),e.styles.addRule({nodeAttributes:r,nodeSelector:n})},addEdgeRule:function(t,i){var r,n;return n=1===arguments.length?void(r=t):(r=i,t),e.styles.addRule({edgeAttributes:r,edgeSelector:n})},getNodeRules:function(){return e.styles.getRuleList().filter((function(t){return void 0===t.getDefinition().edgeAttributes}))},getEdgeRules:function(){return e.styles.getRuleList().filter((function(t){return void 0===t.getDefinition().nodeAttributes}))},createClass:function(t){return e.modules.classes.createClass(t)},getClass:function(t){return e.modules.classes.getClassByName(t)},getClassList:function(){return e.modules.classes.getClassList()},setHoveredNodeAttributes:function(t,i){e.modules.hover.updateNodeAttributes(t,i)},setHoveredEdgeAttributes:function(t,i){e.modules.hover.updateEdgeAttributes(t,i)},setSelectedNodeAttributes:function(t,i){return e.modules.selection.setNodeAttributes(t,i)},setSelectedEdgeAttributes:function(t,i){return e.modules.selection.setEdgeAttributes(t,i)}})},Cx);function Cx(){}var Mx=(Ix.initNamespace=function(t){var e;t.schema=(e=t,{watchNodeObjectProperty:function(t){return e.modules.watcher.watchNodeObjectProperty(t)},watchEdgeObjectProperty:function(t){return e.modules.watcher.watchEdgeObjectProperty(t)},watchNodeNonObjectProperty:function(t){return e.modules.watcher.watchNodeNonObjectProperty(t)},watchEdgeNonObjectProperty:function(t){return e.modules.watcher.watchEdgeNonObjectProperty(t)}})},Ix);function Ix(){}var Lx=(Nx.initNamespace=function(t){t.tools=function(t){return{lasso:{enable:function(t){return d.modules.lasso.enable(t),this},disable:function(){return d.modules.lasso.disable(),this},enabled:function(){return d.modules.lasso.enabled()}},connectNodes:{enable:function(t){return u.modules.connectNodes.enable(t),this},disable:function(){return u.modules.connectNodes.disable(),this},enabled:function(){return u.modules.connectNodes.enabled()}},legend:{enable:function(t){return s.modules.legend.enable(t)},disable:function(){return s.modules.legend.disable()},enabled:function(){return s.modules.legend.enabled()},getOptions:function(){return s.modules.legend.getOptions()}},rectangleSelect:{enable:function(t){a.modules.rectangleSelect.enable(t)},disable:function(){a.modules.rectangleSelect.disable()},enabled:function(){return a.modules.rectangleSelect.enabled()}},resize:{enable:function(t){return o.modules.resizing.enable(t),this},disable:function(){return o.modules.resizing.disable(),this},enabled:function(){return o.modules.resizing.enabled()}},rewire:{enable:function(t){return n.modules.rewiring.enable(t),this},disable:function(){return n.modules.rewiring.disable(),this},enabled:function(){return n.modules.rewiring.enabled()}},snapping:{enable:function(t){return r.modules.snapping.enable(t),this},disable:function(){return r.modules.snapping.disable(),this},enabled:function(){return r.modules.snapping.enabled()}},tooltip:{onNodeHover:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("hover.node",t,e)},onNodeClick:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("click.left.node",t,e)},onNodeRightClick:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("click.right.node",t,e)},onNodeDoubleClick:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("doubleClick.left.node",t,e)},onEdgeHover:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("hover.edge",t,e)},onEdgeClick:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("click.left.edge",t,e)},onEdgeRightClick:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("click.right.edge",t,e)},onEdgeDoubleClick:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("doubleClick.left.edge",t,e)},onBackgroundClick:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("click.left.background",t,e)},onBackgroundRightClick:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("click.right.background",t,e)},onBackgroundDoubleClick:function(t,e){void 0===e&&(e={}),i.modules.tooltip.setHandler("doubleClick.left.background",t,e)},refresh:function(){return i.modules.tooltip.refresh()},isShown:function(){return i.modules.tooltip.isShown()},hide:function(){i.modules.tooltip.hide()},show:function(t,e){return i.modules.tooltip.show(t,e)}},brand:(e=i=r=n=o=a=s=u=d=t,{set:function(t,i){return e.modules.brand.set(t,i)},remove:function(){e.modules.brand.remove()}})};var e,i,r,n,o,a,s,u,d}(t)},Nx);function Nx(){}function kx(t){return!0}function Ox(t){return""}function Fx(t,e,i){return{}}var Rx,Px=(E(Dx,Rx=Yh),Dx.prototype._computeNodeGroupId=function(t){if(this._nodeSelector&&this._nodeGroupIdFunction)return this._nodeSelector(t)?this._nodeGroupIdFunction(t):void 0},Dx.prototype._computeEdgeGroupId=function(t){if(this._edgeSelector&&this._edgeGroupIdFunction)return this._edgeSelector(t)?this._edgeGroupIdFunction(t):void 0},Dx.prototype._addMetaNodes=function(t,e){for(var i=e.getId(),r=t.getNodes().filter((function(t){return null===t.getMetaNode()})),n=new Map,o=0;o<r.size;++o){var a=r.get(o);if(void 0!==(h=this._computeNodeGroupId(a))){var s=n.get(h);s||(s={id:h,nodes:[]},n.set(h,s)),s.nodes.push(a)}}var u=Kn(n),d=u.map((function(e){var i=e.nodes;return t.getNodes(i)})),l=[];for(o=0;o<u.length;++o){var h=u[o].id,c=d[o],f=this._nodeGenerator(c,h,e);void 0===f.id&&(f.id=Bx(h,i)),f.position=il(c.getPosition()),l.push(f)}return t.addNodes(l.map((function(t){return{id:t.id,attributes:t.position}})),{virtual:!0}).then((function(){var e=t.getNodes(l.map((function(t){return t.id})));e.replaceOriginalAttributes(l.map((function(t){return t.attributes})),["x","y","radius"]);for(var i=e.getData(),r=0;r<i.length;r++){var n=i[r],o=l[r];i[r]=void 0===n?o.data:A(A({},o.data),n)}return e.setData(null,i),e.setVisible(!0),t.modules.grouping.setSubElements(e,d),d.forEach((function(i,r){t.modules.grouping.setMetaElement(i,e.get(r))})),e}))},Dx.prototype._addMetaEdges=function(t,e){for(var i=e.getId(),r=t.getEdges(),n=new Map,o=t.modules.graphics.getAttributesManager().getUsedEdgeAttributes(),a=0;a<r.size;++a){var s=r.get(a);if(void 0!==(y=this._computeEdgeGroupId(s))){var u=this._edgeSource(s),d=this._edgeTarget(s),l=this._groupEdges?zx(y,u.getId(),d.getId(),this._separateEdgesByDirection):String(s.getId());(m=n.get(l))||(m={id:l,source:u,target:d,edges:[]},n.set(l,m)),m.edges.push(s)}}var h,c,f,g,p=Kn(n),_=p.map((function(e){var i=e.edges;return t.getEdges(i)})),v=[];for(a=0;a<p.length;++a){var m,y=(m=p[a]).id,b=_[a],x=this._groupEdges?this._edgeGenerator(b,y,e):(f=o,g=void 0,{data:(g=b.get(0)).getData(),attributes:g.getAttributes(f)});if(null!=x.id&&(h=t,c=x.id,null!=h.getEdge(c)))throw Error("The id "+x.id+" returned by the edgeGenerator function is not a unique id.");void 0===x.id&&(x.id=Bx(y,i)),x.source=m.source.getId(),x.target=m.target.getId(),v.push(x)}return t.addEdges(v.map((function(t){return{id:t.id,source:t.source,target:t.target}})),{virtual:!0}).then((function(){var e=t.getEdges(v.map((function(t){return t.id})));e.setAttributes(v.map((function(t){return t.attributes})));for(var i=e.getData(),r=0;r<i.length;r++){var n=v[r],o=i[r];i[r]=void 0===o?n.data:A(A({},o),n.data)}return e.setData(null,i),e.setVisible(!0),t.modules.grouping.setSubElements(e,_),_.forEach((function(i,r){t.modules.grouping.setMetaElement(i,e.get(r))})),e}))},Dx);function Dx(t){var e=Rx.call(this,t)||this;return e._nodeSelector=t.nodeSelector||kx,e._nodeGroupIdFunction=t.nodeGroupIdFunction||Ox,e._nodeGenerator=t.nodeGenerator||Fx,e._edgeSelector=t.edgeSelector||kx,e._edgeGroupIdFunction=t.edgeGroupIdFunction||Ox,e._edgeGenerator=t.edgeGenerator||Fx,e._edgeSource=t.edgeSource,e._edgeTarget=t.edgeTarget,e._separateEdgesByDirection=t.separateEdgesByDirection,e._groupSelfLoopEdges=!!t.groupSelfLoopEdges,e._groupEdges=t.groupEdges,e}function zx(t,e,i,r){var n=e,o=i;return!r&&n.toString()>o.toString()&&(n=i,o=e),t+"["+n+"-"+o+"]"}function Bx(t,e){return"gen_grp_"+e+"_"+t}var Ux,Vx=(E(jx,Ux=Px),jx.prototype.getName=function(){return rv.NodeGrouping},jx.prototype.run=function(t){var e,i,r=this,n=t.ogma,o=t.duration,a=t.wrapper,s=t.context,u=n.createNodeList(),d=n.createNodeList(),l=n.createEdgeList(),h=[],c=n.modules.grouping,f=[],g=new Set,p=new Set;return this._addMetaNodes(n,a).then((function(t){return(e=t).setVisible(!1),r._addMetaEdges(n,a)})).then((function(t){return(i=t).setVisible(!1),e.forEach((function(t){var e=t.getSubNodes(),i=t.getPosition(),n=r._showContents(t);if(e){if(n){g.add(t._index);var o=e.getAdjacentEdges({bothExtremities:!0});e.setVisible(!0),o.forEach((function(t){return p.add(t._index)}))}else{g.delete(t._index),c.removeVisibleGroup(t),h.push.apply(h,e.getPosition().map((function(t){return t.x=t.x-i.x,t.y=t.y-i.y,t}))),u=u.concat(e);for(var a=e.toArray();0!==a.length;){var s=a.pop(),l=s.getSubNodes();l&&c.isVisibleGroup(s)&&(l.setVisible(!1),l.getAdjacentEdges({bothExtremities:!0}).setVisible(!1),a.push.apply(a,l.toArray()))}}d=d.concat(e)}})),l=i.getSubEdges().reduce((function(t,e){var i=e.filter((function(t){if(p.has(t._index))return!1;var e=t.getSource().getMetaNode(),i=t.getTarget().getMetaNode();return!(e&&i&&c.isVisibleGroup(e)&&c.isVisibleGroup(i)&&e===i)}));return t.concat(i)}),n.createEdgeList()),u.setAttributes(u.getPosition().map((function(t,e){var i=h[e];return t.x-=i.x,t.y-=i.y,t})),o)})).then((function(){u.setVisible(!1),l.setVisible(!1),e.setVisible(!0),i.filter((function(t){return r._groupSelfLoopEdges||t.getSource()!==t.getTarget()})).setVisible(!0)})).then((function(){var t=new Set;e.forEach((function(e){var i,o=g.has(e._index),a=e.getSubNodes();if(a){var s=a.getAdjacentEdges({filter:"all",bothExtremities:!0});if(o){var u=a.reduce((function(e,i){var r=c.getNodeDepth(i);return t.add(i._index),r<e?r:e}),0);s.forEach((function(t){return p.add(t._index)})),c.addVisibleGroup(e,-1+u),r._metaNodesIds.has(e.getId())||(r._metaNodesIds.add(e.getId()),f.push(((i=r._onCreated(e,o,a,s))&&"function"===i.then?i:Promise.resolve(i)).then(n.view.afterNextFrame)))}}})),i.forEach((function(t){var e=Math.min(c.getNodeDepth(t.getSource()),c.getNodeDepth(t.getTarget()));t.setAttribute("layer",e)})),l=l.filter((function(t){return!p.has(t._index)})),u=u.filter((function(e){return!t.has(e._index)})),n.modules.graphics.getAttributesManager().update()})).then((function(){return Promise.all(f)})).then((function(){return{metaNodes:e,metaEdges:i,virtualNodes:e,virtualEdges:i,subNodes:d,collapsedSubNodes:u,subEdges:l,offsets:h,invalidMetaNodes:null==s?void 0:s.metaNodes.filter((function(t){return null===t.getSubNodes()})),invalidMetaEdges:null==s?void 0:s.metaEdges.filter((function(t){return null===t.getSubEdges()}))}}))},jx.prototype.undo=function(t){var e=this,i=t.ogma,r=t.duration,n=t.context,o=n.metaNodes,a=n.metaEdges,s=n.subNodes,u=n.subEdges,d=n.offsets,l=n.collapsedSubNodes,h=i.getNodes(l.getMetaNode()).getPosition(),c=h.map((function(t,e){return i=t,r=d[e],{x:i.x+r.x,y:i.y+r.y};var i,r})),f=i.modules.grouping;return s.setVisible(!0),u.setVisible(!0),f.setMetaElement(s,null),f.setMetaElement(u,null),o.setVisible(!1),a.setVisible(!1),o.forEach((function(t){if(!t.getSubNodes()||f.isVisibleGroup(t))f.removeVisibleGroup(t);else for(var e=t.getSubNodes().filter((function(t){return f.isVisibleGroup(t)})).toArray();0!==e.length;){var i=e.pop();if(f.isVisibleGroup(i)){var r=i.getSubNodes();r&&(r.setVisible(!0),r.getAdjacentEdges({bothExtremities:!0,filter:"all"}).setVisible(!0),e.push.apply(e,r.toArray()))}}})),f.setSubElements(o,null),f.setSubElements(a,null),f.resetOffsets(),l.setAttributes(h).then((function(){return e._restorePositions?l.setAttributes(c,r):Promise.resolve(l)}))},jx.prototype.cleanup=function(t){var e=t.ogma,i=t.context,r=i.metaNodes,n=i.metaEdges,o=i.invalidMetaNodes,a=i.invalidMetaEdges,s=e.modules.graph;o&&(r=r.concat(o)),a&&(n=n.concat(a));var u=Pi(s,r,(function(t){return t.isVisible()})),d=Pi(s,n,(function(t){return t.isVisible()}));return i.metaNodes=i.virtualNodes=u.valid,i.metaEdges=i.virtualEdges=d.valid,Promise.all([function(){return e.modules.grouping.resetOffsets()},e.removeEdges(d.invalid,{virtual:!0}),e.removeNodes(u.invalid,{virtual:!0})]).then((function(){return Promise.resolve()}))},jx);function jx(t){var e=void 0===t?{}:t,i=e.selector,r=void 0===i?kx:i,n=e.groupIdFunction,o=void 0===n?Ox:n,a=e.nodeGenerator,s=void 0===a?Fx:a,u=e.edgeGenerator,d=void 0===u?Fx:u,l=e.separateEdgesByDirection,h=void 0!==l&&l,c=e.groupSelfLoopEdges,f=void 0!==c&&c,g=e.groupEdges,p=void 0===g||g,_=e.restorePositions,v=void 0===_||_,m=e.showContents,y=void 0!==m&&m,b=e.onCreated,x=Ux.call(this,{nodeSelector:r,nodeGroupIdFunction:o,nodeGenerator:s,edgeSelector:function(t){return!(!t.getSource().getMetaNode()&&!t.getTarget().getMetaNode())},edgeGroupIdFunction:function(){return""},edgeGenerator:d,edgeSource:function(t){return Gx(t.getSource())},edgeTarget:function(t){return Gx(t.getTarget())},separateEdgesByDirection:h,groupEdges:p,groupSelfLoopEdges:f})||this;return x._metaNodesIds=new Set,x._showContents="function"!=typeof y?function(){return y}:y,x._restorePositions=v,x._onCreated=b||function(t,e,i,r){},x}function Gx(t){return t.getMetaNode()||t}var Hx,Wx=(E(qx,Hx=Px),qx.prototype.getName=function(){return rv.EdgeGrouping},qx.prototype.run=function(t){var e,i,r=t.ogma,n=t.wrapper,o=t.context;return this._addMetaEdges(r,n).then((function(t){return(i=(e=t).getSubEdges().reduce((function(t,e){return t.concat(e)}),r.createEdgeList())).setVisible(!1),{metaEdges:o?e.concat(o.metaEdges).dedupe():e,subEdges:i,virtualNodes:null,virtualEdges:e}}))},qx.prototype.undo=function(t){var e=t.ogma,i=t.context,r=i.metaEdges,n=i.subEdges;return e.modules.grouping.setMetaElement(n,null),e.modules.grouping.setSubElements(r,null),n.filter((function(t){return t.getSource().isVisible()&&t.getTarget().isVisible()})).setVisible(!0),r.setVisible(!1),Promise.resolve()},qx.prototype.cleanup=function(t){var e=t.ogma,i=t.context,r=i.metaEdges,n=Pi(e.modules.graph,r,(function(t){return t.isVisible()}));return e.removeEdges(n.invalid,{virtual:!0}).then((function(){return i.metaEdges=n.valid,i.virtualEdges=n.valid,Promise.resolve()}))},qx);function qx(t){var e=void 0===t?{}:t,i=e.selector,r=void 0===i?kx:i,n=e.groupIdFunction,o=void 0===n?Ox:n,a=e.generator,s=void 0===a?Fx:a,u=e.separateEdgesByDirection,d=void 0!==u&&u;return Hx.call(this,{nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:r,edgeGroupIdFunction:o,edgeGenerator:s,edgeSource:function(t){return t.getSource()},edgeTarget:function(t){return t.getTarget()},separateEdgesByDirection:d,groupEdges:!0})||this}function Xx(t){return null!=t}function Yx(t,e){return{source:t.getId(),target:e.getId()}}var Zx,Kx=(E(Qx,Zx=Yh),Qx.prototype.getName=function(){return rv.NeighborGeneration},Qx.prototype.run=function(t){for(var e,i=this,r=t.ogma,n=t.duration,o=t.wrapper.getId(),a=r.getNodes(),s=new Map,u=0;u<a.size;++u){var d=a.get(u),l=(e=this._generateIds(d),((Array.isArray(e)?e:e?[e]:null)||[]).filter(Xx));if(l)for(var h=0;h<l.length;++h){var c=l[h];(m=s.get(c))||(m=[],s.set(c,m)),m.push(d)}}var f,g,p=new Array(s.size),_=Zn(s),v=Kn(s).map((function(t){return r.getNodes(t)}));for(u=0;u<p.length;++u){c=_[u];var m=v[u],y=this._nodeGenerator(c,m);y.id="_gen_"+o+"_"+c;var b=il(m.getPosition());y.attributes=y.attributes||{},y.attributes.x=b.x,y.attributes.y=b.y,p[u]=y}return r.addNodes(p.map((function(t){return{id:t.id,attributes:t.attributes}})),{virtual:!0}).then((function(t){(f=t).replaceOriginalAttributes(p.map((function(t){return t.attributes})),["x","y"]),f.setData(null,p.map((function(t){return t.data})));for(var e=[],n=0;n<t.size;++n)for(var o=t.get(n),a=v[n],s=0;s<a.size;++s){var u=a.get(s),d=i._edgeGenerator(u,o);d.source||d.target||(d.source=u.getId(),d.target=o.getId()),e.push(d)}return r.addEdges(e,{virtual:!0})})).then((function(t){return g=t,f.setVisible(!0),g.setVisible(!0),f.addClass(gi),g.addClass(gi),Promise.all([f.removeClass(gi,n),g.removeClass(gi,n)])})).then((function(){return{virtualNodes:f,virtualEdges:g}}))},Qx.prototype.undo=function(t){var e=t.context,i=t.duration,r=e.virtualNodes,n=e.virtualEdges;return n&&r?Promise.all([r.addClass(gi,i),n.addClass(gi,i)]).then((function(){r.setVisible(!1),n.setVisible(!1)})):Promise.resolve()},Qx.prototype.cleanup=function(t){var e=t.ogma,i=t.context,r=i.virtualEdges,n=i.virtualNodes;if(r&&n){var o=n.filter((function(t){return!t.isVisible()})),a=r.filter((function(t){return!t.isVisible()}));e.removeNodes(o,{virtual:!0}),e.removeEdges(a,{virtual:!0})}return Promise.resolve()},Qx);function Qx(t){var e=Zx.call(this)||this,i=t.selector,r=void 0===i?function(){return!0}:i,n=t.neighborIdFunction,o=void 0===n?function(){return null}:n,a=t.nodeGenerator,s=void 0===a?function(){return{}}:a,u=t.edgeGenerator,d=void 0===u?Yx:u;return e._generateIds=function(t){return r&&r(t)&&o(t)||null},e._nodeGenerator=s,e._edgeGenerator=d||Yx,e}var Jx,$x=(E(tE,Jx=Yh),tE.prototype.run=function(t){for(var e=t.ogma,i=t.duration,r=e.getNodes().filter(this._selector?this._selector:function(t){return!0}),n=[],o=new Map,a=0;a<r.size;++a)for(var s=r.get(a),u=s.getAdjacentEdges(),d=this._dataFunction(s),l=0;l<u.size;++l){var h=u.get(l),c=h.getSource(),f=h.getTarget();if(c!==f&&void 0!==d){var g=c===s?f:c,p=o.get(g);p||(p=[],o.set(g,p)),p.push(d)}n.push(h)}var _=e.getEdges(n),v=e.getNodes(Zn(o)),m=Kn(o),y=v.getData(),b=new Array(v.size);for(a=0;a<b.length;++a){var x=m[a],E=y[a];for(l=0;l<x.length;++l)E=it(E,x[l]);b[a]=E}return Promise.all([r.addClass(gi,i),_.addClass(gi,i)]).then((function(){return r.setVisible(!1),_.setVisible(!1),v.setData(b),{hiddenNodes:r,hiddenEdges:_,nodesWithDataChange:v,oldDataList:y,virtualNodes:new gr(new Uint32Array,e),virtualEdges:new Ki(new Uint32Array,e)}}))},tE.prototype.getName=function(){return rv.NeighborMerging},tE.prototype.undo=function(t){var e=t.duration,i=t.context,r=i.hiddenNodes,n=i.hiddenEdges,o=i.nodesWithDataChange,a=i.oldDataList;return r.setVisible(!0),n.setVisible(!0),r.addClass(gi),n.addClass(gi),Promise.all([r.removeClass(gi,e),n.removeClass(gi,e)]).then((function(){o.setData(a)}))},tE);function tE(t){var e=t.selector,i=void 0===e?function(){return!1}:e,r=t.dataFunction,n=void 0===r?function(){}:r,o=Jx.call(this)||this;return o._selector=i,o._dataFunction=n,o}function eE(t,e){return t.size===e.size&&0<t.filter((function(t){return e.includes(t)})).size}var iE,rE=(E(nE,iE=Yh),nE.prototype.getName=function(){return rv.NodeCollapsing},nE.prototype.run=function(t){for(var e=this,i=t.ogma,r=t.duration,n=i.getNodes().filter(this._selector),o=n.getAdjacentEdges(),a=[],s=n.map((function(t){return t.getAdjacentNodes().filter((function(t){return!e._selector(t)}))})),u=0;u<n.size;u++)for(var d=u;d<n.size;d++){var l=n.get(u),h=n.get(d);if(0<i.modules.graph.getEdgesBetweenTwoNodes(l,h).size&&(s[u].size||s[d].size)&&!eE(s[u],s[d]))throw Error("addNodeCollapsing: invalid connected nodes ["+l.getId()+"] and ["+h.getId()+"] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.")}for(u=0;u<n.size;++u){var c=n.get(u),f=s[u];for(d=0;d<f.size-1;++d){var g=f.get(d),p=i.modules.graph.getEdgesBetweenTwoNodes(c,g);if(g!==c)for(var _=d+1;_<f.size;++_){var v=f.get(_),m=i.modules.graph.getEdgesBetweenTwoNodes(c,v),y=this._edgeGenerator(c,g,v,p,m);if(y)for(var b=F(y),x=0;x<b.length;++x)a.push(oE(i,b[x],x,c,g,v,p,m))}}}return i.addEdges(a,{virtual:!0}).then((function(t){return t.addClass(gi)})).then((function(t){return Promise.all([t.removeClass(gi,r),n.addClass(gi,r),o.addClass(gi,r)])})).then((function(t){var e=t[0];return n.setVisible(!1),o.setVisible(!1),{virtualEdges:e,virtualNodes:null,hiddenNodes:n,hiddenEdges:o}}))},nE.prototype.undo=function(t){var e=t.duration,i=t.context,r=t.ogma,n=i.hiddenNodes,o=i.hiddenEdges,a=i.virtualEdges||r.createEdgeList();return n.setVisible(!0),o.setVisible(!0),Promise.all([n.addClass(gi),o.addClass(gi)]).then((function(){return Promise.all([n.removeClass(gi,e),o.removeClass(gi,e),a.addClass(gi,e)])})).then((function(){a.setVisible(!1)}))},nE.prototype.cleanup=function(t){var e=t.ogma,i=t.context.virtualEdges||e.createEdgeList();return e.removeEdges(i.filter((function(t){return!t.isVisible()})),{virtual:!0})},nE);function nE(t){var e=t.selector,i=t.edgeGenerator,r=void 0===i?function(){return{}}:i,n=iE.call(this)||this;return n._selector=e||function(t){return!1},n._edgeGenerator=r,n}function oE(t,e,i,r,n,o,a,s){var u=void 0,d=void 0;if(void 0!==e.source&&(u=t.getNode(e.source))!==n&&u!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid source ["+e.source+"]","expected to be ["+n.getId()+"] or ["+o.getId()+"]"].join("; "));if(void 0!==e.target&&(d=t.getNode(e.target))!==n&&d!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid target ["+e.target+"]","expected to be ["+n.getId()+"] or ["+o.getId()+"]"].join("; "));if(u&&d&&u===d)throw new Error("addNodeCollapsing: edge generator produced RawEdge with same source and target ["+u.getId()+"]");if(u&&!d)d=u===n?o:n;else if(d&&!u)u=d===n?o:n;else if(!u&&!d){for(var l=!0,h=0;h<a.size;++h)a.get(h).getSource()===n&&(l=!1);for(h=0;h<s.size;++h)s.get(h).getTarget()===o&&(l=!1);d=l?(u=o,n):(u=n,o)}return u&&d?A(A({},e),{id:"_gen_"+r.getId()+"_"+u.getId()+"_"+d.getId()+"_"+i,source:u.getId(),target:d.getId()}):{}}var aE,sE=(E(uE,aE=Yh),uE.prototype.getName=function(){return rv.VirtualProperties},uE.prototype.run=function(t){var e=t.ogma,i={nodes:null,edges:null,oldNodesData:null,oldEdgesData:null,virtualEdges:null,virtualNodes:null};return this._nodeDataFunction&&(i.nodes=e.getNodes().filter(this._nodeSelector),i.oldNodesData=dE(i.nodes,this._nodeDataFunction)),this._edgeDataFunction&&(i.edges=e.getEdges().filter(this._edgeSelector),i.oldEdgesData=dE(i.edges,this._edgeDataFunction)),Promise.resolve(i)},uE.prototype.undo=function(t){var e=t.context,i=e.nodes,r=e.oldNodesData,n=e.edges,o=e.oldEdgesData;return i&&i.setData(r),n&&n.setData(o),Promise.resolve()},uE);function uE(t){var e=t.nodeSelector,i=void 0===e?function(){return!0}:e,r=t.edgeSelector,n=void 0===r?function(){return!0}:r,o=t.nodeDataFunction,a=void 0===o?null:o,s=t.edgeDataFunction,u=void 0===s?null:s,d=aE.call(this)||this;return d._nodeSelector=i||function(t){return!0},d._edgeSelector=n||function(t){return!0},d._nodeDataFunction=a,d._edgeDataFunction=u,d}function dE(t,e){for(var i=[],r=0;r<t.size;++r){var n=t.get(r),o=n.getData(),a=it(o,e(n));i.push(o),n.setData(a)}return i}var lE=(hE.initNamespace=function(t){t.transformations=function(t){return A(A(A(A(A(A({},(a=t,{getList:function(){return a.modules.transformations.getList()},clear:function(){return a.modules.transformations.clear()},afterNextUpdate:function(){return a.modules.transformations.whenApplied()}})),(o=t,{addNodeGrouping:function(t){return void 0===t&&(t={}),o.modules.transformations.add(new Vx(t),{duration:t.duration,enabled:t.enabled})},addEdgeGrouping:function(t){return void 0===t&&(t={}),o.modules.transformations.add(new Wx(t),{duration:t.duration,enabled:t.enabled})}})),(n=t,{addNodeFilter:function(t){return n.modules.filters.addNodeFilter(t)},addEdgeFilter:function(t){return n.modules.filters.addEdgeFilter(t)}})),(r=t,{addNeighborGeneration:function(t){return r.modules.transformations.add(new Kx(t),{duration:t.duration,enabled:t.enabled})},addNeighborMerging:function(t){return r.modules.transformations.add(new $x(t),{duration:t.duration,enabled:t.enabled})}})),(i=t,{addNodeCollapsing:function(t){return void 0===t&&(t={}),i.modules.transformations.add(new rE(t),{duration:t.duration,enabled:t.enabled})}})),(e=t,{addVirtualProperties:function(t){return e.modules.transformations.add(new sE(t),{duration:t.duration,enabled:t.enabled})}}));var e,i,r,n,o,a}(t)},hE.prototype.addNodeFilter=function(t){return this.modules.filters.addNodeFilter(t)},hE.prototype.addEdgeFilter=function(t){return this.modules.filters.addEdgeFilter(t)},hE.prototype.getNodeFilters=function(){return this.modules.transformations.getList().filter((function(t){return t.getName()===rv.NodeFilter}))},hE.prototype.getEdgeFilters=function(){return this.modules.transformations.getList().filter((function(t){return t.getName()===rv.EdgeFilter}))},hE.prototype.clearNodeFilters=function(){return Promise.all(this.getNodeFilters().map((function(t){return t.destroy()}))).then((function(){return Promise.resolve()}))},hE.prototype.clearEdgeFilters=function(){return Promise.all(this.getEdgeFilters().map((function(t){return t.destroy()}))).then((function(){return Promise.resolve()}))},hE);function hE(){}var cE=(fE.initNamespace=function(t){var e,i,r,n,o,a,s,u;t.view=(i=(e=t).modules,r=i.camera,n=i.captor,o=i.dom,a=i.graphics,s=i.locate,u=i.spatial,{setZoom:function(t,e){return r.setZoom(t,e)},zoomIn:function(t,e){return r.zoomIn(t,e)},zoomOut:function(t,e){return r.zoomOut(t,e)},getZoom:function(){return r.getZoom()},setCenter:function(t,e){return r.setCenter(t,e)},move:function(t,e){return r.move(t,e)},getCenter:function(){return r.getCenter()},setAngle:function(t,e){return r.setAngle(t,e)},rotate:function(t,e){return r.rotate(t,e)},getAngle:function(){return r.getAngle()},set:function(t,e){return r.setView(t,e)},get:function(){return r.getView()},graphToScreenCoordinates:function(t){return r.graphToScreenCoordinates(t)},screenToGraphCoordinates:function(t){return r.screenToGraphCoordinates(t)},getImageData:function(){return a.getImageData()},getElementAt:function(t,i){return void 0===i&&(i=!1),i&&(t=e.view.graphToScreenCoordinates(t)),n.getElementAt(t)},getElementsInside:function(t,i,r,n,o){if(void 0===o&&(o=!0),o){var a=e.view.graphToScreenCoordinates({x:t,y:i}),s=e.view.graphToScreenCoordinates({x:r,y:n});return u.queryProjected(a.x,a.y,s.x,s.y)}return u.queryProjected(t,i,r,n)},beforeNextFrame:function(){return o.beforeNextFrame()},afterNextFrame:function(){return o.afterNextFrame()},setFullScreen:function(t){return o.setFullScreen(t)},isFullScreen:function(){return o.isFullScreen()},forceResize:function(){return o.forceResize()},getSize:function(){return o.getDimensions()},setSize:function(t){if(!t||isNaN(t.width)||isNaN(t.height))throw new Error("Size must follow the format { width: number, height: number }");if(t.width<0)throw new Error("width must be positive");if(t.height<0)throw new Error("height must be positive");return o.setDimensions(t),Promise.resolve()},locateGraph:function(t){return s.locateGraph(t)},locateRawGraph:function(t,e){return s.locateRawGraph(t,e)},getGraphBoundingBox:function(){return s.getGraphBoundingBox()}})},fE);function fE(){}var gE=Object.freeze({__proto__:null,circleCircleIntersection:vd,circleSortCompare:md,circleContainsPoint:yd,circleContainsCircle:bd,circleIntersectsBox:xd,circleLineIntersection:Ed,isPointInLine:Es,twoSegmentsIntersect:function(t,e,i,r,n){if(void 0===n&&(n=!1),n&&(As(t,i)||As(t,r)||As(e,i)||As(e,r)))return!1;var o=(t.y-i.y)*(r.x-i.x)-(t.x-i.x)*(r.y-i.y),a=(e.x-t.x)*(r.y-i.y)-(e.y-t.y)*(r.x-i.x);if(0==a)return!1;var s=o/a,u=(o=(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y))/a;return!(s<=0||1<=s||u<=0||1<=u)},lineAngle:Ss,angle:function(t,e,i){var r=Ss(t.x,t.y,e.x,e.y)-Ss(i.x,i.y,e.x,e.y);return r<0?r+2*Math.PI:r},lineIntersection:function(t,e,i,r,n,o,a,s){var u=(s-o)*(i-t)-(a-n)*(r-e);if(0==u)return null;var d=e-o;return{x:t+(d=((a-n)*d-(s-o)*(t-n))/u)*(i-t),y:e+d*(r-e)}},segmentIntersection:ws,segmentRectangleIntersection:Ts,lineLine:Cs,lineAABB:Ms,distancePointSegment:Is,distToSegmentSquared:Ls,getClosestPointOnSegment:Ns,getClosestPointOnLine:function(t,e,i,r,n,o){var a=n-i,s=o-r,u=((t-i)*a+(e-r)*s)/(a*a+s*s);return{x:i+a*u,y:r+s*u}},defaultAABB:Fa,rotate:Ra,move:function(t,e,i,r){return void 0===i&&(i=0),void 0===r&&(r={x:0,y:0}),r.x=t.x+i*Math.sin(e),r.y=t.y+i*Math.cos(e),r},distance:Pa,squaredDistance:Da,radiansToDegrees:za,degreesToRadians:function(t){return t*Math.PI/180},extendBounds:Ba,isPointInPolygon:Jd,polygonsIntersect:el,computeCentroid:il,quadBezierAABB:Fs,cubicBezierAABB:Ps,getSelfLoopControlPoints:Ta,getQuadraticCurveControlPoint:wa,getPointOnQuadraticCurve:Ds,isPointOnQuadraticCurve:zs,getPointOnBezierCurve:Bs,isPointOnBezierCurve:Us,getQuadraticCurveBoundingBox:Vs,getBezierCurveBoundingBox:js,getAABB:Qc,getOBBPoints:Jc,moveAABB:$c,padBounds:function(t,e){return Ba(t,e)},overlapsAABB:function(t,e){return ef(t[0],t[1],t[2],t[3],e[0],e[1],e[2],e[3])},intersects:tf,overlaps:ef}),pE=1,_E=function(){function t(t){var e=this;void 0===t&&(t={}),this.node=function(t){return new cr(t,e)},this.edge=function(t){return new Yi(t,e)},this.nodeList=function(t){return new gr(t||new Uint32Array(0),e)},this.edgeList=function(t){return new Ki(t||new Uint32Array(0),e)},this._onReady=[],this._init(t)}return t.prototype._init=function(t){var e=this;this._initParameters=t,this._debug=!!t.debug,this._token=pE++,this.modules=new vv(this,t),Tx.initNamespace(this),yv.initNamespace(this),Sm.initNamespace(this),Py.initNamespace(this),Hm.initNamespace(this),gx.initNamespace(this),Fy.initNamespace(this),lE.initNamespace(this),Lx.initNamespace(this),cE.initNamespace(this),_x.initNamespace(this),Iv.initNamespace(this),Mx.initNamespace(this),bx.initNamespace(this),qm.initNamespace(this),mx.initNamespace(this),wv.initNamespace(this),this._onReady.forEach((function(t){return t(e)})),this.safelyBindToInstance()},t.prototype.safelyBindToInstance=function(){for(var e=0,i=Object.keys(t.prototype);e<i.length;e++){var r=i[e];"function"==typeof t.prototype[r]&&(this[r]=this[r].bind(this))}},t.prototype.onReady=function(t){this._onReady.push(t)},t.prototype._destroy=function(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null},t.prototype.destroy=function(){this._destroy()},t.prototype.reset=function(){var t=this._initParameters;this._destroy(),this._init(t)},t.prototype.isDebug=function(){return this._debug},t.libraries=T,t.build={version:"3.1.0",commit:"d0e62a2",date:"Fri Sep 04 2020 16:52:54 GMT+0200 (Central European Summer Time)"},t.geometry=gE,t.algorithms=bf,t.utils=Po,t}(),vE=[yv,xv,Av,wv,Cv,Iv,Sm,Hm,qm,Zm,Qm,Fy,Py,gx,mx,Ex,Sx,Tx,Lx,lE,cE,_x,Mx,bx];return Object.assign.apply(Object,w([_E.prototype],vE.map((function(t){return t.prototype})))),_E}()}).call(this,i(3),i(4)(t))},function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",r=t[3];if(!r)return i;if(e&&"function"==typeof btoa){var n=(a=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),o=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[i].concat(o).concat([n]).join("\n")}var a,s,u;return[i].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,r){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(n[a]=!0)}for(var s=0;s<t.length;s++){var u=[].concat(t[s]);r&&n[u[0]]||(i&&(u[2]?u[2]="".concat(i," and ").concat(u[2]):u[2]=i),e.push(u))}},e}},function(t,e,i){"use strict";i.r(e);var r=i(0),n=i.n(r);i(5);console.log("Welcome to visualisation with Ogma");const o=document.createElement("div");o.id="vis",document.body.appendChild(o);const a=new n.a({container:o});a.addNode({id:0,attributes:{x:-125,y:-75,radius:20}}),a.addNode({id:1,attributes:{x:125,y:-75,radius:20}}),a.addEdge({source:0,target:1})},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){var r=i(6),n=i(7);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var o={insert:"head",singleton:!1};r(n,o);t.exports=n.locals||{}},function(t,e,i){"use strict";var r,n=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),a=[];function s(t){for(var e=-1,i=0;i<a.length;i++)if(a[i].identifier===t){e=i;break}return e}function u(t,e){for(var i={},r=[],n=0;n<t.length;n++){var o=t[n],u=e.base?o[0]+e.base:o[0],d=i[u]||0,l="".concat(u," ").concat(d);i[u]=d+1;var h=s(l),c={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(a[h].references++,a[h].updater(c)):a.push({identifier:l,updater:_(c,e),references:1}),r.push(l)}return r}function d(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var n=i.nc;n&&(r.nonce=n)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var a=o(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var l,h=(l=[],function(t,e){return l[t]=e,l.filter(Boolean).join("\n")});function c(t,e,i,r){var n=i?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=h(e,n);else{var o=document.createTextNode(n),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function f(t,e,i){var r=i.css,n=i.media,o=i.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),o&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var g=null,p=0;function _(t,e){var i,r,n;if(e.singleton){var o=p++;i=g||(g=d(e)),r=c.bind(null,i,o,!1),n=c.bind(null,i,o,!0)}else i=d(e),r=f.bind(null,i,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=n());var i=u(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<i.length;r++){var n=s(i[r]);a[n].references--}for(var o=u(t,e),d=0;d<i.length;d++){var l=s(i[d]);0===a[l].references&&(a[l].updater(),a.splice(l,1))}i=o}}}},function(t,e,i){"use strict";i.r(e);var r=i(1),n=i.n(r)()(!1);n.push([t.i,"html, body {\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n}\n\n#vis {\n  display: block;\n  width: 100%;\n  height: 100%;\n}\n",""]),e.default=n}]);