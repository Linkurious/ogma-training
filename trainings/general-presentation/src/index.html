<!doctype html>
<html>

<head>
  <link rel="shortcut icon" href="images/favicon.ico">
  <link type="text/css" rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section data-background-image="images/background.png">
        <section>
          <h2>Building applications with</h2>
          <div style="margin-top: 30px; font-size: 72px;">
            <img src="images/logotype.png" id="header-logo" />Ogma
          </div>
        </section>
        <section>
          <ol>
            <li class="">Introduction: features, docs, examples</li>
            <li class="fragment fade-in">Setting up the environment</li>
            <li class="fragment fade-in">How to get Ogma</li>
            <li class="fragment fade-in">Access your data</li>
            <li class="fragment fade-in">Styling</li>
            <li class="fragment fade-in">Geo mode & Transformations</li>
            <li class="fragment fade-in">UI, frameworks integration</li>
          </ol>
        </section>
      </section>
      <!-- Intro, features, examples -->


      <section data-background-image="images/background.png">
        <section>
          <h2>What is Ogma?</h2>
        </section>

        <section>
          <p>Ogma is a client-side <nobr>interactive graph visualisation library
            </nobr>
          </p>
          <img src="images/example-0.png"
            style="border: 0; width: 35%; display: inline-block; margin: auto; vertical-align: middle;" />
          <ul>
            <li><code>ogma.min.js</code> - the library</li>
            <li><code>ogma.min.d.ts</code> - TypeScript declaration file</li>
            <li>Documentation, tutorials & 100+ examples</li>
            <li>Technical support</li>
          </ul>
        </section>

        <section>
          <h2>Documentation</h2>
          <a href="https://ogma.linkurio.us">https://ogma.linkurio.us</a>
        </section>

        <section>
          <h2>Download center</h2>
          <a href="https://get.linkurio.us">https://get.linkurio.us</a>
        </section>
      </section>

      <section data-background-image="images/background.png">
        <section>
          <h2>Features:</h2>
        </section>
        <section>
          <h2>Features:</h2>
          <p>Visualisation styling</p>
          <iframe height="500" width="800"
            src="https://doc.linkurio.us/ogma/3.1.5/resources/data-driven-styles.html"></iframe>
        </section>
        <section>
          <h2>Features:</h2>
          <p>Layouts</p>
          <iframe height="500" width="800"
            src="https://doc.linkurio.us/ogma/3.1.5/resources/layout-force.html"></iframe>
        </section>
        <section>
          <h2>Features:</h2>
          <p>Layouts</p>
          <iframe height="500" width="800"
            src="https://doc.linkurio.us/ogma/3.1.5/resources/layout-hierarchical-custom-root.html"></iframe>
        </section>
        <section>
          <h2>Features:</h2>
          <p>Geo mode</p>
          <iframe height="500" width="800"
            src="https://doc.linkurio.us/ogma/3.1.5/resources/geo-mode-providers.html"></iframe>
        </section>
        <section>
          <h2>Features:</h2>
          <p><a target="_blank"
              href="https://doc.linkurio.us/ogma/latest/examples/hover.html">Interactions</a>
          </p>
          <iframe height="500" width="800"
            src="https://doc.linkurio.us/ogma/3.1.5/resources/manual-resizing.html"></iframe>
        </section>
        <section>
          <h2>Features:</h2>
          <p><a target="_blank"
              href="https://doc.linkurio.us/ogma/latest/examples/group-nodes.html">Transformations</a>
          </p>
          <iframe height="500" width="800"
            src="https://doc.linkurio.us/ogma/3.1.5/resources/visual-grouping.html"></iframe>
        </section>
        <section>
          <h2>Features:</h2>
          <p>Algorithms</p>
          <iframe height="500" width="800"
            src="https://doc.linkurio.us/ogma/3.1.5/resources/cycles.html"></iframe>
        </section>
      </section>

      <section data-background-image="images/background.png">
        <section>
          <h2>1. Setting up the environment</h2>
          <div class="fragment">Example: Ogma + <img src="images/webpack.png"
              style="height: 1.5em; border: 0; vertical-align: middle;">Webpack
          </div>
          <br>
          <ul>
            <li class="fragment">
              Get Node & npm <a
                href="https://nodejs.org/">https://nodejs.org/</a>
            </li>
            <li class="fragment">
              <pre><code class="lang-shell">npm i -D webpack webpack-cli \
css-loader style-loader \
webpack-dev-server html-webpack-plugin
</code></pre>
            </li>
            <li class="fragment">
              Set up your <code>package.json</code>
              <pre><code class="lang-json" style="max-height: 200px;">{
  "name": "01-setup",
  "version": "1.0.0",
  "main": "src/index.js",
  "scripts": {
    "build": "webpack",
    "start": "webpack -w"
  },
  "devDependencies": {
    "css-loader": "^4.3.0",
    "style-loader": "^1.2.1",
    "webpack": "^4.44.1",
    "webpack-cli": "^3.3.12"
  }
}</code></pre>
            </li>
          </ul>
        </section>
        <section>
          <h2>1. Setting up the environment</h2>
          <div>Example: Ogma + <img src="images/webpack.png"
              style="height: 1.5em; border: 0; vertical-align: middle;">Webpack
          </div>
          <br>
          <div>
            <code>src/index.js</code>
            <pre><code data-line-numbers>import "styles.css";

// your code will go here
console.log('Welcome to visualisation with Ogma');
            </code></pre>
          </div>
          <div class="fragment">
            <code>src/styles.css</code>
            <pre><code data-line-numbers>#container {
  display: block;
  width: 100%;
  height: 100%;
}</code></pre>
          </div>
        </section>
        <section>
          <h2>1. Setting up the environment</h2>
          <div>Example: Ogma + <img src="images/webpack.png"
              style="height: 1.5em; border: 0; vertical-align: middle;">Webpack
          </div>
          <p>Set up the Webpack config</p>
          <pre><code>const path = require('path');
const HtmlWebpackPlugin = require("html-webpack-plugin");

module.exports = {
  module: {
    rules: [{
      test: /\.css$/i,
      use: ['style-loader', 'css-loader'],
    }]
  },
  entry: './src/index.js',
  output: {
    filename: "[name].bundle.js",
    path: path.resolve(__dirname, "dist")
  },
  plugins: [new HtmlWebpackPlugin()],
  devServer: {
    contentBase: path.join(__dirname, 'dist'),
    port: 9000
  }
};
</code></pre>
        </section>
        <section>
          <h2>1. Setting up the environment</h2>
          <div>Example: Ogma + <img src="images/webpack.png"
              style="height: 1.5em; border: 0; vertical-align: middle;">Webpack
          </div>
          <pre><code class="lang-shell">npm start</code></pre>
          <div class="fragment"><img style="max-height: 400px;"
              src="images/example-0-empty.png"></div>
        </section>
      </section>

      <section data-background-image="images/background.png">
        <section>
          <h2>2. Installing Ogma</h2>
          <div class="fragment">go to <a
              href="https://get.linkurio.us">https://get.linkurio.us</a>
          </div>
          <div class="fragment">
            <img src="images/download-1.png" />
          </div>
          <div class="fragment">Download &rarr; copy your <code>npm</code> link
          </div>
          <div class="fragment">
            <pre>
              <code class="lang-shell">npm install --save https://get.linkurio.us/.../?secret=&lt;YOUR_API_KEY&gt;</code>
            </pre>
          </div>
          <div class="fragment">
            <pre>
              <code>import Ogma from 'ogma';</code>
            </pre>
          </div>
        </section>
        <section>
          <h2>2.1 Let's show some nodes</h2>
          <pre>
            <code class="stretch" class="lang-javascript" data-line-numbers="1-2|4-7|9-10|12-20">// index.js
import Ogma from 'ogma';

// create a container and add CSS to it
const container = document.createElement('div');
container.id = 'vis';
document.body.appendChild(container);

// initialize Ogma
const ogma = new Ogma({ container });

// add some nodes and edges
ogma.addNode({ id: 0, attributes: {
  x: -120, y: -75
}});
ogma.addNode({ id: 1, attributes: {
  x: 120, y: -75
}});
// add edge
ogma.addEdge({ source: 0, target: 1 });
            </code>
          </pre>
        </section>
        <section>
          <h2>2.1 Let's show some nodes</h2>
          <img src="images/example-0-nodes.png">
        </section>
        <section>
          <h2>2.3 Updating Ogma version</h2>
          <p>We encourage you to update Ogma every time you get a notification
            that the new version is out.</p>
          <br>
          <ul>
            <li>go to <a href="https://get.linkurio.us">get.linkurio.us</a></li>
            <li>get a new <code>npm</code> link (it contains the package
              version)</li>
            <li>copy it into your <code>package.json</code></p>
            <li>run <code>npm install</code></li>
          </ul>
        </section>
      </section>

      <section data-background-image="images/background.png">
        <section>
          <h2>3. Accessing your data</h2>
          <p>Ogma + neo4j database</p>
          <p>For this example we have loaded a supply chain dataset from <a
              href="https://neo4j.com/graphgist/supply-chain-management">this
              neo4j tutorial</a> into a hosted neo4j instance</p>
        </section>
        <section>
          <h2>3. Accessing your data</h2>
          <p>To load data into Ogma you need to parse it into its internal
            format:</p>
          <pre><code class="lang-json">{
  "nodes": [{
    "id": 0, // number|string, required
    // see https://doc.linkurio.us/ogma/latest/api.html#NodeAttributes
    "attributes": {}, // visual attributes
    "data": {}, // any data properties, free format
  }, ...],
  "edges": [{
    "source": 0, // required
    "target": 1, // required,
    // see https://doc.linkurio.us/ogma/latest/api.html#EdgeAttributes
    "attributes": {}, // same as for nodes
    "data": {}
  }]
}</code></pre>
          <p>See <a
              href="https://doc.linkurio.us/ogma/latest/api.html#NodeAttributes">NodeAttributes</a>,
            <a
              href="https://doc.linkurio.us/ogma/latest/api.html#EdgeAttributes">EdgeAttributes</a>
            docs
          </p>
        </section>
        <section>
          <h2>3. Accessing your data</h2>
          <ul>
            <li>Load the dataset</li>
            <li>Get your connection credentials
              <pre><code>import { HOST, DB_NAME, PASSWORD } from '../../credentials.json';</code></pre>
            </li>
            <li>Connect to your database</li>
            <li>Establish the API to query the graph
              <pre><code>const query = "MATCH (a)-[r]-() RETURN a, r";
return this._session
  .run(query)
  // parse the response into the format Ogma understands
  .then(response => ogma.parse.neo4j(response));</code></pre>
            </li>
          </ul>
        </section>
        <section>
          <h2>3. Accessing your data</h2>
          <p>Your dummy neo4j client looks like this:</p>
          <pre><code class="lang-javascript">// Create a driver to connect to the Neo4j database
const driver = neo4j.driver(
  HOST, neo4j.auth.basic(DB_NAME, PASSWORD)
);
const session = driver.session({
  database: DB_NAME,
  defaultAccessMode: neo4j.session.READ,
});

// Query the graph to the server and load it to ogma
const query = "MATCH (a)-[r]-() RETURN a, r";
session
  .run(query)
  .then(response => ogma.parse.neo4j(response));
</code></pre>
        </section>
        <section>
          <h2>3. Accessing your data</h2>
          <pre><code>// instance of the API client
const api = new API(HOST, DB_NAME, PASSWORD);

// load the graph
api.getGraph()
  .then((rawGraph) => ogma.setGraph(rawGraph))
  // setup the camera so we can see the entire graph
  .then(() => ogma.view.locateGraph())
  .then(() => {
    // show some information about the graph
    const nodes = ogma.getNodes();
    const edges = ogma.getEdges();
    document.getElementById('controls').innerHTML =
      `Loaded <br>${nodes.size} nodes, ${edges.size} edges`;
    });</code></pre>
        </section>
        <section>
          <h2>3. Accessing your data</h2>
          <img style="max-height: 600px;" src="images/example-1-load.png">
        </section>
      </section>

      <section data-background-image="images/background.png">
        <section>
          <h2>4. Adding styles</h2>
          <img style="max-height: 600px;" src="images/example-1-load.png">
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>What is missing?</p>
          <ul>
            <li class="fragment">Positions</li>
            <li class="fragment">Nodes meaning</li>
            <li class="fragment">Edges meaning</li>
            <li class="fragment">Insights</li>
          </ul>
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Positions</p>
          <p class="fragment">Let's run the layout!</p>
          <div class="fragment">
            <pre>
            <code class="lang-javascript" data-line-numbers>api.getGraph();
  .then((rawGraph) => ogma.setGraph(rawGraph))
  // apply the force layout to the graph
  // (places the nodes so it is readable )
  .then(() => ogma.layouts.force());
  </code></pre>
          </div>
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Positions</p>
          <img src="images/example-2-layout.gif">
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Nodes color and icon coding:</p>
          <pre><code class="lang-javascript">// Define buckets of importance for nodes
// some values repeat themselves for different types
const supplierStyle = { color: "#6FC1A7", icon: "\uEA04" };
const rawSupplierStyle = { color: "#3DCB8D", icon: "\uEA03" };
const wholeSalerStyle = { color: "#E77152", icon: "\uEA09" };
const retailerStyle = { color: "#9AD0D0", icon: "\uEA06" };

const nodeStyles = {
  'SupplierA': supplierStyle,
  'SupplierB': supplierStyle,

  'RawSupplierA': rawSupplierStyle,
  'RawSupplierB': rawSupplierStyle,
  'AllRawSupliers': rawSupplierStyle,

  'Retailer': retailerStyle,
  'AllRetailers': retailerStyle,

  'Wholesaler': wholeSalerStyle,
  'AllWholesalers': wholeSalerStyle,

  'FrameSupplier': { color: "#6FC1A7", icon: "\uEA05" },
  'WheelSupplier': { color: "#6FC1A7", icon: "\uEA08" },

  'Product': { color: "#76378A", icon: "\uEA02" }
};</code></pre>
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Edges color and size coding:</p>
          <pre><code class="lang-javascript">// edge color and width buckets
const edgeBuckets = ogma.rules.slices({
  field: "neo4jProperties.quantity",
  values: [
    { color: "#DDD", width: 0.5 },
    { color: "#AAA", width: 1.5 },
    { color: "#777", width: 2 },
    { color: "#444", width: 3.5 }
  ],
  // buckets are
  // (-Infinity, 15], (15, 150], (150, 280], [280, Infinity)
  stops: [15, 150, 280]
});</code></pre>
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Apply edge styling</p>
          <div>
            <pre><code class="lang-javascript">ogma.styles.addRule({
  edgeAttributes: (edge) => {
    const quantity = edge.getData("neo4jProperties.quantity");
    const { color, width } = edgeBuckets(edge);
    return {
      shape: { head: "arrow" },
      color, width
    };
  }});</code></pre>
          </div>
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Apply edge styling</p>
          <div>
            <img style="max-height: 500px;" src="images/example-3-edges.png">
          </div>
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Apply node styling</p>
          <div>
            <pre><code class="lang-javascript">ogma.styles.addRule({
  nodeAttributes: (node) => {
    // get data field
    const type = getNodeType(node);
    // match with the styles object
    const { color, icon } = nodeStyles[type];

    // sizing: quantity of incoming edges / 300
    // nodes size depend on the quantity of Product that is exanged through them
    const radius = node
      .getAdjacentEdges()
      .reduce((acc, e) => acc + e.getData("neo4jProperties.quantity"), 0) / 300 + 5;

    return {
      icon: {
        font: "icon-font",
        color: "#000000",
        content: icon,
      },
      color, radius
    };
}});</code></pre>
          </div>
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Apply node styling</p>
          <div>
            <img style="max-height: 500px;" src="images/example-3-nodes.png">
          </div>
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Add insights</p>
          <div>
            <pre><code class="lang-javascript">// Helper function to check if a node should pulse
// Nodes pulses if the total demand is higher than their stock
function hasRisk(node) {
  const totalDemand = node
    .getAdjacentEdges()
    .filter((edge) => edge.getSource() === node)
    .reduce((total, edge) => total + edge.getData("neo4jProperties.quantity"), 0);
  return node.getData("neo4jProperties.stock") - totalDemand < 100;
}

// enable pulse animation
ogma.getNodes().filter(hasRisk).pulse();
</code></pre>
          </div>
        </section>
        <section>
          <h2>4. Adding styles</h2>
          <p>Add insights</p>
          <div>
            <img style="max-height: 500px;" src="images/example-3-pulse.gif">
          </div>
          <div class="fragment">
            <a
              href="https://github.com/linkurious/ogma-training/examples/03-styling/">Get
              the code on Github</a>
          </div>
        </section>
      </section>

      <section data-background-image="images/background.png">
        <section>
          <h2>5. Geo mode + Transformations</h2>
          <p>Let's look at the the same graph with the geo reference</p>
          <pre><code class="lang-javascript">// let Ogma know where to look for the coordinates
ogma.geo.enable({
  longitudePath: 'neo4jProperties.lon',
  latitudePath: 'neo4jProperties.lat'
});</code></pre>
          <div class="fragment">
            <img style="max-height: 400px;" src="images/example-4-geo.png">
            <div>
              <a
                href="https://doc.linkurio.us/ogma/latest/tutorials/geo-leaflet/index.html">Ogma
                geo mode tutorial</a>
            </div>
          </div>
        </section>
        <section>
          <h2>5. Geo mode + Transformations</h2>
          <p>Let's clear up the view a bit</p>
          <p class="fragment">First let's group the parallel edges</p>
          <div class="fragment">
            <pre><code class="lang-javascript">const edgeGrouping = ogma.transformations.addEdgeGrouping({
  selector: (edge) => edge.getData("neo4jType") === "DELIVER",
  generator: (edges) => {
    return {
      data: { neo4jProperties: {  quantity: edges.reduce(...), 0), }}
    };
  }
});</code></pre>
          </div>
        </section>
        <section>
          <h2>5. Geo mode + Transformations</h2>
          <p>Parallel edges are grouped</p>
          <div>
            <img style="max-height: 500px;" src="images/example-4-edges.png">
          </div>
        </section>
        <section>
          <h2>5. Geo mode + Transformations</h2>
          <p>Let's group the nodes: join the raw suppliers, wholesalers and
            group the part suppliers:</p>
          <div class="fragment">
            <pre><code class="lang-javascript">const nodeGrouping = ogma.transformations.addNodeGrouping({
  groupIdFunction: (node) => node.getData("neo4jLabels")[0],
  // don't group the product
  selector: (node) => node.getData("neo4jLabels")[0] !== "Product",
  nodeGenerator: (nodes, groupId) => {
    // choose label for the style
    let label = ['Wholesalers']; // default
    if (groupId === "SupplierA") label = ["FrameSupplier"];
    else if (groupId === "SupplierB") label = ["WheelSupplier"];
    else if (/RawSupplier/.test(groupId)) label = ["RawSuppliers"];
    else if (groupId === 'Retailer') label = ["Retailers"];

    // sizing criteria
    const quantity = nodes.getData("neo4jProperties.quantity")
      .reduce((total, q) => total + q, 0);

    // generated group node
    return {
      data: {
        neo4jLabels: label,
        neo4jProperties: { quantity }
      }
    };
  }
});</code></pre>
          </div>
        </section>
        <section>
          <h2>5. Geo mode + Transformations</h2>
          <p>Nodes are now grouped by the type:</p>
          <div>
            <img style="max-height: 450px;" src="images/example-4-nodes.png">
          </div>
        </section>
        <section>
          <h2>5. Geo mode + Transformations</h2>
          <p>Let's make sense of this new view on the supply chain by applying a
            different layout:</p>
          <div class="fragment">
            <img src="images/example-4-layout.png">
          </div>
          <div class="fragment">
            <a
              href="https://github.com/linkurious/ogma-training/examples/04-transformations/">Get
              the code on Github</a>
          </div>
        </section>
      </section>

      <section data-background-image="images/background.png">
        <section>
          <h2>6. UI & frameworks</h2>
          <p>Let's add some controls</p>
          <div class="fragment">
            <pre>
            <code class="lang-html"><!-- index.html -->
<div id="controls">
  <button id="edge-grouping">Edge grouping: off</button>
  <button id="node-grouping">Node grouping: off</button>
  <button id="geo-mode">Geo mode</button>
</div>
            </code>
          </pre>
          </div>
          <div class="fragment">
            <pre>
            <code class="lang-javascript">// index.js
const edgeGroupingButton = document.getElementById('edge-grouping');
edgeGroupingButton.addEventListener('click', () => {
  edgeGrouping.toggle()
    .then(() => {
      const state = edgeGrouping.isEnabled() ? 'on' : 'off';
      edgeGroupingButton.innerHTML = 'Edge grouping: ' + state;
    });
});
            </code>
          </pre>
          </div>
        </section>
        <section>
          <h2>6. UI & frameworks</h2>
          <img src="images/example-5-ui.png">
        </section>
        <section>
          <h2>6. UI & frameworks</h2>
          <p>Final result</p>
          <iframe width="100%" height="550"
            src="examples/04-transformations/"></iframe>
        </section>
        <section>
          <div>
            <a href="https://github.com/linkurious/ogma-training/">Get
              the code on Github</a>
          </div>
        </section>
        <section>
          <h2>6. UI & frameworks</h2>
          <p>Ogma integrates nicely with all the popular front-end frameworks
          </p>
          <p><img src="images/react-logo.jpg" width="150" class="logo">
            <img src="images/ts-logo.png" width="150" class="logo">
            <img src="images/vue-logo.png" width="150" class="logo">
          </p>
          <p><img src="images/webpack.png" width="150" class="logo">
            <img src="images/angular-logo.svg" width="150" class="logo"> <img
              src="images/node-logo.png" width="150" class="logo">
          </p>
          <div class="fragment"><a
              href="https://doc.linkurio.us/ogma/latest/tutorials/">https://ogma.linkurio.us/tutorials/</a>
          </div>
        </section>
      </section>
      <section data-background-image="images/background.png">
        <h2>Questions?</h2>
        <p>ogma@linkurio.us</p>
        <p><a href="https://ogma.linkurio.us">Ogma docs</a>
        <p><a href="https://get.linkurio.us">Distribution center</a></p>
        <p><a href="https://github.com/linkurios/ogma-training/">Code from this
            presentation</a></p>
      </section>
    </div>
  </div>
  <script src="./index.js"></script>
</body>

</html>
